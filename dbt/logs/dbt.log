[0m14:03:29.228499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ddf990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e30150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112dd4090>]}


============================== 14:03:29.232055 | 5e1acd32-6eae-4e6d-a2ad-a5ef8518da9c ==============================
[0m14:03:29.232055 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:03:29.232707 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/roman/Desktop/hw4-mlops-bokhyan/dbt/logs', 'profiles_dir': '..', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:03:29.314635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e1acd32-6eae-4e6d-a2ad-a5ef8518da9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e50f10>]}
[0m14:03:29.332525 [debug] [MainThread]: Set downloads directory='/var/folders/md/1cwdxcj9029gzv7mhg8hkg480000gn/T/dbt-downloads-2iffykmd'
[0m14:03:29.333449 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:03:29.671705 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:03:29.672578 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:03:29.890139 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:03:29.898241 [error] [MainThread]: Encountered an error:
Package dbt-labs/dbt_date was not found in the package index
[0m14:03:29.902081 [error] [MainThread]: Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/dbt/cli/requires.py", line 201, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/dbt/cli/main.py", line 447, in deps
    results = task.run()
              ^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/dbt/task/deps.py", line 217, in run
    self.lock()
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/dbt/task/deps.py", line 194, in lock
    resolved_deps = resolve_packages(packages, self.project, self.cli_vars)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/dbt/deps/resolver.py", line 128, in resolve_packages
    target = final[package].resolved().fetch_metadata(project, renderer)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/dbt/deps/registry.py", line 101, in resolved
    self._check_in_index()
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/dbt/deps/registry.py", line 80, in _check_in_index
    raise PackageNotFoundError(self.package)
dbt.exceptions.PackageNotFoundError: Package dbt-labs/dbt_date was not found in the package index

[0m14:03:30.190559 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_wall_clock_time": 1.0112773, "process_user_time": 0.823175, "process_kernel_time": 0.198506, "process_mem_max_rss": "110919680", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:03:30.191027 [debug] [MainThread]: Command `dbt deps` failed at 14:03:30.190965 after 1.01 seconds
[0m14:03:30.191305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e66450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b09110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ba72d0>]}
[0m14:03:30.191743 [debug] [MainThread]: Flushing usage events
[0m14:03:44.231778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d1f8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d90c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d91290>]}


============================== 14:03:44.235438 | 1b6b1ff1-8a83-4b0b-b2ac-f4b0f8fdca10 ==============================
[0m14:03:44.235438 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:03:44.235854 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/roman/Desktop/hw4-mlops-bokhyan/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '..', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:03:44.316320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b6b1ff1-8a83-4b0b-b2ac-f4b0f8fdca10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f0e750>]}
[0m14:03:44.330785 [debug] [MainThread]: Set downloads directory='/var/folders/md/1cwdxcj9029gzv7mhg8hkg480000gn/T/dbt-downloads-iy1hfhod'
[0m14:03:44.331216 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:03:44.551873 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:03:44.552659 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:03:44.749265 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:03:44.759172 [error] [MainThread]: Encountered an error:
Package dbt-labs/dbt-date was not found in the package index
[0m14:03:44.763858 [error] [MainThread]: Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/dbt/cli/requires.py", line 201, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/dbt/cli/main.py", line 447, in deps
    results = task.run()
              ^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/dbt/task/deps.py", line 217, in run
    self.lock()
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/dbt/task/deps.py", line 194, in lock
    resolved_deps = resolve_packages(packages, self.project, self.cli_vars)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/dbt/deps/resolver.py", line 128, in resolve_packages
    target = final[package].resolved().fetch_metadata(project, renderer)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/dbt/deps/registry.py", line 101, in resolved
    self._check_in_index()
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/dbt/deps/registry.py", line 80, in _check_in_index
    raise PackageNotFoundError(self.package)
dbt.exceptions.PackageNotFoundError: Package dbt-labs/dbt-date was not found in the package index

[0m14:03:44.768342 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_wall_clock_time": 0.58142525, "process_user_time": 0.827651, "process_kernel_time": 0.191371, "process_mem_max_rss": "110723072", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:03:44.769030 [debug] [MainThread]: Command `dbt deps` failed at 14:03:44.768941 after 0.58 seconds
[0m14:03:44.769406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c1ba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101099110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d91010>]}
[0m14:03:44.769873 [debug] [MainThread]: Flushing usage events
[0m14:05:26.216631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11111fe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111179250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111179e10>]}


============================== 14:05:26.220113 | 5e0927b7-4c9b-4992-b40f-1a837177bc25 ==============================
[0m14:05:26.220113 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:05:26.220540 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/roman/Desktop/hw4-mlops-bokhyan/dbt/logs', 'profiles_dir': '..', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:26.304587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e0927b7-4c9b-4992-b40f-1a837177bc25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111267e10>]}
[0m14:05:26.319668 [debug] [MainThread]: Set downloads directory='/var/folders/md/1cwdxcj9029gzv7mhg8hkg480000gn/T/dbt-downloads-s864g0js'
[0m14:05:26.320289 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:26.510133 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:26.510815 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:26.733360 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:26.740517 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m14:05:26.931886 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m14:05:26.932718 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_date` package is deprecated in favor of
`godatadriven/dbt_date`. Please update your `packages.yml` configuration to use
`godatadriven/dbt_date` instead.
[0m14:05:26.933492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5e0927b7-4c9b-4992-b40f-1a837177bc25', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111c5450>]}
[0m14:05:26.935676 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m14:05:27.141810 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m14:05:27.153509 [info ] [MainThread]: Updating lock file in file path: /Users/roman/Desktop/hw4-mlops-bokhyan/dbt/package-lock.yml
[0m14:05:27.156454 [debug] [MainThread]: Set downloads directory='/var/folders/md/1cwdxcj9029gzv7mhg8hkg480000gn/T/dbt-downloads-ptes5xeq'
[0m14:05:27.161264 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:27.684120 [info ] [MainThread]: Installed from version 1.3.2
[0m14:05:27.684405 [info ] [MainThread]: Up to date!
[0m14:05:27.684601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5e0927b7-4c9b-4992-b40f-1a837177bc25', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11145d450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11145cb50>]}
[0m14:05:27.684860 [info ] [MainThread]: Installing calogica/dbt_date
[0m14:05:28.061155 [info ] [MainThread]: Installed from version 0.10.1
[0m14:05:28.061485 [info ] [MainThread]: Up to date!
[0m14:05:28.061695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5e0927b7-4c9b-4992-b40f-1a837177bc25', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11140ec10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11140e390>]}
[0m14:05:28.061921 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m14:05:29.035245 [info ] [MainThread]: Installed from version 0.10.4
[0m14:05:29.035771 [info ] [MainThread]: Up to date!
[0m14:05:29.036327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5e0927b7-4c9b-4992-b40f-1a837177bc25', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ad8f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111170210>]}
[0m14:05:29.039639 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 2.868712, "process_user_time": 0.936366, "process_kernel_time": 0.303515, "process_mem_max_rss": "119193600", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:29.040112 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:29.040032 after 2.87 seconds
[0m14:05:29.040374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f81110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111179710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111179650>]}
[0m14:05:29.040676 [debug] [MainThread]: Flushing usage events
[0m14:05:46.101072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1224df510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12251cb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12255d350>]}


============================== 14:05:46.104707 | f16bd517-02dd-4d8e-8f15-4d627874bb89 ==============================
[0m14:05:46.104707 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:05:46.105063 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '..', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/roman/Desktop/hw4-mlops-bokhyan/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:46.183981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f16bd517-02dd-4d8e-8f15-4d627874bb89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1222c6210>]}
[0m14:05:46.199005 [debug] [MainThread]: Set downloads directory='/var/folders/md/1cwdxcj9029gzv7mhg8hkg480000gn/T/dbt-downloads-tyjc_fok'
[0m14:05:46.199709 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:46.368598 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:46.369309 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:46.566268 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:46.571353 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json
[0m14:05:46.750509 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json 200
[0m14:05:46.752825 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m14:05:46.946950 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m14:05:46.947825 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_expectations` package is deprecated in favor of
`metaplane/dbt_expectations`. Please update your `packages.yml` configuration to
use `metaplane/dbt_expectations` instead.
[0m14:05:46.948068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f16bd517-02dd-4d8e-8f15-4d627874bb89', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1227899d0>]}
[0m14:05:46.950234 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m14:05:47.220827 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m14:05:47.229728 [error] [MainThread]: Encountered an error:
Found duplicate project "dbt_date". This occurs when a dependency has the same project name as some other dependency.
[0m14:05:47.232126 [error] [MainThread]: Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/dbt/cli/requires.py", line 201, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/dbt/cli/main.py", line 447, in deps
    results = task.run()
              ^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/dbt/task/deps.py", line 225, in run
    self.lock()
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/dbt/task/deps.py", line 194, in lock
    resolved_deps = resolve_packages(packages, self.project, self.cli_vars)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/dbt/deps/resolver.py", line 133, in resolve_packages
    _check_for_duplicate_project_names(resolved, project, renderer)
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/dbt/deps/resolver.py", line 107, in _check_for_duplicate_project_names
    raise DuplicateProjectDependencyError(project_name)
dbt.exceptions.DuplicateProjectDependencyError: Found duplicate project "dbt_date". This occurs when a dependency has the same project name as some other dependency.

[0m14:05:47.234752 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_wall_clock_time": 1.1803848, "process_user_time": 0.947747, "process_kernel_time": 0.239301, "process_mem_max_rss": "111362048", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:47.235158 [debug] [MainThread]: Command `dbt deps` failed at 14:05:47.235090 after 1.18 seconds
[0m14:05:47.235460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122564c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1025350d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1025d2f50>]}
[0m14:05:47.235709 [debug] [MainThread]: Flushing usage events
[0m14:06:00.208231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128163d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112888490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112888b10>]}


============================== 14:06:00.211666 | 6cae377b-c3bb-4a56-8ed1-cc4ec0e52a8f ==============================
[0m14:06:00.211666 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:06:00.212013 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '..', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/roman/Desktop/hw4-mlops-bokhyan/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:06:00.295494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6cae377b-c3bb-4a56-8ed1-cc4ec0e52a8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128d2a10>]}
[0m14:06:00.309778 [debug] [MainThread]: Set downloads directory='/var/folders/md/1cwdxcj9029gzv7mhg8hkg480000gn/T/dbt-downloads-ua1mi5b2'
[0m14:06:00.310177 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:06:00.520249 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:06:00.520876 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:06:00.715225 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:06:00.719586 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json
[0m14:06:00.914373 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json 200
[0m14:06:00.916493 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m14:06:01.127538 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m14:06:01.128570 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_expectations` package is deprecated in favor of
`metaplane/dbt_expectations`. Please update your `packages.yml` configuration to
use `metaplane/dbt_expectations` instead.
[0m14:06:01.133727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6cae377b-c3bb-4a56-8ed1-cc4ec0e52a8f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b3a450>]}
[0m14:06:01.136458 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m14:06:01.323765 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m14:06:01.338618 [error] [MainThread]: Encountered an error:
Found duplicate project "dbt_date". This occurs when a dependency has the same project name as some other dependency.
[0m14:06:01.341850 [error] [MainThread]: Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/dbt/cli/requires.py", line 201, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/dbt/cli/main.py", line 447, in deps
    results = task.run()
              ^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/dbt/task/deps.py", line 217, in run
    self.lock()
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/dbt/task/deps.py", line 194, in lock
    resolved_deps = resolve_packages(packages, self.project, self.cli_vars)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/dbt/deps/resolver.py", line 133, in resolve_packages
    _check_for_duplicate_project_names(resolved, project, renderer)
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/dbt/deps/resolver.py", line 107, in _check_for_duplicate_project_names
    raise DuplicateProjectDependencyError(project_name)
dbt.exceptions.DuplicateProjectDependencyError: Found duplicate project "dbt_date". This occurs when a dependency has the same project name as some other dependency.

[0m14:06:01.345128 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_wall_clock_time": 1.1799324, "process_user_time": 0.859708, "process_kernel_time": 0.210109, "process_mem_max_rss": "111017984", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:06:01.345647 [debug] [MainThread]: Command `dbt deps` failed at 14:06:01.345570 after 1.18 seconds
[0m14:06:01.345958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128a9f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045c1090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10465ef50>]}
[0m14:06:01.346250 [debug] [MainThread]: Flushing usage events
[0m14:06:13.669519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a1e3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a81190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a81810>]}


============================== 14:06:13.672969 | aa5f6bdf-a940-410e-861a-1c7010b1818f ==============================
[0m14:06:13.672969 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:06:13.673514 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '..', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/roman/Desktop/hw4-mlops-bokhyan/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:06:13.756496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa5f6bdf-a940-410e-861a-1c7010b1818f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b2d890>]}
[0m14:06:13.771271 [debug] [MainThread]: Set downloads directory='/var/folders/md/1cwdxcj9029gzv7mhg8hkg480000gn/T/dbt-downloads-_thcwn72'
[0m14:06:13.771774 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:06:14.052035 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:06:14.052732 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:06:14.373597 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:06:14.377838 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json
[0m14:06:14.581992 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json 200
[0m14:06:14.584579 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m14:06:14.769268 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m14:06:14.770879 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_expectations` package is deprecated in favor of
`metaplane/dbt_expectations`. Please update your `packages.yml` configuration to
use `metaplane/dbt_expectations` instead.
[0m14:06:14.771384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'aa5f6bdf-a940-410e-861a-1c7010b1818f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b79610>]}
[0m14:06:14.775200 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m14:06:15.013343 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m14:06:15.024427 [error] [MainThread]: Encountered an error:
Found duplicate project "dbt_date". This occurs when a dependency has the same project name as some other dependency.
[0m14:06:15.026788 [error] [MainThread]: Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/dbt/cli/requires.py", line 201, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/dbt/cli/main.py", line 447, in deps
    results = task.run()
              ^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/dbt/task/deps.py", line 217, in run
    self.lock()
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/dbt/task/deps.py", line 194, in lock
    resolved_deps = resolve_packages(packages, self.project, self.cli_vars)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/dbt/deps/resolver.py", line 133, in resolve_packages
    _check_for_duplicate_project_names(resolved, project, renderer)
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/dbt/deps/resolver.py", line 107, in _check_for_duplicate_project_names
    raise DuplicateProjectDependencyError(project_name)
dbt.exceptions.DuplicateProjectDependencyError: Found duplicate project "dbt_date". This occurs when a dependency has the same project name as some other dependency.

[0m14:06:15.029391 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_wall_clock_time": 1.4034562, "process_user_time": 0.85864, "process_kernel_time": 0.204932, "process_mem_max_rss": "110264320", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:06:15.029777 [debug] [MainThread]: Command `dbt deps` failed at 14:06:15.029723 after 1.40 seconds
[0m14:06:15.030019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b85110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a832d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c232d0>]}
[0m14:06:15.030249 [debug] [MainThread]: Flushing usage events
[0m14:07:07.704788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105342950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053bca10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053bd090>]}


============================== 14:07:07.708860 | db51d339-2b89-4d04-9985-c02145f9a381 ==============================
[0m14:07:07.708860 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:07:07.709250 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '..', 'version_check': 'True', 'debug': 'True', 'log_path': '/Users/roman/Desktop/hw4-mlops-bokhyan/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --debug', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:07:07.790383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db51d339-2b89-4d04-9985-c02145f9a381', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10546a610>]}
[0m14:07:07.806363 [debug] [MainThread]: Set downloads directory='/var/folders/md/1cwdxcj9029gzv7mhg8hkg480000gn/T/dbt-downloads-moq7dmdm'
[0m14:07:07.806775 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:07:08.055722 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:07:08.056649 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:07:08.291405 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:07:08.295854 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json
[0m14:07:08.533039 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json 200
[0m14:07:08.535879 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m14:07:08.747238 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m14:07:08.748661 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_expectations` package is deprecated in favor of
`metaplane/dbt_expectations`. Please update your `packages.yml` configuration to
use `metaplane/dbt_expectations` instead.
[0m14:07:08.749052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'db51d339-2b89-4d04-9985-c02145f9a381', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105566f50>]}
[0m14:07:08.752834 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m14:07:08.943363 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m14:07:08.952479 [error] [MainThread]: Encountered an error:
Found duplicate project "dbt_date". This occurs when a dependency has the same project name as some other dependency.
[0m14:07:08.955738 [error] [MainThread]: Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/dbt/cli/requires.py", line 201, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/dbt/cli/main.py", line 447, in deps
    results = task.run()
              ^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/dbt/task/deps.py", line 217, in run
    self.lock()
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/dbt/task/deps.py", line 194, in lock
    resolved_deps = resolve_packages(packages, self.project, self.cli_vars)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/dbt/deps/resolver.py", line 133, in resolve_packages
    _check_for_duplicate_project_names(resolved, project, renderer)
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/dbt/deps/resolver.py", line 107, in _check_for_duplicate_project_names
    raise DuplicateProjectDependencyError(project_name)
dbt.exceptions.DuplicateProjectDependencyError: Found duplicate project "dbt_date". This occurs when a dependency has the same project name as some other dependency.

[0m14:07:08.958189 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_wall_clock_time": 1.2977997, "process_user_time": 0.84553, "process_kernel_time": 0.208565, "process_mem_max_rss": "110592000", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:07:08.958826 [debug] [MainThread]: Command `dbt deps` failed at 14:07:08.958723 after 1.30 seconds
[0m14:07:08.959254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053d1590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100c75090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100d12e90>]}
[0m14:07:08.959614 [debug] [MainThread]: Flushing usage events
[0m14:08:02.908634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c14e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c94b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c95750>]}


============================== 14:08:02.912487 | d6052a86-4e5b-4887-9a91-8c969630a947 ==============================
[0m14:08:02.912487 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:08:02.912883 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '..', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/roman/Desktop/hw4-mlops-bokhyan/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:08:03.040998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6052a86-4e5b-4887-9a91-8c969630a947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d0d9d0>]}
[0m14:08:03.057472 [debug] [MainThread]: Set downloads directory='/var/folders/md/1cwdxcj9029gzv7mhg8hkg480000gn/T/dbt-downloads-ylplmabk'
[0m14:08:03.057893 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:08:03.305569 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:08:03.306223 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:08:03.529580 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:08:03.533654 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m14:08:03.733798 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m14:08:03.734681 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_date` package is deprecated in favor of
`godatadriven/dbt_date`. Please update your `packages.yml` configuration to use
`godatadriven/dbt_date` instead.
[0m14:08:03.735062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd6052a86-4e5b-4887-9a91-8c969630a947', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cac110>]}
[0m14:08:03.736666 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m14:08:03.983289 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m14:08:03.994128 [info ] [MainThread]: Updating lock file in file path: /Users/roman/Desktop/hw4-mlops-bokhyan/dbt/package-lock.yml
[0m14:08:03.996041 [debug] [MainThread]: Set downloads directory='/var/folders/md/1cwdxcj9029gzv7mhg8hkg480000gn/T/dbt-downloads-xzzu100j'
[0m14:08:04.000087 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:08:04.684954 [info ] [MainThread]: Installed from version 1.3.2
[0m14:08:04.685366 [info ] [MainThread]: Up to date!
[0m14:08:04.685892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd6052a86-4e5b-4887-9a91-8c969630a947', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c0e590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e32c90>]}
[0m14:08:04.686147 [info ] [MainThread]: Installing calogica/dbt_date
[0m14:08:05.111347 [info ] [MainThread]: Installed from version 0.10.1
[0m14:08:05.111730 [info ] [MainThread]: Up to date!
[0m14:08:05.111954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd6052a86-4e5b-4887-9a91-8c969630a947', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ccabd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d05590>]}
[0m14:08:05.112316 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m14:08:06.280453 [info ] [MainThread]: Installed from version 0.10.4
[0m14:08:06.280718 [info ] [MainThread]: Up to date!
[0m14:08:06.280911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd6052a86-4e5b-4887-9a91-8c969630a947', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d77990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c68790>]}
[0m14:08:06.284148 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 3.4199471, "process_user_time": 0.929601, "process_kernel_time": 0.322691, "process_mem_max_rss": "117981184", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:08:06.284540 [debug] [MainThread]: Command `dbt deps` succeeded at 14:08:06.284485 after 3.42 seconds
[0m14:08:06.284773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100535110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c95110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c94f50>]}
[0m14:08:06.284973 [debug] [MainThread]: Flushing usage events
[0m14:08:12.909415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a51fdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a20e8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a571590>]}


============================== 14:08:12.913946 | 1b7161d9-30ef-4aaf-b7b9-6a71f7b26d10 ==============================
[0m14:08:12.913946 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:08:12.914379 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/roman/Desktop/hw4-mlops-bokhyan/dbt/logs', 'profiles_dir': '..', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:08:12.918046 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'hw4_dbt'
[0m14:08:12.921446 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 0.06397821, "process_user_time": 0.775956, "process_kernel_time": 0.163636, "process_mem_max_rss": "103841792", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:08:12.922010 [debug] [MainThread]: Command `dbt seed` failed at 14:08:12.921934 after 0.06 seconds
[0m14:08:12.922371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a56bcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b35110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a571750>]}
[0m14:08:12.922745 [debug] [MainThread]: Flushing usage events
[0m14:08:33.440713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ce10d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d40b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d41210>]}


============================== 14:08:33.444478 | a9130511-7975-4823-831d-f8331928d269 ==============================
[0m14:08:33.444478 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:08:33.444852 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/roman/Desktop/hw4-mlops-bokhyan/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m14:08:33.949294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9130511-7975-4823-831d-f8331928d269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d40290>]}
[0m14:08:33.985663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a9130511-7975-4823-831d-f8331928d269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a4fc50>]}
[0m14:08:33.986619 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m14:08:34.455822 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m14:08:34.456450 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:08:34.456674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a9130511-7975-4823-831d-f8331928d269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f40950>]}
[0m14:08:35.394818 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:08:35.395195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a9130511-7975-4823-831d-f8331928d269', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10936e010>]}
[0m14:08:35.707228 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.hw4_dbt.sources
[0m14:08:35.714934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9130511-7975-4823-831d-f8331928d269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10936a9d0>]}
[0m14:08:35.800147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9130511-7975-4823-831d-f8331928d269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10991f710>]}
[0m14:08:35.800551 [info ] [MainThread]: Found 7 models, 56 data tests, 2 seeds, 1 source, 805 macros
[0m14:08:35.800745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9130511-7975-4823-831d-f8331928d269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090e58d0>]}
[0m14:08:35.802475 [info ] [MainThread]: 
[0m14:08:35.803064 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:08:35.806314 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_transactions'
[0m14:08:35.855012 [debug] [ThreadPool]: Using duckdb connection "list_transactions"
[0m14:08:35.855325 [debug] [ThreadPool]: On list_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "connection_name": "list_transactions"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'transactions'
    
  
  
[0m14:08:35.855494 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:08:37.749794 [debug] [ThreadPool]: SQL status: OK in 1.894 seconds
[0m14:08:37.750733 [debug] [ThreadPool]: On list_transactions: Close
[0m14:08:37.752152 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transactions, now create_transactions_main_transactions_db)
[0m14:08:37.752412 [debug] [ThreadPool]: Creating schema "database: "transactions"
schema: "main_transactions_db"
"
[0m14:08:37.756256 [debug] [ThreadPool]: Using duckdb connection "create_transactions_main_transactions_db"
[0m14:08:37.756555 [debug] [ThreadPool]: On create_transactions_main_transactions_db: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "connection_name": "create_transactions_main_transactions_db"} */

    
        select type from duckdb_databases()
        where database_name='transactions'
        and type='sqlite'
    
  
[0m14:08:37.756741 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:08:37.764404 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m14:08:37.766750 [debug] [ThreadPool]: Using duckdb connection "create_transactions_main_transactions_db"
[0m14:08:37.766986 [debug] [ThreadPool]: On create_transactions_main_transactions_db: BEGIN
[0m14:08:37.767400 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:08:37.768501 [debug] [ThreadPool]: Using duckdb connection "create_transactions_main_transactions_db"
[0m14:08:37.768787 [debug] [ThreadPool]: On create_transactions_main_transactions_db: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "connection_name": "create_transactions_main_transactions_db"} */

    
    
        create schema if not exists transactions.main_transactions_db
    
[0m14:08:37.769178 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:08:37.769712 [debug] [ThreadPool]: On create_transactions_main_transactions_db: COMMIT
[0m14:08:37.770734 [debug] [ThreadPool]: Using duckdb connection "create_transactions_main_transactions_db"
[0m14:08:37.771013 [debug] [ThreadPool]: On create_transactions_main_transactions_db: COMMIT
[0m14:08:37.772825 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:08:37.773107 [debug] [ThreadPool]: On create_transactions_main_transactions_db: Close
[0m14:08:37.776331 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_transactions_main_transactions_db, now list_transactions_main_transactions_db)
[0m14:08:37.776699 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_transactions_main_staging'
[0m14:08:37.777017 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_transactions_main_marts'
[0m14:08:37.780219 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_transactions_db"
[0m14:08:37.782426 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_staging"
[0m14:08:37.783734 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_marts"
[0m14:08:37.783974 [debug] [ThreadPool]: On list_transactions_main_transactions_db: BEGIN
[0m14:08:37.784219 [debug] [ThreadPool]: On list_transactions_main_staging: BEGIN
[0m14:08:37.784417 [debug] [ThreadPool]: On list_transactions_main_marts: BEGIN
[0m14:08:37.784600 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:08:37.784784 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:08:37.785005 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:08:37.793129 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m14:08:37.793380 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m14:08:37.793580 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m14:08:37.793785 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_transactions_db"
[0m14:08:37.793929 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_staging"
[0m14:08:37.794082 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_marts"
[0m14:08:37.794272 [debug] [ThreadPool]: On list_transactions_main_transactions_db: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "connection_name": "list_transactions_main_transactions_db"} */
select
      'transactions' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_transactions_db'
    and table_catalog = 'transactions'
  
[0m14:08:37.794462 [debug] [ThreadPool]: On list_transactions_main_staging: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "connection_name": "list_transactions_main_staging"} */
select
      'transactions' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_staging'
    and table_catalog = 'transactions'
  
[0m14:08:37.794834 [debug] [ThreadPool]: On list_transactions_main_marts: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "connection_name": "list_transactions_main_marts"} */
select
      'transactions' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_marts'
    and table_catalog = 'transactions'
  
[0m14:08:37.805440 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m14:08:37.805945 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m14:08:37.806219 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m14:08:37.806986 [debug] [ThreadPool]: On list_transactions_main_transactions_db: ROLLBACK
[0m14:08:37.807728 [debug] [ThreadPool]: On list_transactions_main_marts: ROLLBACK
[0m14:08:37.808531 [debug] [ThreadPool]: On list_transactions_main_staging: ROLLBACK
[0m14:08:37.809639 [debug] [ThreadPool]: Failed to rollback 'list_transactions_main_transactions_db'
[0m14:08:37.809923 [debug] [ThreadPool]: Failed to rollback 'list_transactions_main_staging'
[0m14:08:37.810106 [debug] [ThreadPool]: On list_transactions_main_transactions_db: Close
[0m14:08:37.810273 [debug] [ThreadPool]: Failed to rollback 'list_transactions_main_marts'
[0m14:08:37.810441 [debug] [ThreadPool]: On list_transactions_main_staging: Close
[0m14:08:37.810782 [debug] [ThreadPool]: On list_transactions_main_marts: Close
[0m14:08:37.812583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9130511-7975-4823-831d-f8331928d269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098483d0>]}
[0m14:08:37.812939 [debug] [MainThread]: Using duckdb connection "master"
[0m14:08:37.813103 [debug] [MainThread]: On master: BEGIN
[0m14:08:37.813245 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:08:37.820947 [debug] [MainThread]: SQL status: OK in 0.008 seconds
[0m14:08:37.821256 [debug] [MainThread]: On master: COMMIT
[0m14:08:37.821419 [debug] [MainThread]: Using duckdb connection "master"
[0m14:08:37.821566 [debug] [MainThread]: On master: COMMIT
[0m14:08:37.821824 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:08:37.821982 [debug] [MainThread]: On master: Close
[0m14:08:37.823266 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:08:37.823553 [info ] [MainThread]: 
[0m14:08:37.826082 [debug] [Thread-1 (]: Began running node seed.hw4_dbt.states
[0m14:08:37.826330 [debug] [Thread-2 (]: Began running node seed.hw4_dbt.transactions
[0m14:08:37.826676 [info ] [Thread-1 (]: 1 of 2 START seed file main_transactions_db.states ............................. [RUN]
[0m14:08:37.827115 [info ] [Thread-2 (]: 2 of 2 START seed file main_transactions_db.transactions ....................... [RUN]
[0m14:08:37.827545 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_transactions_main_transactions_db, now seed.hw4_dbt.states)
[0m14:08:37.827814 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_transactions_main_staging, now seed.hw4_dbt.transactions)
[0m14:08:37.828032 [debug] [Thread-1 (]: Began compiling node seed.hw4_dbt.states
[0m14:08:37.828292 [debug] [Thread-2 (]: Began compiling node seed.hw4_dbt.transactions
[0m14:08:37.828776 [debug] [Thread-1 (]: Began executing node seed.hw4_dbt.states
[0m14:08:37.829100 [debug] [Thread-2 (]: Began executing node seed.hw4_dbt.transactions
[0m14:08:37.845985 [debug] [Thread-1 (]: Using duckdb connection "seed.hw4_dbt.states"
[0m14:08:37.848418 [debug] [Thread-1 (]: On seed.hw4_dbt.states: BEGIN
[0m14:08:37.849283 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:37.861674 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m14:08:37.862888 [debug] [Thread-1 (]: Using duckdb connection "seed.hw4_dbt.states"
[0m14:08:37.863253 [debug] [Thread-1 (]: On seed.hw4_dbt.states: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "seed.hw4_dbt.states"} */

    create table transactions.main_transactions_db.states (state_code text,state_name text)
  
[0m14:08:37.864056 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:08:37.875801 [debug] [Thread-1 (]: Using duckdb connection "seed.hw4_dbt.states"
[0m14:08:37.876186 [debug] [Thread-1 (]: On seed.hw4_dbt.states: 
          COPY transactions.main_transactions_db.states FROM '/Users/roman/Desktop/hw4-mlops-bokhyan/dbt/seeds/states.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m14:08:37.882566 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m14:08:37.886146 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.hw4_dbt.states"
[0m14:08:37.901392 [debug] [Thread-1 (]: On seed.hw4_dbt.states: COMMIT
[0m14:08:37.901798 [debug] [Thread-1 (]: Using duckdb connection "seed.hw4_dbt.states"
[0m14:08:37.901979 [debug] [Thread-1 (]: On seed.hw4_dbt.states: COMMIT
[0m14:08:37.903733 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:08:37.905194 [debug] [Thread-1 (]: On seed.hw4_dbt.states: Close
[0m14:08:37.966706 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9130511-7975-4823-831d-f8331928d269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c9f9d0>]}
[0m14:08:38.108854 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file main_transactions_db.states ......................... [[32mINSERT 50[0m in 0.14s]
[0m14:08:38.132204 [debug] [Thread-1 (]: Finished running node seed.hw4_dbt.states
[0m14:09:07.556717 [debug] [Thread-2 (]: Using duckdb connection "seed.hw4_dbt.transactions"
[0m14:09:07.558144 [debug] [Thread-2 (]: On seed.hw4_dbt.transactions: BEGIN
[0m14:09:07.558621 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:09:07.571479 [debug] [Thread-2 (]: SQL status: OK in 0.013 seconds
[0m14:09:07.571811 [debug] [Thread-2 (]: Using duckdb connection "seed.hw4_dbt.transactions"
[0m14:09:07.572005 [debug] [Thread-2 (]: On seed.hw4_dbt.transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "seed.hw4_dbt.transactions"} */

    create table transactions.main_transactions_db.transactions (transaction_time text,merch text,cat_id text,amount float8,name_1 text,name_2 text,gender text,street text,one_city text,us_state text,post_code integer,lat float8,lon float8,population_city integer,jobs text,merchant_lat float8,merchant_lon float8,target integer)
  
[0m14:09:07.572569 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m14:09:07.573810 [debug] [Thread-2 (]: Using duckdb connection "seed.hw4_dbt.transactions"
[0m14:09:07.574025 [debug] [Thread-2 (]: On seed.hw4_dbt.transactions: 
          COPY transactions.main_transactions_db.transactions FROM '/Users/roman/Desktop/hw4-mlops-bokhyan/dbt/seeds/transactions.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m14:09:09.053039 [debug] [Thread-2 (]: SQL status: OK in 1.479 seconds
[0m14:09:09.053767 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.hw4_dbt.transactions"
[0m14:09:09.055341 [debug] [Thread-2 (]: On seed.hw4_dbt.transactions: COMMIT
[0m14:09:09.055533 [debug] [Thread-2 (]: Using duckdb connection "seed.hw4_dbt.transactions"
[0m14:09:09.055689 [debug] [Thread-2 (]: On seed.hw4_dbt.transactions: COMMIT
[0m14:09:09.061126 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m14:09:09.062082 [debug] [Thread-2 (]: On seed.hw4_dbt.transactions: Close
[0m14:09:09.069673 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9130511-7975-4823-831d-f8331928d269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b4c1d0>]}
[0m14:09:09.070347 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file main_transactions_db.transactions ................... [[32mINSERT 786431[0m in 31.24s]
[0m14:09:09.070949 [debug] [Thread-2 (]: Finished running node seed.hw4_dbt.transactions
[0m14:09:09.075695 [debug] [MainThread]: Using duckdb connection "master"
[0m14:09:09.076006 [debug] [MainThread]: On master: BEGIN
[0m14:09:09.076163 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:09:09.086358 [debug] [MainThread]: SQL status: OK in 0.010 seconds
[0m14:09:09.086641 [debug] [MainThread]: On master: COMMIT
[0m14:09:09.086788 [debug] [MainThread]: Using duckdb connection "master"
[0m14:09:09.086923 [debug] [MainThread]: On master: COMMIT
[0m14:09:09.087144 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:09:09.087280 [debug] [MainThread]: On master: Close
[0m14:09:09.088462 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:09:09.088626 [debug] [MainThread]: Connection 'seed.hw4_dbt.states' was properly closed.
[0m14:09:09.088782 [debug] [MainThread]: Connection 'seed.hw4_dbt.transactions' was properly closed.
[0m14:09:09.088900 [debug] [MainThread]: Connection 'list_transactions_main_marts' was properly closed.
[0m14:09:09.089208 [info ] [MainThread]: 
[0m14:09:09.089405 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 33.29 seconds (33.29s).
[0m14:09:09.090702 [debug] [MainThread]: Command end result
[0m14:09:09.187565 [info ] [MainThread]: 
[0m14:09:09.187922 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:09:09.188149 [info ] [MainThread]: 
[0m14:09:09.188500 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:09:09.191317 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 35.797676, "process_user_time": 32.039577, "process_kernel_time": 1.917728, "process_mem_max_rss": "2172076032", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:09:09.191728 [debug] [MainThread]: Command `dbt seed` succeeded at 14:09:09.191682 after 35.80 seconds
[0m14:09:09.192062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d41050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d40f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108aca550>]}
[0m14:09:09.192276 [debug] [MainThread]: Flushing usage events
[0m14:09:24.576422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10661f510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106674ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106675150>]}


============================== 14:09:24.580283 | 5adab0e1-ed04-4f95-ba58-8b7c24822833 ==============================
[0m14:09:24.580283 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:09:24.580683 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/roman/Desktop/hw4-mlops-bokhyan/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:09:24.772500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5adab0e1-ed04-4f95-ba58-8b7c24822833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066cc690>]}
[0m14:09:24.808631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5adab0e1-ed04-4f95-ba58-8b7c24822833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10512ca50>]}
[0m14:09:24.809874 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m14:09:24.876294 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m14:09:24.947508 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:09:24.947856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5adab0e1-ed04-4f95-ba58-8b7c24822833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050f0650>]}
[0m14:09:25.997632 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:09:25.998360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5adab0e1-ed04-4f95-ba58-8b7c24822833', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107434390>]}
[0m14:09:26.322294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5adab0e1-ed04-4f95-ba58-8b7c24822833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10778ef50>]}
[0m14:09:26.422877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5adab0e1-ed04-4f95-ba58-8b7c24822833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e0bb10>]}
[0m14:09:26.423263 [info ] [MainThread]: Found 7 models, 56 data tests, 2 seeds, 1 source, 805 macros
[0m14:09:26.423552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5adab0e1-ed04-4f95-ba58-8b7c24822833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076ab1d0>]}
[0m14:09:26.425576 [info ] [MainThread]: 
[0m14:09:26.425945 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:09:26.428795 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_transactions'
[0m14:09:26.429159 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_transactions'
[0m14:09:26.464923 [debug] [ThreadPool]: Using duckdb connection "list_transactions"
[0m14:09:26.465283 [debug] [ThreadPool]: Using duckdb connection "list_transactions"
[0m14:09:26.466084 [debug] [ThreadPool]: On list_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "connection_name": "list_transactions"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'transactions'
    
  
  
[0m14:09:26.466311 [debug] [ThreadPool]: On list_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "connection_name": "list_transactions"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'transactions'
    
  
  
[0m14:09:26.466501 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:09:26.466766 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:09:26.475582 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m14:09:26.475863 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m14:09:26.476647 [debug] [ThreadPool]: On list_transactions: Close
[0m14:09:26.477251 [debug] [ThreadPool]: On list_transactions: Close
[0m14:09:26.479076 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transactions, now create_transactions_main_marts)
[0m14:09:26.479330 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transactions, now create_transactions_main_staging)
[0m14:09:26.479652 [debug] [ThreadPool]: Creating schema "database: "transactions"
schema: "main_marts"
"
[0m14:09:26.480000 [debug] [ThreadPool]: Creating schema "database: "transactions"
schema: "main_staging"
"
[0m14:09:26.483824 [debug] [ThreadPool]: Using duckdb connection "create_transactions_main_marts"
[0m14:09:26.485212 [debug] [ThreadPool]: Using duckdb connection "create_transactions_main_staging"
[0m14:09:26.485439 [debug] [ThreadPool]: On create_transactions_main_marts: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "connection_name": "create_transactions_main_marts"} */

    
        select type from duckdb_databases()
        where database_name='transactions'
        and type='sqlite'
    
  
[0m14:09:26.485608 [debug] [ThreadPool]: On create_transactions_main_staging: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "connection_name": "create_transactions_main_staging"} */

    
        select type from duckdb_databases()
        where database_name='transactions'
        and type='sqlite'
    
  
[0m14:09:26.485751 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:09:26.485878 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:09:26.494160 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m14:09:26.494448 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m14:09:26.495580 [debug] [ThreadPool]: Using duckdb connection "create_transactions_main_marts"
[0m14:09:26.496230 [debug] [ThreadPool]: Using duckdb connection "create_transactions_main_staging"
[0m14:09:26.496408 [debug] [ThreadPool]: On create_transactions_main_marts: BEGIN
[0m14:09:26.496565 [debug] [ThreadPool]: On create_transactions_main_staging: BEGIN
[0m14:09:26.496974 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:09:26.497212 [debug] [ThreadPool]: Using duckdb connection "create_transactions_main_marts"
[0m14:09:26.497382 [debug] [ThreadPool]: On create_transactions_main_marts: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "connection_name": "create_transactions_main_marts"} */

    
    
        create schema if not exists transactions.main_marts
    
[0m14:09:26.497661 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:09:26.497860 [debug] [ThreadPool]: Using duckdb connection "create_transactions_main_staging"
[0m14:09:26.498017 [debug] [ThreadPool]: On create_transactions_main_staging: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "connection_name": "create_transactions_main_staging"} */

    
    
        create schema if not exists transactions.main_staging
    
[0m14:09:26.498218 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:09:26.498953 [debug] [ThreadPool]: On create_transactions_main_marts: COMMIT
[0m14:09:26.499277 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:09:26.499475 [debug] [ThreadPool]: Using duckdb connection "create_transactions_main_marts"
[0m14:09:26.500012 [debug] [ThreadPool]: On create_transactions_main_staging: COMMIT
[0m14:09:26.500207 [debug] [ThreadPool]: On create_transactions_main_marts: COMMIT
[0m14:09:26.500405 [debug] [ThreadPool]: Using duckdb connection "create_transactions_main_staging"
[0m14:09:26.500720 [debug] [ThreadPool]: On create_transactions_main_staging: COMMIT
[0m14:09:26.501114 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:09:26.501330 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:09:26.501466 [debug] [ThreadPool]: On create_transactions_main_marts: Close
[0m14:09:26.501648 [debug] [ThreadPool]: On create_transactions_main_staging: Close
[0m14:09:26.507898 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_transactions_main_marts, now list_transactions_main_transactions_db)
[0m14:09:26.508279 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_transactions_main_staging, now list_transactions_main_marts)
[0m14:09:26.508559 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_transactions_main_staging'
[0m14:09:26.511796 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_transactions_db"
[0m14:09:26.513333 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_marts"
[0m14:09:26.515449 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_staging"
[0m14:09:26.515848 [debug] [ThreadPool]: On list_transactions_main_transactions_db: BEGIN
[0m14:09:26.516041 [debug] [ThreadPool]: On list_transactions_main_marts: BEGIN
[0m14:09:26.516224 [debug] [ThreadPool]: On list_transactions_main_staging: BEGIN
[0m14:09:26.516400 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:09:26.516578 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:09:26.516815 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:09:26.524974 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m14:09:26.525403 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m14:09:26.525597 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_transactions_db"
[0m14:09:26.525785 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m14:09:26.526047 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_marts"
[0m14:09:26.526230 [debug] [ThreadPool]: On list_transactions_main_transactions_db: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "connection_name": "list_transactions_main_transactions_db"} */
select
      'transactions' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_transactions_db'
    and table_catalog = 'transactions'
  
[0m14:09:26.526391 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_staging"
[0m14:09:26.526550 [debug] [ThreadPool]: On list_transactions_main_marts: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "connection_name": "list_transactions_main_marts"} */
select
      'transactions' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_marts'
    and table_catalog = 'transactions'
  
[0m14:09:26.526955 [debug] [ThreadPool]: On list_transactions_main_staging: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "connection_name": "list_transactions_main_staging"} */
select
      'transactions' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_staging'
    and table_catalog = 'transactions'
  
[0m14:09:26.535620 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m14:09:26.536114 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m14:09:26.536513 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m14:09:26.537324 [debug] [ThreadPool]: On list_transactions_main_transactions_db: ROLLBACK
[0m14:09:26.537870 [debug] [ThreadPool]: On list_transactions_main_marts: ROLLBACK
[0m14:09:26.538510 [debug] [ThreadPool]: On list_transactions_main_staging: ROLLBACK
[0m14:09:26.539513 [debug] [ThreadPool]: Failed to rollback 'list_transactions_main_transactions_db'
[0m14:09:26.539844 [debug] [ThreadPool]: Failed to rollback 'list_transactions_main_staging'
[0m14:09:26.540003 [debug] [ThreadPool]: On list_transactions_main_transactions_db: Close
[0m14:09:26.540183 [debug] [ThreadPool]: Failed to rollback 'list_transactions_main_marts'
[0m14:09:26.540395 [debug] [ThreadPool]: On list_transactions_main_staging: Close
[0m14:09:26.541003 [debug] [ThreadPool]: On list_transactions_main_marts: Close
[0m14:09:26.542816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5adab0e1-ed04-4f95-ba58-8b7c24822833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107403d10>]}
[0m14:09:26.543142 [debug] [MainThread]: Using duckdb connection "master"
[0m14:09:26.543293 [debug] [MainThread]: On master: BEGIN
[0m14:09:26.543425 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:09:26.551001 [debug] [MainThread]: SQL status: OK in 0.008 seconds
[0m14:09:26.551280 [debug] [MainThread]: On master: COMMIT
[0m14:09:26.551422 [debug] [MainThread]: Using duckdb connection "master"
[0m14:09:26.551555 [debug] [MainThread]: On master: COMMIT
[0m14:09:26.551772 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:09:26.551908 [debug] [MainThread]: On master: Close
[0m14:09:26.553187 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:09:26.553431 [info ] [MainThread]: 
[0m14:09:26.555593 [debug] [Thread-1 (]: Began running node model.hw4_dbt.stg_transactions
[0m14:09:26.556054 [info ] [Thread-1 (]: 1 of 7 START sql view model main_staging.stg_transactions ...................... [RUN]
[0m14:09:26.556383 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_transactions_main_transactions_db, now model.hw4_dbt.stg_transactions)
[0m14:09:26.556643 [debug] [Thread-1 (]: Began compiling node model.hw4_dbt.stg_transactions
[0m14:09:26.563454 [debug] [Thread-1 (]: Writing injected SQL for node "model.hw4_dbt.stg_transactions"
[0m14:09:26.564249 [debug] [Thread-1 (]: Began executing node model.hw4_dbt.stg_transactions
[0m14:09:26.579942 [debug] [Thread-1 (]: Writing runtime sql for node "model.hw4_dbt.stg_transactions"
[0m14:09:26.580678 [debug] [Thread-1 (]: Using duckdb connection "model.hw4_dbt.stg_transactions"
[0m14:09:26.580866 [debug] [Thread-1 (]: On model.hw4_dbt.stg_transactions: BEGIN
[0m14:09:26.581027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:26.588756 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m14:09:26.589025 [debug] [Thread-1 (]: Using duckdb connection "model.hw4_dbt.stg_transactions"
[0m14:09:26.589285 [debug] [Thread-1 (]: On model.hw4_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "model.hw4_dbt.stg_transactions"} */

  
  create view transactions.main_staging.stg_transactions__dbt_tmp as (
    with source as (
    select * from transactions.transactions_db.transactions
),
renamed as (
    select
        md5(cast(coalesce(cast(transaction_time as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(merch as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(amount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(cat_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(post_code as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as transaction_id,
        cast(transaction_time as timestamp) as transaction_ts,
        cast(date(transaction_time) as date) as transaction_date,
        date_trunc('hour', cast(transaction_time as timestamp)) as transaction_hour,
        substr(dayname(cast(transaction_time as timestamp)), 1, 3) as day_name,
        merch as merchant_name,
        md5(cast(coalesce(cast(merch as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as merchant_id,
        cat_id,
        cast(amount as double) as amount,
        
    case
        when cast(amount as double) is null then 'unknown'
        when cast(amount as double) < 50 then 'small'
        when cast(amount as double) < 200 then 'medium'
        when cast(amount as double) < 500 then 'large'
        else 'extra_large'
    end
 as amount_bucket,
        case
            when upper(gender) in ('M', 'MALE') then 'M'
            when upper(gender) in ('F', 'FEMALE') then 'F'
            else 'U'
        end as gender,
        md5(cast(coalesce(cast(name_1 as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(name_2 as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(street as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(post_code as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
        concat_ws(' ', nullif(name_1, ''), nullif(name_2, '')) as customer_full_name,
        street,
        one_city as city,
        upper(us_state) as us_state,
        post_code,
        cast(lat as double) as customer_lat,
        cast(lon as double) as customer_lon,
        cast(merchant_lat as double) as merchant_lat,
        cast(merchant_lon as double) as merchant_lon,
        nullif(jobs, '') as job_title,
        cast(population_city as bigint) as population_city,
        cast(target as integer) as is_fraud,
        case when 
    case
        when cast(amount as double) is null then 'unknown'
        when cast(amount as double) < 50 then 'small'
        when cast(amount as double) < 200 then 'medium'
        when cast(amount as double) < 500 then 'large'
        else 'extra_large'
    end
 in ('large', 'extra_large') then 1 else 0 end as is_large_amount
    from source
),
with_states as (
    select
        r.*,
        s.state_name
    from renamed r
    left join transactions.main_transactions_db.states s
        on r.us_state = s.state_code
)
select * from with_states
  );

[0m14:09:26.596435 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "model.hw4_dbt.stg_transactions"} */

  
  create view transactions.main_staging.stg_transactions__dbt_tmp as (
    with source as (
    select * from transactions.transactions_db.transactions
),
renamed as (
    select
        md5(cast(coalesce(cast(transaction_time as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(merch as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(amount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(cat_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(post_code as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as transaction_id,
        cast(transaction_time as timestamp) as transaction_ts,
        cast(date(transaction_time) as date) as transaction_date,
        date_trunc('hour', cast(transaction_time as timestamp)) as transaction_hour,
        substr(dayname(cast(transaction_time as timestamp)), 1, 3) as day_name,
        merch as merchant_name,
        md5(cast(coalesce(cast(merch as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as merchant_id,
        cat_id,
        cast(amount as double) as amount,
        
    case
        when cast(amount as double) is null then 'unknown'
        when cast(amount as double) < 50 then 'small'
        when cast(amount as double) < 200 then 'medium'
        when cast(amount as double) < 500 then 'large'
        else 'extra_large'
    end
 as amount_bucket,
        case
            when upper(gender) in ('M', 'MALE') then 'M'
            when upper(gender) in ('F', 'FEMALE') then 'F'
            else 'U'
        end as gender,
        md5(cast(coalesce(cast(name_1 as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(name_2 as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(street as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(post_code as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
        concat_ws(' ', nullif(name_1, ''), nullif(name_2, '')) as customer_full_name,
        street,
        one_city as city,
        upper(us_state) as us_state,
        post_code,
        cast(lat as double) as customer_lat,
        cast(lon as double) as customer_lon,
        cast(merchant_lat as double) as merchant_lat,
        cast(merchant_lon as double) as merchant_lon,
        nullif(jobs, '') as job_title,
        cast(population_city as bigint) as population_city,
        cast(target as integer) as is_fraud,
        case when 
    case
        when cast(amount as double) is null then 'unknown'
        when cast(amount as double) < 50 then 'small'
        when cast(amount as double) < 200 then 'medium'
        when cast(amount as double) < 500 then 'large'
        else 'extra_large'
    end
 in ('large', 'extra_large') then 1 else 0 end as is_large_amount
    from source
),
with_states as (
    select
        r.*,
        s.state_name
    from renamed r
    left join transactions.main_transactions_db.states s
        on r.us_state = s.state_code
)
select * from with_states
  );

[0m14:09:26.596786 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m14:09:26.597041 [debug] [Thread-1 (]: On model.hw4_dbt.stg_transactions: ROLLBACK
[0m14:09:26.602102 [debug] [Thread-1 (]: Failed to rollback 'model.hw4_dbt.stg_transactions'
[0m14:09:26.602396 [debug] [Thread-1 (]: On model.hw4_dbt.stg_transactions: Close
[0m14:09:26.605191 [debug] [Thread-1 (]: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Catalog Error: Table with name transactions does not exist!
  Did you mean "main_transactions_db.transactions"?
  
  LINE 6:     select * from transactions.transactions_db.transactions
                            ^
[0m14:09:26.606086 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5adab0e1-ed04-4f95-ba58-8b7c24822833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b30d10>]}
[0m14:09:26.606447 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model main_staging.stg_transactions ............. [[31mERROR[0m in 0.05s]
[0m14:09:26.606742 [debug] [Thread-1 (]: Finished running node model.hw4_dbt.stg_transactions
[0m14:09:26.607897 [debug] [Thread-3 (]: Began running node model.hw4_dbt.mart_customer_risk_profile
[0m14:09:26.608331 [debug] [Thread-4 (]: Began running node model.hw4_dbt.mart_daily_state_metrics
[0m14:09:26.608804 [debug] [Thread-2 (]: Began running node model.hw4_dbt.mart_fraud_by_category
[0m14:09:26.609030 [info ] [Thread-3 (]: 2 of 7 SKIP relation main_marts.mart_customer_risk_profile ..................... [[33mSKIP[0m]
[0m14:09:26.609229 [debug] [Thread-1 (]: Began running node model.hw4_dbt.mart_fraud_by_state
[0m14:09:26.609680 [info ] [Thread-4 (]: 3 of 7 SKIP relation main_marts.mart_daily_state_metrics ....................... [[33mSKIP[0m]
[0m14:09:26.611593 [debug] [Thread-4 (]: Finished running node model.hw4_dbt.mart_daily_state_metrics
[0m14:09:26.610239 [info ] [Thread-2 (]: 4 of 7 SKIP relation main_marts.mart_fraud_by_category ......................... [[33mSKIP[0m]
[0m14:09:26.610854 [info ] [Thread-1 (]: 5 of 7 SKIP relation main_marts.mart_fraud_by_state ............................ [[33mSKIP[0m]
[0m14:09:26.612138 [debug] [Thread-4 (]: Began running node model.hw4_dbt.mart_hourly_fraud_pattern
[0m14:09:26.610532 [debug] [Thread-3 (]: Finished running node model.hw4_dbt.mart_customer_risk_profile
[0m14:09:26.612499 [debug] [Thread-2 (]: Finished running node model.hw4_dbt.mart_fraud_by_category
[0m14:09:26.612829 [debug] [Thread-1 (]: Finished running node model.hw4_dbt.mart_fraud_by_state
[0m14:09:26.613092 [info ] [Thread-4 (]: 6 of 7 SKIP relation main_marts.mart_hourly_fraud_pattern ...................... [[33mSKIP[0m]
[0m14:09:26.613428 [debug] [Thread-3 (]: Began running node model.hw4_dbt.mart_merchant_analytics
[0m14:09:26.614022 [debug] [Thread-4 (]: Finished running node model.hw4_dbt.mart_hourly_fraud_pattern
[0m14:09:26.614269 [info ] [Thread-3 (]: 7 of 7 SKIP relation main_marts.mart_merchant_analytics ........................ [[33mSKIP[0m]
[0m14:09:26.614631 [debug] [Thread-3 (]: Finished running node model.hw4_dbt.mart_merchant_analytics
[0m14:09:26.615741 [debug] [MainThread]: Using duckdb connection "master"
[0m14:09:26.615982 [debug] [MainThread]: On master: BEGIN
[0m14:09:26.616128 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:09:26.624274 [debug] [MainThread]: SQL status: OK in 0.008 seconds
[0m14:09:26.624600 [debug] [MainThread]: On master: COMMIT
[0m14:09:26.624740 [debug] [MainThread]: Using duckdb connection "master"
[0m14:09:26.624870 [debug] [MainThread]: On master: COMMIT
[0m14:09:26.625179 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:09:26.625325 [debug] [MainThread]: On master: Close
[0m14:09:26.626574 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:09:26.626758 [debug] [MainThread]: Connection 'model.hw4_dbt.stg_transactions' was properly closed.
[0m14:09:26.626885 [debug] [MainThread]: Connection 'list_transactions_main_marts' was properly closed.
[0m14:09:26.627003 [debug] [MainThread]: Connection 'list_transactions_main_staging' was properly closed.
[0m14:09:26.627207 [info ] [MainThread]: 
[0m14:09:26.627363 [info ] [MainThread]: Finished running 1 view model, 6 table models in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m14:09:26.627960 [debug] [MainThread]: Command end result
[0m14:09:26.737755 [info ] [MainThread]: 
[0m14:09:26.738030 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:09:26.738188 [info ] [MainThread]: 
[0m14:09:26.738545 [error] [MainThread]:   Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Catalog Error: Table with name transactions does not exist!
  Did you mean "main_transactions_db.transactions"?
  
  LINE 6:     select * from transactions.transactions_db.transactions
                            ^
[0m14:09:26.738987 [info ] [MainThread]: 
[0m14:09:26.739276 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=6 TOTAL=7
[0m14:09:26.741225 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.2084, "process_user_time": 2.519776, "process_kernel_time": 0.334136, "process_mem_max_rss": "163725312", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:09:26.741549 [debug] [MainThread]: Command `dbt run` failed at 14:09:26.741502 after 2.21 seconds
[0m14:09:26.741786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1003fd110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106675490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10049af50>]}
[0m14:09:26.741998 [debug] [MainThread]: Flushing usage events
[0m14:09:50.959723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107677050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076d8e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076d9510>]}


============================== 14:09:50.963054 | 74c942a1-d9a2-4550-bfc9-760efb5b9155 ==============================
[0m14:09:50.963054 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:09:50.963412 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/roman/Desktop/hw4-mlops-bokhyan/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:09:51.103457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '74c942a1-d9a2-4550-bfc9-760efb5b9155', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076c4b90>]}
[0m14:09:51.138921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '74c942a1-d9a2-4550-bfc9-760efb5b9155', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053f4210>]}
[0m14:09:51.139547 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m14:09:51.201186 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m14:09:51.294491 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:09:51.295651 [debug] [MainThread]: Partial parsing: updated file: hw4_dbt://models/sources/sources.yml
[0m14:09:51.558134 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:09:51.558640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '74c942a1-d9a2-4550-bfc9-760efb5b9155', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d65710>]}
[0m14:09:51.790248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74c942a1-d9a2-4550-bfc9-760efb5b9155', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108091ad0>]}
[0m14:09:51.868354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74c942a1-d9a2-4550-bfc9-760efb5b9155', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ebe650>]}
[0m14:09:51.868675 [info ] [MainThread]: Found 2 seeds, 56 data tests, 7 models, 1 source, 805 macros
[0m14:09:51.870299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74c942a1-d9a2-4550-bfc9-760efb5b9155', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ce12d0>]}
[0m14:09:51.871771 [info ] [MainThread]: 
[0m14:09:51.872818 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:09:51.875424 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_transactions'
[0m14:09:51.875805 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_transactions'
[0m14:09:51.904728 [debug] [ThreadPool]: Using duckdb connection "list_transactions"
[0m14:09:51.904974 [debug] [ThreadPool]: Using duckdb connection "list_transactions"
[0m14:09:51.905282 [debug] [ThreadPool]: On list_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "connection_name": "list_transactions"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'transactions'
    
  
  
[0m14:09:51.905541 [debug] [ThreadPool]: On list_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "connection_name": "list_transactions"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'transactions'
    
  
  
[0m14:09:51.905762 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:09:51.905940 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:09:51.913940 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m14:09:51.914132 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m14:09:51.914874 [debug] [ThreadPool]: On list_transactions: Close
[0m14:09:51.915451 [debug] [ThreadPool]: On list_transactions: Close
[0m14:09:51.917426 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transactions, now list_transactions_main_marts)
[0m14:09:51.917725 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transactions, now list_transactions_main_staging)
[0m14:09:51.917981 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_transactions_main_transactions_db'
[0m14:09:51.921016 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_marts"
[0m14:09:51.922172 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_staging"
[0m14:09:51.923918 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_transactions_db"
[0m14:09:51.924151 [debug] [ThreadPool]: On list_transactions_main_marts: BEGIN
[0m14:09:51.924324 [debug] [ThreadPool]: On list_transactions_main_staging: BEGIN
[0m14:09:51.924538 [debug] [ThreadPool]: On list_transactions_main_transactions_db: BEGIN
[0m14:09:51.924733 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:09:51.924897 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:09:51.925046 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:09:51.931984 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m14:09:51.932238 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m14:09:51.932395 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m14:09:51.932516 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_marts"
[0m14:09:51.932658 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_transactions_db"
[0m14:09:51.932789 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_staging"
[0m14:09:51.932942 [debug] [ThreadPool]: On list_transactions_main_marts: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "connection_name": "list_transactions_main_marts"} */
select
      'transactions' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_marts'
    and table_catalog = 'transactions'
  
[0m14:09:51.933102 [debug] [ThreadPool]: On list_transactions_main_transactions_db: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "connection_name": "list_transactions_main_transactions_db"} */
select
      'transactions' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_transactions_db'
    and table_catalog = 'transactions'
  
[0m14:09:51.933262 [debug] [ThreadPool]: On list_transactions_main_staging: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "connection_name": "list_transactions_main_staging"} */
select
      'transactions' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_staging'
    and table_catalog = 'transactions'
  
[0m14:09:51.940813 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m14:09:51.941088 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m14:09:51.941267 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m14:09:51.941880 [debug] [ThreadPool]: On list_transactions_main_marts: ROLLBACK
[0m14:09:51.942449 [debug] [ThreadPool]: On list_transactions_main_transactions_db: ROLLBACK
[0m14:09:51.942914 [debug] [ThreadPool]: On list_transactions_main_staging: ROLLBACK
[0m14:09:51.943518 [debug] [ThreadPool]: Failed to rollback 'list_transactions_main_marts'
[0m14:09:51.943721 [debug] [ThreadPool]: Failed to rollback 'list_transactions_main_transactions_db'
[0m14:09:51.943921 [debug] [ThreadPool]: Failed to rollback 'list_transactions_main_staging'
[0m14:09:51.944073 [debug] [ThreadPool]: On list_transactions_main_marts: Close
[0m14:09:51.944215 [debug] [ThreadPool]: On list_transactions_main_transactions_db: Close
[0m14:09:51.944351 [debug] [ThreadPool]: On list_transactions_main_staging: Close
[0m14:09:51.946390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74c942a1-d9a2-4550-bfc9-760efb5b9155', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080ed090>]}
[0m14:09:51.946710 [debug] [MainThread]: Using duckdb connection "master"
[0m14:09:51.946863 [debug] [MainThread]: On master: BEGIN
[0m14:09:51.946996 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:09:51.953995 [debug] [MainThread]: SQL status: OK in 0.007 seconds
[0m14:09:51.954207 [debug] [MainThread]: On master: COMMIT
[0m14:09:51.954347 [debug] [MainThread]: Using duckdb connection "master"
[0m14:09:51.954477 [debug] [MainThread]: On master: COMMIT
[0m14:09:51.954679 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:09:51.954814 [debug] [MainThread]: On master: Close
[0m14:09:51.955812 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:09:51.955972 [info ] [MainThread]: 
[0m14:09:51.957242 [debug] [Thread-1 (]: Began running node model.hw4_dbt.stg_transactions
[0m14:09:51.957584 [info ] [Thread-1 (]: 1 of 7 START sql view model main_staging.stg_transactions ...................... [RUN]
[0m14:09:51.957943 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_transactions_main_marts, now model.hw4_dbt.stg_transactions)
[0m14:09:51.958351 [debug] [Thread-1 (]: Began compiling node model.hw4_dbt.stg_transactions
[0m14:09:51.964364 [debug] [Thread-1 (]: Writing injected SQL for node "model.hw4_dbt.stg_transactions"
[0m14:09:51.964876 [debug] [Thread-1 (]: Began executing node model.hw4_dbt.stg_transactions
[0m14:09:51.979120 [debug] [Thread-1 (]: Writing runtime sql for node "model.hw4_dbt.stg_transactions"
[0m14:09:51.979660 [debug] [Thread-1 (]: Using duckdb connection "model.hw4_dbt.stg_transactions"
[0m14:09:51.979833 [debug] [Thread-1 (]: On model.hw4_dbt.stg_transactions: BEGIN
[0m14:09:51.979990 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:51.986811 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m14:09:51.987056 [debug] [Thread-1 (]: Using duckdb connection "model.hw4_dbt.stg_transactions"
[0m14:09:51.987327 [debug] [Thread-1 (]: On model.hw4_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "model.hw4_dbt.stg_transactions"} */

  
  create view transactions.main_staging.stg_transactions__dbt_tmp as (
    with source as (
    select * from main.transactions_db.transactions
),
renamed as (
    select
        md5(cast(coalesce(cast(transaction_time as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(merch as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(amount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(cat_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(post_code as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as transaction_id,
        cast(transaction_time as timestamp) as transaction_ts,
        cast(date(transaction_time) as date) as transaction_date,
        date_trunc('hour', cast(transaction_time as timestamp)) as transaction_hour,
        substr(dayname(cast(transaction_time as timestamp)), 1, 3) as day_name,
        merch as merchant_name,
        md5(cast(coalesce(cast(merch as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as merchant_id,
        cat_id,
        cast(amount as double) as amount,
        
    case
        when cast(amount as double) is null then 'unknown'
        when cast(amount as double) < 50 then 'small'
        when cast(amount as double) < 200 then 'medium'
        when cast(amount as double) < 500 then 'large'
        else 'extra_large'
    end
 as amount_bucket,
        case
            when upper(gender) in ('M', 'MALE') then 'M'
            when upper(gender) in ('F', 'FEMALE') then 'F'
            else 'U'
        end as gender,
        md5(cast(coalesce(cast(name_1 as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(name_2 as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(street as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(post_code as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
        concat_ws(' ', nullif(name_1, ''), nullif(name_2, '')) as customer_full_name,
        street,
        one_city as city,
        upper(us_state) as us_state,
        post_code,
        cast(lat as double) as customer_lat,
        cast(lon as double) as customer_lon,
        cast(merchant_lat as double) as merchant_lat,
        cast(merchant_lon as double) as merchant_lon,
        nullif(jobs, '') as job_title,
        cast(population_city as bigint) as population_city,
        cast(target as integer) as is_fraud,
        case when 
    case
        when cast(amount as double) is null then 'unknown'
        when cast(amount as double) < 50 then 'small'
        when cast(amount as double) < 200 then 'medium'
        when cast(amount as double) < 500 then 'large'
        else 'extra_large'
    end
 in ('large', 'extra_large') then 1 else 0 end as is_large_amount
    from source
),
with_states as (
    select
        r.*,
        s.state_name
    from renamed r
    left join transactions.main_transactions_db.states s
        on r.us_state = s.state_code
)
select * from with_states
  );

[0m14:09:51.988404 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "model.hw4_dbt.stg_transactions"} */

  
  create view transactions.main_staging.stg_transactions__dbt_tmp as (
    with source as (
    select * from main.transactions_db.transactions
),
renamed as (
    select
        md5(cast(coalesce(cast(transaction_time as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(merch as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(amount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(cat_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(post_code as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as transaction_id,
        cast(transaction_time as timestamp) as transaction_ts,
        cast(date(transaction_time) as date) as transaction_date,
        date_trunc('hour', cast(transaction_time as timestamp)) as transaction_hour,
        substr(dayname(cast(transaction_time as timestamp)), 1, 3) as day_name,
        merch as merchant_name,
        md5(cast(coalesce(cast(merch as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as merchant_id,
        cat_id,
        cast(amount as double) as amount,
        
    case
        when cast(amount as double) is null then 'unknown'
        when cast(amount as double) < 50 then 'small'
        when cast(amount as double) < 200 then 'medium'
        when cast(amount as double) < 500 then 'large'
        else 'extra_large'
    end
 as amount_bucket,
        case
            when upper(gender) in ('M', 'MALE') then 'M'
            when upper(gender) in ('F', 'FEMALE') then 'F'
            else 'U'
        end as gender,
        md5(cast(coalesce(cast(name_1 as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(name_2 as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(street as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(post_code as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
        concat_ws(' ', nullif(name_1, ''), nullif(name_2, '')) as customer_full_name,
        street,
        one_city as city,
        upper(us_state) as us_state,
        post_code,
        cast(lat as double) as customer_lat,
        cast(lon as double) as customer_lon,
        cast(merchant_lat as double) as merchant_lat,
        cast(merchant_lon as double) as merchant_lon,
        nullif(jobs, '') as job_title,
        cast(population_city as bigint) as population_city,
        cast(target as integer) as is_fraud,
        case when 
    case
        when cast(amount as double) is null then 'unknown'
        when cast(amount as double) < 50 then 'small'
        when cast(amount as double) < 200 then 'medium'
        when cast(amount as double) < 500 then 'large'
        else 'extra_large'
    end
 in ('large', 'extra_large') then 1 else 0 end as is_large_amount
    from source
),
with_states as (
    select
        r.*,
        s.state_name
    from renamed r
    left join transactions.main_transactions_db.states s
        on r.us_state = s.state_code
)
select * from with_states
  );

[0m14:09:51.988674 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m14:09:51.988935 [debug] [Thread-1 (]: On model.hw4_dbt.stg_transactions: ROLLBACK
[0m14:09:51.990988 [debug] [Thread-1 (]: Failed to rollback 'model.hw4_dbt.stg_transactions'
[0m14:09:51.991162 [debug] [Thread-1 (]: On model.hw4_dbt.stg_transactions: Close
[0m14:09:51.993290 [debug] [Thread-1 (]: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Binder Error: Catalog "main" does not exist!
[0m14:09:51.994094 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74c942a1-d9a2-4550-bfc9-760efb5b9155', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108038c10>]}
[0m14:09:51.994416 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model main_staging.stg_transactions ............. [[31mERROR[0m in 0.04s]
[0m14:09:51.994701 [debug] [Thread-1 (]: Finished running node model.hw4_dbt.stg_transactions
[0m14:09:51.995614 [debug] [Thread-3 (]: Began running node model.hw4_dbt.mart_customer_risk_profile
[0m14:09:51.995845 [info ] [Thread-3 (]: 2 of 7 SKIP relation main_marts.mart_customer_risk_profile ..................... [[33mSKIP[0m]
[0m14:09:51.996076 [debug] [Thread-4 (]: Began running node model.hw4_dbt.mart_daily_state_metrics
[0m14:09:51.996417 [debug] [Thread-2 (]: Began running node model.hw4_dbt.mart_fraud_by_category
[0m14:09:51.996661 [debug] [Thread-1 (]: Began running node model.hw4_dbt.mart_fraud_by_state
[0m14:09:51.996853 [debug] [Thread-3 (]: Finished running node model.hw4_dbt.mart_customer_risk_profile
[0m14:09:51.997064 [info ] [Thread-4 (]: 3 of 7 SKIP relation main_marts.mart_daily_state_metrics ....................... [[33mSKIP[0m]
[0m14:09:51.997471 [info ] [Thread-2 (]: 4 of 7 SKIP relation main_marts.mart_fraud_by_category ......................... [[33mSKIP[0m]
[0m14:09:51.997998 [info ] [Thread-1 (]: 5 of 7 SKIP relation main_marts.mart_fraud_by_state ............................ [[33mSKIP[0m]
[0m14:09:51.998578 [debug] [Thread-3 (]: Began running node model.hw4_dbt.mart_hourly_fraud_pattern
[0m14:09:51.999341 [debug] [Thread-4 (]: Finished running node model.hw4_dbt.mart_daily_state_metrics
[0m14:09:51.999810 [debug] [Thread-2 (]: Finished running node model.hw4_dbt.mart_fraud_by_category
[0m14:09:52.000035 [debug] [Thread-1 (]: Finished running node model.hw4_dbt.mart_fraud_by_state
[0m14:09:52.000239 [info ] [Thread-3 (]: 6 of 7 SKIP relation main_marts.mart_hourly_fraud_pattern ...................... [[33mSKIP[0m]
[0m14:09:52.000548 [debug] [Thread-4 (]: Began running node model.hw4_dbt.mart_merchant_analytics
[0m14:09:52.001132 [debug] [Thread-3 (]: Finished running node model.hw4_dbt.mart_hourly_fraud_pattern
[0m14:09:52.001378 [info ] [Thread-4 (]: 7 of 7 SKIP relation main_marts.mart_merchant_analytics ........................ [[33mSKIP[0m]
[0m14:09:52.001735 [debug] [Thread-4 (]: Finished running node model.hw4_dbt.mart_merchant_analytics
[0m14:09:52.002525 [debug] [MainThread]: Using duckdb connection "master"
[0m14:09:52.002700 [debug] [MainThread]: On master: BEGIN
[0m14:09:52.002846 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:09:52.009721 [debug] [MainThread]: SQL status: OK in 0.007 seconds
[0m14:09:52.009921 [debug] [MainThread]: On master: COMMIT
[0m14:09:52.010068 [debug] [MainThread]: Using duckdb connection "master"
[0m14:09:52.010193 [debug] [MainThread]: On master: COMMIT
[0m14:09:52.010399 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:09:52.010537 [debug] [MainThread]: On master: Close
[0m14:09:52.011495 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:09:52.011656 [debug] [MainThread]: Connection 'model.hw4_dbt.stg_transactions' was properly closed.
[0m14:09:52.011786 [debug] [MainThread]: Connection 'list_transactions_main_staging' was properly closed.
[0m14:09:52.011906 [debug] [MainThread]: Connection 'list_transactions_main_transactions_db' was properly closed.
[0m14:09:52.012098 [info ] [MainThread]: 
[0m14:09:52.012273 [info ] [MainThread]: Finished running 1 view model, 6 table models in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m14:09:52.012772 [debug] [MainThread]: Command end result
[0m14:09:52.109361 [info ] [MainThread]: 
[0m14:09:52.110448 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:09:52.111527 [info ] [MainThread]: 
[0m14:09:52.113742 [error] [MainThread]:   Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Binder Error: Catalog "main" does not exist!
[0m14:09:52.117479 [info ] [MainThread]: 
[0m14:09:52.118078 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=6 TOTAL=7
[0m14:09:52.119752 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.1999471, "process_user_time": 1.670693, "process_kernel_time": 0.230434, "process_mem_max_rss": "162119680", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:09:52.120067 [debug] [MainThread]: Command `dbt run` failed at 14:09:52.120018 after 1.20 seconds
[0m14:09:52.120294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1031632d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103162e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108503410>]}
[0m14:09:52.120855 [debug] [MainThread]: Flushing usage events
[0m14:10:06.094139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c1ced0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c80c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c812d0>]}


============================== 14:10:06.097116 | e52b39fc-13cf-422e-a166-dd1f39dc8c8e ==============================
[0m14:10:06.097116 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:10:06.097464 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/roman/Desktop/hw4-mlops-bokhyan/dbt/logs', 'debug': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug --config-dir', 'send_anonymous_usage_stats': 'True'}
[0m14:10:06.105086 [info ] [MainThread]: To view your profiles.yml file, run:

open .
[0m14:10:06.106672 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.05526817, "process_user_time": 0.67401, "process_kernel_time": 0.121586, "process_mem_max_rss": "105791488", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:10:06.107033 [debug] [MainThread]: Command `dbt debug` succeeded at 14:10:06.106976 after 0.06 seconds
[0m14:10:06.107280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a19090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c81110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c810d0>]}
[0m14:10:06.107506 [debug] [MainThread]: Flushing usage events
[0m14:10:13.284956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10781f450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107878a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078790d0>]}


============================== 14:10:13.287914 | 478d1945-329d-4d16-a18e-2dabc2ab2068 ==============================
[0m14:10:13.287914 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:10:13.288807 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '.', 'log_path': '/Users/roman/Desktop/hw4-mlops-bokhyan/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:10:13.295060 [info ] [MainThread]: dbt version: 1.8.2
[0m14:10:13.295373 [info ] [MainThread]: python version: 3.11.4
[0m14:10:13.295549 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.11/bin/python3.11
[0m14:10:13.295707 [info ] [MainThread]: os info: macOS-15.6.1-arm64-arm-64bit
[0m14:10:13.353135 [info ] [MainThread]: Using profiles dir at .
[0m14:10:13.353499 [info ] [MainThread]: Using profiles.yml file at ./profiles.yml
[0m14:10:13.353654 [info ] [MainThread]: Using dbt_project.yml file at /Users/roman/Desktop/hw4-mlops-bokhyan/dbt/dbt_project.yml
[0m14:10:13.354324 [info ] [MainThread]: adapter type: duckdb
[0m14:10:13.355071 [info ] [MainThread]: adapter version: 1.8.2
[0m14:10:13.414381 [info ] [MainThread]: Configuration:
[0m14:10:13.414735 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:10:13.414937 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:10:13.415364 [info ] [MainThread]: Required dependencies:
[0m14:10:13.415759 [debug] [MainThread]: Executing "git --help"
[0m14:10:13.428876 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:10:13.429520 [debug] [MainThread]: STDERR: "b''"
[0m14:10:13.429901 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:10:13.430307 [info ] [MainThread]: Connection:
[0m14:10:13.431053 [info ] [MainThread]:   database: transactions
[0m14:10:13.431222 [info ] [MainThread]:   schema: main
[0m14:10:13.431404 [info ] [MainThread]:   path: ./data/transactions.duckdb
[0m14:10:13.431987 [info ] [MainThread]:   config_options: None
[0m14:10:13.432205 [info ] [MainThread]:   extensions: ['json']
[0m14:10:13.432449 [info ] [MainThread]:   settings: {}
[0m14:10:13.432852 [info ] [MainThread]:   external_root: .
[0m14:10:13.433077 [info ] [MainThread]:   use_credential_provider: None
[0m14:10:13.433351 [info ] [MainThread]:   attach: None
[0m14:10:13.433494 [info ] [MainThread]:   filesystems: None
[0m14:10:13.433623 [info ] [MainThread]:   remote: None
[0m14:10:13.433956 [info ] [MainThread]:   plugins: None
[0m14:10:13.434429 [info ] [MainThread]:   disable_transactions: False
[0m14:10:13.435200 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m14:10:13.498994 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m14:10:13.521804 [debug] [MainThread]: Using duckdb connection "debug"
[0m14:10:13.522100 [debug] [MainThread]: On debug: select 1 as id
[0m14:10:13.522339 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:10:13.531155 [debug] [MainThread]: SQL status: OK in 0.009 seconds
[0m14:10:13.531811 [debug] [MainThread]: On debug: Close
[0m14:10:13.533056 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:10:13.533343 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:10:13.535232 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.29086542, "process_user_time": 0.8293, "process_kernel_time": 0.17042, "process_mem_max_rss": "134791168", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:10:13.535713 [debug] [MainThread]: Command `dbt debug` succeeded at 14:10:13.535633 after 0.29 seconds
[0m14:10:13.535934 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:10:13.536149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100729110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107870210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107878f90>]}
[0m14:10:13.536406 [debug] [MainThread]: Flushing usage events
[0m14:11:31.230567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11331f650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113370150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113314090>]}


============================== 14:11:31.233512 | a7588774-10ab-4760-b8d4-a193b90fbdb5 ==============================
[0m14:11:31.233512 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:11:31.233847 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/roman/Desktop/hw4-mlops-bokhyan/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:11:31.364944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7588774-10ab-4760-b8d4-a193b90fbdb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133ea410>]}
[0m14:11:31.402033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7588774-10ab-4760-b8d4-a193b90fbdb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102b0310>]}
[0m14:11:31.402628 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m14:11:31.465950 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m14:11:31.566491 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:11:31.567460 [debug] [MainThread]: Partial parsing: updated file: hw4_dbt://models/sources/sources.yml
[0m14:11:31.841286 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:11:31.841694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a7588774-10ab-4760-b8d4-a193b90fbdb5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139aaa50>]}
[0m14:11:32.127047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7588774-10ab-4760-b8d4-a193b90fbdb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11482b550>]}
[0m14:11:32.209094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7588774-10ab-4760-b8d4-a193b90fbdb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111458910>]}
[0m14:11:32.209440 [info ] [MainThread]: Found 2 seeds, 56 data tests, 7 models, 1 source, 805 macros
[0m14:11:32.209615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7588774-10ab-4760-b8d4-a193b90fbdb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114844e50>]}
[0m14:11:32.211249 [info ] [MainThread]: 
[0m14:11:32.211689 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:11:32.214306 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_transactions'
[0m14:11:32.214802 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_transactions'
[0m14:11:32.246513 [debug] [ThreadPool]: Using duckdb connection "list_transactions"
[0m14:11:32.246807 [debug] [ThreadPool]: Using duckdb connection "list_transactions"
[0m14:11:32.247140 [debug] [ThreadPool]: On list_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "connection_name": "list_transactions"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'transactions'
    
  
  
[0m14:11:32.247320 [debug] [ThreadPool]: On list_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "connection_name": "list_transactions"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'transactions'
    
  
  
[0m14:11:32.247474 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:11:32.247611 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:11:32.256034 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m14:11:32.256325 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m14:11:32.257369 [debug] [ThreadPool]: On list_transactions: Close
[0m14:11:32.258291 [debug] [ThreadPool]: On list_transactions: Close
[0m14:11:32.260642 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transactions, now list_transactions_main_transactions_db)
[0m14:11:32.261094 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transactions, now list_transactions_main_staging)
[0m14:11:32.261355 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_transactions_main_marts'
[0m14:11:32.264723 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_transactions_db"
[0m14:11:32.266193 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_staging"
[0m14:11:32.267658 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_marts"
[0m14:11:32.267826 [debug] [ThreadPool]: On list_transactions_main_transactions_db: BEGIN
[0m14:11:32.267978 [debug] [ThreadPool]: On list_transactions_main_staging: BEGIN
[0m14:11:32.268114 [debug] [ThreadPool]: On list_transactions_main_marts: BEGIN
[0m14:11:32.268242 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:11:32.268399 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:11:32.268556 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:11:32.276136 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m14:11:32.276387 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m14:11:32.276605 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m14:11:32.276752 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_transactions_db"
[0m14:11:32.276899 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_staging"
[0m14:11:32.277032 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_marts"
[0m14:11:32.277244 [debug] [ThreadPool]: On list_transactions_main_transactions_db: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "connection_name": "list_transactions_main_transactions_db"} */
select
      'transactions' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_transactions_db'
    and table_catalog = 'transactions'
  
[0m14:11:32.277563 [debug] [ThreadPool]: On list_transactions_main_staging: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "connection_name": "list_transactions_main_staging"} */
select
      'transactions' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_staging'
    and table_catalog = 'transactions'
  
[0m14:11:32.278019 [debug] [ThreadPool]: On list_transactions_main_marts: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "connection_name": "list_transactions_main_marts"} */
select
      'transactions' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_marts'
    and table_catalog = 'transactions'
  
[0m14:11:32.287046 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m14:11:32.287328 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m14:11:32.287487 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m14:11:32.288169 [debug] [ThreadPool]: On list_transactions_main_staging: ROLLBACK
[0m14:11:32.288786 [debug] [ThreadPool]: On list_transactions_main_transactions_db: ROLLBACK
[0m14:11:32.289230 [debug] [ThreadPool]: On list_transactions_main_marts: ROLLBACK
[0m14:11:32.290056 [debug] [ThreadPool]: Failed to rollback 'list_transactions_main_staging'
[0m14:11:32.290522 [debug] [ThreadPool]: Failed to rollback 'list_transactions_main_transactions_db'
[0m14:11:32.290726 [debug] [ThreadPool]: On list_transactions_main_staging: Close
[0m14:11:32.290903 [debug] [ThreadPool]: Failed to rollback 'list_transactions_main_marts'
[0m14:11:32.291051 [debug] [ThreadPool]: On list_transactions_main_transactions_db: Close
[0m14:11:32.291343 [debug] [ThreadPool]: On list_transactions_main_marts: Close
[0m14:11:32.293132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7588774-10ab-4760-b8d4-a193b90fbdb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b63ed0>]}
[0m14:11:32.293549 [debug] [MainThread]: Using duckdb connection "master"
[0m14:11:32.293759 [debug] [MainThread]: On master: BEGIN
[0m14:11:32.294039 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:11:32.302082 [debug] [MainThread]: SQL status: OK in 0.008 seconds
[0m14:11:32.302366 [debug] [MainThread]: On master: COMMIT
[0m14:11:32.302558 [debug] [MainThread]: Using duckdb connection "master"
[0m14:11:32.302712 [debug] [MainThread]: On master: COMMIT
[0m14:11:32.302963 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:11:32.303111 [debug] [MainThread]: On master: Close
[0m14:11:32.304199 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:11:32.304362 [info ] [MainThread]: 
[0m14:11:32.305619 [debug] [Thread-1 (]: Began running node model.hw4_dbt.stg_transactions
[0m14:11:32.305903 [info ] [Thread-1 (]: 1 of 7 START sql view model main_staging.stg_transactions ...................... [RUN]
[0m14:11:32.306126 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_transactions_main_transactions_db, now model.hw4_dbt.stg_transactions)
[0m14:11:32.306444 [debug] [Thread-1 (]: Began compiling node model.hw4_dbt.stg_transactions
[0m14:11:32.313580 [debug] [Thread-1 (]: Writing injected SQL for node "model.hw4_dbt.stg_transactions"
[0m14:11:32.314126 [debug] [Thread-1 (]: Began executing node model.hw4_dbt.stg_transactions
[0m14:11:32.330612 [debug] [Thread-1 (]: Writing runtime sql for node "model.hw4_dbt.stg_transactions"
[0m14:11:32.331247 [debug] [Thread-1 (]: Using duckdb connection "model.hw4_dbt.stg_transactions"
[0m14:11:32.331433 [debug] [Thread-1 (]: On model.hw4_dbt.stg_transactions: BEGIN
[0m14:11:32.331985 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:32.339379 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m14:11:32.339683 [debug] [Thread-1 (]: Using duckdb connection "model.hw4_dbt.stg_transactions"
[0m14:11:32.340068 [debug] [Thread-1 (]: On model.hw4_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "model.hw4_dbt.stg_transactions"} */

  
  create view transactions.main_staging.stg_transactions__dbt_tmp as (
    with source as (
    select * from transactions.main_transactions_db.transactions
),
renamed as (
    select
        md5(cast(coalesce(cast(transaction_time as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(merch as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(amount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(cat_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(post_code as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as transaction_id,
        cast(transaction_time as timestamp) as transaction_ts,
        cast(date(transaction_time) as date) as transaction_date,
        date_trunc('hour', cast(transaction_time as timestamp)) as transaction_hour,
        substr(dayname(cast(transaction_time as timestamp)), 1, 3) as day_name,
        merch as merchant_name,
        md5(cast(coalesce(cast(merch as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as merchant_id,
        cat_id,
        cast(amount as double) as amount,
        
    case
        when cast(amount as double) is null then 'unknown'
        when cast(amount as double) < 50 then 'small'
        when cast(amount as double) < 200 then 'medium'
        when cast(amount as double) < 500 then 'large'
        else 'extra_large'
    end
 as amount_bucket,
        case
            when upper(gender) in ('M', 'MALE') then 'M'
            when upper(gender) in ('F', 'FEMALE') then 'F'
            else 'U'
        end as gender,
        md5(cast(coalesce(cast(name_1 as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(name_2 as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(street as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(post_code as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
        concat_ws(' ', nullif(name_1, ''), nullif(name_2, '')) as customer_full_name,
        street,
        one_city as city,
        upper(us_state) as us_state,
        post_code,
        cast(lat as double) as customer_lat,
        cast(lon as double) as customer_lon,
        cast(merchant_lat as double) as merchant_lat,
        cast(merchant_lon as double) as merchant_lon,
        nullif(jobs, '') as job_title,
        cast(population_city as bigint) as population_city,
        cast(target as integer) as is_fraud,
        case when 
    case
        when cast(amount as double) is null then 'unknown'
        when cast(amount as double) < 50 then 'small'
        when cast(amount as double) < 200 then 'medium'
        when cast(amount as double) < 500 then 'large'
        else 'extra_large'
    end
 in ('large', 'extra_large') then 1 else 0 end as is_large_amount
    from source
),
with_states as (
    select
        r.*,
        s.state_name
    from renamed r
    left join transactions.main_transactions_db.states s
        on r.us_state = s.state_code
)
select * from with_states
  );

[0m14:11:32.341844 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:11:32.345661 [debug] [Thread-1 (]: Using duckdb connection "model.hw4_dbt.stg_transactions"
[0m14:11:32.346031 [debug] [Thread-1 (]: On model.hw4_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "model.hw4_dbt.stg_transactions"} */
alter view transactions.main_staging.stg_transactions__dbt_tmp rename to stg_transactions
[0m14:11:32.346800 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:11:32.353840 [debug] [Thread-1 (]: On model.hw4_dbt.stg_transactions: COMMIT
[0m14:11:32.354124 [debug] [Thread-1 (]: Using duckdb connection "model.hw4_dbt.stg_transactions"
[0m14:11:32.354285 [debug] [Thread-1 (]: On model.hw4_dbt.stg_transactions: COMMIT
[0m14:11:32.355598 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:11:32.358683 [debug] [Thread-1 (]: Using duckdb connection "model.hw4_dbt.stg_transactions"
[0m14:11:32.358951 [debug] [Thread-1 (]: On model.hw4_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "model.hw4_dbt.stg_transactions"} */
drop view if exists transactions.main_staging.stg_transactions__dbt_backup cascade
[0m14:11:32.359335 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:11:32.360468 [debug] [Thread-1 (]: On model.hw4_dbt.stg_transactions: Close
[0m14:11:32.366853 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7588774-10ab-4760-b8d4-a193b90fbdb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1150d43d0>]}
[0m14:11:32.367304 [info ] [Thread-1 (]: 1 of 7 OK created sql view model main_staging.stg_transactions ................. [[32mOK[0m in 0.06s]
[0m14:11:32.367703 [debug] [Thread-1 (]: Finished running node model.hw4_dbt.stg_transactions
[0m14:11:32.368347 [debug] [Thread-3 (]: Began running node model.hw4_dbt.mart_customer_risk_profile
[0m14:11:32.368578 [debug] [Thread-4 (]: Began running node model.hw4_dbt.mart_daily_state_metrics
[0m14:11:32.368794 [debug] [Thread-2 (]: Began running node model.hw4_dbt.mart_fraud_by_category
[0m14:11:32.369054 [debug] [Thread-1 (]: Began running node model.hw4_dbt.mart_fraud_by_state
[0m14:11:32.369449 [info ] [Thread-3 (]: 2 of 7 START sql table model main_marts.mart_customer_risk_profile ............. [RUN]
[0m14:11:32.369853 [info ] [Thread-4 (]: 3 of 7 START sql table model main_marts.mart_daily_state_metrics ............... [RUN]
[0m14:11:32.370368 [info ] [Thread-2 (]: 4 of 7 START sql table model main_marts.mart_fraud_by_category ................. [RUN]
[0m14:11:32.370832 [info ] [Thread-1 (]: 5 of 7 START sql table model main_marts.mart_fraud_by_state .................... [RUN]
[0m14:11:32.371235 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_transactions_main_marts, now model.hw4_dbt.mart_customer_risk_profile)
[0m14:11:32.371509 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.hw4_dbt.mart_daily_state_metrics'
[0m14:11:32.371830 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_transactions_main_staging, now model.hw4_dbt.mart_fraud_by_category)
[0m14:11:32.372110 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.hw4_dbt.stg_transactions, now model.hw4_dbt.mart_fraud_by_state)
[0m14:11:32.372338 [debug] [Thread-3 (]: Began compiling node model.hw4_dbt.mart_customer_risk_profile
[0m14:11:32.372535 [debug] [Thread-4 (]: Began compiling node model.hw4_dbt.mart_daily_state_metrics
[0m14:11:32.372730 [debug] [Thread-2 (]: Began compiling node model.hw4_dbt.mart_fraud_by_category
[0m14:11:32.372902 [debug] [Thread-1 (]: Began compiling node model.hw4_dbt.mart_fraud_by_state
[0m14:11:32.376044 [debug] [Thread-3 (]: Writing injected SQL for node "model.hw4_dbt.mart_customer_risk_profile"
[0m14:11:32.427925 [debug] [Thread-4 (]: Writing injected SQL for node "model.hw4_dbt.mart_daily_state_metrics"
[0m14:11:32.430681 [debug] [Thread-2 (]: Writing injected SQL for node "model.hw4_dbt.mart_fraud_by_category"
[0m14:11:32.432744 [debug] [Thread-1 (]: Writing injected SQL for node "model.hw4_dbt.mart_fraud_by_state"
[0m14:11:32.434216 [debug] [Thread-2 (]: Began executing node model.hw4_dbt.mart_fraud_by_category
[0m14:11:32.434481 [debug] [Thread-4 (]: Began executing node model.hw4_dbt.mart_daily_state_metrics
[0m14:11:32.442067 [debug] [Thread-3 (]: Began executing node model.hw4_dbt.mart_customer_risk_profile
[0m14:11:32.446718 [debug] [Thread-2 (]: Writing runtime sql for node "model.hw4_dbt.mart_fraud_by_category"
[0m14:11:32.447097 [debug] [Thread-1 (]: Began executing node model.hw4_dbt.mart_fraud_by_state
[0m14:11:32.450063 [debug] [Thread-4 (]: Writing runtime sql for node "model.hw4_dbt.mart_daily_state_metrics"
[0m14:11:32.452052 [debug] [Thread-3 (]: Writing runtime sql for node "model.hw4_dbt.mart_customer_risk_profile"
[0m14:11:32.454539 [debug] [Thread-1 (]: Writing runtime sql for node "model.hw4_dbt.mart_fraud_by_state"
[0m14:11:32.455407 [debug] [Thread-2 (]: Using duckdb connection "model.hw4_dbt.mart_fraud_by_category"
[0m14:11:32.455669 [debug] [Thread-4 (]: Using duckdb connection "model.hw4_dbt.mart_daily_state_metrics"
[0m14:11:32.455880 [debug] [Thread-3 (]: Using duckdb connection "model.hw4_dbt.mart_customer_risk_profile"
[0m14:11:32.456083 [debug] [Thread-1 (]: Using duckdb connection "model.hw4_dbt.mart_fraud_by_state"
[0m14:11:32.456269 [debug] [Thread-2 (]: On model.hw4_dbt.mart_fraud_by_category: BEGIN
[0m14:11:32.456754 [debug] [Thread-4 (]: On model.hw4_dbt.mart_daily_state_metrics: BEGIN
[0m14:11:32.457127 [debug] [Thread-3 (]: On model.hw4_dbt.mart_customer_risk_profile: BEGIN
[0m14:11:32.457573 [debug] [Thread-1 (]: On model.hw4_dbt.mart_fraud_by_state: BEGIN
[0m14:11:32.457916 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:11:32.458185 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:11:32.458508 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:11:32.458705 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:32.467646 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m14:11:32.467910 [debug] [Thread-4 (]: SQL status: OK in 0.010 seconds
[0m14:11:32.468142 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m14:11:32.468362 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m14:11:32.468593 [debug] [Thread-2 (]: Using duckdb connection "model.hw4_dbt.mart_fraud_by_category"
[0m14:11:32.468804 [debug] [Thread-4 (]: Using duckdb connection "model.hw4_dbt.mart_daily_state_metrics"
[0m14:11:32.469103 [debug] [Thread-3 (]: Using duckdb connection "model.hw4_dbt.mart_customer_risk_profile"
[0m14:11:32.469596 [debug] [Thread-1 (]: Using duckdb connection "model.hw4_dbt.mart_fraud_by_state"
[0m14:11:32.469962 [debug] [Thread-2 (]: On model.hw4_dbt.mart_fraud_by_category: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "model.hw4_dbt.mart_fraud_by_category"} */

  
    
    

    create  table
      transactions.main_marts.mart_fraud_by_category__dbt_tmp
  
    as (
      with base as (
    select
        cat_id,
        amount,
        is_fraud
    from transactions.main_staging.stg_transactions
),
agg as (
    select
        cat_id,
        count(*) as transaction_count,
        sum(is_fraud) as fraud_count,
        sum(amount) as total_amount,
        sum(case when is_fraud = 1 then amount else 0 end) as fraud_amount,
        avg(amount) as avg_amount
    from base
    group by cat_id
)
select
    cat_id,
    transaction_count,
    fraud_count,
    case when transaction_count = 0 then 0 else fraud_count * 100.0 / transaction_count end as fraud_rate,
    total_amount,
    fraud_amount,
    avg_amount
from agg
order by fraud_rate desc
    );
  
  
[0m14:11:32.470407 [debug] [Thread-4 (]: On model.hw4_dbt.mart_daily_state_metrics: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "model.hw4_dbt.mart_daily_state_metrics"} */

  
    
    

    create  table
      transactions.main_marts.mart_daily_state_metrics__dbt_tmp
  
    as (
      with base as (
    select
        transaction_date,
        us_state,
        amount,
        amount_bucket,
        is_fraud
    from transactions.main_staging.stg_transactions
),
agg as (
    select
        transaction_date,
        us_state,
        count(*) as transaction_count,
        sum(amount) as total_amount,
        avg(amount) as avg_amount,
        percentile_cont(0.95) within group (order by amount) as p95_amount,
        sum(case when amount_bucket in ('large', 'extra_large') then 1 else 0 end) as large_txn_count,
        sum(is_fraud) as fraud_count,
        sum(case when is_fraud = 1 then amount else 0 end) as fraud_amount
    from base
    group by transaction_date, us_state
)
select
    transaction_date,
    us_state,
    transaction_count,
    total_amount,
    avg_amount,
    p95_amount,
    large_txn_count,
    case when transaction_count = 0 then 0 else large_txn_count * 1.0 / transaction_count end as large_txn_share,
    fraud_count,
    fraud_amount,
    case when transaction_count = 0 then 0 else fraud_count * 1.0 / transaction_count end as fraud_rate
from agg
    );
  
  
[0m14:11:32.470765 [debug] [Thread-3 (]: On model.hw4_dbt.mart_customer_risk_profile: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "model.hw4_dbt.mart_customer_risk_profile"} */

  
    
    

    create  table
      transactions.main_marts.mart_customer_risk_profile__dbt_tmp
  
    as (
      with base as (
    select
        customer_id,
        customer_full_name,
        us_state,
        amount,
        amount_bucket,
        is_fraud,
        merchant_id,
        transaction_date
    from transactions.main_staging.stg_transactions
),
agg as (
    select
        customer_id,
        max(customer_full_name) as customer_full_name,
        max(us_state) as home_state,
        count(*) as transaction_count,
        sum(is_fraud) as fraud_count,
        case when count(*) = 0 then 0 else sum(is_fraud) * 100.0 / count(*) end as fraud_rate,
        sum(amount) as total_amount,
        avg(amount) as avg_amount,
        max(transaction_date) as last_transaction_date,
        sum(case when amount_bucket in ('large', 'extra_large') then 1 else 0 end) as large_txn_count,
        count(distinct merchant_id) as merchant_diversity
    from base
    group by customer_id
),
scored as (
    select
        *,
        case when transaction_count = 0 then 0 else large_txn_count * 1.0 / transaction_count end as large_txn_share
    from agg
),
final as (
    select
        customer_id,
        customer_full_name,
        home_state,
        transaction_count,
        fraud_count,
        fraud_rate,
        total_amount,
        avg_amount,
        last_transaction_date,
        large_txn_share,
        merchant_diversity,
        case
            when fraud_rate >= 5 or large_txn_share >= 0.4 then 'HIGH'
            when fraud_rate >= 2 or large_txn_share >= 0.2 then 'MEDIUM'
            else 'LOW'
        end as risk_level
    from scored
)
select * from final
    );
  
  
[0m14:11:32.471041 [debug] [Thread-1 (]: On model.hw4_dbt.mart_fraud_by_state: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "model.hw4_dbt.mart_fraud_by_state"} */

  
    
    

    create  table
      transactions.main_marts.mart_fraud_by_state__dbt_tmp
  
    as (
      with base as (
    select
        us_state,
        amount,
        is_fraud,
        customer_id,
        merchant_id
    from transactions.main_staging.stg_transactions
),
agg as (
    select
        us_state,
        count(*) as transaction_count,
        count(distinct customer_id) as unique_customers,
        count(distinct merchant_id) as unique_merchants,
        sum(is_fraud) as fraud_count,
        sum(amount) as total_amount,
        sum(case when is_fraud = 1 then amount else 0 end) as fraud_amount,
        avg(amount) as avg_amount
    from base
    group by us_state
)
select
    us_state,
    transaction_count,
    unique_customers,
    unique_merchants,
    total_amount,
    fraud_amount,
    avg_amount,
    fraud_count,
    case when transaction_count = 0 then 0 else fraud_count * 100.0 / transaction_count end as fraud_rate
from agg
order by fraud_rate desc
    );
  
  
[0m14:11:32.497860 [debug] [Thread-2 (]: SQL status: OK in 0.026 seconds
[0m14:11:32.513658 [debug] [Thread-2 (]: Using duckdb connection "model.hw4_dbt.mart_fraud_by_category"
[0m14:11:32.514061 [debug] [Thread-2 (]: On model.hw4_dbt.mart_fraud_by_category: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "model.hw4_dbt.mart_fraud_by_category"} */
alter table transactions.main_marts.mart_fraud_by_category__dbt_tmp rename to mart_fraud_by_category
[0m14:11:32.515723 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:11:32.525568 [debug] [Thread-2 (]: On model.hw4_dbt.mart_fraud_by_category: COMMIT
[0m14:11:32.525907 [debug] [Thread-2 (]: Using duckdb connection "model.hw4_dbt.mart_fraud_by_category"
[0m14:11:32.526083 [debug] [Thread-2 (]: On model.hw4_dbt.mart_fraud_by_category: COMMIT
[0m14:11:32.526922 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:11:32.534997 [debug] [Thread-2 (]: Using duckdb connection "model.hw4_dbt.mart_fraud_by_category"
[0m14:11:32.535364 [debug] [Thread-2 (]: On model.hw4_dbt.mart_fraud_by_category: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "model.hw4_dbt.mart_fraud_by_category"} */
drop table if exists transactions.main_marts.mart_fraud_by_category__dbt_backup cascade
[0m14:11:32.535783 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m14:11:32.537935 [debug] [Thread-2 (]: On model.hw4_dbt.mart_fraud_by_category: Close
[0m14:11:32.538341 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7588774-10ab-4760-b8d4-a193b90fbdb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1148eb0d0>]}
[0m14:11:32.538703 [info ] [Thread-2 (]: 4 of 7 OK created sql table model main_marts.mart_fraud_by_category ............ [[32mOK[0m in 0.17s]
[0m14:11:32.538990 [debug] [Thread-2 (]: Finished running node model.hw4_dbt.mart_fraud_by_category
[0m14:11:32.539403 [debug] [Thread-2 (]: Began running node model.hw4_dbt.mart_hourly_fraud_pattern
[0m14:11:32.539741 [info ] [Thread-2 (]: 6 of 7 START sql table model main_marts.mart_hourly_fraud_pattern .............. [RUN]
[0m14:11:32.541132 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.hw4_dbt.mart_fraud_by_category, now model.hw4_dbt.mart_hourly_fraud_pattern)
[0m14:11:32.541716 [debug] [Thread-2 (]: Began compiling node model.hw4_dbt.mart_hourly_fraud_pattern
[0m14:11:32.544676 [debug] [Thread-2 (]: Writing injected SQL for node "model.hw4_dbt.mart_hourly_fraud_pattern"
[0m14:11:32.546178 [debug] [Thread-2 (]: Began executing node model.hw4_dbt.mart_hourly_fraud_pattern
[0m14:11:32.548271 [debug] [Thread-2 (]: Writing runtime sql for node "model.hw4_dbt.mart_hourly_fraud_pattern"
[0m14:11:32.549627 [debug] [Thread-2 (]: Using duckdb connection "model.hw4_dbt.mart_hourly_fraud_pattern"
[0m14:11:32.553883 [debug] [Thread-2 (]: On model.hw4_dbt.mart_hourly_fraud_pattern: BEGIN
[0m14:11:32.554402 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:11:32.554843 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:11:32.555135 [debug] [Thread-2 (]: Using duckdb connection "model.hw4_dbt.mart_hourly_fraud_pattern"
[0m14:11:32.555941 [debug] [Thread-2 (]: On model.hw4_dbt.mart_hourly_fraud_pattern: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "model.hw4_dbt.mart_hourly_fraud_pattern"} */

  
    
    

    create  table
      transactions.main_marts.mart_hourly_fraud_pattern__dbt_tmp
  
    as (
      with base as (
    select
        day_name,
        transaction_hour,
        amount,
        is_fraud
    from transactions.main_staging.stg_transactions
),
bucketed as (
    select
        day_name,
        extract(hour from transaction_hour) as hour_of_day,
        amount,
        is_fraud
    from base
)
select
    day_name,
    hour_of_day,
    count(*) as transaction_count,
    sum(is_fraud) as fraud_count,
    case when count(*) = 0 then 0 else sum(is_fraud) * 100.0 / count(*) end as fraud_rate,
    avg(amount) as avg_amount,
    percentile_cont(0.95) within group (order by amount) as p95_amount
from bucketed
group by day_name, hour_of_day
order by fraud_rate desc
    );
  
  
[0m14:11:32.730206 [debug] [Thread-2 (]: SQL status: OK in 0.173 seconds
[0m14:11:32.733132 [debug] [Thread-2 (]: Using duckdb connection "model.hw4_dbt.mart_hourly_fraud_pattern"
[0m14:11:32.733571 [debug] [Thread-2 (]: On model.hw4_dbt.mart_hourly_fraud_pattern: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "model.hw4_dbt.mart_hourly_fraud_pattern"} */
alter table transactions.main_marts.mart_hourly_fraud_pattern__dbt_tmp rename to mart_hourly_fraud_pattern
[0m14:11:32.734156 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m14:11:32.735746 [debug] [Thread-2 (]: On model.hw4_dbt.mart_hourly_fraud_pattern: COMMIT
[0m14:11:32.736087 [debug] [Thread-2 (]: Using duckdb connection "model.hw4_dbt.mart_hourly_fraud_pattern"
[0m14:11:32.736314 [debug] [Thread-2 (]: On model.hw4_dbt.mart_hourly_fraud_pattern: COMMIT
[0m14:11:32.737186 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:11:32.739146 [debug] [Thread-2 (]: Using duckdb connection "model.hw4_dbt.mart_hourly_fraud_pattern"
[0m14:11:32.739662 [debug] [Thread-2 (]: On model.hw4_dbt.mart_hourly_fraud_pattern: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "model.hw4_dbt.mart_hourly_fraud_pattern"} */
drop table if exists transactions.main_marts.mart_hourly_fraud_pattern__dbt_backup cascade
[0m14:11:32.740192 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m14:11:32.741000 [debug] [Thread-2 (]: On model.hw4_dbt.mart_hourly_fraud_pattern: Close
[0m14:11:32.741338 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7588774-10ab-4760-b8d4-a193b90fbdb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113fca3d0>]}
[0m14:11:32.741676 [info ] [Thread-2 (]: 6 of 7 OK created sql table model main_marts.mart_hourly_fraud_pattern ......... [[32mOK[0m in 0.20s]
[0m14:11:32.741978 [debug] [Thread-2 (]: Finished running node model.hw4_dbt.mart_hourly_fraud_pattern
[0m14:11:32.742197 [debug] [Thread-2 (]: Began running node model.hw4_dbt.mart_merchant_analytics
[0m14:11:32.742528 [info ] [Thread-2 (]: 7 of 7 START sql table model main_marts.mart_merchant_analytics ................ [RUN]
[0m14:11:32.742759 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.hw4_dbt.mart_hourly_fraud_pattern, now model.hw4_dbt.mart_merchant_analytics)
[0m14:11:32.742931 [debug] [Thread-2 (]: Began compiling node model.hw4_dbt.mart_merchant_analytics
[0m14:11:32.745955 [debug] [Thread-2 (]: Writing injected SQL for node "model.hw4_dbt.mart_merchant_analytics"
[0m14:11:32.747543 [debug] [Thread-2 (]: Began executing node model.hw4_dbt.mart_merchant_analytics
[0m14:11:32.753463 [debug] [Thread-2 (]: Writing runtime sql for node "model.hw4_dbt.mart_merchant_analytics"
[0m14:11:32.755941 [debug] [Thread-2 (]: Using duckdb connection "model.hw4_dbt.mart_merchant_analytics"
[0m14:11:32.756494 [debug] [Thread-2 (]: On model.hw4_dbt.mart_merchant_analytics: BEGIN
[0m14:11:32.757085 [debug] [Thread-4 (]: SQL status: OK in 0.286 seconds
[0m14:11:32.757324 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:11:32.759658 [debug] [Thread-4 (]: Using duckdb connection "model.hw4_dbt.mart_daily_state_metrics"
[0m14:11:32.760721 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m14:11:32.761188 [debug] [Thread-4 (]: On model.hw4_dbt.mart_daily_state_metrics: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "model.hw4_dbt.mart_daily_state_metrics"} */
alter table transactions.main_marts.mart_daily_state_metrics__dbt_tmp rename to mart_daily_state_metrics
[0m14:11:32.761722 [debug] [Thread-1 (]: SQL status: OK in 0.290 seconds
[0m14:11:32.763319 [debug] [Thread-2 (]: Using duckdb connection "model.hw4_dbt.mart_merchant_analytics"
[0m14:11:32.763976 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m14:11:32.766260 [debug] [Thread-1 (]: Using duckdb connection "model.hw4_dbt.mart_fraud_by_state"
[0m14:11:32.766741 [debug] [Thread-2 (]: On model.hw4_dbt.mart_merchant_analytics: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "model.hw4_dbt.mart_merchant_analytics"} */

  
    
    

    create  table
      transactions.main_marts.mart_merchant_analytics__dbt_tmp
  
    as (
      with base as (
    select
        merchant_id,
        merchant_name,
        us_state,
        amount,
        amount_bucket,
        is_fraud,
        customer_id
    from transactions.main_staging.stg_transactions
),
state_pref as (
    select
        merchant_id,
        us_state,
        count(*) as txn_count,
        row_number() over (partition by merchant_id order by count(*) desc) as rn
    from base
    group by merchant_id, us_state
),
primary_state as (
    select merchant_id, us_state as primary_state from state_pref where rn = 1
),
agg as (
    select
        merchant_id,
        max(merchant_name) as merchant_name,
        count(*) as transaction_count,
        sum(is_fraud) as fraud_count,
        sum(amount) as total_amount,
        avg(amount) as avg_amount,
        sum(case when amount_bucket in ('large', 'extra_large') then 1 else 0 end) as large_txn_count,
        count(distinct customer_id) as unique_customers
    from base
    group by merchant_id
),
scored as (
    select
        a.merchant_id,
        a.merchant_name,
        coalesce(p.primary_state, 'NA') as primary_state,
        a.transaction_count,
        a.total_amount,
        a.avg_amount,
        a.fraud_count,
        a.large_txn_count,
        a.unique_customers,
        case when a.transaction_count = 0 then 0 else a.fraud_count * 100.0 / a.transaction_count end as fraud_rate,
        case when a.transaction_count = 0 then 0 else a.large_txn_count * 1.0 / a.transaction_count end as large_txn_share
    from agg a
    left join primary_state p on a.merchant_id = p.merchant_id
)
select
    *,
    case when fraud_rate >= 5 or large_txn_share >= 0.4 then 1 else 0 end as suspicious_flag
from scored
order by fraud_rate desc
    );
  
  
[0m14:11:32.767587 [debug] [Thread-4 (]: On model.hw4_dbt.mart_daily_state_metrics: COMMIT
[0m14:11:32.768139 [debug] [Thread-1 (]: On model.hw4_dbt.mart_fraud_by_state: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "model.hw4_dbt.mart_fraud_by_state"} */
alter table transactions.main_marts.mart_fraud_by_state__dbt_tmp rename to mart_fraud_by_state
[0m14:11:32.769460 [debug] [Thread-4 (]: Using duckdb connection "model.hw4_dbt.mart_daily_state_metrics"
[0m14:11:32.770216 [debug] [Thread-4 (]: On model.hw4_dbt.mart_daily_state_metrics: COMMIT
[0m14:11:32.770491 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:11:32.771514 [debug] [Thread-1 (]: On model.hw4_dbt.mart_fraud_by_state: COMMIT
[0m14:11:32.771955 [debug] [Thread-1 (]: Using duckdb connection "model.hw4_dbt.mart_fraud_by_state"
[0m14:11:32.772237 [debug] [Thread-1 (]: On model.hw4_dbt.mart_fraud_by_state: COMMIT
[0m14:11:32.775780 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m14:11:32.777918 [debug] [Thread-4 (]: Using duckdb connection "model.hw4_dbt.mart_daily_state_metrics"
[0m14:11:32.778420 [debug] [Thread-4 (]: On model.hw4_dbt.mart_daily_state_metrics: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "model.hw4_dbt.mart_daily_state_metrics"} */
drop table if exists transactions.main_marts.mart_daily_state_metrics__dbt_backup cascade
[0m14:11:32.778855 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m14:11:32.779637 [debug] [Thread-4 (]: On model.hw4_dbt.mart_daily_state_metrics: Close
[0m14:11:32.779935 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7588774-10ab-4760-b8d4-a193b90fbdb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f13610>]}
[0m14:11:32.780237 [info ] [Thread-4 (]: 3 of 7 OK created sql table model main_marts.mart_daily_state_metrics .......... [[32mOK[0m in 0.41s]
[0m14:11:32.780501 [debug] [Thread-4 (]: Finished running node model.hw4_dbt.mart_daily_state_metrics
[0m14:11:32.784442 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m14:11:32.789137 [debug] [Thread-1 (]: Using duckdb connection "model.hw4_dbt.mart_fraud_by_state"
[0m14:11:32.789453 [debug] [Thread-1 (]: On model.hw4_dbt.mart_fraud_by_state: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "model.hw4_dbt.mart_fraud_by_state"} */
drop table if exists transactions.main_marts.mart_fraud_by_state__dbt_backup cascade
[0m14:11:32.789863 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:11:32.791633 [debug] [Thread-1 (]: On model.hw4_dbt.mart_fraud_by_state: Close
[0m14:11:32.795282 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7588774-10ab-4760-b8d4-a193b90fbdb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ce3690>]}
[0m14:11:32.796223 [info ] [Thread-1 (]: 5 of 7 OK created sql table model main_marts.mart_fraud_by_state ............... [[32mOK[0m in 0.42s]
[0m14:11:32.796642 [debug] [Thread-1 (]: Finished running node model.hw4_dbt.mart_fraud_by_state
[0m14:11:32.835116 [debug] [Thread-3 (]: SQL status: OK in 0.363 seconds
[0m14:11:32.838309 [debug] [Thread-3 (]: Using duckdb connection "model.hw4_dbt.mart_customer_risk_profile"
[0m14:11:32.838610 [debug] [Thread-3 (]: On model.hw4_dbt.mart_customer_risk_profile: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "model.hw4_dbt.mart_customer_risk_profile"} */
alter table transactions.main_marts.mart_customer_risk_profile__dbt_tmp rename to mart_customer_risk_profile
[0m14:11:32.839075 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m14:11:32.839749 [debug] [Thread-3 (]: On model.hw4_dbt.mart_customer_risk_profile: COMMIT
[0m14:11:32.839927 [debug] [Thread-3 (]: Using duckdb connection "model.hw4_dbt.mart_customer_risk_profile"
[0m14:11:32.840085 [debug] [Thread-3 (]: On model.hw4_dbt.mart_customer_risk_profile: COMMIT
[0m14:11:32.841284 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:11:32.843197 [debug] [Thread-3 (]: Using duckdb connection "model.hw4_dbt.mart_customer_risk_profile"
[0m14:11:32.843475 [debug] [Thread-3 (]: On model.hw4_dbt.mart_customer_risk_profile: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "model.hw4_dbt.mart_customer_risk_profile"} */
drop table if exists transactions.main_marts.mart_customer_risk_profile__dbt_backup cascade
[0m14:11:32.843877 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m14:11:32.844599 [debug] [Thread-3 (]: On model.hw4_dbt.mart_customer_risk_profile: Close
[0m14:11:32.845041 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7588774-10ab-4760-b8d4-a193b90fbdb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114862410>]}
[0m14:11:32.845443 [info ] [Thread-3 (]: 2 of 7 OK created sql table model main_marts.mart_customer_risk_profile ........ [[32mOK[0m in 0.47s]
[0m14:11:32.845737 [debug] [Thread-3 (]: Finished running node model.hw4_dbt.mart_customer_risk_profile
[0m14:11:32.955278 [debug] [Thread-2 (]: SQL status: OK in 0.187 seconds
[0m14:11:32.957969 [debug] [Thread-2 (]: Using duckdb connection "model.hw4_dbt.mart_merchant_analytics"
[0m14:11:32.958364 [debug] [Thread-2 (]: On model.hw4_dbt.mart_merchant_analytics: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "model.hw4_dbt.mart_merchant_analytics"} */
alter table transactions.main_marts.mart_merchant_analytics__dbt_tmp rename to mart_merchant_analytics
[0m14:11:32.958911 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m14:11:32.959640 [debug] [Thread-2 (]: On model.hw4_dbt.mart_merchant_analytics: COMMIT
[0m14:11:32.959834 [debug] [Thread-2 (]: Using duckdb connection "model.hw4_dbt.mart_merchant_analytics"
[0m14:11:32.959986 [debug] [Thread-2 (]: On model.hw4_dbt.mart_merchant_analytics: COMMIT
[0m14:11:32.960892 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:11:32.964436 [debug] [Thread-2 (]: Using duckdb connection "model.hw4_dbt.mart_merchant_analytics"
[0m14:11:32.964722 [debug] [Thread-2 (]: On model.hw4_dbt.mart_merchant_analytics: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "model.hw4_dbt.mart_merchant_analytics"} */
drop table if exists transactions.main_marts.mart_merchant_analytics__dbt_backup cascade
[0m14:11:32.965157 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m14:11:32.965919 [debug] [Thread-2 (]: On model.hw4_dbt.mart_merchant_analytics: Close
[0m14:11:33.011844 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7588774-10ab-4760-b8d4-a193b90fbdb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113820490>]}
[0m14:11:33.013712 [info ] [Thread-2 (]: 7 of 7 OK created sql table model main_marts.mart_merchant_analytics ........... [[32mOK[0m in 0.27s]
[0m14:11:33.014201 [debug] [Thread-2 (]: Finished running node model.hw4_dbt.mart_merchant_analytics
[0m14:11:33.015538 [debug] [MainThread]: Using duckdb connection "master"
[0m14:11:33.016112 [debug] [MainThread]: On master: BEGIN
[0m14:11:33.016366 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:11:33.027124 [debug] [MainThread]: SQL status: OK in 0.011 seconds
[0m14:11:33.027404 [debug] [MainThread]: On master: COMMIT
[0m14:11:33.030333 [debug] [MainThread]: Using duckdb connection "master"
[0m14:11:33.030533 [debug] [MainThread]: On master: COMMIT
[0m14:11:33.030845 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:11:33.031013 [debug] [MainThread]: On master: Close
[0m14:11:33.032663 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:11:33.033106 [debug] [MainThread]: Connection 'model.hw4_dbt.mart_fraud_by_state' was properly closed.
[0m14:11:33.033444 [debug] [MainThread]: Connection 'model.hw4_dbt.mart_merchant_analytics' was properly closed.
[0m14:11:33.033619 [debug] [MainThread]: Connection 'model.hw4_dbt.mart_customer_risk_profile' was properly closed.
[0m14:11:33.033756 [debug] [MainThread]: Connection 'model.hw4_dbt.mart_daily_state_metrics' was properly closed.
[0m14:11:33.034195 [info ] [MainThread]: 
[0m14:11:33.034496 [info ] [MainThread]: Finished running 1 view model, 6 table models in 0 hours 0 minutes and 0.82 seconds (0.82s).
[0m14:11:33.035332 [debug] [MainThread]: Command end result
[0m14:11:33.070306 [info ] [MainThread]: 
[0m14:11:33.070776 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:11:33.071193 [info ] [MainThread]: 
[0m14:11:33.071398 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m14:11:33.074452 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.8845873, "process_user_time": 3.715454, "process_kernel_time": 0.476209, "process_mem_max_rss": "711557120", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:11:33.075529 [debug] [MainThread]: Command `dbt run` succeeded at 14:11:33.075437 after 1.89 seconds
[0m14:11:33.075912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130065d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049bd7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11330fc50>]}
[0m14:11:33.076158 [debug] [MainThread]: Flushing usage events
[0m14:11:41.134582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10841f590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108478d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108479410>]}


============================== 14:11:41.137673 | 6e4ef7e6-5a60-4476-ac21-594fb7c537e7 ==============================
[0m14:11:41.137673 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:11:41.138053 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/roman/Desktop/hw4-mlops-bokhyan/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:11:41.276116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e4ef7e6-5a60-4476-ac21-594fb7c537e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a4e950>]}
[0m14:11:41.312906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e4ef7e6-5a60-4476-ac21-594fb7c537e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ab1210>]}
[0m14:11:41.313512 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m14:11:41.374486 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m14:11:41.466095 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:11:41.466421 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:11:41.498415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e4ef7e6-5a60-4476-ac21-594fb7c537e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108df6b50>]}
[0m14:11:41.589317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e4ef7e6-5a60-4476-ac21-594fb7c537e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a89010>]}
[0m14:11:41.589669 [info ] [MainThread]: Found 2 seeds, 56 data tests, 7 models, 1 source, 805 macros
[0m14:11:41.589858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e4ef7e6-5a60-4476-ac21-594fb7c537e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108de6350>]}
[0m14:11:41.625968 [info ] [MainThread]: 
[0m14:11:41.626446 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:11:41.629881 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_transactions_main_staging'
[0m14:11:41.630288 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_transactions_main_marts'
[0m14:11:41.630640 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_transactions_main_transactions_db'
[0m14:11:41.662314 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_staging"
[0m14:11:41.662653 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_marts"
[0m14:11:41.662901 [debug] [ThreadPool]: On list_transactions_main_staging: BEGIN
[0m14:11:41.663053 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_transactions_db"
[0m14:11:41.663202 [debug] [ThreadPool]: On list_transactions_main_marts: BEGIN
[0m14:11:41.663337 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:11:41.663467 [debug] [ThreadPool]: On list_transactions_main_transactions_db: BEGIN
[0m14:11:41.663593 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:11:41.664217 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:11:41.672511 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m14:11:41.672798 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m14:11:41.673053 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m14:11:41.673268 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_staging"
[0m14:11:41.673432 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_marts"
[0m14:11:41.673576 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_transactions_db"
[0m14:11:41.673733 [debug] [ThreadPool]: On list_transactions_main_staging: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "connection_name": "list_transactions_main_staging"} */
select
      'transactions' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_staging'
    and table_catalog = 'transactions'
  
[0m14:11:41.673912 [debug] [ThreadPool]: On list_transactions_main_marts: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "connection_name": "list_transactions_main_marts"} */
select
      'transactions' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_marts'
    and table_catalog = 'transactions'
  
[0m14:11:41.674078 [debug] [ThreadPool]: On list_transactions_main_transactions_db: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "connection_name": "list_transactions_main_transactions_db"} */
select
      'transactions' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_transactions_db'
    and table_catalog = 'transactions'
  
[0m14:11:41.684039 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m14:11:41.684396 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m14:11:41.684613 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m14:11:41.685532 [debug] [ThreadPool]: On list_transactions_main_marts: ROLLBACK
[0m14:11:41.686353 [debug] [ThreadPool]: On list_transactions_main_staging: ROLLBACK
[0m14:11:41.687241 [debug] [ThreadPool]: On list_transactions_main_transactions_db: ROLLBACK
[0m14:11:41.687813 [debug] [ThreadPool]: Failed to rollback 'list_transactions_main_marts'
[0m14:11:41.688116 [debug] [ThreadPool]: Failed to rollback 'list_transactions_main_transactions_db'
[0m14:11:41.688334 [debug] [ThreadPool]: On list_transactions_main_marts: Close
[0m14:11:41.688582 [debug] [ThreadPool]: Failed to rollback 'list_transactions_main_staging'
[0m14:11:41.688742 [debug] [ThreadPool]: On list_transactions_main_transactions_db: Close
[0m14:11:41.689602 [debug] [ThreadPool]: On list_transactions_main_staging: Close
[0m14:11:41.692156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e4ef7e6-5a60-4476-ac21-594fb7c537e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105db4c10>]}
[0m14:11:41.692464 [debug] [MainThread]: Using duckdb connection "master"
[0m14:11:41.692615 [debug] [MainThread]: On master: BEGIN
[0m14:11:41.692749 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:11:41.700774 [debug] [MainThread]: SQL status: OK in 0.008 seconds
[0m14:11:41.701027 [debug] [MainThread]: On master: COMMIT
[0m14:11:41.701171 [debug] [MainThread]: Using duckdb connection "master"
[0m14:11:41.701297 [debug] [MainThread]: On master: COMMIT
[0m14:11:41.701511 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:11:41.701651 [debug] [MainThread]: On master: Close
[0m14:11:41.703042 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:11:41.703358 [info ] [MainThread]: 
[0m14:11:41.705647 [debug] [Thread-1 (]: Began running node test.hw4_dbt.accepted_values_mart_customer_risk_profile_risk_level__HIGH__MEDIUM__LOW.95fabd3536
[0m14:11:41.705876 [debug] [Thread-2 (]: Began running node test.hw4_dbt.accepted_values_mart_merchant_analytics_suspicious_flag__0__1.221ef94aff
[0m14:11:41.706193 [debug] [Thread-3 (]: Began running node test.hw4_dbt.accepted_values_stg_transactions_amount_bucket__small__medium__large__extra_large__unknown.f09a27d70f
[0m14:11:41.706476 [debug] [Thread-4 (]: Began running node test.hw4_dbt.accepted_values_stg_transactions_gender__M__F__U.ae8f0c87a0
[0m14:11:41.706817 [info ] [Thread-1 (]: 1 of 56 START test accepted_values_mart_customer_risk_profile_risk_level__HIGH__MEDIUM__LOW  [RUN]
[0m14:11:41.707193 [info ] [Thread-2 (]: 2 of 56 START test accepted_values_mart_merchant_analytics_suspicious_flag__0__1  [RUN]
[0m14:11:41.708051 [info ] [Thread-3 (]: 3 of 56 START test accepted_values_stg_transactions_amount_bucket__small__medium__large__extra_large__unknown  [RUN]
[0m14:11:41.708727 [info ] [Thread-4 (]: 4 of 56 START test accepted_values_stg_transactions_gender__M__F__U ............ [RUN]
[0m14:11:41.709306 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_transactions_main_staging, now test.hw4_dbt.accepted_values_mart_customer_risk_profile_risk_level__HIGH__MEDIUM__LOW.95fabd3536)
[0m14:11:41.709587 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_transactions_main_marts, now test.hw4_dbt.accepted_values_mart_merchant_analytics_suspicious_flag__0__1.221ef94aff)
[0m14:11:41.709818 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_transactions_main_transactions_db, now test.hw4_dbt.accepted_values_stg_transactions_amount_bucket__small__medium__large__extra_large__unknown.f09a27d70f)
[0m14:11:41.710118 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.hw4_dbt.accepted_values_stg_transactions_gender__M__F__U.ae8f0c87a0'
[0m14:11:41.710375 [debug] [Thread-1 (]: Began compiling node test.hw4_dbt.accepted_values_mart_customer_risk_profile_risk_level__HIGH__MEDIUM__LOW.95fabd3536
[0m14:11:41.710678 [debug] [Thread-2 (]: Began compiling node test.hw4_dbt.accepted_values_mart_merchant_analytics_suspicious_flag__0__1.221ef94aff
[0m14:11:41.710907 [debug] [Thread-3 (]: Began compiling node test.hw4_dbt.accepted_values_stg_transactions_amount_bucket__small__medium__large__extra_large__unknown.f09a27d70f
[0m14:11:41.711153 [debug] [Thread-4 (]: Began compiling node test.hw4_dbt.accepted_values_stg_transactions_gender__M__F__U.ae8f0c87a0
[0m14:11:41.734240 [debug] [Thread-1 (]: Writing injected SQL for node "test.hw4_dbt.accepted_values_mart_customer_risk_profile_risk_level__HIGH__MEDIUM__LOW.95fabd3536"
[0m14:11:41.736548 [debug] [Thread-2 (]: Writing injected SQL for node "test.hw4_dbt.accepted_values_mart_merchant_analytics_suspicious_flag__0__1.221ef94aff"
[0m14:11:41.740003 [debug] [Thread-3 (]: Writing injected SQL for node "test.hw4_dbt.accepted_values_stg_transactions_amount_bucket__small__medium__large__extra_large__unknown.f09a27d70f"
[0m14:11:41.742906 [debug] [Thread-4 (]: Writing injected SQL for node "test.hw4_dbt.accepted_values_stg_transactions_gender__M__F__U.ae8f0c87a0"
[0m14:11:41.743923 [debug] [Thread-1 (]: Began executing node test.hw4_dbt.accepted_values_mart_customer_risk_profile_risk_level__HIGH__MEDIUM__LOW.95fabd3536
[0m14:11:41.750086 [debug] [Thread-2 (]: Began executing node test.hw4_dbt.accepted_values_mart_merchant_analytics_suspicious_flag__0__1.221ef94aff
[0m14:11:41.789023 [debug] [Thread-3 (]: Began executing node test.hw4_dbt.accepted_values_stg_transactions_amount_bucket__small__medium__large__extra_large__unknown.f09a27d70f
[0m14:11:41.792093 [debug] [Thread-2 (]: Writing runtime sql for node "test.hw4_dbt.accepted_values_mart_merchant_analytics_suspicious_flag__0__1.221ef94aff"
[0m14:11:41.792889 [debug] [Thread-1 (]: Writing runtime sql for node "test.hw4_dbt.accepted_values_mart_customer_risk_profile_risk_level__HIGH__MEDIUM__LOW.95fabd3536"
[0m14:11:41.794695 [debug] [Thread-3 (]: Writing runtime sql for node "test.hw4_dbt.accepted_values_stg_transactions_amount_bucket__small__medium__large__extra_large__unknown.f09a27d70f"
[0m14:11:41.795032 [debug] [Thread-4 (]: Began executing node test.hw4_dbt.accepted_values_stg_transactions_gender__M__F__U.ae8f0c87a0
[0m14:11:41.796791 [debug] [Thread-4 (]: Writing runtime sql for node "test.hw4_dbt.accepted_values_stg_transactions_gender__M__F__U.ae8f0c87a0"
[0m14:11:41.797322 [debug] [Thread-1 (]: Using duckdb connection "test.hw4_dbt.accepted_values_mart_customer_risk_profile_risk_level__HIGH__MEDIUM__LOW.95fabd3536"
[0m14:11:41.797604 [debug] [Thread-2 (]: Using duckdb connection "test.hw4_dbt.accepted_values_mart_merchant_analytics_suspicious_flag__0__1.221ef94aff"
[0m14:11:41.797835 [debug] [Thread-1 (]: On test.hw4_dbt.accepted_values_mart_customer_risk_profile_risk_level__HIGH__MEDIUM__LOW.95fabd3536: BEGIN
[0m14:11:41.798066 [debug] [Thread-4 (]: Using duckdb connection "test.hw4_dbt.accepted_values_stg_transactions_gender__M__F__U.ae8f0c87a0"
[0m14:11:41.798266 [debug] [Thread-3 (]: Using duckdb connection "test.hw4_dbt.accepted_values_stg_transactions_amount_bucket__small__medium__large__extra_large__unknown.f09a27d70f"
[0m14:11:41.798420 [debug] [Thread-2 (]: On test.hw4_dbt.accepted_values_mart_merchant_analytics_suspicious_flag__0__1.221ef94aff: BEGIN
[0m14:11:41.798606 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:41.798783 [debug] [Thread-4 (]: On test.hw4_dbt.accepted_values_stg_transactions_gender__M__F__U.ae8f0c87a0: BEGIN
[0m14:11:41.798951 [debug] [Thread-3 (]: On test.hw4_dbt.accepted_values_stg_transactions_amount_bucket__small__medium__large__extra_large__unknown.f09a27d70f: BEGIN
[0m14:11:41.799138 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:11:41.799536 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:11:41.800024 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:11:41.807630 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m14:11:41.807969 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m14:11:41.808233 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m14:11:41.808430 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m14:11:41.808741 [debug] [Thread-1 (]: Using duckdb connection "test.hw4_dbt.accepted_values_mart_customer_risk_profile_risk_level__HIGH__MEDIUM__LOW.95fabd3536"
[0m14:11:41.808965 [debug] [Thread-4 (]: Using duckdb connection "test.hw4_dbt.accepted_values_stg_transactions_gender__M__F__U.ae8f0c87a0"
[0m14:11:41.809219 [debug] [Thread-2 (]: Using duckdb connection "test.hw4_dbt.accepted_values_mart_merchant_analytics_suspicious_flag__0__1.221ef94aff"
[0m14:11:41.809451 [debug] [Thread-3 (]: Using duckdb connection "test.hw4_dbt.accepted_values_stg_transactions_amount_bucket__small__medium__large__extra_large__unknown.f09a27d70f"
[0m14:11:41.809756 [debug] [Thread-1 (]: On test.hw4_dbt.accepted_values_mart_customer_risk_profile_risk_level__HIGH__MEDIUM__LOW.95fabd3536: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.accepted_values_mart_customer_risk_profile_risk_level__HIGH__MEDIUM__LOW.95fabd3536"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        risk_level as value_field,
        count(*) as n_records

    from transactions.main_marts.mart_customer_risk_profile
    group by risk_level

)

select *
from all_values
where value_field not in (
    'HIGH','MEDIUM','LOW'
)



      
    ) dbt_internal_test
[0m14:11:41.810017 [debug] [Thread-4 (]: On test.hw4_dbt.accepted_values_stg_transactions_gender__M__F__U.ae8f0c87a0: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.accepted_values_stg_transactions_gender__M__F__U.ae8f0c87a0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        gender as value_field,
        count(*) as n_records

    from transactions.main_staging.stg_transactions
    group by gender

)

select *
from all_values
where value_field not in (
    'M','F','U'
)



      
    ) dbt_internal_test
[0m14:11:41.810312 [debug] [Thread-2 (]: On test.hw4_dbt.accepted_values_mart_merchant_analytics_suspicious_flag__0__1.221ef94aff: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.accepted_values_mart_merchant_analytics_suspicious_flag__0__1.221ef94aff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        suspicious_flag as value_field,
        count(*) as n_records

    from transactions.main_marts.mart_merchant_analytics
    group by suspicious_flag

)

select *
from all_values
where value_field not in (
    '0','1'
)



      
    ) dbt_internal_test
[0m14:11:41.810568 [debug] [Thread-3 (]: On test.hw4_dbt.accepted_values_stg_transactions_amount_bucket__small__medium__large__extra_large__unknown.f09a27d70f: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.accepted_values_stg_transactions_amount_bucket__small__medium__large__extra_large__unknown.f09a27d70f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        amount_bucket as value_field,
        count(*) as n_records

    from transactions.main_staging.stg_transactions
    group by amount_bucket

)

select *
from all_values
where value_field not in (
    'small','medium','large','extra_large','unknown'
)



      
    ) dbt_internal_test
[0m14:11:41.813643 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:11:41.813878 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:11:41.818321 [debug] [Thread-1 (]: On test.hw4_dbt.accepted_values_mart_customer_risk_profile_risk_level__HIGH__MEDIUM__LOW.95fabd3536: ROLLBACK
[0m14:11:41.823070 [debug] [Thread-2 (]: On test.hw4_dbt.accepted_values_mart_merchant_analytics_suspicious_flag__0__1.221ef94aff: ROLLBACK
[0m14:11:41.823542 [debug] [Thread-4 (]: SQL status: OK in 0.011 seconds
[0m14:11:41.823957 [debug] [Thread-1 (]: Failed to rollback 'test.hw4_dbt.accepted_values_mart_customer_risk_profile_risk_level__HIGH__MEDIUM__LOW.95fabd3536'
[0m14:11:41.824723 [debug] [Thread-2 (]: Failed to rollback 'test.hw4_dbt.accepted_values_mart_merchant_analytics_suspicious_flag__0__1.221ef94aff'
[0m14:11:41.825126 [debug] [Thread-3 (]: SQL status: OK in 0.012 seconds
[0m14:11:41.826075 [debug] [Thread-4 (]: On test.hw4_dbt.accepted_values_stg_transactions_gender__M__F__U.ae8f0c87a0: ROLLBACK
[0m14:11:41.826408 [debug] [Thread-1 (]: On test.hw4_dbt.accepted_values_mart_customer_risk_profile_risk_level__HIGH__MEDIUM__LOW.95fabd3536: Close
[0m14:11:41.826691 [debug] [Thread-2 (]: On test.hw4_dbt.accepted_values_mart_merchant_analytics_suspicious_flag__0__1.221ef94aff: Close
[0m14:11:41.827049 [debug] [Thread-4 (]: Failed to rollback 'test.hw4_dbt.accepted_values_stg_transactions_gender__M__F__U.ae8f0c87a0'
[0m14:11:41.827820 [debug] [Thread-3 (]: On test.hw4_dbt.accepted_values_stg_transactions_amount_bucket__small__medium__large__extra_large__unknown.f09a27d70f: ROLLBACK
[0m14:11:41.829061 [info ] [Thread-1 (]: 1 of 56 PASS accepted_values_mart_customer_risk_profile_risk_level__HIGH__MEDIUM__LOW  [[32mPASS[0m in 0.12s]
[0m14:11:41.829733 [info ] [Thread-2 (]: 2 of 56 PASS accepted_values_mart_merchant_analytics_suspicious_flag__0__1 ..... [[32mPASS[0m in 0.12s]
[0m14:11:41.831435 [debug] [Thread-4 (]: On test.hw4_dbt.accepted_values_stg_transactions_gender__M__F__U.ae8f0c87a0: Close
[0m14:11:41.831885 [debug] [Thread-3 (]: Failed to rollback 'test.hw4_dbt.accepted_values_stg_transactions_amount_bucket__small__medium__large__extra_large__unknown.f09a27d70f'
[0m14:11:41.832438 [debug] [Thread-1 (]: Finished running node test.hw4_dbt.accepted_values_mart_customer_risk_profile_risk_level__HIGH__MEDIUM__LOW.95fabd3536
[0m14:11:41.832725 [debug] [Thread-2 (]: Finished running node test.hw4_dbt.accepted_values_mart_merchant_analytics_suspicious_flag__0__1.221ef94aff
[0m14:11:41.833358 [debug] [Thread-3 (]: On test.hw4_dbt.accepted_values_stg_transactions_amount_bucket__small__medium__large__extra_large__unknown.f09a27d70f: Close
[0m14:11:41.833801 [info ] [Thread-4 (]: 4 of 56 PASS accepted_values_stg_transactions_gender__M__F__U .................. [[32mPASS[0m in 0.12s]
[0m14:11:41.834128 [debug] [Thread-1 (]: Began running node test.hw4_dbt.accepted_values_stg_transactions_is_fraud__0__1.f6d9ff0fc6
[0m14:11:41.834657 [debug] [Thread-2 (]: Began running node test.hw4_dbt.assert_fraud_rate_bounds
[0m14:11:41.835843 [debug] [Thread-4 (]: Finished running node test.hw4_dbt.accepted_values_stg_transactions_gender__M__F__U.ae8f0c87a0
[0m14:11:41.836153 [info ] [Thread-1 (]: 5 of 56 START test accepted_values_stg_transactions_is_fraud__0__1 ............. [RUN]
[0m14:11:41.838105 [debug] [Thread-4 (]: Began running node test.hw4_dbt.assert_no_negative_amounts
[0m14:11:41.836665 [info ] [Thread-3 (]: 3 of 56 PASS accepted_values_stg_transactions_amount_bucket__small__medium__large__extra_large__unknown  [[32mPASS[0m in 0.13s]
[0m14:11:41.837288 [info ] [Thread-2 (]: 6 of 56 START test assert_fraud_rate_bounds .................................... [RUN]
[0m14:11:41.838930 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.accepted_values_mart_customer_risk_profile_risk_level__HIGH__MEDIUM__LOW.95fabd3536, now test.hw4_dbt.accepted_values_stg_transactions_is_fraud__0__1.f6d9ff0fc6)
[0m14:11:41.839434 [info ] [Thread-4 (]: 7 of 56 START test assert_no_negative_amounts .................................. [RUN]
[0m14:11:41.839992 [debug] [Thread-3 (]: Finished running node test.hw4_dbt.accepted_values_stg_transactions_amount_bucket__small__medium__large__extra_large__unknown.f09a27d70f
[0m14:11:41.840370 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.accepted_values_mart_merchant_analytics_suspicious_flag__0__1.221ef94aff, now test.hw4_dbt.assert_fraud_rate_bounds)
[0m14:11:41.840641 [debug] [Thread-1 (]: Began compiling node test.hw4_dbt.accepted_values_stg_transactions_is_fraud__0__1.f6d9ff0fc6
[0m14:11:41.841689 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.accepted_values_stg_transactions_gender__M__F__U.ae8f0c87a0, now test.hw4_dbt.assert_no_negative_amounts)
[0m14:11:41.841953 [debug] [Thread-3 (]: Began running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_customer_risk_profile_fraud_rate__100__0.ee441b99d9
[0m14:11:41.842195 [debug] [Thread-2 (]: Began compiling node test.hw4_dbt.assert_fraud_rate_bounds
[0m14:11:41.845031 [debug] [Thread-1 (]: Writing injected SQL for node "test.hw4_dbt.accepted_values_stg_transactions_is_fraud__0__1.f6d9ff0fc6"
[0m14:11:41.845357 [debug] [Thread-4 (]: Began compiling node test.hw4_dbt.assert_no_negative_amounts
[0m14:11:41.845648 [info ] [Thread-3 (]: 8 of 56 START test dbt_expectations_expect_column_values_to_be_between_mart_customer_risk_profile_fraud_rate__100__0  [RUN]
[0m14:11:41.848041 [debug] [Thread-2 (]: Writing injected SQL for node "test.hw4_dbt.assert_fraud_rate_bounds"
[0m14:11:41.850157 [debug] [Thread-4 (]: Writing injected SQL for node "test.hw4_dbt.assert_no_negative_amounts"
[0m14:11:41.850563 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.accepted_values_stg_transactions_amount_bucket__small__medium__large__extra_large__unknown.f09a27d70f, now test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_customer_risk_profile_fraud_rate__100__0.ee441b99d9)
[0m14:11:41.850788 [debug] [Thread-1 (]: Began executing node test.hw4_dbt.accepted_values_stg_transactions_is_fraud__0__1.f6d9ff0fc6
[0m14:11:41.851181 [debug] [Thread-3 (]: Began compiling node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_customer_risk_profile_fraud_rate__100__0.ee441b99d9
[0m14:11:41.852823 [debug] [Thread-1 (]: Writing runtime sql for node "test.hw4_dbt.accepted_values_stg_transactions_is_fraud__0__1.f6d9ff0fc6"
[0m14:11:41.858509 [debug] [Thread-4 (]: Began executing node test.hw4_dbt.assert_no_negative_amounts
[0m14:11:41.861617 [debug] [Thread-3 (]: Writing injected SQL for node "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_customer_risk_profile_fraud_rate__100__0.ee441b99d9"
[0m14:11:41.861902 [debug] [Thread-2 (]: Began executing node test.hw4_dbt.assert_fraud_rate_bounds
[0m14:11:41.864992 [debug] [Thread-4 (]: Writing runtime sql for node "test.hw4_dbt.assert_no_negative_amounts"
[0m14:11:41.866758 [debug] [Thread-2 (]: Writing runtime sql for node "test.hw4_dbt.assert_fraud_rate_bounds"
[0m14:11:41.867255 [debug] [Thread-1 (]: Using duckdb connection "test.hw4_dbt.accepted_values_stg_transactions_is_fraud__0__1.f6d9ff0fc6"
[0m14:11:41.867509 [debug] [Thread-3 (]: Began executing node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_customer_risk_profile_fraud_rate__100__0.ee441b99d9
[0m14:11:41.867922 [debug] [Thread-1 (]: On test.hw4_dbt.accepted_values_stg_transactions_is_fraud__0__1.f6d9ff0fc6: BEGIN
[0m14:11:41.868142 [debug] [Thread-4 (]: Using duckdb connection "test.hw4_dbt.assert_no_negative_amounts"
[0m14:11:41.868385 [debug] [Thread-2 (]: Using duckdb connection "test.hw4_dbt.assert_fraud_rate_bounds"
[0m14:11:41.869943 [debug] [Thread-3 (]: Writing runtime sql for node "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_customer_risk_profile_fraud_rate__100__0.ee441b99d9"
[0m14:11:41.870325 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:41.870742 [debug] [Thread-4 (]: On test.hw4_dbt.assert_no_negative_amounts: BEGIN
[0m14:11:41.870970 [debug] [Thread-2 (]: On test.hw4_dbt.assert_fraud_rate_bounds: BEGIN
[0m14:11:41.871470 [debug] [Thread-3 (]: Using duckdb connection "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_customer_risk_profile_fraud_rate__100__0.ee441b99d9"
[0m14:11:41.871713 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:11:41.871957 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:11:41.872271 [debug] [Thread-3 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_customer_risk_profile_fraud_rate__100__0.ee441b99d9: BEGIN
[0m14:11:41.872581 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:11:41.879603 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m14:11:41.880005 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m14:11:41.880305 [debug] [Thread-4 (]: Using duckdb connection "test.hw4_dbt.assert_no_negative_amounts"
[0m14:11:41.880511 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m14:11:41.880719 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m14:11:41.880931 [debug] [Thread-1 (]: Using duckdb connection "test.hw4_dbt.accepted_values_stg_transactions_is_fraud__0__1.f6d9ff0fc6"
[0m14:11:41.881151 [debug] [Thread-4 (]: On test.hw4_dbt.assert_no_negative_amounts: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.assert_no_negative_amounts"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * from transactions.main_staging.stg_transactions where amount < 0
      
    ) dbt_internal_test
[0m14:11:41.881390 [debug] [Thread-2 (]: Using duckdb connection "test.hw4_dbt.assert_fraud_rate_bounds"
[0m14:11:41.881579 [debug] [Thread-3 (]: Using duckdb connection "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_customer_risk_profile_fraud_rate__100__0.ee441b99d9"
[0m14:11:41.881848 [debug] [Thread-1 (]: On test.hw4_dbt.accepted_values_stg_transactions_is_fraud__0__1.f6d9ff0fc6: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.accepted_values_stg_transactions_is_fraud__0__1.f6d9ff0fc6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        is_fraud as value_field,
        count(*) as n_records

    from transactions.main_staging.stg_transactions
    group by is_fraud

)

select *
from all_values
where value_field not in (
    '0','1'
)



      
    ) dbt_internal_test
[0m14:11:41.882245 [debug] [Thread-2 (]: On test.hw4_dbt.assert_fraud_rate_bounds: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.assert_fraud_rate_bounds"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select *
from transactions.main_marts.mart_fraud_by_category
where fraud_rate < 0 or fraud_rate > 100
      
    ) dbt_internal_test
[0m14:11:41.882577 [debug] [Thread-3 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_customer_risk_profile_fraud_rate__100__0.ee441b99d9: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_customer_risk_profile_fraud_rate__100__0.ee441b99d9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and fraud_rate >= 0 and fraud_rate <= 100
)
 as expression


    from transactions.main_marts.mart_customer_risk_profile
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m14:11:41.884421 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:11:41.884967 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:11:41.885916 [debug] [Thread-2 (]: On test.hw4_dbt.assert_fraud_rate_bounds: ROLLBACK
[0m14:11:41.886479 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m14:11:41.887510 [debug] [Thread-3 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_customer_risk_profile_fraud_rate__100__0.ee441b99d9: ROLLBACK
[0m14:11:41.888065 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m14:11:41.888384 [debug] [Thread-2 (]: Failed to rollback 'test.hw4_dbt.assert_fraud_rate_bounds'
[0m14:11:41.888853 [debug] [Thread-3 (]: Failed to rollback 'test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_customer_risk_profile_fraud_rate__100__0.ee441b99d9'
[0m14:11:41.889620 [debug] [Thread-4 (]: On test.hw4_dbt.assert_no_negative_amounts: ROLLBACK
[0m14:11:41.890400 [debug] [Thread-1 (]: On test.hw4_dbt.accepted_values_stg_transactions_is_fraud__0__1.f6d9ff0fc6: ROLLBACK
[0m14:11:41.890585 [debug] [Thread-2 (]: On test.hw4_dbt.assert_fraud_rate_bounds: Close
[0m14:11:41.890786 [debug] [Thread-3 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_customer_risk_profile_fraud_rate__100__0.ee441b99d9: Close
[0m14:11:41.892695 [debug] [Thread-4 (]: Failed to rollback 'test.hw4_dbt.assert_no_negative_amounts'
[0m14:11:41.893039 [debug] [Thread-1 (]: Failed to rollback 'test.hw4_dbt.accepted_values_stg_transactions_is_fraud__0__1.f6d9ff0fc6'
[0m14:11:41.893531 [info ] [Thread-2 (]: 6 of 56 PASS assert_fraud_rate_bounds .......................................... [[32mPASS[0m in 0.05s]
[0m14:11:41.893847 [info ] [Thread-3 (]: 8 of 56 PASS dbt_expectations_expect_column_values_to_be_between_mart_customer_risk_profile_fraud_rate__100__0  [[32mPASS[0m in 0.04s]
[0m14:11:41.895242 [debug] [Thread-4 (]: On test.hw4_dbt.assert_no_negative_amounts: Close
[0m14:11:41.895481 [debug] [Thread-1 (]: On test.hw4_dbt.accepted_values_stg_transactions_is_fraud__0__1.f6d9ff0fc6: Close
[0m14:11:41.896286 [debug] [Thread-2 (]: Finished running node test.hw4_dbt.assert_fraud_rate_bounds
[0m14:11:41.897399 [debug] [Thread-3 (]: Finished running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_customer_risk_profile_fraud_rate__100__0.ee441b99d9
[0m14:11:41.897871 [info ] [Thread-4 (]: 7 of 56 PASS assert_no_negative_amounts ........................................ [[32mPASS[0m in 0.06s]
[0m14:11:41.898711 [debug] [Thread-2 (]: Began running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_fraud_rate__1__0.59ce56cc94
[0m14:11:41.899159 [debug] [Thread-3 (]: Began running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_large_txn_share__1__0.d93f9f3127
[0m14:11:41.901277 [debug] [Thread-4 (]: Finished running node test.hw4_dbt.assert_no_negative_amounts
[0m14:11:41.900798 [info ] [Thread-1 (]: 5 of 56 PASS accepted_values_stg_transactions_is_fraud__0__1 ................... [[32mPASS[0m in 0.06s]
[0m14:11:41.903139 [info ] [Thread-2 (]: 9 of 56 START test dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_fraud_rate__1__0  [RUN]
[0m14:11:41.903691 [info ] [Thread-3 (]: 10 of 56 START test dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_large_txn_share__1__0  [RUN]
[0m14:11:41.904560 [debug] [Thread-4 (]: Began running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_category_fraud_rate__100__0.60b2512acf
[0m14:11:41.905165 [debug] [Thread-1 (]: Finished running node test.hw4_dbt.accepted_values_stg_transactions_is_fraud__0__1.f6d9ff0fc6
[0m14:11:41.905493 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.assert_fraud_rate_bounds, now test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_fraud_rate__1__0.59ce56cc94)
[0m14:11:41.905857 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_customer_risk_profile_fraud_rate__100__0.ee441b99d9, now test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_large_txn_share__1__0.d93f9f3127)
[0m14:11:41.906124 [info ] [Thread-4 (]: 11 of 56 START test dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_category_fraud_rate__100__0  [RUN]
[0m14:11:41.906384 [debug] [Thread-1 (]: Began running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_state_fraud_rate__100__0.ad1018ee37
[0m14:11:41.906653 [debug] [Thread-2 (]: Began compiling node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_fraud_rate__1__0.59ce56cc94
[0m14:11:41.906954 [debug] [Thread-3 (]: Began compiling node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_large_txn_share__1__0.d93f9f3127
[0m14:11:41.907195 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.assert_no_negative_amounts, now test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_category_fraud_rate__100__0.60b2512acf)
[0m14:11:41.907413 [info ] [Thread-1 (]: 12 of 56 START test dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_state_fraud_rate__100__0  [RUN]
[0m14:11:41.910765 [debug] [Thread-2 (]: Writing injected SQL for node "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_fraud_rate__1__0.59ce56cc94"
[0m14:11:41.914404 [debug] [Thread-3 (]: Writing injected SQL for node "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_large_txn_share__1__0.d93f9f3127"
[0m14:11:41.914737 [debug] [Thread-4 (]: Began compiling node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_category_fraud_rate__100__0.60b2512acf
[0m14:11:41.914991 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.accepted_values_stg_transactions_is_fraud__0__1.f6d9ff0fc6, now test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_state_fraud_rate__100__0.ad1018ee37)
[0m14:11:41.917961 [debug] [Thread-4 (]: Writing injected SQL for node "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_category_fraud_rate__100__0.60b2512acf"
[0m14:11:41.918649 [debug] [Thread-1 (]: Began compiling node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_state_fraud_rate__100__0.ad1018ee37
[0m14:11:41.919150 [debug] [Thread-2 (]: Began executing node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_fraud_rate__1__0.59ce56cc94
[0m14:11:41.919652 [debug] [Thread-4 (]: Began executing node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_category_fraud_rate__100__0.60b2512acf
[0m14:11:41.922221 [debug] [Thread-1 (]: Writing injected SQL for node "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_state_fraud_rate__100__0.ad1018ee37"
[0m14:11:41.922491 [debug] [Thread-3 (]: Began executing node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_large_txn_share__1__0.d93f9f3127
[0m14:11:41.924430 [debug] [Thread-2 (]: Writing runtime sql for node "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_fraud_rate__1__0.59ce56cc94"
[0m14:11:41.927696 [debug] [Thread-4 (]: Writing runtime sql for node "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_category_fraud_rate__100__0.60b2512acf"
[0m14:11:41.929519 [debug] [Thread-3 (]: Writing runtime sql for node "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_large_txn_share__1__0.d93f9f3127"
[0m14:11:41.930043 [debug] [Thread-1 (]: Began executing node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_state_fraud_rate__100__0.ad1018ee37
[0m14:11:41.930554 [debug] [Thread-2 (]: Using duckdb connection "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_fraud_rate__1__0.59ce56cc94"
[0m14:11:41.930832 [debug] [Thread-4 (]: Using duckdb connection "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_category_fraud_rate__100__0.60b2512acf"
[0m14:11:41.932652 [debug] [Thread-1 (]: Writing runtime sql for node "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_state_fraud_rate__100__0.ad1018ee37"
[0m14:11:41.934256 [debug] [Thread-2 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_fraud_rate__1__0.59ce56cc94: BEGIN
[0m14:11:41.934690 [debug] [Thread-4 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_category_fraud_rate__100__0.60b2512acf: BEGIN
[0m14:11:41.934947 [debug] [Thread-3 (]: Using duckdb connection "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_large_txn_share__1__0.d93f9f3127"
[0m14:11:41.935296 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:11:41.937292 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:11:41.937937 [debug] [Thread-1 (]: Using duckdb connection "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_state_fraud_rate__100__0.ad1018ee37"
[0m14:11:41.938913 [debug] [Thread-3 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_large_txn_share__1__0.d93f9f3127: BEGIN
[0m14:11:41.939700 [debug] [Thread-1 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_state_fraud_rate__100__0.ad1018ee37: BEGIN
[0m14:11:41.940241 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:11:41.940506 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:41.947887 [debug] [Thread-2 (]: SQL status: OK in 0.013 seconds
[0m14:11:41.948302 [debug] [Thread-4 (]: SQL status: OK in 0.012 seconds
[0m14:11:41.948639 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m14:11:41.948882 [debug] [Thread-2 (]: Using duckdb connection "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_fraud_rate__1__0.59ce56cc94"
[0m14:11:41.949138 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m14:11:41.949373 [debug] [Thread-4 (]: Using duckdb connection "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_category_fraud_rate__100__0.60b2512acf"
[0m14:11:41.949659 [debug] [Thread-3 (]: Using duckdb connection "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_large_txn_share__1__0.d93f9f3127"
[0m14:11:41.950024 [debug] [Thread-2 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_fraud_rate__1__0.59ce56cc94: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_fraud_rate__1__0.59ce56cc94"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and fraud_rate >= 0 and fraud_rate <= 1
)
 as expression


    from transactions.main_marts.mart_daily_state_metrics
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m14:11:41.950661 [debug] [Thread-1 (]: Using duckdb connection "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_state_fraud_rate__100__0.ad1018ee37"
[0m14:11:41.951207 [debug] [Thread-4 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_category_fraud_rate__100__0.60b2512acf: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_category_fraud_rate__100__0.60b2512acf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and fraud_rate >= 0 and fraud_rate <= 100
)
 as expression


    from transactions.main_marts.mart_fraud_by_category
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m14:11:41.951509 [debug] [Thread-3 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_large_txn_share__1__0.d93f9f3127: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_large_txn_share__1__0.d93f9f3127"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and large_txn_share >= 0 and large_txn_share <= 1
)
 as expression


    from transactions.main_marts.mart_daily_state_metrics
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m14:11:41.952081 [debug] [Thread-1 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_state_fraud_rate__100__0.ad1018ee37: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_state_fraud_rate__100__0.ad1018ee37"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and fraud_rate >= 0 and fraud_rate <= 100
)
 as expression


    from transactions.main_marts.mart_fraud_by_state
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m14:11:41.952623 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:11:41.953017 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:11:41.953220 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:11:41.953611 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:11:41.954597 [debug] [Thread-2 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_fraud_rate__1__0.59ce56cc94: ROLLBACK
[0m14:11:41.955629 [debug] [Thread-4 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_category_fraud_rate__100__0.60b2512acf: ROLLBACK
[0m14:11:41.956592 [debug] [Thread-1 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_state_fraud_rate__100__0.ad1018ee37: ROLLBACK
[0m14:11:41.957369 [debug] [Thread-3 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_large_txn_share__1__0.d93f9f3127: ROLLBACK
[0m14:11:41.957846 [debug] [Thread-2 (]: Failed to rollback 'test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_fraud_rate__1__0.59ce56cc94'
[0m14:11:41.958230 [debug] [Thread-4 (]: Failed to rollback 'test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_category_fraud_rate__100__0.60b2512acf'
[0m14:11:41.958714 [debug] [Thread-1 (]: Failed to rollback 'test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_state_fraud_rate__100__0.ad1018ee37'
[0m14:11:41.959002 [debug] [Thread-3 (]: Failed to rollback 'test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_large_txn_share__1__0.d93f9f3127'
[0m14:11:41.959199 [debug] [Thread-2 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_fraud_rate__1__0.59ce56cc94: Close
[0m14:11:41.959527 [debug] [Thread-4 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_category_fraud_rate__100__0.60b2512acf: Close
[0m14:11:41.959779 [debug] [Thread-1 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_state_fraud_rate__100__0.ad1018ee37: Close
[0m14:11:41.959963 [debug] [Thread-3 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_large_txn_share__1__0.d93f9f3127: Close
[0m14:11:41.960309 [info ] [Thread-2 (]: 9 of 56 PASS dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_fraud_rate__1__0  [[32mPASS[0m in 0.05s]
[0m14:11:41.960596 [info ] [Thread-4 (]: 11 of 56 PASS dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_category_fraud_rate__100__0  [[32mPASS[0m in 0.05s]
[0m14:11:41.961183 [info ] [Thread-3 (]: 10 of 56 PASS dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_large_txn_share__1__0  [[32mPASS[0m in 0.06s]
[0m14:11:41.961565 [debug] [Thread-2 (]: Finished running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_fraud_rate__1__0.59ce56cc94
[0m14:11:41.961988 [debug] [Thread-4 (]: Finished running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_category_fraud_rate__100__0.60b2512acf
[0m14:11:41.962636 [debug] [Thread-3 (]: Finished running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_large_txn_share__1__0.d93f9f3127
[0m14:11:41.963230 [info ] [Thread-1 (]: 12 of 56 PASS dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_state_fraud_rate__100__0  [[32mPASS[0m in 0.05s]
[0m14:11:41.964098 [debug] [Thread-2 (]: Began running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_hourly_fraud_pattern_fraud_rate__100__0.870771d265
[0m14:11:41.964407 [debug] [Thread-4 (]: Began running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_merchant_analytics_fraud_rate__100__0.8aedb505c1
[0m14:11:41.964725 [debug] [Thread-3 (]: Began running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_stg_transactions_amount__0__True.047010278b
[0m14:11:41.965146 [debug] [Thread-1 (]: Finished running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_state_fraud_rate__100__0.ad1018ee37
[0m14:11:41.965562 [info ] [Thread-2 (]: 13 of 56 START test dbt_expectations_expect_column_values_to_be_between_mart_hourly_fraud_pattern_fraud_rate__100__0  [RUN]
[0m14:11:41.966067 [info ] [Thread-4 (]: 14 of 56 START test dbt_expectations_expect_column_values_to_be_between_mart_merchant_analytics_fraud_rate__100__0  [RUN]
[0m14:11:41.966596 [info ] [Thread-3 (]: 15 of 56 START test dbt_expectations_expect_column_values_to_be_between_stg_transactions_amount__0__True  [RUN]
[0m14:11:41.967153 [debug] [Thread-1 (]: Began running node test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_daily_state_metrics_transaction_date__us_state.36d7185b4c
[0m14:11:41.967668 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_fraud_rate__1__0.59ce56cc94, now test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_hourly_fraud_pattern_fraud_rate__100__0.870771d265)
[0m14:11:41.967957 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_category_fraud_rate__100__0.60b2512acf, now test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_merchant_analytics_fraud_rate__100__0.8aedb505c1)
[0m14:11:41.968235 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_large_txn_share__1__0.d93f9f3127, now test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_stg_transactions_amount__0__True.047010278b)
[0m14:11:41.968474 [info ] [Thread-1 (]: 16 of 56 START test dbt_utils_unique_combination_of_columns_mart_daily_state_metrics_transaction_date__us_state  [RUN]
[0m14:11:41.968828 [debug] [Thread-2 (]: Began compiling node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_hourly_fraud_pattern_fraud_rate__100__0.870771d265
[0m14:11:41.969087 [debug] [Thread-4 (]: Began compiling node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_merchant_analytics_fraud_rate__100__0.8aedb505c1
[0m14:11:41.969600 [debug] [Thread-3 (]: Began compiling node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_stg_transactions_amount__0__True.047010278b
[0m14:11:41.969943 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_state_fraud_rate__100__0.ad1018ee37, now test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_daily_state_metrics_transaction_date__us_state.36d7185b4c)
[0m14:11:41.973719 [debug] [Thread-2 (]: Writing injected SQL for node "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_hourly_fraud_pattern_fraud_rate__100__0.870771d265"
[0m14:11:41.976366 [debug] [Thread-4 (]: Writing injected SQL for node "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_merchant_analytics_fraud_rate__100__0.8aedb505c1"
[0m14:11:41.980158 [debug] [Thread-3 (]: Writing injected SQL for node "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_stg_transactions_amount__0__True.047010278b"
[0m14:11:41.980533 [debug] [Thread-1 (]: Began compiling node test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_daily_state_metrics_transaction_date__us_state.36d7185b4c
[0m14:11:41.989917 [debug] [Thread-1 (]: Writing injected SQL for node "test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_daily_state_metrics_transaction_date__us_state.36d7185b4c"
[0m14:11:41.990373 [debug] [Thread-2 (]: Began executing node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_hourly_fraud_pattern_fraud_rate__100__0.870771d265
[0m14:11:41.990709 [debug] [Thread-3 (]: Began executing node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_stg_transactions_amount__0__True.047010278b
[0m14:11:41.990949 [debug] [Thread-4 (]: Began executing node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_merchant_analytics_fraud_rate__100__0.8aedb505c1
[0m14:11:41.995396 [debug] [Thread-2 (]: Writing runtime sql for node "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_hourly_fraud_pattern_fraud_rate__100__0.870771d265"
[0m14:11:41.997059 [debug] [Thread-3 (]: Writing runtime sql for node "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_stg_transactions_amount__0__True.047010278b"
[0m14:11:41.998953 [debug] [Thread-4 (]: Writing runtime sql for node "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_merchant_analytics_fraud_rate__100__0.8aedb505c1"
[0m14:11:41.999237 [debug] [Thread-1 (]: Began executing node test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_daily_state_metrics_transaction_date__us_state.36d7185b4c
[0m14:11:42.001880 [debug] [Thread-2 (]: Using duckdb connection "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_hourly_fraud_pattern_fraud_rate__100__0.870771d265"
[0m14:11:42.002416 [debug] [Thread-3 (]: Using duckdb connection "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_stg_transactions_amount__0__True.047010278b"
[0m14:11:42.005385 [debug] [Thread-1 (]: Writing runtime sql for node "test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_daily_state_metrics_transaction_date__us_state.36d7185b4c"
[0m14:11:42.007885 [debug] [Thread-4 (]: Using duckdb connection "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_merchant_analytics_fraud_rate__100__0.8aedb505c1"
[0m14:11:42.008184 [debug] [Thread-2 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_hourly_fraud_pattern_fraud_rate__100__0.870771d265: BEGIN
[0m14:11:42.012814 [debug] [Thread-3 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_stg_transactions_amount__0__True.047010278b: BEGIN
[0m14:11:42.014175 [debug] [Thread-4 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_merchant_analytics_fraud_rate__100__0.8aedb505c1: BEGIN
[0m14:11:42.014641 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:11:42.014879 [debug] [Thread-1 (]: Using duckdb connection "test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_daily_state_metrics_transaction_date__us_state.36d7185b4c"
[0m14:11:42.015084 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:11:42.015413 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:11:42.015848 [debug] [Thread-1 (]: On test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_daily_state_metrics_transaction_date__us_state.36d7185b4c: BEGIN
[0m14:11:42.017024 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:42.024418 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m14:11:42.024727 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m14:11:42.024926 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m14:11:42.025134 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m14:11:42.025354 [debug] [Thread-2 (]: Using duckdb connection "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_hourly_fraud_pattern_fraud_rate__100__0.870771d265"
[0m14:11:42.025589 [debug] [Thread-4 (]: Using duckdb connection "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_merchant_analytics_fraud_rate__100__0.8aedb505c1"
[0m14:11:42.025841 [debug] [Thread-3 (]: Using duckdb connection "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_stg_transactions_amount__0__True.047010278b"
[0m14:11:42.026127 [debug] [Thread-1 (]: Using duckdb connection "test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_daily_state_metrics_transaction_date__us_state.36d7185b4c"
[0m14:11:42.026431 [debug] [Thread-2 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_hourly_fraud_pattern_fraud_rate__100__0.870771d265: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_hourly_fraud_pattern_fraud_rate__100__0.870771d265"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and fraud_rate >= 0 and fraud_rate <= 100
)
 as expression


    from transactions.main_marts.mart_hourly_fraud_pattern
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m14:11:42.026773 [debug] [Thread-4 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_merchant_analytics_fraud_rate__100__0.8aedb505c1: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_merchant_analytics_fraud_rate__100__0.8aedb505c1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and fraud_rate >= 0 and fraud_rate <= 100
)
 as expression


    from transactions.main_marts.mart_merchant_analytics
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m14:11:42.027055 [debug] [Thread-3 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_stg_transactions_amount__0__True.047010278b: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_stg_transactions_amount__0__True.047010278b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and amount > 0
)
 as expression


    from transactions.main_staging.stg_transactions
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m14:11:42.027299 [debug] [Thread-1 (]: On test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_daily_state_metrics_transaction_date__us_state.36d7185b4c: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_daily_state_metrics_transaction_date__us_state.36d7185b4c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        transaction_date, us_state
    from transactions.main_marts.mart_daily_state_metrics
    group by transaction_date, us_state
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m14:11:42.028221 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:11:42.028511 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:11:42.029964 [debug] [Thread-2 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_hourly_fraud_pattern_fraud_rate__100__0.870771d265: ROLLBACK
[0m14:11:42.030299 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:11:42.030808 [debug] [Thread-2 (]: Failed to rollback 'test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_hourly_fraud_pattern_fraud_rate__100__0.870771d265'
[0m14:11:42.031537 [debug] [Thread-4 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_merchant_analytics_fraud_rate__100__0.8aedb505c1: ROLLBACK
[0m14:11:42.031788 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m14:11:42.032632 [debug] [Thread-1 (]: On test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_daily_state_metrics_transaction_date__us_state.36d7185b4c: ROLLBACK
[0m14:11:42.032885 [debug] [Thread-2 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_hourly_fraud_pattern_fraud_rate__100__0.870771d265: Close
[0m14:11:42.033317 [debug] [Thread-4 (]: Failed to rollback 'test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_merchant_analytics_fraud_rate__100__0.8aedb505c1'
[0m14:11:42.034284 [debug] [Thread-3 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_stg_transactions_amount__0__True.047010278b: ROLLBACK
[0m14:11:42.034587 [debug] [Thread-1 (]: Failed to rollback 'test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_daily_state_metrics_transaction_date__us_state.36d7185b4c'
[0m14:11:42.034952 [info ] [Thread-2 (]: 13 of 56 PASS dbt_expectations_expect_column_values_to_be_between_mart_hourly_fraud_pattern_fraud_rate__100__0  [[32mPASS[0m in 0.07s]
[0m14:11:42.035177 [debug] [Thread-4 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_merchant_analytics_fraud_rate__100__0.8aedb505c1: Close
[0m14:11:42.035415 [debug] [Thread-3 (]: Failed to rollback 'test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_stg_transactions_amount__0__True.047010278b'
[0m14:11:42.035599 [debug] [Thread-1 (]: On test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_daily_state_metrics_transaction_date__us_state.36d7185b4c: Close
[0m14:11:42.035867 [debug] [Thread-2 (]: Finished running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_hourly_fraud_pattern_fraud_rate__100__0.870771d265
[0m14:11:42.036162 [info ] [Thread-4 (]: 14 of 56 PASS dbt_expectations_expect_column_values_to_be_between_mart_merchant_analytics_fraud_rate__100__0  [[32mPASS[0m in 0.07s]
[0m14:11:42.036508 [debug] [Thread-3 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_stg_transactions_amount__0__True.047010278b: Close
[0m14:11:42.037032 [info ] [Thread-1 (]: 16 of 56 PASS dbt_utils_unique_combination_of_columns_mart_daily_state_metrics_transaction_date__us_state  [[32mPASS[0m in 0.07s]
[0m14:11:42.037574 [debug] [Thread-2 (]: Began running node test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_hourly_fraud_pattern_day_name__hour_of_day.f8d797f239
[0m14:11:42.038073 [debug] [Thread-4 (]: Finished running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_merchant_analytics_fraud_rate__100__0.8aedb505c1
[0m14:11:42.038519 [debug] [Thread-1 (]: Finished running node test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_daily_state_metrics_transaction_date__us_state.36d7185b4c
[0m14:11:42.038863 [info ] [Thread-2 (]: 17 of 56 START test dbt_utils_unique_combination_of_columns_mart_hourly_fraud_pattern_day_name__hour_of_day  [RUN]
[0m14:11:42.039217 [debug] [Thread-4 (]: Began running node test.hw4_dbt.dbt_utils_unique_combination_of_columns_stg_transactions_transaction_id.9f8e8cbeb8
[0m14:11:42.039823 [info ] [Thread-3 (]: 15 of 56 PASS dbt_expectations_expect_column_values_to_be_between_stg_transactions_amount__0__True  [[32mPASS[0m in 0.07s]
[0m14:11:42.040103 [debug] [Thread-1 (]: Began running node test.hw4_dbt.not_null_mart_customer_risk_profile_customer_id.c066ff7487
[0m14:11:42.040515 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_hourly_fraud_pattern_fraud_rate__100__0.870771d265, now test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_hourly_fraud_pattern_day_name__hour_of_day.f8d797f239)
[0m14:11:42.040762 [info ] [Thread-4 (]: 18 of 56 START test dbt_utils_unique_combination_of_columns_stg_transactions_transaction_id  [RUN]
[0m14:11:42.041065 [debug] [Thread-3 (]: Finished running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_stg_transactions_amount__0__True.047010278b
[0m14:11:42.041446 [info ] [Thread-1 (]: 19 of 56 START test not_null_mart_customer_risk_profile_customer_id ............ [RUN]
[0m14:11:42.041961 [debug] [Thread-2 (]: Began compiling node test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_hourly_fraud_pattern_day_name__hour_of_day.f8d797f239
[0m14:11:42.042640 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_merchant_analytics_fraud_rate__100__0.8aedb505c1, now test.hw4_dbt.dbt_utils_unique_combination_of_columns_stg_transactions_transaction_id.9f8e8cbeb8)
[0m14:11:42.042937 [debug] [Thread-3 (]: Began running node test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_count.44f9f89c45
[0m14:11:42.043401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_daily_state_metrics_transaction_date__us_state.36d7185b4c, now test.hw4_dbt.not_null_mart_customer_risk_profile_customer_id.c066ff7487)
[0m14:11:42.047161 [debug] [Thread-2 (]: Writing injected SQL for node "test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_hourly_fraud_pattern_day_name__hour_of_day.f8d797f239"
[0m14:11:42.047554 [debug] [Thread-4 (]: Began compiling node test.hw4_dbt.dbt_utils_unique_combination_of_columns_stg_transactions_transaction_id.9f8e8cbeb8
[0m14:11:42.047910 [info ] [Thread-3 (]: 20 of 56 START test not_null_mart_daily_state_metrics_transaction_count ........ [RUN]
[0m14:11:42.048201 [debug] [Thread-1 (]: Began compiling node test.hw4_dbt.not_null_mart_customer_risk_profile_customer_id.c066ff7487
[0m14:11:42.051538 [debug] [Thread-4 (]: Writing injected SQL for node "test.hw4_dbt.dbt_utils_unique_combination_of_columns_stg_transactions_transaction_id.9f8e8cbeb8"
[0m14:11:42.051938 [debug] [Thread-2 (]: Began executing node test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_hourly_fraud_pattern_day_name__hour_of_day.f8d797f239
[0m14:11:42.052392 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_stg_transactions_amount__0__True.047010278b, now test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_count.44f9f89c45)
[0m14:11:42.057328 [debug] [Thread-1 (]: Writing injected SQL for node "test.hw4_dbt.not_null_mart_customer_risk_profile_customer_id.c066ff7487"
[0m14:11:42.059275 [debug] [Thread-2 (]: Writing runtime sql for node "test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_hourly_fraud_pattern_day_name__hour_of_day.f8d797f239"
[0m14:11:42.059626 [debug] [Thread-3 (]: Began compiling node test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_count.44f9f89c45
[0m14:11:42.059936 [debug] [Thread-4 (]: Began executing node test.hw4_dbt.dbt_utils_unique_combination_of_columns_stg_transactions_transaction_id.9f8e8cbeb8
[0m14:11:42.064505 [debug] [Thread-3 (]: Writing injected SQL for node "test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_count.44f9f89c45"
[0m14:11:42.066395 [debug] [Thread-4 (]: Writing runtime sql for node "test.hw4_dbt.dbt_utils_unique_combination_of_columns_stg_transactions_transaction_id.9f8e8cbeb8"
[0m14:11:42.066716 [debug] [Thread-2 (]: Using duckdb connection "test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_hourly_fraud_pattern_day_name__hour_of_day.f8d797f239"
[0m14:11:42.066972 [debug] [Thread-1 (]: Began executing node test.hw4_dbt.not_null_mart_customer_risk_profile_customer_id.c066ff7487
[0m14:11:42.067338 [debug] [Thread-2 (]: On test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_hourly_fraud_pattern_day_name__hour_of_day.f8d797f239: BEGIN
[0m14:11:42.069618 [debug] [Thread-1 (]: Writing runtime sql for node "test.hw4_dbt.not_null_mart_customer_risk_profile_customer_id.c066ff7487"
[0m14:11:42.069947 [debug] [Thread-4 (]: Using duckdb connection "test.hw4_dbt.dbt_utils_unique_combination_of_columns_stg_transactions_transaction_id.9f8e8cbeb8"
[0m14:11:42.070200 [debug] [Thread-3 (]: Began executing node test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_count.44f9f89c45
[0m14:11:42.070463 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:11:42.070756 [debug] [Thread-4 (]: On test.hw4_dbt.dbt_utils_unique_combination_of_columns_stg_transactions_transaction_id.9f8e8cbeb8: BEGIN
[0m14:11:42.072409 [debug] [Thread-3 (]: Writing runtime sql for node "test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_count.44f9f89c45"
[0m14:11:42.072853 [debug] [Thread-1 (]: Using duckdb connection "test.hw4_dbt.not_null_mart_customer_risk_profile_customer_id.c066ff7487"
[0m14:11:42.073098 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:11:42.073514 [debug] [Thread-1 (]: On test.hw4_dbt.not_null_mart_customer_risk_profile_customer_id.c066ff7487: BEGIN
[0m14:11:42.073909 [debug] [Thread-3 (]: Using duckdb connection "test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_count.44f9f89c45"
[0m14:11:42.074123 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:42.074383 [debug] [Thread-3 (]: On test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_count.44f9f89c45: BEGIN
[0m14:11:42.074658 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:11:42.081651 [debug] [Thread-2 (]: SQL status: OK in 0.011 seconds
[0m14:11:42.081939 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m14:11:42.082156 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m14:11:42.082340 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m14:11:42.082625 [debug] [Thread-2 (]: Using duckdb connection "test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_hourly_fraud_pattern_day_name__hour_of_day.f8d797f239"
[0m14:11:42.082964 [debug] [Thread-1 (]: Using duckdb connection "test.hw4_dbt.not_null_mart_customer_risk_profile_customer_id.c066ff7487"
[0m14:11:42.083226 [debug] [Thread-4 (]: Using duckdb connection "test.hw4_dbt.dbt_utils_unique_combination_of_columns_stg_transactions_transaction_id.9f8e8cbeb8"
[0m14:11:42.083499 [debug] [Thread-3 (]: Using duckdb connection "test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_count.44f9f89c45"
[0m14:11:42.083743 [debug] [Thread-2 (]: On test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_hourly_fraud_pattern_day_name__hour_of_day.f8d797f239: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_hourly_fraud_pattern_day_name__hour_of_day.f8d797f239"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        day_name, hour_of_day
    from transactions.main_marts.mart_hourly_fraud_pattern
    group by day_name, hour_of_day
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m14:11:42.083989 [debug] [Thread-1 (]: On test.hw4_dbt.not_null_mart_customer_risk_profile_customer_id.c066ff7487: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.not_null_mart_customer_risk_profile_customer_id.c066ff7487"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from transactions.main_marts.mart_customer_risk_profile
where customer_id is null



      
    ) dbt_internal_test
[0m14:11:42.084255 [debug] [Thread-4 (]: On test.hw4_dbt.dbt_utils_unique_combination_of_columns_stg_transactions_transaction_id.9f8e8cbeb8: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.dbt_utils_unique_combination_of_columns_stg_transactions_transaction_id.9f8e8cbeb8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        transaction_id
    from transactions.main_staging.stg_transactions
    group by transaction_id
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m14:11:42.084566 [debug] [Thread-3 (]: On test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_count.44f9f89c45: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_count.44f9f89c45"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_count
from transactions.main_marts.mart_daily_state_metrics
where transaction_count is null



      
    ) dbt_internal_test
[0m14:11:42.085642 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m14:11:42.085914 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:11:42.086170 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:11:42.086977 [debug] [Thread-3 (]: On test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_count.44f9f89c45: ROLLBACK
[0m14:11:42.089157 [debug] [Thread-1 (]: On test.hw4_dbt.not_null_mart_customer_risk_profile_customer_id.c066ff7487: ROLLBACK
[0m14:11:42.091806 [debug] [Thread-1 (]: Failed to rollback 'test.hw4_dbt.not_null_mart_customer_risk_profile_customer_id.c066ff7487'
[0m14:11:42.089991 [debug] [Thread-2 (]: On test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_hourly_fraud_pattern_day_name__hour_of_day.f8d797f239: ROLLBACK
[0m14:11:42.092452 [debug] [Thread-1 (]: On test.hw4_dbt.not_null_mart_customer_risk_profile_customer_id.c066ff7487: Close
[0m14:11:42.095814 [info ] [Thread-1 (]: 19 of 56 PASS not_null_mart_customer_risk_profile_customer_id .................. [[32mPASS[0m in 0.05s]
[0m14:11:42.096403 [debug] [Thread-1 (]: Finished running node test.hw4_dbt.not_null_mart_customer_risk_profile_customer_id.c066ff7487
[0m14:11:42.096831 [debug] [Thread-1 (]: Began running node test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_date.27b2c6ebe0
[0m14:11:42.097061 [info ] [Thread-1 (]: 21 of 56 START test not_null_mart_daily_state_metrics_transaction_date ......... [RUN]
[0m14:11:42.097311 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_mart_customer_risk_profile_customer_id.c066ff7487, now test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_date.27b2c6ebe0)
[0m14:11:42.097736 [debug] [Thread-2 (]: Failed to rollback 'test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_hourly_fraud_pattern_day_name__hour_of_day.f8d797f239'
[0m14:11:42.099085 [debug] [Thread-2 (]: On test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_hourly_fraud_pattern_day_name__hour_of_day.f8d797f239: Close
[0m14:11:42.099461 [info ] [Thread-2 (]: 17 of 56 PASS dbt_utils_unique_combination_of_columns_mart_hourly_fraud_pattern_day_name__hour_of_day  [[32mPASS[0m in 0.06s]
[0m14:11:42.099901 [debug] [Thread-2 (]: Finished running node test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_hourly_fraud_pattern_day_name__hour_of_day.f8d797f239
[0m14:11:42.090676 [debug] [Thread-3 (]: Failed to rollback 'test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_count.44f9f89c45'
[0m14:11:42.102335 [debug] [Thread-3 (]: On test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_count.44f9f89c45: Close
[0m14:11:42.101560 [debug] [Thread-2 (]: Began running node test.hw4_dbt.not_null_mart_daily_state_metrics_us_state.e9c98cd892
[0m14:11:42.107188 [info ] [Thread-2 (]: 22 of 56 START test not_null_mart_daily_state_metrics_us_state ................. [RUN]
[0m14:11:42.107463 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_hourly_fraud_pattern_day_name__hour_of_day.f8d797f239, now test.hw4_dbt.not_null_mart_daily_state_metrics_us_state.e9c98cd892)
[0m14:11:42.107666 [debug] [Thread-2 (]: Began compiling node test.hw4_dbt.not_null_mart_daily_state_metrics_us_state.e9c98cd892
[0m14:11:42.106658 [info ] [Thread-3 (]: 20 of 56 PASS not_null_mart_daily_state_metrics_transaction_count .............. [[32mPASS[0m in 0.05s]
[0m14:11:42.118338 [debug] [Thread-3 (]: Finished running node test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_count.44f9f89c45
[0m14:11:42.119147 [debug] [Thread-3 (]: Began running node test.hw4_dbt.not_null_mart_fraud_by_category_cat_id.1d7340ccc5
[0m14:11:42.112313 [debug] [Thread-2 (]: Writing injected SQL for node "test.hw4_dbt.not_null_mart_daily_state_metrics_us_state.e9c98cd892"
[0m14:11:42.098292 [debug] [Thread-1 (]: Began compiling node test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_date.27b2c6ebe0
[0m14:11:42.121331 [debug] [Thread-2 (]: Began executing node test.hw4_dbt.not_null_mart_daily_state_metrics_us_state.e9c98cd892
[0m14:11:42.119780 [info ] [Thread-3 (]: 23 of 56 START test not_null_mart_fraud_by_category_cat_id ..................... [RUN]
[0m14:11:42.126293 [debug] [Thread-1 (]: Writing injected SQL for node "test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_date.27b2c6ebe0"
[0m14:11:42.129424 [debug] [Thread-2 (]: Writing runtime sql for node "test.hw4_dbt.not_null_mart_daily_state_metrics_us_state.e9c98cd892"
[0m14:11:42.132052 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_count.44f9f89c45, now test.hw4_dbt.not_null_mart_fraud_by_category_cat_id.1d7340ccc5)
[0m14:11:42.133726 [debug] [Thread-1 (]: Began executing node test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_date.27b2c6ebe0
[0m14:11:42.134898 [debug] [Thread-3 (]: Began compiling node test.hw4_dbt.not_null_mart_fraud_by_category_cat_id.1d7340ccc5
[0m14:11:42.135358 [debug] [Thread-2 (]: Using duckdb connection "test.hw4_dbt.not_null_mart_daily_state_metrics_us_state.e9c98cd892"
[0m14:11:42.146714 [debug] [Thread-2 (]: On test.hw4_dbt.not_null_mart_daily_state_metrics_us_state.e9c98cd892: BEGIN
[0m14:11:42.146280 [debug] [Thread-3 (]: Writing injected SQL for node "test.hw4_dbt.not_null_mart_fraud_by_category_cat_id.1d7340ccc5"
[0m14:11:42.146906 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:11:42.141512 [debug] [Thread-1 (]: Writing runtime sql for node "test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_date.27b2c6ebe0"
[0m14:11:42.147475 [debug] [Thread-3 (]: Began executing node test.hw4_dbt.not_null_mart_fraud_by_category_cat_id.1d7340ccc5
[0m14:11:42.149987 [debug] [Thread-3 (]: Writing runtime sql for node "test.hw4_dbt.not_null_mart_fraud_by_category_cat_id.1d7340ccc5"
[0m14:11:42.151178 [debug] [Thread-1 (]: Using duckdb connection "test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_date.27b2c6ebe0"
[0m14:11:42.151675 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m14:11:42.152408 [debug] [Thread-1 (]: On test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_date.27b2c6ebe0: BEGIN
[0m14:11:42.153283 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:42.153819 [debug] [Thread-3 (]: Using duckdb connection "test.hw4_dbt.not_null_mart_fraud_by_category_cat_id.1d7340ccc5"
[0m14:11:42.152994 [debug] [Thread-2 (]: Using duckdb connection "test.hw4_dbt.not_null_mart_daily_state_metrics_us_state.e9c98cd892"
[0m14:11:42.154803 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:11:42.155624 [debug] [Thread-3 (]: On test.hw4_dbt.not_null_mart_fraud_by_category_cat_id.1d7340ccc5: BEGIN
[0m14:11:42.156886 [debug] [Thread-2 (]: On test.hw4_dbt.not_null_mart_daily_state_metrics_us_state.e9c98cd892: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.not_null_mart_daily_state_metrics_us_state.e9c98cd892"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select us_state
from transactions.main_marts.mart_daily_state_metrics
where us_state is null



      
    ) dbt_internal_test
[0m14:11:42.157476 [debug] [Thread-1 (]: Using duckdb connection "test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_date.27b2c6ebe0"
[0m14:11:42.158159 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:11:42.159909 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:11:42.160213 [debug] [Thread-1 (]: On test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_date.27b2c6ebe0: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_date.27b2c6ebe0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_date
from transactions.main_marts.mart_daily_state_metrics
where transaction_date is null



      
    ) dbt_internal_test
[0m14:11:42.161176 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m14:11:42.162420 [debug] [Thread-2 (]: On test.hw4_dbt.not_null_mart_daily_state_metrics_us_state.e9c98cd892: ROLLBACK
[0m14:11:42.163822 [debug] [Thread-3 (]: Using duckdb connection "test.hw4_dbt.not_null_mart_fraud_by_category_cat_id.1d7340ccc5"
[0m14:11:42.164337 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:11:42.165199 [debug] [Thread-2 (]: Failed to rollback 'test.hw4_dbt.not_null_mart_daily_state_metrics_us_state.e9c98cd892'
[0m14:11:42.165589 [debug] [Thread-3 (]: On test.hw4_dbt.not_null_mart_fraud_by_category_cat_id.1d7340ccc5: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.not_null_mart_fraud_by_category_cat_id.1d7340ccc5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select cat_id
from transactions.main_marts.mart_fraud_by_category
where cat_id is null



      
    ) dbt_internal_test
[0m14:11:42.166970 [debug] [Thread-1 (]: On test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_date.27b2c6ebe0: ROLLBACK
[0m14:11:42.167515 [debug] [Thread-2 (]: On test.hw4_dbt.not_null_mart_daily_state_metrics_us_state.e9c98cd892: Close
[0m14:11:42.168314 [debug] [Thread-1 (]: Failed to rollback 'test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_date.27b2c6ebe0'
[0m14:11:42.168926 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:11:42.169782 [info ] [Thread-2 (]: 22 of 56 PASS not_null_mart_daily_state_metrics_us_state ....................... [[32mPASS[0m in 0.06s]
[0m14:11:42.170294 [debug] [Thread-1 (]: On test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_date.27b2c6ebe0: Close
[0m14:11:42.172192 [debug] [Thread-3 (]: On test.hw4_dbt.not_null_mart_fraud_by_category_cat_id.1d7340ccc5: ROLLBACK
[0m14:11:42.172561 [debug] [Thread-2 (]: Finished running node test.hw4_dbt.not_null_mart_daily_state_metrics_us_state.e9c98cd892
[0m14:11:42.173496 [info ] [Thread-1 (]: 21 of 56 PASS not_null_mart_daily_state_metrics_transaction_date ............... [[32mPASS[0m in 0.08s]
[0m14:11:42.174175 [debug] [Thread-3 (]: Failed to rollback 'test.hw4_dbt.not_null_mart_fraud_by_category_cat_id.1d7340ccc5'
[0m14:11:42.174892 [debug] [Thread-2 (]: Began running node test.hw4_dbt.not_null_mart_fraud_by_state_unique_customers.afa2f0b8db
[0m14:11:42.175968 [debug] [Thread-1 (]: Finished running node test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_date.27b2c6ebe0
[0m14:11:42.176522 [debug] [Thread-3 (]: On test.hw4_dbt.not_null_mart_fraud_by_category_cat_id.1d7340ccc5: Close
[0m14:11:42.176831 [info ] [Thread-2 (]: 24 of 56 START test not_null_mart_fraud_by_state_unique_customers .............. [RUN]
[0m14:11:42.177144 [debug] [Thread-1 (]: Began running node test.hw4_dbt.not_null_mart_fraud_by_state_us_state.95ac4eba19
[0m14:11:42.177746 [info ] [Thread-3 (]: 23 of 56 PASS not_null_mart_fraud_by_category_cat_id ........................... [[32mPASS[0m in 0.05s]
[0m14:11:42.178033 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_mart_daily_state_metrics_us_state.e9c98cd892, now test.hw4_dbt.not_null_mart_fraud_by_state_unique_customers.afa2f0b8db)
[0m14:11:42.178302 [info ] [Thread-1 (]: 25 of 56 START test not_null_mart_fraud_by_state_us_state ...................... [RUN]
[0m14:11:42.178901 [debug] [Thread-3 (]: Finished running node test.hw4_dbt.not_null_mart_fraud_by_category_cat_id.1d7340ccc5
[0m14:11:42.179700 [debug] [Thread-2 (]: Began compiling node test.hw4_dbt.not_null_mart_fraud_by_state_unique_customers.afa2f0b8db
[0m14:11:42.180479 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_date.27b2c6ebe0, now test.hw4_dbt.not_null_mart_fraud_by_state_us_state.95ac4eba19)
[0m14:11:42.181108 [debug] [Thread-3 (]: Began running node test.hw4_dbt.not_null_mart_hourly_fraud_pattern_day_name.cc79fdc01d
[0m14:11:42.184077 [debug] [Thread-2 (]: Writing injected SQL for node "test.hw4_dbt.not_null_mart_fraud_by_state_unique_customers.afa2f0b8db"
[0m14:11:42.184637 [debug] [Thread-1 (]: Began compiling node test.hw4_dbt.not_null_mart_fraud_by_state_us_state.95ac4eba19
[0m14:11:42.184897 [info ] [Thread-3 (]: 26 of 56 START test not_null_mart_hourly_fraud_pattern_day_name ................ [RUN]
[0m14:11:42.188967 [debug] [Thread-1 (]: Writing injected SQL for node "test.hw4_dbt.not_null_mart_fraud_by_state_us_state.95ac4eba19"
[0m14:11:42.189440 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_mart_fraud_by_category_cat_id.1d7340ccc5, now test.hw4_dbt.not_null_mart_hourly_fraud_pattern_day_name.cc79fdc01d)
[0m14:11:42.189917 [debug] [Thread-2 (]: Began executing node test.hw4_dbt.not_null_mart_fraud_by_state_unique_customers.afa2f0b8db
[0m14:11:42.190290 [debug] [Thread-3 (]: Began compiling node test.hw4_dbt.not_null_mart_hourly_fraud_pattern_day_name.cc79fdc01d
[0m14:11:42.192054 [debug] [Thread-2 (]: Writing runtime sql for node "test.hw4_dbt.not_null_mart_fraud_by_state_unique_customers.afa2f0b8db"
[0m14:11:42.196102 [debug] [Thread-3 (]: Writing injected SQL for node "test.hw4_dbt.not_null_mart_hourly_fraud_pattern_day_name.cc79fdc01d"
[0m14:11:42.196508 [debug] [Thread-1 (]: Began executing node test.hw4_dbt.not_null_mart_fraud_by_state_us_state.95ac4eba19
[0m14:11:42.200826 [debug] [Thread-1 (]: Writing runtime sql for node "test.hw4_dbt.not_null_mart_fraud_by_state_us_state.95ac4eba19"
[0m14:11:42.201461 [debug] [Thread-1 (]: Using duckdb connection "test.hw4_dbt.not_null_mart_fraud_by_state_us_state.95ac4eba19"
[0m14:11:42.201665 [debug] [Thread-1 (]: On test.hw4_dbt.not_null_mart_fraud_by_state_us_state.95ac4eba19: BEGIN
[0m14:11:42.201831 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:42.202380 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:11:42.202784 [debug] [Thread-1 (]: Using duckdb connection "test.hw4_dbt.not_null_mart_fraud_by_state_us_state.95ac4eba19"
[0m14:11:42.203262 [debug] [Thread-1 (]: On test.hw4_dbt.not_null_mart_fraud_by_state_us_state.95ac4eba19: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.not_null_mart_fraud_by_state_us_state.95ac4eba19"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select us_state
from transactions.main_marts.mart_fraud_by_state
where us_state is null



      
    ) dbt_internal_test
[0m14:11:42.204163 [debug] [Thread-2 (]: Using duckdb connection "test.hw4_dbt.not_null_mart_fraud_by_state_unique_customers.afa2f0b8db"
[0m14:11:42.206782 [debug] [Thread-3 (]: Began executing node test.hw4_dbt.not_null_mart_hourly_fraud_pattern_day_name.cc79fdc01d
[0m14:11:42.207318 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:11:42.208530 [debug] [Thread-2 (]: On test.hw4_dbt.not_null_mart_fraud_by_state_unique_customers.afa2f0b8db: BEGIN
[0m14:11:42.211691 [debug] [Thread-3 (]: Writing runtime sql for node "test.hw4_dbt.not_null_mart_hourly_fraud_pattern_day_name.cc79fdc01d"
[0m14:11:42.212642 [debug] [Thread-1 (]: On test.hw4_dbt.not_null_mart_fraud_by_state_us_state.95ac4eba19: ROLLBACK
[0m14:11:42.213112 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:11:42.213674 [debug] [Thread-1 (]: Failed to rollback 'test.hw4_dbt.not_null_mart_fraud_by_state_us_state.95ac4eba19'
[0m14:11:42.214792 [debug] [Thread-3 (]: Using duckdb connection "test.hw4_dbt.not_null_mart_hourly_fraud_pattern_day_name.cc79fdc01d"
[0m14:11:42.215019 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m14:11:42.216282 [debug] [Thread-1 (]: On test.hw4_dbt.not_null_mart_fraud_by_state_us_state.95ac4eba19: Close
[0m14:11:42.217058 [debug] [Thread-3 (]: On test.hw4_dbt.not_null_mart_hourly_fraud_pattern_day_name.cc79fdc01d: BEGIN
[0m14:11:42.218527 [debug] [Thread-2 (]: Using duckdb connection "test.hw4_dbt.not_null_mart_fraud_by_state_unique_customers.afa2f0b8db"
[0m14:11:42.219500 [info ] [Thread-1 (]: 25 of 56 PASS not_null_mart_fraud_by_state_us_state ............................ [[32mPASS[0m in 0.04s]
[0m14:11:42.220375 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:11:42.221011 [debug] [Thread-2 (]: On test.hw4_dbt.not_null_mart_fraud_by_state_unique_customers.afa2f0b8db: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.not_null_mart_fraud_by_state_unique_customers.afa2f0b8db"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select unique_customers
from transactions.main_marts.mart_fraud_by_state
where unique_customers is null



      
    ) dbt_internal_test
[0m14:11:42.222322 [debug] [Thread-1 (]: Finished running node test.hw4_dbt.not_null_mart_fraud_by_state_us_state.95ac4eba19
[0m14:11:42.222969 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m14:11:42.223314 [debug] [Thread-1 (]: Began running node test.hw4_dbt.not_null_mart_hourly_fraud_pattern_hour_of_day.7bbb67dbe4
[0m14:11:42.223567 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:11:42.223764 [debug] [Thread-3 (]: Using duckdb connection "test.hw4_dbt.not_null_mart_hourly_fraud_pattern_day_name.cc79fdc01d"
[0m14:11:42.223997 [info ] [Thread-1 (]: 27 of 56 START test not_null_mart_hourly_fraud_pattern_hour_of_day ............. [RUN]
[0m14:11:42.225200 [debug] [Thread-2 (]: On test.hw4_dbt.not_null_mart_fraud_by_state_unique_customers.afa2f0b8db: ROLLBACK
[0m14:11:42.226316 [debug] [Thread-3 (]: On test.hw4_dbt.not_null_mart_hourly_fraud_pattern_day_name.cc79fdc01d: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.not_null_mart_hourly_fraud_pattern_day_name.cc79fdc01d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select day_name
from transactions.main_marts.mart_hourly_fraud_pattern
where day_name is null



      
    ) dbt_internal_test
[0m14:11:42.227081 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_mart_fraud_by_state_us_state.95ac4eba19, now test.hw4_dbt.not_null_mart_hourly_fraud_pattern_hour_of_day.7bbb67dbe4)
[0m14:11:42.227576 [debug] [Thread-2 (]: Failed to rollback 'test.hw4_dbt.not_null_mart_fraud_by_state_unique_customers.afa2f0b8db'
[0m14:11:42.229073 [debug] [Thread-1 (]: Began compiling node test.hw4_dbt.not_null_mart_hourly_fraud_pattern_hour_of_day.7bbb67dbe4
[0m14:11:42.229602 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:11:42.231214 [debug] [Thread-2 (]: On test.hw4_dbt.not_null_mart_fraud_by_state_unique_customers.afa2f0b8db: Close
[0m14:11:42.240619 [info ] [Thread-2 (]: 24 of 56 PASS not_null_mart_fraud_by_state_unique_customers .................... [[32mPASS[0m in 0.06s]
[0m14:11:42.235605 [debug] [Thread-1 (]: Writing injected SQL for node "test.hw4_dbt.not_null_mart_hourly_fraud_pattern_hour_of_day.7bbb67dbe4"
[0m14:11:42.241028 [debug] [Thread-2 (]: Finished running node test.hw4_dbt.not_null_mart_fraud_by_state_unique_customers.afa2f0b8db
[0m14:11:42.243557 [debug] [Thread-2 (]: Began running node test.hw4_dbt.not_null_mart_merchant_analytics_merchant_id.61b4b4d63c
[0m14:11:42.238725 [debug] [Thread-3 (]: On test.hw4_dbt.not_null_mart_hourly_fraud_pattern_day_name.cc79fdc01d: ROLLBACK
[0m14:11:42.244866 [debug] [Thread-1 (]: Began executing node test.hw4_dbt.not_null_mart_hourly_fraud_pattern_hour_of_day.7bbb67dbe4
[0m14:11:42.245519 [info ] [Thread-2 (]: 28 of 56 START test not_null_mart_merchant_analytics_merchant_id ............... [RUN]
[0m14:11:42.245897 [debug] [Thread-4 (]: SQL status: OK in 0.161 seconds
[0m14:11:42.246438 [debug] [Thread-3 (]: Failed to rollback 'test.hw4_dbt.not_null_mart_hourly_fraud_pattern_day_name.cc79fdc01d'
[0m14:11:42.248380 [debug] [Thread-1 (]: Writing runtime sql for node "test.hw4_dbt.not_null_mart_hourly_fraud_pattern_hour_of_day.7bbb67dbe4"
[0m14:11:42.248772 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_mart_fraud_by_state_unique_customers.afa2f0b8db, now test.hw4_dbt.not_null_mart_merchant_analytics_merchant_id.61b4b4d63c)
[0m14:11:42.249860 [debug] [Thread-4 (]: On test.hw4_dbt.dbt_utils_unique_combination_of_columns_stg_transactions_transaction_id.9f8e8cbeb8: ROLLBACK
[0m14:11:42.250097 [debug] [Thread-3 (]: On test.hw4_dbt.not_null_mart_hourly_fraud_pattern_day_name.cc79fdc01d: Close
[0m14:11:42.250907 [debug] [Thread-2 (]: Began compiling node test.hw4_dbt.not_null_mart_merchant_analytics_merchant_id.61b4b4d63c
[0m14:11:42.251325 [debug] [Thread-4 (]: Failed to rollback 'test.hw4_dbt.dbt_utils_unique_combination_of_columns_stg_transactions_transaction_id.9f8e8cbeb8'
[0m14:11:42.251660 [debug] [Thread-1 (]: Using duckdb connection "test.hw4_dbt.not_null_mart_hourly_fraud_pattern_hour_of_day.7bbb67dbe4"
[0m14:11:42.252053 [info ] [Thread-3 (]: 26 of 56 PASS not_null_mart_hourly_fraud_pattern_day_name ...................... [[32mPASS[0m in 0.06s]
[0m14:11:42.256200 [debug] [Thread-2 (]: Writing injected SQL for node "test.hw4_dbt.not_null_mart_merchant_analytics_merchant_id.61b4b4d63c"
[0m14:11:42.256524 [debug] [Thread-4 (]: On test.hw4_dbt.dbt_utils_unique_combination_of_columns_stg_transactions_transaction_id.9f8e8cbeb8: Close
[0m14:11:42.256747 [debug] [Thread-1 (]: On test.hw4_dbt.not_null_mart_hourly_fraud_pattern_hour_of_day.7bbb67dbe4: BEGIN
[0m14:11:42.257284 [debug] [Thread-3 (]: Finished running node test.hw4_dbt.not_null_mart_hourly_fraud_pattern_day_name.cc79fdc01d
[0m14:11:42.257731 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:42.258034 [debug] [Thread-3 (]: Began running node test.hw4_dbt.not_null_states_state_code.4c83882290
[0m14:11:42.258585 [debug] [Thread-2 (]: Began executing node test.hw4_dbt.not_null_mart_merchant_analytics_merchant_id.61b4b4d63c
[0m14:11:42.259197 [info ] [Thread-3 (]: 29 of 56 START test not_null_states_state_code ................................. [RUN]
[0m14:11:42.261714 [debug] [Thread-2 (]: Writing runtime sql for node "test.hw4_dbt.not_null_mart_merchant_analytics_merchant_id.61b4b4d63c"
[0m14:11:42.262068 [info ] [Thread-4 (]: 18 of 56 PASS dbt_utils_unique_combination_of_columns_stg_transactions_transaction_id  [[32mPASS[0m in 0.22s]
[0m14:11:42.262412 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_mart_hourly_fraud_pattern_day_name.cc79fdc01d, now test.hw4_dbt.not_null_states_state_code.4c83882290)
[0m14:11:42.263059 [debug] [Thread-4 (]: Finished running node test.hw4_dbt.dbt_utils_unique_combination_of_columns_stg_transactions_transaction_id.9f8e8cbeb8
[0m14:11:42.263962 [debug] [Thread-2 (]: Using duckdb connection "test.hw4_dbt.not_null_mart_merchant_analytics_merchant_id.61b4b4d63c"
[0m14:11:42.264334 [debug] [Thread-3 (]: Began compiling node test.hw4_dbt.not_null_states_state_code.4c83882290
[0m14:11:42.264598 [debug] [Thread-4 (]: Began running node test.hw4_dbt.not_null_states_state_name.f652068228
[0m14:11:42.264873 [debug] [Thread-2 (]: On test.hw4_dbt.not_null_mart_merchant_analytics_merchant_id.61b4b4d63c: BEGIN
[0m14:11:42.268105 [debug] [Thread-3 (]: Writing injected SQL for node "test.hw4_dbt.not_null_states_state_code.4c83882290"
[0m14:11:42.268893 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:11:42.268527 [info ] [Thread-4 (]: 30 of 56 START test not_null_states_state_name ................................. [RUN]
[0m14:11:42.269582 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.dbt_utils_unique_combination_of_columns_stg_transactions_transaction_id.9f8e8cbeb8, now test.hw4_dbt.not_null_states_state_name.f652068228)
[0m14:11:42.269827 [debug] [Thread-4 (]: Began compiling node test.hw4_dbt.not_null_states_state_name.f652068228
[0m14:11:42.274370 [debug] [Thread-4 (]: Writing injected SQL for node "test.hw4_dbt.not_null_states_state_name.f652068228"
[0m14:11:42.275135 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m14:11:42.275363 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m14:11:42.275693 [debug] [Thread-1 (]: Using duckdb connection "test.hw4_dbt.not_null_mart_hourly_fraud_pattern_hour_of_day.7bbb67dbe4"
[0m14:11:42.275950 [debug] [Thread-3 (]: Began executing node test.hw4_dbt.not_null_states_state_code.4c83882290
[0m14:11:42.276354 [debug] [Thread-2 (]: Using duckdb connection "test.hw4_dbt.not_null_mart_merchant_analytics_merchant_id.61b4b4d63c"
[0m14:11:42.276817 [debug] [Thread-1 (]: On test.hw4_dbt.not_null_mart_hourly_fraud_pattern_hour_of_day.7bbb67dbe4: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.not_null_mart_hourly_fraud_pattern_hour_of_day.7bbb67dbe4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select hour_of_day
from transactions.main_marts.mart_hourly_fraud_pattern
where hour_of_day is null



      
    ) dbt_internal_test
[0m14:11:42.277101 [debug] [Thread-4 (]: Began executing node test.hw4_dbt.not_null_states_state_name.f652068228
[0m14:11:42.278936 [debug] [Thread-3 (]: Writing runtime sql for node "test.hw4_dbt.not_null_states_state_code.4c83882290"
[0m14:11:42.279290 [debug] [Thread-2 (]: On test.hw4_dbt.not_null_mart_merchant_analytics_merchant_id.61b4b4d63c: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.not_null_mart_merchant_analytics_merchant_id.61b4b4d63c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select merchant_id
from transactions.main_marts.mart_merchant_analytics
where merchant_id is null



      
    ) dbt_internal_test
[0m14:11:42.283569 [debug] [Thread-4 (]: Writing runtime sql for node "test.hw4_dbt.not_null_states_state_name.f652068228"
[0m14:11:42.285837 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m14:11:42.286390 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m14:11:42.286785 [debug] [Thread-4 (]: Using duckdb connection "test.hw4_dbt.not_null_states_state_name.f652068228"
[0m14:11:42.289264 [debug] [Thread-1 (]: On test.hw4_dbt.not_null_mart_hourly_fraud_pattern_hour_of_day.7bbb67dbe4: ROLLBACK
[0m14:11:42.291361 [debug] [Thread-2 (]: On test.hw4_dbt.not_null_mart_merchant_analytics_merchant_id.61b4b4d63c: ROLLBACK
[0m14:11:42.292058 [debug] [Thread-3 (]: Using duckdb connection "test.hw4_dbt.not_null_states_state_code.4c83882290"
[0m14:11:42.292626 [debug] [Thread-4 (]: On test.hw4_dbt.not_null_states_state_name.f652068228: BEGIN
[0m14:11:42.293489 [debug] [Thread-1 (]: Failed to rollback 'test.hw4_dbt.not_null_mart_hourly_fraud_pattern_hour_of_day.7bbb67dbe4'
[0m14:11:42.293867 [debug] [Thread-2 (]: Failed to rollback 'test.hw4_dbt.not_null_mart_merchant_analytics_merchant_id.61b4b4d63c'
[0m14:11:42.294397 [debug] [Thread-3 (]: On test.hw4_dbt.not_null_states_state_code.4c83882290: BEGIN
[0m14:11:42.294638 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:11:42.294978 [debug] [Thread-1 (]: On test.hw4_dbt.not_null_mart_hourly_fraud_pattern_hour_of_day.7bbb67dbe4: Close
[0m14:11:42.295266 [debug] [Thread-2 (]: On test.hw4_dbt.not_null_mart_merchant_analytics_merchant_id.61b4b4d63c: Close
[0m14:11:42.295500 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:11:42.296244 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m14:11:42.296777 [info ] [Thread-1 (]: 27 of 56 PASS not_null_mart_hourly_fraud_pattern_hour_of_day ................... [[32mPASS[0m in 0.07s]
[0m14:11:42.297978 [info ] [Thread-2 (]: 28 of 56 PASS not_null_mart_merchant_analytics_merchant_id ..................... [[32mPASS[0m in 0.05s]
[0m14:11:42.298526 [debug] [Thread-4 (]: Using duckdb connection "test.hw4_dbt.not_null_states_state_name.f652068228"
[0m14:11:42.298817 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m14:11:42.299122 [debug] [Thread-1 (]: Finished running node test.hw4_dbt.not_null_mart_hourly_fraud_pattern_hour_of_day.7bbb67dbe4
[0m14:11:42.299671 [debug] [Thread-2 (]: Finished running node test.hw4_dbt.not_null_mart_merchant_analytics_merchant_id.61b4b4d63c
[0m14:11:42.299933 [debug] [Thread-4 (]: On test.hw4_dbt.not_null_states_state_name.f652068228: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.not_null_states_state_name.f652068228"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select state_name
from transactions.main_transactions_db.states
where state_name is null



      
    ) dbt_internal_test
[0m14:11:42.300601 [debug] [Thread-3 (]: Using duckdb connection "test.hw4_dbt.not_null_states_state_code.4c83882290"
[0m14:11:42.301075 [debug] [Thread-1 (]: Began running node test.hw4_dbt.not_null_stg_transactions_amount.3629b5421e
[0m14:11:42.301466 [debug] [Thread-2 (]: Began running node test.hw4_dbt.not_null_stg_transactions_amount_bucket.ddccfce050
[0m14:11:42.302531 [debug] [Thread-3 (]: On test.hw4_dbt.not_null_states_state_code.4c83882290: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.not_null_states_state_code.4c83882290"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select state_code
from transactions.main_transactions_db.states
where state_code is null



      
    ) dbt_internal_test
[0m14:11:42.302839 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:11:42.303189 [info ] [Thread-1 (]: 31 of 56 START test not_null_stg_transactions_amount ........................... [RUN]
[0m14:11:42.303496 [info ] [Thread-2 (]: 32 of 56 START test not_null_stg_transactions_amount_bucket .................... [RUN]
[0m14:11:42.306152 [debug] [Thread-4 (]: On test.hw4_dbt.not_null_states_state_name.f652068228: ROLLBACK
[0m14:11:42.306442 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:11:42.306771 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_mart_hourly_fraud_pattern_hour_of_day.7bbb67dbe4, now test.hw4_dbt.not_null_stg_transactions_amount.3629b5421e)
[0m14:11:42.307035 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_mart_merchant_analytics_merchant_id.61b4b4d63c, now test.hw4_dbt.not_null_stg_transactions_amount_bucket.ddccfce050)
[0m14:11:42.307345 [debug] [Thread-4 (]: Failed to rollback 'test.hw4_dbt.not_null_states_state_name.f652068228'
[0m14:11:42.308313 [debug] [Thread-3 (]: On test.hw4_dbt.not_null_states_state_code.4c83882290: ROLLBACK
[0m14:11:42.308543 [debug] [Thread-1 (]: Began compiling node test.hw4_dbt.not_null_stg_transactions_amount.3629b5421e
[0m14:11:42.308824 [debug] [Thread-2 (]: Began compiling node test.hw4_dbt.not_null_stg_transactions_amount_bucket.ddccfce050
[0m14:11:42.309046 [debug] [Thread-4 (]: On test.hw4_dbt.not_null_states_state_name.f652068228: Close
[0m14:11:42.309424 [debug] [Thread-3 (]: Failed to rollback 'test.hw4_dbt.not_null_states_state_code.4c83882290'
[0m14:11:42.311938 [debug] [Thread-1 (]: Writing injected SQL for node "test.hw4_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m14:11:42.316463 [debug] [Thread-2 (]: Writing injected SQL for node "test.hw4_dbt.not_null_stg_transactions_amount_bucket.ddccfce050"
[0m14:11:42.317243 [debug] [Thread-3 (]: On test.hw4_dbt.not_null_states_state_code.4c83882290: Close
[0m14:11:42.317032 [info ] [Thread-4 (]: 30 of 56 PASS not_null_states_state_name ....................................... [[32mPASS[0m in 0.05s]
[0m14:11:42.318002 [debug] [Thread-4 (]: Finished running node test.hw4_dbt.not_null_states_state_name.f652068228
[0m14:11:42.318547 [debug] [Thread-4 (]: Began running node test.hw4_dbt.not_null_stg_transactions_cat_id.81205306d9
[0m14:11:42.319217 [info ] [Thread-4 (]: 33 of 56 START test not_null_stg_transactions_cat_id ........................... [RUN]
[0m14:11:42.320066 [debug] [Thread-2 (]: Began executing node test.hw4_dbt.not_null_stg_transactions_amount_bucket.ddccfce050
[0m14:11:42.320447 [debug] [Thread-1 (]: Began executing node test.hw4_dbt.not_null_stg_transactions_amount.3629b5421e
[0m14:11:42.320836 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_states_state_name.f652068228, now test.hw4_dbt.not_null_stg_transactions_cat_id.81205306d9)
[0m14:11:42.321140 [info ] [Thread-3 (]: 29 of 56 PASS not_null_states_state_code ....................................... [[32mPASS[0m in 0.06s]
[0m14:11:42.323880 [debug] [Thread-2 (]: Writing runtime sql for node "test.hw4_dbt.not_null_stg_transactions_amount_bucket.ddccfce050"
[0m14:11:42.325554 [debug] [Thread-1 (]: Writing runtime sql for node "test.hw4_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m14:11:42.325842 [debug] [Thread-4 (]: Began compiling node test.hw4_dbt.not_null_stg_transactions_cat_id.81205306d9
[0m14:11:42.326405 [debug] [Thread-3 (]: Finished running node test.hw4_dbt.not_null_states_state_code.4c83882290
[0m14:11:42.329746 [debug] [Thread-4 (]: Writing injected SQL for node "test.hw4_dbt.not_null_stg_transactions_cat_id.81205306d9"
[0m14:11:42.330128 [debug] [Thread-1 (]: Using duckdb connection "test.hw4_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m14:11:42.330347 [debug] [Thread-2 (]: Using duckdb connection "test.hw4_dbt.not_null_stg_transactions_amount_bucket.ddccfce050"
[0m14:11:42.330705 [debug] [Thread-3 (]: Began running node test.hw4_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m14:11:42.331734 [debug] [Thread-1 (]: On test.hw4_dbt.not_null_stg_transactions_amount.3629b5421e: BEGIN
[0m14:11:42.332091 [debug] [Thread-2 (]: On test.hw4_dbt.not_null_stg_transactions_amount_bucket.ddccfce050: BEGIN
[0m14:11:42.332306 [debug] [Thread-4 (]: Began executing node test.hw4_dbt.not_null_stg_transactions_cat_id.81205306d9
[0m14:11:42.332606 [info ] [Thread-3 (]: 34 of 56 START test not_null_stg_transactions_customer_id ...................... [RUN]
[0m14:11:42.332942 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:42.333241 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:11:42.334962 [debug] [Thread-4 (]: Writing runtime sql for node "test.hw4_dbt.not_null_stg_transactions_cat_id.81205306d9"
[0m14:11:42.335520 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_states_state_code.4c83882290, now test.hw4_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf)
[0m14:11:42.336712 [debug] [Thread-3 (]: Began compiling node test.hw4_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m14:11:42.341380 [debug] [Thread-3 (]: Writing injected SQL for node "test.hw4_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m14:11:42.341843 [debug] [Thread-4 (]: Using duckdb connection "test.hw4_dbt.not_null_stg_transactions_cat_id.81205306d9"
[0m14:11:42.342110 [debug] [Thread-4 (]: On test.hw4_dbt.not_null_stg_transactions_cat_id.81205306d9: BEGIN
[0m14:11:42.342294 [debug] [Thread-3 (]: Began executing node test.hw4_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m14:11:42.342534 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:11:42.392583 [debug] [Thread-3 (]: Writing runtime sql for node "test.hw4_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m14:11:42.393194 [debug] [Thread-1 (]: SQL status: OK in 0.060 seconds
[0m14:11:42.393667 [debug] [Thread-2 (]: SQL status: OK in 0.060 seconds
[0m14:11:42.393969 [debug] [Thread-4 (]: SQL status: OK in 0.051 seconds
[0m14:11:42.394272 [debug] [Thread-1 (]: Using duckdb connection "test.hw4_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m14:11:42.394497 [debug] [Thread-2 (]: Using duckdb connection "test.hw4_dbt.not_null_stg_transactions_amount_bucket.ddccfce050"
[0m14:11:42.394717 [debug] [Thread-4 (]: Using duckdb connection "test.hw4_dbt.not_null_stg_transactions_cat_id.81205306d9"
[0m14:11:42.394975 [debug] [Thread-3 (]: Using duckdb connection "test.hw4_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m14:11:42.395298 [debug] [Thread-1 (]: On test.hw4_dbt.not_null_stg_transactions_amount.3629b5421e: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.not_null_stg_transactions_amount.3629b5421e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select amount
from transactions.main_staging.stg_transactions
where amount is null



      
    ) dbt_internal_test
[0m14:11:42.395594 [debug] [Thread-2 (]: On test.hw4_dbt.not_null_stg_transactions_amount_bucket.ddccfce050: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.not_null_stg_transactions_amount_bucket.ddccfce050"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select amount_bucket
from transactions.main_staging.stg_transactions
where amount_bucket is null



      
    ) dbt_internal_test
[0m14:11:42.395831 [debug] [Thread-4 (]: On test.hw4_dbt.not_null_stg_transactions_cat_id.81205306d9: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.not_null_stg_transactions_cat_id.81205306d9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select cat_id
from transactions.main_staging.stg_transactions
where cat_id is null



      
    ) dbt_internal_test
[0m14:11:42.396041 [debug] [Thread-3 (]: On test.hw4_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: BEGIN
[0m14:11:42.397137 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:11:42.397832 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:11:42.398180 [debug] [Thread-3 (]: Using duckdb connection "test.hw4_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m14:11:42.398433 [debug] [Thread-3 (]: On test.hw4_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from transactions.main_staging.stg_transactions
where customer_id is null



      
    ) dbt_internal_test
[0m14:11:42.399957 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:11:42.401288 [debug] [Thread-1 (]: On test.hw4_dbt.not_null_stg_transactions_amount.3629b5421e: ROLLBACK
[0m14:11:42.401582 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m14:11:42.402065 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m14:11:42.406715 [debug] [Thread-1 (]: Failed to rollback 'test.hw4_dbt.not_null_stg_transactions_amount.3629b5421e'
[0m14:11:42.411190 [debug] [Thread-4 (]: On test.hw4_dbt.not_null_stg_transactions_cat_id.81205306d9: ROLLBACK
[0m14:11:42.413298 [debug] [Thread-2 (]: On test.hw4_dbt.not_null_stg_transactions_amount_bucket.ddccfce050: ROLLBACK
[0m14:11:42.416512 [debug] [Thread-2 (]: Failed to rollback 'test.hw4_dbt.not_null_stg_transactions_amount_bucket.ddccfce050'
[0m14:11:42.415883 [debug] [Thread-1 (]: On test.hw4_dbt.not_null_stg_transactions_amount.3629b5421e: Close
[0m14:11:42.425419 [info ] [Thread-1 (]: 31 of 56 PASS not_null_stg_transactions_amount ................................. [[32mPASS[0m in 0.12s]
[0m14:11:42.425897 [debug] [Thread-1 (]: Finished running node test.hw4_dbt.not_null_stg_transactions_amount.3629b5421e
[0m14:11:42.426115 [debug] [Thread-1 (]: Began running node test.hw4_dbt.not_null_stg_transactions_is_fraud.c832a79395
[0m14:11:42.426291 [info ] [Thread-1 (]: 35 of 56 START test not_null_stg_transactions_is_fraud ......................... [RUN]
[0m14:11:42.426506 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_stg_transactions_amount.3629b5421e, now test.hw4_dbt.not_null_stg_transactions_is_fraud.c832a79395)
[0m14:11:42.426676 [debug] [Thread-1 (]: Began compiling node test.hw4_dbt.not_null_stg_transactions_is_fraud.c832a79395
[0m14:11:42.419872 [debug] [Thread-2 (]: On test.hw4_dbt.not_null_stg_transactions_amount_bucket.ddccfce050: Close
[0m14:11:42.428991 [debug] [Thread-1 (]: Writing injected SQL for node "test.hw4_dbt.not_null_stg_transactions_is_fraud.c832a79395"
[0m14:11:42.434840 [debug] [Thread-1 (]: Began executing node test.hw4_dbt.not_null_stg_transactions_is_fraud.c832a79395
[0m14:11:42.416255 [debug] [Thread-4 (]: Failed to rollback 'test.hw4_dbt.not_null_stg_transactions_cat_id.81205306d9'
[0m14:11:42.439595 [debug] [Thread-1 (]: Writing runtime sql for node "test.hw4_dbt.not_null_stg_transactions_is_fraud.c832a79395"
[0m14:11:42.444977 [debug] [Thread-4 (]: On test.hw4_dbt.not_null_stg_transactions_cat_id.81205306d9: Close
[0m14:11:42.446152 [info ] [Thread-4 (]: 33 of 56 PASS not_null_stg_transactions_cat_id ................................. [[32mPASS[0m in 0.13s]
[0m14:11:42.446917 [debug] [Thread-4 (]: Finished running node test.hw4_dbt.not_null_stg_transactions_cat_id.81205306d9
[0m14:11:42.447908 [debug] [Thread-4 (]: Began running node test.hw4_dbt.not_null_stg_transactions_merchant_id.b64621d2d7
[0m14:11:42.448154 [info ] [Thread-4 (]: 36 of 56 START test not_null_stg_transactions_merchant_id ...................... [RUN]
[0m14:11:42.448415 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_stg_transactions_cat_id.81205306d9, now test.hw4_dbt.not_null_stg_transactions_merchant_id.b64621d2d7)
[0m14:11:42.449536 [debug] [Thread-4 (]: Began compiling node test.hw4_dbt.not_null_stg_transactions_merchant_id.b64621d2d7
[0m14:11:42.452930 [debug] [Thread-4 (]: Writing injected SQL for node "test.hw4_dbt.not_null_stg_transactions_merchant_id.b64621d2d7"
[0m14:11:42.453532 [debug] [Thread-4 (]: Began executing node test.hw4_dbt.not_null_stg_transactions_merchant_id.b64621d2d7
[0m14:11:42.455922 [debug] [Thread-4 (]: Writing runtime sql for node "test.hw4_dbt.not_null_stg_transactions_merchant_id.b64621d2d7"
[0m14:11:42.456511 [debug] [Thread-4 (]: Using duckdb connection "test.hw4_dbt.not_null_stg_transactions_merchant_id.b64621d2d7"
[0m14:11:42.456954 [debug] [Thread-4 (]: On test.hw4_dbt.not_null_stg_transactions_merchant_id.b64621d2d7: BEGIN
[0m14:11:42.457125 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:11:42.457553 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m14:11:42.434030 [info ] [Thread-2 (]: 32 of 56 PASS not_null_stg_transactions_amount_bucket .......................... [[32mPASS[0m in 0.13s]
[0m14:11:42.457812 [debug] [Thread-4 (]: Using duckdb connection "test.hw4_dbt.not_null_stg_transactions_merchant_id.b64621d2d7"
[0m14:11:42.458055 [debug] [Thread-1 (]: Using duckdb connection "test.hw4_dbt.not_null_stg_transactions_is_fraud.c832a79395"
[0m14:11:42.458610 [debug] [Thread-2 (]: Finished running node test.hw4_dbt.not_null_stg_transactions_amount_bucket.ddccfce050
[0m14:11:42.461852 [debug] [Thread-4 (]: On test.hw4_dbt.not_null_stg_transactions_merchant_id.b64621d2d7: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.not_null_stg_transactions_merchant_id.b64621d2d7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select merchant_id
from transactions.main_staging.stg_transactions
where merchant_id is null



      
    ) dbt_internal_test
[0m14:11:42.462443 [debug] [Thread-1 (]: On test.hw4_dbt.not_null_stg_transactions_is_fraud.c832a79395: BEGIN
[0m14:11:42.463206 [debug] [Thread-2 (]: Began running node test.hw4_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m14:11:42.464323 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:42.464912 [info ] [Thread-2 (]: 37 of 56 START test not_null_stg_transactions_transaction_date ................. [RUN]
[0m14:11:42.465513 [debug] [Thread-3 (]: SQL status: OK in 0.067 seconds
[0m14:11:42.466071 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_stg_transactions_amount_bucket.ddccfce050, now test.hw4_dbt.not_null_stg_transactions_transaction_date.353bde368c)
[0m14:11:42.466419 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:11:42.467360 [debug] [Thread-3 (]: On test.hw4_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: ROLLBACK
[0m14:11:42.468311 [debug] [Thread-2 (]: Began compiling node test.hw4_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m14:11:42.468839 [debug] [Thread-1 (]: Using duckdb connection "test.hw4_dbt.not_null_stg_transactions_is_fraud.c832a79395"
[0m14:11:42.469177 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m14:11:42.469595 [debug] [Thread-3 (]: Failed to rollback 'test.hw4_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf'
[0m14:11:42.473186 [debug] [Thread-2 (]: Writing injected SQL for node "test.hw4_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m14:11:42.473517 [debug] [Thread-1 (]: On test.hw4_dbt.not_null_stg_transactions_is_fraud.c832a79395: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.not_null_stg_transactions_is_fraud.c832a79395"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_fraud
from transactions.main_staging.stg_transactions
where is_fraud is null



      
    ) dbt_internal_test
[0m14:11:42.474644 [debug] [Thread-4 (]: On test.hw4_dbt.not_null_stg_transactions_merchant_id.b64621d2d7: ROLLBACK
[0m14:11:42.474855 [debug] [Thread-3 (]: On test.hw4_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: Close
[0m14:11:42.475674 [debug] [Thread-2 (]: Began executing node test.hw4_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m14:11:42.476215 [debug] [Thread-4 (]: Failed to rollback 'test.hw4_dbt.not_null_stg_transactions_merchant_id.b64621d2d7'
[0m14:11:42.478046 [debug] [Thread-2 (]: Writing runtime sql for node "test.hw4_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m14:11:42.478427 [info ] [Thread-3 (]: 34 of 56 PASS not_null_stg_transactions_customer_id ............................ [[32mPASS[0m in 0.14s]
[0m14:11:42.478769 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:11:42.479107 [debug] [Thread-4 (]: On test.hw4_dbt.not_null_stg_transactions_merchant_id.b64621d2d7: Close
[0m14:11:42.479549 [debug] [Thread-3 (]: Finished running node test.hw4_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m14:11:42.479970 [debug] [Thread-2 (]: Using duckdb connection "test.hw4_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m14:11:42.481019 [debug] [Thread-1 (]: On test.hw4_dbt.not_null_stg_transactions_is_fraud.c832a79395: ROLLBACK
[0m14:11:42.481399 [info ] [Thread-4 (]: 36 of 56 PASS not_null_stg_transactions_merchant_id ............................ [[32mPASS[0m in 0.03s]
[0m14:11:42.481711 [debug] [Thread-3 (]: Began running node test.hw4_dbt.not_null_stg_transactions_transaction_hour.99d50d4d46
[0m14:11:42.482005 [debug] [Thread-2 (]: On test.hw4_dbt.not_null_stg_transactions_transaction_date.353bde368c: BEGIN
[0m14:11:42.482347 [debug] [Thread-1 (]: Failed to rollback 'test.hw4_dbt.not_null_stg_transactions_is_fraud.c832a79395'
[0m14:11:42.482678 [debug] [Thread-4 (]: Finished running node test.hw4_dbt.not_null_stg_transactions_merchant_id.b64621d2d7
[0m14:11:42.482922 [info ] [Thread-3 (]: 38 of 56 START test not_null_stg_transactions_transaction_hour ................. [RUN]
[0m14:11:42.483214 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:11:42.483503 [debug] [Thread-1 (]: On test.hw4_dbt.not_null_stg_transactions_is_fraud.c832a79395: Close
[0m14:11:42.483758 [debug] [Thread-4 (]: Began running node test.hw4_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m14:11:42.484304 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf, now test.hw4_dbt.not_null_stg_transactions_transaction_hour.99d50d4d46)
[0m14:11:42.485061 [info ] [Thread-1 (]: 35 of 56 PASS not_null_stg_transactions_is_fraud ............................... [[32mPASS[0m in 0.06s]
[0m14:11:42.485742 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m14:11:42.485464 [info ] [Thread-4 (]: 39 of 56 START test not_null_stg_transactions_transaction_id ................... [RUN]
[0m14:11:42.486178 [debug] [Thread-3 (]: Began compiling node test.hw4_dbt.not_null_stg_transactions_transaction_hour.99d50d4d46
[0m14:11:42.486469 [debug] [Thread-1 (]: Finished running node test.hw4_dbt.not_null_stg_transactions_is_fraud.c832a79395
[0m14:11:42.486664 [debug] [Thread-2 (]: Using duckdb connection "test.hw4_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m14:11:42.486900 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_stg_transactions_merchant_id.b64621d2d7, now test.hw4_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4)
[0m14:11:42.491100 [debug] [Thread-3 (]: Writing injected SQL for node "test.hw4_dbt.not_null_stg_transactions_transaction_hour.99d50d4d46"
[0m14:11:42.491481 [debug] [Thread-1 (]: Began running node test.hw4_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m14:11:42.491777 [debug] [Thread-2 (]: On test.hw4_dbt.not_null_stg_transactions_transaction_date.353bde368c: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.not_null_stg_transactions_transaction_date.353bde368c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_date
from transactions.main_staging.stg_transactions
where transaction_date is null



      
    ) dbt_internal_test
[0m14:11:42.492121 [debug] [Thread-4 (]: Began compiling node test.hw4_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m14:11:42.492611 [info ] [Thread-1 (]: 40 of 56 START test not_null_stg_transactions_transaction_ts ................... [RUN]
[0m14:11:42.497228 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_stg_transactions_is_fraud.c832a79395, now test.hw4_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7)
[0m14:11:42.493308 [debug] [Thread-3 (]: Began executing node test.hw4_dbt.not_null_stg_transactions_transaction_hour.99d50d4d46
[0m14:11:42.501230 [debug] [Thread-1 (]: Began compiling node test.hw4_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m14:11:42.505267 [debug] [Thread-3 (]: Writing runtime sql for node "test.hw4_dbt.not_null_stg_transactions_transaction_hour.99d50d4d46"
[0m14:11:42.496028 [debug] [Thread-4 (]: Writing injected SQL for node "test.hw4_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m14:11:42.508589 [debug] [Thread-1 (]: Writing injected SQL for node "test.hw4_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m14:11:42.508955 [debug] [Thread-2 (]: SQL status: OK in 0.015 seconds
[0m14:11:42.509568 [debug] [Thread-4 (]: Began executing node test.hw4_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m14:11:42.509924 [debug] [Thread-3 (]: Using duckdb connection "test.hw4_dbt.not_null_stg_transactions_transaction_hour.99d50d4d46"
[0m14:11:42.510173 [debug] [Thread-1 (]: Began executing node test.hw4_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m14:11:42.511303 [debug] [Thread-2 (]: On test.hw4_dbt.not_null_stg_transactions_transaction_date.353bde368c: ROLLBACK
[0m14:11:42.513143 [debug] [Thread-4 (]: Writing runtime sql for node "test.hw4_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m14:11:42.513506 [debug] [Thread-3 (]: On test.hw4_dbt.not_null_stg_transactions_transaction_hour.99d50d4d46: BEGIN
[0m14:11:42.515265 [debug] [Thread-1 (]: Writing runtime sql for node "test.hw4_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m14:11:42.515694 [debug] [Thread-2 (]: Failed to rollback 'test.hw4_dbt.not_null_stg_transactions_transaction_date.353bde368c'
[0m14:11:42.516055 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:11:42.516377 [debug] [Thread-2 (]: On test.hw4_dbt.not_null_stg_transactions_transaction_date.353bde368c: Close
[0m14:11:42.516573 [debug] [Thread-4 (]: Using duckdb connection "test.hw4_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m14:11:42.517101 [debug] [Thread-1 (]: Using duckdb connection "test.hw4_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m14:11:42.517963 [debug] [Thread-4 (]: On test.hw4_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: BEGIN
[0m14:11:42.518301 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:11:42.517520 [info ] [Thread-2 (]: 37 of 56 PASS not_null_stg_transactions_transaction_date ....................... [[32mPASS[0m in 0.05s]
[0m14:11:42.518804 [debug] [Thread-1 (]: On test.hw4_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: BEGIN
[0m14:11:42.519035 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:11:42.519224 [debug] [Thread-3 (]: Using duckdb connection "test.hw4_dbt.not_null_stg_transactions_transaction_hour.99d50d4d46"
[0m14:11:42.519533 [debug] [Thread-2 (]: Finished running node test.hw4_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m14:11:42.519713 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:42.520089 [debug] [Thread-3 (]: On test.hw4_dbt.not_null_stg_transactions_transaction_hour.99d50d4d46: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.not_null_stg_transactions_transaction_hour.99d50d4d46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_hour
from transactions.main_staging.stg_transactions
where transaction_hour is null



      
    ) dbt_internal_test
[0m14:11:42.520338 [debug] [Thread-2 (]: Began running node test.hw4_dbt.not_null_stg_transactions_us_state.11afe11a0c
[0m14:11:42.520498 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:11:42.520995 [info ] [Thread-2 (]: 41 of 56 START test not_null_stg_transactions_us_state ......................... [RUN]
[0m14:11:42.521378 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:11:42.521840 [debug] [Thread-4 (]: Using duckdb connection "test.hw4_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m14:11:42.522375 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_stg_transactions_transaction_date.353bde368c, now test.hw4_dbt.not_null_stg_transactions_us_state.11afe11a0c)
[0m14:11:42.522766 [debug] [Thread-1 (]: Using duckdb connection "test.hw4_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m14:11:42.528693 [debug] [Thread-1 (]: On test.hw4_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_ts
from transactions.main_staging.stg_transactions
where transaction_ts is null



      
    ) dbt_internal_test
[0m14:11:42.523384 [debug] [Thread-4 (]: On test.hw4_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_id
from transactions.main_staging.stg_transactions
where transaction_id is null



      
    ) dbt_internal_test
[0m14:11:42.523990 [debug] [Thread-2 (]: Began compiling node test.hw4_dbt.not_null_stg_transactions_us_state.11afe11a0c
[0m14:11:42.537644 [debug] [Thread-2 (]: Writing injected SQL for node "test.hw4_dbt.not_null_stg_transactions_us_state.11afe11a0c"
[0m14:11:42.538818 [debug] [Thread-2 (]: Began executing node test.hw4_dbt.not_null_stg_transactions_us_state.11afe11a0c
[0m14:11:42.540420 [debug] [Thread-2 (]: Writing runtime sql for node "test.hw4_dbt.not_null_stg_transactions_us_state.11afe11a0c"
[0m14:11:42.542016 [debug] [Thread-3 (]: SQL status: OK in 0.021 seconds
[0m14:11:42.543861 [debug] [Thread-3 (]: On test.hw4_dbt.not_null_stg_transactions_transaction_hour.99d50d4d46: ROLLBACK
[0m14:11:42.544228 [debug] [Thread-3 (]: Failed to rollback 'test.hw4_dbt.not_null_stg_transactions_transaction_hour.99d50d4d46'
[0m14:11:42.544407 [debug] [Thread-3 (]: On test.hw4_dbt.not_null_stg_transactions_transaction_hour.99d50d4d46: Close
[0m14:11:42.544722 [info ] [Thread-3 (]: 38 of 56 PASS not_null_stg_transactions_transaction_hour ....................... [[32mPASS[0m in 0.06s]
[0m14:11:42.544986 [debug] [Thread-3 (]: Finished running node test.hw4_dbt.not_null_stg_transactions_transaction_hour.99d50d4d46
[0m14:11:42.545185 [debug] [Thread-3 (]: Began running node test.hw4_dbt.relationships_stg_transactions_us_state__state_code__ref_states_.7b260553ef
[0m14:11:42.545366 [info ] [Thread-3 (]: 42 of 56 START test relationships_stg_transactions_us_state__state_code__ref_states_  [RUN]
[0m14:11:42.545687 [debug] [Thread-2 (]: Using duckdb connection "test.hw4_dbt.not_null_stg_transactions_us_state.11afe11a0c"
[0m14:11:42.568392 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_stg_transactions_transaction_hour.99d50d4d46, now test.hw4_dbt.relationships_stg_transactions_us_state__state_code__ref_states_.7b260553ef)
[0m14:11:42.572119 [debug] [Thread-1 (]: SQL status: OK in 0.043 seconds
[0m14:11:42.588278 [debug] [Thread-1 (]: On test.hw4_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: ROLLBACK
[0m14:11:42.588739 [debug] [Thread-1 (]: Failed to rollback 'test.hw4_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7'
[0m14:11:42.588934 [debug] [Thread-1 (]: On test.hw4_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: Close
[0m14:11:42.589274 [info ] [Thread-1 (]: 40 of 56 PASS not_null_stg_transactions_transaction_ts ......................... [[32mPASS[0m in 0.09s]
[0m14:11:42.589584 [debug] [Thread-1 (]: Finished running node test.hw4_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m14:11:42.589792 [debug] [Thread-1 (]: Began running node test.hw4_dbt.source_accepted_values_transactions_db_transactions_target__0__1.ff30b0d50d
[0m14:11:42.590035 [info ] [Thread-1 (]: 43 of 56 START test source_accepted_values_transactions_db_transactions_target__0__1  [RUN]
[0m14:11:42.590244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7, now test.hw4_dbt.source_accepted_values_transactions_db_transactions_target__0__1.ff30b0d50d)
[0m14:11:42.590434 [debug] [Thread-1 (]: Began compiling node test.hw4_dbt.source_accepted_values_transactions_db_transactions_target__0__1.ff30b0d50d
[0m14:11:42.579971 [debug] [Thread-2 (]: On test.hw4_dbt.not_null_stg_transactions_us_state.11afe11a0c: BEGIN
[0m14:11:42.601775 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:11:42.602305 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:11:42.603685 [debug] [Thread-2 (]: Using duckdb connection "test.hw4_dbt.not_null_stg_transactions_us_state.11afe11a0c"
[0m14:11:42.603949 [debug] [Thread-2 (]: On test.hw4_dbt.not_null_stg_transactions_us_state.11afe11a0c: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.not_null_stg_transactions_us_state.11afe11a0c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select us_state
from transactions.main_staging.stg_transactions
where us_state is null



      
    ) dbt_internal_test
[0m14:11:42.585231 [debug] [Thread-3 (]: Began compiling node test.hw4_dbt.relationships_stg_transactions_us_state__state_code__ref_states_.7b260553ef
[0m14:11:42.599212 [debug] [Thread-1 (]: Writing injected SQL for node "test.hw4_dbt.source_accepted_values_transactions_db_transactions_target__0__1.ff30b0d50d"
[0m14:11:42.612636 [debug] [Thread-3 (]: Writing injected SQL for node "test.hw4_dbt.relationships_stg_transactions_us_state__state_code__ref_states_.7b260553ef"
[0m14:11:42.616238 [debug] [Thread-2 (]: SQL status: OK in 0.012 seconds
[0m14:11:42.618666 [debug] [Thread-3 (]: Began executing node test.hw4_dbt.relationships_stg_transactions_us_state__state_code__ref_states_.7b260553ef
[0m14:11:42.622807 [debug] [Thread-2 (]: On test.hw4_dbt.not_null_stg_transactions_us_state.11afe11a0c: ROLLBACK
[0m14:11:42.624214 [debug] [Thread-1 (]: Began executing node test.hw4_dbt.source_accepted_values_transactions_db_transactions_target__0__1.ff30b0d50d
[0m14:11:42.626915 [debug] [Thread-3 (]: Writing runtime sql for node "test.hw4_dbt.relationships_stg_transactions_us_state__state_code__ref_states_.7b260553ef"
[0m14:11:42.627485 [debug] [Thread-2 (]: Failed to rollback 'test.hw4_dbt.not_null_stg_transactions_us_state.11afe11a0c'
[0m14:11:42.630210 [debug] [Thread-2 (]: On test.hw4_dbt.not_null_stg_transactions_us_state.11afe11a0c: Close
[0m14:11:42.631505 [info ] [Thread-2 (]: 41 of 56 PASS not_null_stg_transactions_us_state ............................... [[32mPASS[0m in 0.11s]
[0m14:11:42.631828 [debug] [Thread-2 (]: Finished running node test.hw4_dbt.not_null_stg_transactions_us_state.11afe11a0c
[0m14:11:42.632111 [debug] [Thread-2 (]: Began running node test.hw4_dbt.source_accepted_values_transactions_db_transactions_us_state__AL__AK__AZ__AR__CA__CO__CT__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY.35e2d449e5
[0m14:11:42.632367 [info ] [Thread-2 (]: 44 of 56 START test source_accepted_values_transactions_db_transactions_us_state__AL__AK__AZ__AR__CA__CO__CT__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY  [RUN]
[0m14:11:42.632626 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_stg_transactions_us_state.11afe11a0c, now test.hw4_dbt.source_accepted_values_transactions_db_transactions_us_state__AL__AK__AZ__AR__CA__CO__CT__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY.35e2d449e5)
[0m14:11:42.634339 [debug] [Thread-2 (]: Began compiling node test.hw4_dbt.source_accepted_values_transactions_db_transactions_us_state__AL__AK__AZ__AR__CA__CO__CT__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY.35e2d449e5
[0m14:11:42.629134 [debug] [Thread-1 (]: Writing runtime sql for node "test.hw4_dbt.source_accepted_values_transactions_db_transactions_target__0__1.ff30b0d50d"
[0m14:11:42.633050 [debug] [Thread-3 (]: Using duckdb connection "test.hw4_dbt.relationships_stg_transactions_us_state__state_code__ref_states_.7b260553ef"
[0m14:11:42.651933 [debug] [Thread-2 (]: Writing injected SQL for node "test.hw4_dbt.source_accepted_values_transactions_db_transactions_us_state__AL__AK__AZ__AR__CA__CO__CT__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY.35e2d449e5"
[0m14:11:42.652727 [debug] [Thread-3 (]: On test.hw4_dbt.relationships_stg_transactions_us_state__state_code__ref_states_.7b260553ef: BEGIN
[0m14:11:42.656433 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:11:42.654592 [debug] [Thread-2 (]: Began executing node test.hw4_dbt.source_accepted_values_transactions_db_transactions_us_state__AL__AK__AZ__AR__CA__CO__CT__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY.35e2d449e5
[0m14:11:42.655786 [debug] [Thread-1 (]: Using duckdb connection "test.hw4_dbt.source_accepted_values_transactions_db_transactions_target__0__1.ff30b0d50d"
[0m14:11:42.658894 [debug] [Thread-1 (]: On test.hw4_dbt.source_accepted_values_transactions_db_transactions_target__0__1.ff30b0d50d: BEGIN
[0m14:11:42.658525 [debug] [Thread-2 (]: Writing runtime sql for node "test.hw4_dbt.source_accepted_values_transactions_db_transactions_us_state__AL__AK__AZ__AR__CA__CO__CT__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY.35e2d449e5"
[0m14:11:42.659394 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:42.659713 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m14:11:42.661018 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:11:42.661417 [debug] [Thread-3 (]: Using duckdb connection "test.hw4_dbt.relationships_stg_transactions_us_state__state_code__ref_states_.7b260553ef"
[0m14:11:42.661723 [debug] [Thread-2 (]: Using duckdb connection "test.hw4_dbt.source_accepted_values_transactions_db_transactions_us_state__AL__AK__AZ__AR__CA__CO__CT__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY.35e2d449e5"
[0m14:11:42.662095 [debug] [Thread-1 (]: Using duckdb connection "test.hw4_dbt.source_accepted_values_transactions_db_transactions_target__0__1.ff30b0d50d"
[0m14:11:42.662796 [debug] [Thread-3 (]: On test.hw4_dbt.relationships_stg_transactions_us_state__state_code__ref_states_.7b260553ef: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.relationships_stg_transactions_us_state__state_code__ref_states_.7b260553ef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select us_state as from_field
    from transactions.main_staging.stg_transactions
    where us_state is not null
),

parent as (
    select state_code as to_field
    from transactions.main_transactions_db.states
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m14:11:42.663512 [debug] [Thread-2 (]: On test.hw4_dbt.source_accepted_values_transactions_db_transactions_us_state__AL__AK__AZ__AR__CA__CO__CT__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY.35e2d449e5: BEGIN
[0m14:11:42.664093 [debug] [Thread-1 (]: On test.hw4_dbt.source_accepted_values_transactions_db_transactions_target__0__1.ff30b0d50d: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.source_accepted_values_transactions_db_transactions_target__0__1.ff30b0d50d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        target as value_field,
        count(*) as n_records

    from transactions.main_transactions_db.transactions
    group by target

)

select *
from all_values
where value_field not in (
    '0','1'
)



      
    ) dbt_internal_test
[0m14:11:42.664940 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:11:42.666304 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:11:42.666599 [debug] [Thread-2 (]: Using duckdb connection "test.hw4_dbt.source_accepted_values_transactions_db_transactions_us_state__AL__AK__AZ__AR__CA__CO__CT__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY.35e2d449e5"
[0m14:11:42.667512 [debug] [Thread-2 (]: On test.hw4_dbt.source_accepted_values_transactions_db_transactions_us_state__AL__AK__AZ__AR__CA__CO__CT__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY.35e2d449e5: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.source_accepted_values_transactions_db_transactions_us_state__AL__AK__AZ__AR__CA__CO__CT__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY.35e2d449e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        us_state as value_field,
        count(*) as n_records

    from transactions.main_transactions_db.transactions
    group by us_state

)

select *
from all_values
where value_field not in (
    'AL','AK','AZ','AR','CA','CO','CT','DE','FL','GA','HI','ID','IL','IN','IA','KS','KY','LA','ME','MD','MA','MI','MN','MS','MO','MT','NE','NV','NH','NJ','NM','NY','NC','ND','OH','OK','OR','PA','RI','SC','SD','TN','TX','UT','VT','VA','WA','WV','WI','WY'
)



      
    ) dbt_internal_test
[0m14:11:42.669862 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:11:42.674857 [debug] [Thread-1 (]: On test.hw4_dbt.source_accepted_values_transactions_db_transactions_target__0__1.ff30b0d50d: ROLLBACK
[0m14:11:42.676988 [debug] [Thread-1 (]: Failed to rollback 'test.hw4_dbt.source_accepted_values_transactions_db_transactions_target__0__1.ff30b0d50d'
[0m14:11:42.677262 [debug] [Thread-1 (]: On test.hw4_dbt.source_accepted_values_transactions_db_transactions_target__0__1.ff30b0d50d: Close
[0m14:11:42.677626 [info ] [Thread-1 (]: 43 of 56 PASS source_accepted_values_transactions_db_transactions_target__0__1 . [[32mPASS[0m in 0.09s]
[0m14:11:42.677920 [debug] [Thread-1 (]: Finished running node test.hw4_dbt.source_accepted_values_transactions_db_transactions_target__0__1.ff30b0d50d
[0m14:11:42.678154 [debug] [Thread-1 (]: Began running node test.hw4_dbt.source_not_null_transactions_db_transactions_amount.307a04757b
[0m14:11:42.678338 [info ] [Thread-1 (]: 45 of 56 START test source_not_null_transactions_db_transactions_amount ........ [RUN]
[0m14:11:42.678540 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.source_accepted_values_transactions_db_transactions_target__0__1.ff30b0d50d, now test.hw4_dbt.source_not_null_transactions_db_transactions_amount.307a04757b)
[0m14:11:42.679097 [debug] [Thread-1 (]: Began compiling node test.hw4_dbt.source_not_null_transactions_db_transactions_amount.307a04757b
[0m14:11:42.686103 [debug] [Thread-1 (]: Writing injected SQL for node "test.hw4_dbt.source_not_null_transactions_db_transactions_amount.307a04757b"
[0m14:11:42.687333 [debug] [Thread-1 (]: Began executing node test.hw4_dbt.source_not_null_transactions_db_transactions_amount.307a04757b
[0m14:11:42.690890 [debug] [Thread-1 (]: Writing runtime sql for node "test.hw4_dbt.source_not_null_transactions_db_transactions_amount.307a04757b"
[0m14:11:42.691752 [debug] [Thread-1 (]: Using duckdb connection "test.hw4_dbt.source_not_null_transactions_db_transactions_amount.307a04757b"
[0m14:11:42.692420 [debug] [Thread-3 (]: SQL status: OK in 0.028 seconds
[0m14:11:42.692790 [debug] [Thread-1 (]: On test.hw4_dbt.source_not_null_transactions_db_transactions_amount.307a04757b: BEGIN
[0m14:11:42.693656 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:42.694564 [debug] [Thread-3 (]: On test.hw4_dbt.relationships_stg_transactions_us_state__state_code__ref_states_.7b260553ef: ROLLBACK
[0m14:11:42.695301 [debug] [Thread-3 (]: Failed to rollback 'test.hw4_dbt.relationships_stg_transactions_us_state__state_code__ref_states_.7b260553ef'
[0m14:11:42.695531 [debug] [Thread-3 (]: On test.hw4_dbt.relationships_stg_transactions_us_state__state_code__ref_states_.7b260553ef: Close
[0m14:11:42.695906 [error] [Thread-3 (]: 42 of 56 FAIL 2219 relationships_stg_transactions_us_state__state_code__ref_states_  [[31mFAIL 2219[0m in 0.15s]
[0m14:11:42.697072 [debug] [Thread-3 (]: Finished running node test.hw4_dbt.relationships_stg_transactions_us_state__state_code__ref_states_.7b260553ef
[0m14:11:42.697577 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:11:42.698010 [debug] [Thread-3 (]: Began running node test.hw4_dbt.source_not_null_transactions_db_transactions_cat_id.24c084b034
[0m14:11:42.699043 [debug] [Thread-1 (]: Using duckdb connection "test.hw4_dbt.source_not_null_transactions_db_transactions_amount.307a04757b"
[0m14:11:42.699498 [info ] [Thread-3 (]: 46 of 56 START test source_not_null_transactions_db_transactions_cat_id ........ [RUN]
[0m14:11:42.699747 [debug] [Thread-1 (]: On test.hw4_dbt.source_not_null_transactions_db_transactions_amount.307a04757b: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.source_not_null_transactions_db_transactions_amount.307a04757b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select amount
from transactions.main_transactions_db.transactions
where amount is null



      
    ) dbt_internal_test
[0m14:11:42.701045 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.relationships_stg_transactions_us_state__state_code__ref_states_.7b260553ef, now test.hw4_dbt.source_not_null_transactions_db_transactions_cat_id.24c084b034)
[0m14:11:42.701894 [debug] [Thread-3 (]: Began compiling node test.hw4_dbt.source_not_null_transactions_db_transactions_cat_id.24c084b034
[0m14:11:42.702355 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:11:42.707233 [debug] [Thread-3 (]: Writing injected SQL for node "test.hw4_dbt.source_not_null_transactions_db_transactions_cat_id.24c084b034"
[0m14:11:42.708788 [debug] [Thread-1 (]: On test.hw4_dbt.source_not_null_transactions_db_transactions_amount.307a04757b: ROLLBACK
[0m14:11:42.709978 [debug] [Thread-1 (]: Failed to rollback 'test.hw4_dbt.source_not_null_transactions_db_transactions_amount.307a04757b'
[0m14:11:42.710612 [debug] [Thread-3 (]: Began executing node test.hw4_dbt.source_not_null_transactions_db_transactions_cat_id.24c084b034
[0m14:11:42.710877 [debug] [Thread-1 (]: On test.hw4_dbt.source_not_null_transactions_db_transactions_amount.307a04757b: Close
[0m14:11:42.712442 [debug] [Thread-3 (]: Writing runtime sql for node "test.hw4_dbt.source_not_null_transactions_db_transactions_cat_id.24c084b034"
[0m14:11:42.712973 [info ] [Thread-1 (]: 45 of 56 PASS source_not_null_transactions_db_transactions_amount .............. [[32mPASS[0m in 0.03s]
[0m14:11:42.714316 [debug] [Thread-1 (]: Finished running node test.hw4_dbt.source_not_null_transactions_db_transactions_amount.307a04757b
[0m14:11:42.714986 [debug] [Thread-3 (]: Using duckdb connection "test.hw4_dbt.source_not_null_transactions_db_transactions_cat_id.24c084b034"
[0m14:11:42.715234 [debug] [Thread-1 (]: Began running node test.hw4_dbt.source_not_null_transactions_db_transactions_merch.b9d9c15594
[0m14:11:42.715542 [debug] [Thread-3 (]: On test.hw4_dbt.source_not_null_transactions_db_transactions_cat_id.24c084b034: BEGIN
[0m14:11:42.715784 [info ] [Thread-1 (]: 47 of 56 START test source_not_null_transactions_db_transactions_merch ......... [RUN]
[0m14:11:42.716494 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:11:42.716817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.source_not_null_transactions_db_transactions_amount.307a04757b, now test.hw4_dbt.source_not_null_transactions_db_transactions_merch.b9d9c15594)
[0m14:11:42.718364 [debug] [Thread-1 (]: Began compiling node test.hw4_dbt.source_not_null_transactions_db_transactions_merch.b9d9c15594
[0m14:11:42.718661 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:11:42.722738 [debug] [Thread-1 (]: Writing injected SQL for node "test.hw4_dbt.source_not_null_transactions_db_transactions_merch.b9d9c15594"
[0m14:11:42.723251 [debug] [Thread-2 (]: SQL status: OK in 0.055 seconds
[0m14:11:42.723491 [debug] [Thread-3 (]: Using duckdb connection "test.hw4_dbt.source_not_null_transactions_db_transactions_cat_id.24c084b034"
[0m14:11:42.724483 [debug] [Thread-2 (]: On test.hw4_dbt.source_accepted_values_transactions_db_transactions_us_state__AL__AK__AZ__AR__CA__CO__CT__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY.35e2d449e5: ROLLBACK
[0m14:11:42.724728 [debug] [Thread-3 (]: On test.hw4_dbt.source_not_null_transactions_db_transactions_cat_id.24c084b034: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.source_not_null_transactions_db_transactions_cat_id.24c084b034"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select cat_id
from transactions.main_transactions_db.transactions
where cat_id is null



      
    ) dbt_internal_test
[0m14:11:42.725319 [debug] [Thread-2 (]: Failed to rollback 'test.hw4_dbt.source_accepted_values_transactions_db_transactions_us_state__AL__AK__AZ__AR__CA__CO__CT__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY.35e2d449e5'
[0m14:11:42.725618 [debug] [Thread-1 (]: Began executing node test.hw4_dbt.source_not_null_transactions_db_transactions_merch.b9d9c15594
[0m14:11:42.726592 [debug] [Thread-2 (]: On test.hw4_dbt.source_accepted_values_transactions_db_transactions_us_state__AL__AK__AZ__AR__CA__CO__CT__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY.35e2d449e5: Close
[0m14:11:42.727085 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:11:42.728711 [debug] [Thread-1 (]: Writing runtime sql for node "test.hw4_dbt.source_not_null_transactions_db_transactions_merch.b9d9c15594"
[0m14:11:42.730547 [debug] [Thread-3 (]: On test.hw4_dbt.source_not_null_transactions_db_transactions_cat_id.24c084b034: ROLLBACK
[0m14:11:42.729339 [error] [Thread-2 (]: 44 of 56 FAIL 1 source_accepted_values_transactions_db_transactions_us_state__AL__AK__AZ__AR__CA__CO__CT__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY  [[31mFAIL 1[0m in 0.10s]
[0m14:11:42.731210 [debug] [Thread-3 (]: Failed to rollback 'test.hw4_dbt.source_not_null_transactions_db_transactions_cat_id.24c084b034'
[0m14:11:42.731614 [debug] [Thread-2 (]: Finished running node test.hw4_dbt.source_accepted_values_transactions_db_transactions_us_state__AL__AK__AZ__AR__CA__CO__CT__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY.35e2d449e5
[0m14:11:42.731950 [debug] [Thread-1 (]: Using duckdb connection "test.hw4_dbt.source_not_null_transactions_db_transactions_merch.b9d9c15594"
[0m14:11:42.732169 [debug] [Thread-3 (]: On test.hw4_dbt.source_not_null_transactions_db_transactions_cat_id.24c084b034: Close
[0m14:11:42.732485 [debug] [Thread-2 (]: Began running node test.hw4_dbt.source_not_null_transactions_db_transactions_target.ee81663a6c
[0m14:11:42.732967 [debug] [Thread-1 (]: On test.hw4_dbt.source_not_null_transactions_db_transactions_merch.b9d9c15594: BEGIN
[0m14:11:42.733391 [info ] [Thread-3 (]: 46 of 56 PASS source_not_null_transactions_db_transactions_cat_id .............. [[32mPASS[0m in 0.03s]
[0m14:11:42.733622 [info ] [Thread-2 (]: 48 of 56 START test source_not_null_transactions_db_transactions_target ........ [RUN]
[0m14:11:42.734328 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:42.734983 [debug] [Thread-3 (]: Finished running node test.hw4_dbt.source_not_null_transactions_db_transactions_cat_id.24c084b034
[0m14:11:42.735272 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.source_accepted_values_transactions_db_transactions_us_state__AL__AK__AZ__AR__CA__CO__CT__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY.35e2d449e5, now test.hw4_dbt.source_not_null_transactions_db_transactions_target.ee81663a6c)
[0m14:11:42.735804 [debug] [Thread-3 (]: Began running node test.hw4_dbt.source_not_null_transactions_db_transactions_transaction_time.b0308d1b6c
[0m14:11:42.736083 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:11:42.736389 [debug] [Thread-2 (]: Began compiling node test.hw4_dbt.source_not_null_transactions_db_transactions_target.ee81663a6c
[0m14:11:42.736646 [info ] [Thread-3 (]: 49 of 56 START test source_not_null_transactions_db_transactions_transaction_time  [RUN]
[0m14:11:42.736949 [debug] [Thread-1 (]: Using duckdb connection "test.hw4_dbt.source_not_null_transactions_db_transactions_merch.b9d9c15594"
[0m14:11:42.740065 [debug] [Thread-2 (]: Writing injected SQL for node "test.hw4_dbt.source_not_null_transactions_db_transactions_target.ee81663a6c"
[0m14:11:42.740442 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.source_not_null_transactions_db_transactions_cat_id.24c084b034, now test.hw4_dbt.source_not_null_transactions_db_transactions_transaction_time.b0308d1b6c)
[0m14:11:42.740768 [debug] [Thread-1 (]: On test.hw4_dbt.source_not_null_transactions_db_transactions_merch.b9d9c15594: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.source_not_null_transactions_db_transactions_merch.b9d9c15594"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select merch
from transactions.main_transactions_db.transactions
where merch is null



      
    ) dbt_internal_test
[0m14:11:42.741135 [debug] [Thread-3 (]: Began compiling node test.hw4_dbt.source_not_null_transactions_db_transactions_transaction_time.b0308d1b6c
[0m14:11:42.745396 [debug] [Thread-3 (]: Writing injected SQL for node "test.hw4_dbt.source_not_null_transactions_db_transactions_transaction_time.b0308d1b6c"
[0m14:11:42.745666 [debug] [Thread-2 (]: Began executing node test.hw4_dbt.source_not_null_transactions_db_transactions_target.ee81663a6c
[0m14:11:42.745911 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:11:42.746076 [debug] [Thread-4 (]: SQL status: OK in 0.211 seconds
[0m14:11:42.749838 [debug] [Thread-2 (]: Writing runtime sql for node "test.hw4_dbt.source_not_null_transactions_db_transactions_target.ee81663a6c"
[0m14:11:42.750889 [debug] [Thread-1 (]: On test.hw4_dbt.source_not_null_transactions_db_transactions_merch.b9d9c15594: ROLLBACK
[0m14:11:42.751261 [debug] [Thread-3 (]: Began executing node test.hw4_dbt.source_not_null_transactions_db_transactions_transaction_time.b0308d1b6c
[0m14:11:42.752654 [debug] [Thread-4 (]: On test.hw4_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: ROLLBACK
[0m14:11:42.753211 [debug] [Thread-1 (]: Failed to rollback 'test.hw4_dbt.source_not_null_transactions_db_transactions_merch.b9d9c15594'
[0m14:11:42.754999 [debug] [Thread-3 (]: Writing runtime sql for node "test.hw4_dbt.source_not_null_transactions_db_transactions_transaction_time.b0308d1b6c"
[0m14:11:42.755691 [debug] [Thread-4 (]: Failed to rollback 'test.hw4_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4'
[0m14:11:42.755937 [debug] [Thread-2 (]: Using duckdb connection "test.hw4_dbt.source_not_null_transactions_db_transactions_target.ee81663a6c"
[0m14:11:42.756347 [debug] [Thread-1 (]: On test.hw4_dbt.source_not_null_transactions_db_transactions_merch.b9d9c15594: Close
[0m14:11:42.756849 [debug] [Thread-4 (]: On test.hw4_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: Close
[0m14:11:42.757221 [debug] [Thread-2 (]: On test.hw4_dbt.source_not_null_transactions_db_transactions_target.ee81663a6c: BEGIN
[0m14:11:42.757520 [debug] [Thread-3 (]: Using duckdb connection "test.hw4_dbt.source_not_null_transactions_db_transactions_transaction_time.b0308d1b6c"
[0m14:11:42.757945 [info ] [Thread-1 (]: 47 of 56 PASS source_not_null_transactions_db_transactions_merch ............... [[32mPASS[0m in 0.04s]
[0m14:11:42.758268 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:11:42.758637 [debug] [Thread-3 (]: On test.hw4_dbt.source_not_null_transactions_db_transactions_transaction_time.b0308d1b6c: BEGIN
[0m14:11:42.759368 [debug] [Thread-1 (]: Finished running node test.hw4_dbt.source_not_null_transactions_db_transactions_merch.b9d9c15594
[0m14:11:42.759997 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:11:42.760374 [debug] [Thread-1 (]: Began running node test.hw4_dbt.source_not_null_transactions_db_transactions_us_state.4999dadbbc
[0m14:11:42.760792 [info ] [Thread-4 (]: 39 of 56 PASS not_null_stg_transactions_transaction_id ......................... [[32mPASS[0m in 0.27s]
[0m14:11:42.761505 [info ] [Thread-1 (]: 50 of 56 START test source_not_null_transactions_db_transactions_us_state ...... [RUN]
[0m14:11:42.761963 [debug] [Thread-4 (]: Finished running node test.hw4_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m14:11:42.762277 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.source_not_null_transactions_db_transactions_merch.b9d9c15594, now test.hw4_dbt.source_not_null_transactions_db_transactions_us_state.4999dadbbc)
[0m14:11:42.762629 [debug] [Thread-4 (]: Began running node test.hw4_dbt.unique_mart_customer_risk_profile_customer_id.7b43a6fbd0
[0m14:11:42.763542 [debug] [Thread-1 (]: Began compiling node test.hw4_dbt.source_not_null_transactions_db_transactions_us_state.4999dadbbc
[0m14:11:42.764281 [info ] [Thread-4 (]: 51 of 56 START test unique_mart_customer_risk_profile_customer_id .............. [RUN]
[0m14:11:42.767722 [debug] [Thread-1 (]: Writing injected SQL for node "test.hw4_dbt.source_not_null_transactions_db_transactions_us_state.4999dadbbc"
[0m14:11:42.768169 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4, now test.hw4_dbt.unique_mart_customer_risk_profile_customer_id.7b43a6fbd0)
[0m14:11:42.768622 [debug] [Thread-4 (]: Began compiling node test.hw4_dbt.unique_mart_customer_risk_profile_customer_id.7b43a6fbd0
[0m14:11:42.772838 [debug] [Thread-4 (]: Writing injected SQL for node "test.hw4_dbt.unique_mart_customer_risk_profile_customer_id.7b43a6fbd0"
[0m14:11:42.773586 [debug] [Thread-1 (]: Began executing node test.hw4_dbt.source_not_null_transactions_db_transactions_us_state.4999dadbbc
[0m14:11:42.773963 [debug] [Thread-2 (]: SQL status: OK in 0.016 seconds
[0m14:11:42.774199 [debug] [Thread-3 (]: SQL status: OK in 0.014 seconds
[0m14:11:42.775996 [debug] [Thread-1 (]: Writing runtime sql for node "test.hw4_dbt.source_not_null_transactions_db_transactions_us_state.4999dadbbc"
[0m14:11:42.776438 [debug] [Thread-2 (]: Using duckdb connection "test.hw4_dbt.source_not_null_transactions_db_transactions_target.ee81663a6c"
[0m14:11:42.776678 [debug] [Thread-3 (]: Using duckdb connection "test.hw4_dbt.source_not_null_transactions_db_transactions_transaction_time.b0308d1b6c"
[0m14:11:42.776858 [debug] [Thread-4 (]: Began executing node test.hw4_dbt.unique_mart_customer_risk_profile_customer_id.7b43a6fbd0
[0m14:11:42.777516 [debug] [Thread-2 (]: On test.hw4_dbt.source_not_null_transactions_db_transactions_target.ee81663a6c: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.source_not_null_transactions_db_transactions_target.ee81663a6c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select target
from transactions.main_transactions_db.transactions
where target is null



      
    ) dbt_internal_test
[0m14:11:42.777891 [debug] [Thread-3 (]: On test.hw4_dbt.source_not_null_transactions_db_transactions_transaction_time.b0308d1b6c: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.source_not_null_transactions_db_transactions_transaction_time.b0308d1b6c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_time
from transactions.main_transactions_db.transactions
where transaction_time is null



      
    ) dbt_internal_test
[0m14:11:42.778221 [debug] [Thread-1 (]: Using duckdb connection "test.hw4_dbt.source_not_null_transactions_db_transactions_us_state.4999dadbbc"
[0m14:11:42.779937 [debug] [Thread-4 (]: Writing runtime sql for node "test.hw4_dbt.unique_mart_customer_risk_profile_customer_id.7b43a6fbd0"
[0m14:11:42.780597 [debug] [Thread-1 (]: On test.hw4_dbt.source_not_null_transactions_db_transactions_us_state.4999dadbbc: BEGIN
[0m14:11:42.780860 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:11:42.781345 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:11:42.781943 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:42.782501 [debug] [Thread-4 (]: Using duckdb connection "test.hw4_dbt.unique_mart_customer_risk_profile_customer_id.7b43a6fbd0"
[0m14:11:42.783721 [debug] [Thread-2 (]: On test.hw4_dbt.source_not_null_transactions_db_transactions_target.ee81663a6c: ROLLBACK
[0m14:11:42.784471 [debug] [Thread-3 (]: On test.hw4_dbt.source_not_null_transactions_db_transactions_transaction_time.b0308d1b6c: ROLLBACK
[0m14:11:42.784703 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:11:42.785135 [debug] [Thread-4 (]: On test.hw4_dbt.unique_mart_customer_risk_profile_customer_id.7b43a6fbd0: BEGIN
[0m14:11:42.785946 [debug] [Thread-2 (]: Failed to rollback 'test.hw4_dbt.source_not_null_transactions_db_transactions_target.ee81663a6c'
[0m14:11:42.786510 [debug] [Thread-3 (]: Failed to rollback 'test.hw4_dbt.source_not_null_transactions_db_transactions_transaction_time.b0308d1b6c'
[0m14:11:42.786789 [debug] [Thread-1 (]: Using duckdb connection "test.hw4_dbt.source_not_null_transactions_db_transactions_us_state.4999dadbbc"
[0m14:11:42.787020 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:11:42.787231 [debug] [Thread-2 (]: On test.hw4_dbt.source_not_null_transactions_db_transactions_target.ee81663a6c: Close
[0m14:11:42.787617 [debug] [Thread-3 (]: On test.hw4_dbt.source_not_null_transactions_db_transactions_transaction_time.b0308d1b6c: Close
[0m14:11:42.787887 [debug] [Thread-1 (]: On test.hw4_dbt.source_not_null_transactions_db_transactions_us_state.4999dadbbc: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.source_not_null_transactions_db_transactions_us_state.4999dadbbc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select us_state
from transactions.main_transactions_db.transactions
where us_state is null



      
    ) dbt_internal_test
[0m14:11:42.788718 [info ] [Thread-2 (]: 48 of 56 PASS source_not_null_transactions_db_transactions_target .............. [[32mPASS[0m in 0.05s]
[0m14:11:42.788971 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m14:11:42.789469 [info ] [Thread-3 (]: 49 of 56 PASS source_not_null_transactions_db_transactions_transaction_time .... [[32mPASS[0m in 0.05s]
[0m14:11:42.790129 [debug] [Thread-2 (]: Finished running node test.hw4_dbt.source_not_null_transactions_db_transactions_target.ee81663a6c
[0m14:11:42.790430 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:11:42.790636 [debug] [Thread-4 (]: Using duckdb connection "test.hw4_dbt.unique_mart_customer_risk_profile_customer_id.7b43a6fbd0"
[0m14:11:42.791013 [debug] [Thread-3 (]: Finished running node test.hw4_dbt.source_not_null_transactions_db_transactions_transaction_time.b0308d1b6c
[0m14:11:42.791272 [debug] [Thread-2 (]: Began running node test.hw4_dbt.unique_mart_fraud_by_category_cat_id.69c514d94d
[0m14:11:42.792393 [debug] [Thread-1 (]: On test.hw4_dbt.source_not_null_transactions_db_transactions_us_state.4999dadbbc: ROLLBACK
[0m14:11:42.792901 [debug] [Thread-4 (]: On test.hw4_dbt.unique_mart_customer_risk_profile_customer_id.7b43a6fbd0: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.unique_mart_customer_risk_profile_customer_id.7b43a6fbd0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from transactions.main_marts.mart_customer_risk_profile
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:11:42.793189 [debug] [Thread-3 (]: Began running node test.hw4_dbt.unique_mart_fraud_by_state_us_state.45e47cf1a6
[0m14:11:42.793663 [info ] [Thread-2 (]: 52 of 56 START test unique_mart_fraud_by_category_cat_id ....................... [RUN]
[0m14:11:42.794141 [debug] [Thread-1 (]: Failed to rollback 'test.hw4_dbt.source_not_null_transactions_db_transactions_us_state.4999dadbbc'
[0m14:11:42.794600 [info ] [Thread-3 (]: 53 of 56 START test unique_mart_fraud_by_state_us_state ........................ [RUN]
[0m14:11:42.794938 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.source_not_null_transactions_db_transactions_target.ee81663a6c, now test.hw4_dbt.unique_mart_fraud_by_category_cat_id.69c514d94d)
[0m14:11:42.795256 [debug] [Thread-1 (]: On test.hw4_dbt.source_not_null_transactions_db_transactions_us_state.4999dadbbc: Close
[0m14:11:42.795796 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.source_not_null_transactions_db_transactions_transaction_time.b0308d1b6c, now test.hw4_dbt.unique_mart_fraud_by_state_us_state.45e47cf1a6)
[0m14:11:42.796088 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m14:11:42.796361 [debug] [Thread-2 (]: Began compiling node test.hw4_dbt.unique_mart_fraud_by_category_cat_id.69c514d94d
[0m14:11:42.796779 [info ] [Thread-1 (]: 50 of 56 PASS source_not_null_transactions_db_transactions_us_state ............ [[32mPASS[0m in 0.03s]
[0m14:11:42.797356 [debug] [Thread-3 (]: Began compiling node test.hw4_dbt.unique_mart_fraud_by_state_us_state.45e47cf1a6
[0m14:11:42.798535 [debug] [Thread-4 (]: On test.hw4_dbt.unique_mart_customer_risk_profile_customer_id.7b43a6fbd0: ROLLBACK
[0m14:11:42.801431 [debug] [Thread-2 (]: Writing injected SQL for node "test.hw4_dbt.unique_mart_fraud_by_category_cat_id.69c514d94d"
[0m14:11:42.801855 [debug] [Thread-1 (]: Finished running node test.hw4_dbt.source_not_null_transactions_db_transactions_us_state.4999dadbbc
[0m14:11:42.804567 [debug] [Thread-3 (]: Writing injected SQL for node "test.hw4_dbt.unique_mart_fraud_by_state_us_state.45e47cf1a6"
[0m14:11:42.805164 [debug] [Thread-4 (]: Failed to rollback 'test.hw4_dbt.unique_mart_customer_risk_profile_customer_id.7b43a6fbd0'
[0m14:11:42.805758 [debug] [Thread-1 (]: Began running node test.hw4_dbt.unique_mart_merchant_analytics_merchant_id.58d0768274
[0m14:11:42.806253 [debug] [Thread-2 (]: Began executing node test.hw4_dbt.unique_mart_fraud_by_category_cat_id.69c514d94d
[0m14:11:42.806559 [debug] [Thread-4 (]: On test.hw4_dbt.unique_mart_customer_risk_profile_customer_id.7b43a6fbd0: Close
[0m14:11:42.806819 [debug] [Thread-3 (]: Began executing node test.hw4_dbt.unique_mart_fraud_by_state_us_state.45e47cf1a6
[0m14:11:42.807091 [info ] [Thread-1 (]: 54 of 56 START test unique_mart_merchant_analytics_merchant_id ................. [RUN]
[0m14:11:42.810729 [debug] [Thread-2 (]: Writing runtime sql for node "test.hw4_dbt.unique_mart_fraud_by_category_cat_id.69c514d94d"
[0m14:11:42.812541 [debug] [Thread-3 (]: Writing runtime sql for node "test.hw4_dbt.unique_mart_fraud_by_state_us_state.45e47cf1a6"
[0m14:11:42.812903 [info ] [Thread-4 (]: 51 of 56 PASS unique_mart_customer_risk_profile_customer_id .................... [[32mPASS[0m in 0.04s]
[0m14:11:42.813192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.source_not_null_transactions_db_transactions_us_state.4999dadbbc, now test.hw4_dbt.unique_mart_merchant_analytics_merchant_id.58d0768274)
[0m14:11:42.813775 [debug] [Thread-4 (]: Finished running node test.hw4_dbt.unique_mart_customer_risk_profile_customer_id.7b43a6fbd0
[0m14:11:42.814036 [debug] [Thread-1 (]: Began compiling node test.hw4_dbt.unique_mart_merchant_analytics_merchant_id.58d0768274
[0m14:11:42.814407 [debug] [Thread-3 (]: Using duckdb connection "test.hw4_dbt.unique_mart_fraud_by_state_us_state.45e47cf1a6"
[0m14:11:42.814865 [debug] [Thread-4 (]: Began running node test.hw4_dbt.unique_states_state_code.67c4706beb
[0m14:11:42.815167 [debug] [Thread-2 (]: Using duckdb connection "test.hw4_dbt.unique_mart_fraud_by_category_cat_id.69c514d94d"
[0m14:11:42.817973 [debug] [Thread-1 (]: Writing injected SQL for node "test.hw4_dbt.unique_mart_merchant_analytics_merchant_id.58d0768274"
[0m14:11:42.818307 [debug] [Thread-3 (]: On test.hw4_dbt.unique_mart_fraud_by_state_us_state.45e47cf1a6: BEGIN
[0m14:11:42.818701 [info ] [Thread-4 (]: 55 of 56 START test unique_states_state_code ................................... [RUN]
[0m14:11:42.819230 [debug] [Thread-2 (]: On test.hw4_dbt.unique_mart_fraud_by_category_cat_id.69c514d94d: BEGIN
[0m14:11:42.819783 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:11:42.820174 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.unique_mart_customer_risk_profile_customer_id.7b43a6fbd0, now test.hw4_dbt.unique_states_state_code.67c4706beb)
[0m14:11:42.820451 [debug] [Thread-1 (]: Began executing node test.hw4_dbt.unique_mart_merchant_analytics_merchant_id.58d0768274
[0m14:11:42.820668 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:11:42.820990 [debug] [Thread-4 (]: Began compiling node test.hw4_dbt.unique_states_state_code.67c4706beb
[0m14:11:42.823197 [debug] [Thread-1 (]: Writing runtime sql for node "test.hw4_dbt.unique_mart_merchant_analytics_merchant_id.58d0768274"
[0m14:11:42.825929 [debug] [Thread-4 (]: Writing injected SQL for node "test.hw4_dbt.unique_states_state_code.67c4706beb"
[0m14:11:42.827036 [debug] [Thread-4 (]: Began executing node test.hw4_dbt.unique_states_state_code.67c4706beb
[0m14:11:42.827362 [debug] [Thread-1 (]: Using duckdb connection "test.hw4_dbt.unique_mart_merchant_analytics_merchant_id.58d0768274"
[0m14:11:42.829063 [debug] [Thread-4 (]: Writing runtime sql for node "test.hw4_dbt.unique_states_state_code.67c4706beb"
[0m14:11:42.829333 [debug] [Thread-1 (]: On test.hw4_dbt.unique_mart_merchant_analytics_merchant_id.58d0768274: BEGIN
[0m14:11:42.830035 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m14:11:42.830330 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m14:11:42.830643 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:42.831024 [debug] [Thread-3 (]: Using duckdb connection "test.hw4_dbt.unique_mart_fraud_by_state_us_state.45e47cf1a6"
[0m14:11:42.831838 [debug] [Thread-4 (]: Using duckdb connection "test.hw4_dbt.unique_states_state_code.67c4706beb"
[0m14:11:42.832153 [debug] [Thread-2 (]: Using duckdb connection "test.hw4_dbt.unique_mart_fraud_by_category_cat_id.69c514d94d"
[0m14:11:42.832659 [debug] [Thread-3 (]: On test.hw4_dbt.unique_mart_fraud_by_state_us_state.45e47cf1a6: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.unique_mart_fraud_by_state_us_state.45e47cf1a6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    us_state as unique_field,
    count(*) as n_records

from transactions.main_marts.mart_fraud_by_state
where us_state is not null
group by us_state
having count(*) > 1



      
    ) dbt_internal_test
[0m14:11:42.832962 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:11:42.833142 [debug] [Thread-4 (]: On test.hw4_dbt.unique_states_state_code.67c4706beb: BEGIN
[0m14:11:42.833355 [debug] [Thread-2 (]: On test.hw4_dbt.unique_mart_fraud_by_category_cat_id.69c514d94d: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.unique_mart_fraud_by_category_cat_id.69c514d94d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    cat_id as unique_field,
    count(*) as n_records

from transactions.main_marts.mart_fraud_by_category
where cat_id is not null
group by cat_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:11:42.833690 [debug] [Thread-1 (]: Using duckdb connection "test.hw4_dbt.unique_mart_merchant_analytics_merchant_id.58d0768274"
[0m14:11:42.833870 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:11:42.834217 [debug] [Thread-1 (]: On test.hw4_dbt.unique_mart_merchant_analytics_merchant_id.58d0768274: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.unique_mart_merchant_analytics_merchant_id.58d0768274"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    merchant_id as unique_field,
    count(*) as n_records

from transactions.main_marts.mart_merchant_analytics
where merchant_id is not null
group by merchant_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:11:42.834968 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:11:42.835174 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:11:42.835527 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:11:42.836067 [debug] [Thread-4 (]: Using duckdb connection "test.hw4_dbt.unique_states_state_code.67c4706beb"
[0m14:11:42.837235 [debug] [Thread-2 (]: On test.hw4_dbt.unique_mart_fraud_by_category_cat_id.69c514d94d: ROLLBACK
[0m14:11:42.837901 [debug] [Thread-3 (]: On test.hw4_dbt.unique_mart_fraud_by_state_us_state.45e47cf1a6: ROLLBACK
[0m14:11:42.838219 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:11:42.838538 [debug] [Thread-4 (]: On test.hw4_dbt.unique_states_state_code.67c4706beb: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.unique_states_state_code.67c4706beb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    state_code as unique_field,
    count(*) as n_records

from transactions.main_transactions_db.states
where state_code is not null
group by state_code
having count(*) > 1



      
    ) dbt_internal_test
[0m14:11:42.839160 [debug] [Thread-2 (]: Failed to rollback 'test.hw4_dbt.unique_mart_fraud_by_category_cat_id.69c514d94d'
[0m14:11:42.839672 [debug] [Thread-3 (]: Failed to rollback 'test.hw4_dbt.unique_mart_fraud_by_state_us_state.45e47cf1a6'
[0m14:11:42.840581 [debug] [Thread-1 (]: On test.hw4_dbt.unique_mart_merchant_analytics_merchant_id.58d0768274: ROLLBACK
[0m14:11:42.841439 [debug] [Thread-2 (]: On test.hw4_dbt.unique_mart_fraud_by_category_cat_id.69c514d94d: Close
[0m14:11:42.841701 [debug] [Thread-3 (]: On test.hw4_dbt.unique_mart_fraud_by_state_us_state.45e47cf1a6: Close
[0m14:11:42.842218 [debug] [Thread-1 (]: Failed to rollback 'test.hw4_dbt.unique_mart_merchant_analytics_merchant_id.58d0768274'
[0m14:11:42.842745 [info ] [Thread-2 (]: 52 of 56 PASS unique_mart_fraud_by_category_cat_id ............................. [[32mPASS[0m in 0.05s]
[0m14:11:42.844935 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m14:11:42.844664 [info ] [Thread-3 (]: 53 of 56 PASS unique_mart_fraud_by_state_us_state .............................. [[32mPASS[0m in 0.05s]
[0m14:11:42.845556 [debug] [Thread-1 (]: On test.hw4_dbt.unique_mart_merchant_analytics_merchant_id.58d0768274: Close
[0m14:11:42.846066 [debug] [Thread-2 (]: Finished running node test.hw4_dbt.unique_mart_fraud_by_category_cat_id.69c514d94d
[0m14:11:42.847301 [debug] [Thread-4 (]: On test.hw4_dbt.unique_states_state_code.67c4706beb: ROLLBACK
[0m14:11:42.847857 [debug] [Thread-3 (]: Finished running node test.hw4_dbt.unique_mart_fraud_by_state_us_state.45e47cf1a6
[0m14:11:42.848496 [debug] [Thread-2 (]: Began running node test.hw4_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m14:11:42.848936 [info ] [Thread-1 (]: 54 of 56 PASS unique_mart_merchant_analytics_merchant_id ....................... [[32mPASS[0m in 0.04s]
[0m14:11:42.849768 [debug] [Thread-4 (]: Failed to rollback 'test.hw4_dbt.unique_states_state_code.67c4706beb'
[0m14:11:42.850541 [info ] [Thread-2 (]: 56 of 56 START test unique_stg_transactions_transaction_id ..................... [RUN]
[0m14:11:42.851608 [debug] [Thread-1 (]: Finished running node test.hw4_dbt.unique_mart_merchant_analytics_merchant_id.58d0768274
[0m14:11:42.852635 [debug] [Thread-4 (]: On test.hw4_dbt.unique_states_state_code.67c4706beb: Close
[0m14:11:42.853090 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.unique_mart_fraud_by_category_cat_id.69c514d94d, now test.hw4_dbt.unique_stg_transactions_transaction_id.ee9a78a396)
[0m14:11:42.853804 [debug] [Thread-2 (]: Began compiling node test.hw4_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m14:11:42.857483 [debug] [Thread-2 (]: Writing injected SQL for node "test.hw4_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m14:11:42.857837 [info ] [Thread-4 (]: 55 of 56 PASS unique_states_state_code ......................................... [[32mPASS[0m in 0.04s]
[0m14:11:42.858761 [debug] [Thread-4 (]: Finished running node test.hw4_dbt.unique_states_state_code.67c4706beb
[0m14:11:42.859306 [debug] [Thread-2 (]: Began executing node test.hw4_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m14:11:42.861555 [debug] [Thread-2 (]: Writing runtime sql for node "test.hw4_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m14:11:42.862103 [debug] [Thread-2 (]: Using duckdb connection "test.hw4_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m14:11:42.862288 [debug] [Thread-2 (]: On test.hw4_dbt.unique_stg_transactions_transaction_id.ee9a78a396: BEGIN
[0m14:11:42.862442 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:11:42.871205 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m14:11:42.871589 [debug] [Thread-2 (]: Using duckdb connection "test.hw4_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m14:11:42.871835 [debug] [Thread-2 (]: On test.hw4_dbt.unique_stg_transactions_transaction_id.ee9a78a396: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.unique_stg_transactions_transaction_id.ee9a78a396"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from transactions.main_staging.stg_transactions
where transaction_id is not null
group by transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:11:43.095410 [debug] [Thread-2 (]: SQL status: OK in 0.223 seconds
[0m14:11:43.096464 [debug] [Thread-2 (]: On test.hw4_dbt.unique_stg_transactions_transaction_id.ee9a78a396: ROLLBACK
[0m14:11:43.096787 [debug] [Thread-2 (]: Failed to rollback 'test.hw4_dbt.unique_stg_transactions_transaction_id.ee9a78a396'
[0m14:11:43.096965 [debug] [Thread-2 (]: On test.hw4_dbt.unique_stg_transactions_transaction_id.ee9a78a396: Close
[0m14:11:43.100054 [info ] [Thread-2 (]: 56 of 56 PASS unique_stg_transactions_transaction_id ........................... [[32mPASS[0m in 0.25s]
[0m14:11:43.100592 [debug] [Thread-2 (]: Finished running node test.hw4_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m14:11:43.101725 [debug] [MainThread]: Using duckdb connection "master"
[0m14:11:43.101967 [debug] [MainThread]: On master: BEGIN
[0m14:11:43.102122 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:11:43.110369 [debug] [MainThread]: SQL status: OK in 0.008 seconds
[0m14:11:43.110673 [debug] [MainThread]: On master: COMMIT
[0m14:11:43.110830 [debug] [MainThread]: Using duckdb connection "master"
[0m14:11:43.110967 [debug] [MainThread]: On master: COMMIT
[0m14:11:43.111183 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:11:43.111323 [debug] [MainThread]: On master: Close
[0m14:11:43.112722 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:11:43.112933 [debug] [MainThread]: Connection 'test.hw4_dbt.unique_mart_merchant_analytics_merchant_id.58d0768274' was properly closed.
[0m14:11:43.113076 [debug] [MainThread]: Connection 'test.hw4_dbt.unique_stg_transactions_transaction_id.ee9a78a396' was properly closed.
[0m14:11:43.113227 [debug] [MainThread]: Connection 'test.hw4_dbt.unique_mart_fraud_by_state_us_state.45e47cf1a6' was properly closed.
[0m14:11:43.113379 [debug] [MainThread]: Connection 'test.hw4_dbt.unique_states_state_code.67c4706beb' was properly closed.
[0m14:11:43.113640 [info ] [MainThread]: 
[0m14:11:43.113811 [info ] [MainThread]: Finished running 56 data tests in 0 hours 0 minutes and 1.49 seconds (1.49s).
[0m14:11:43.116996 [debug] [MainThread]: Command end result
[0m14:11:43.155470 [info ] [MainThread]: 
[0m14:11:43.156460 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m14:11:43.156714 [info ] [MainThread]: 
[0m14:11:43.156946 [error] [MainThread]: [31mFailure in test relationships_stg_transactions_us_state__state_code__ref_states_ (models/staging/stg_transactions.yml)[0m
[0m14:11:43.157155 [error] [MainThread]:   Got 2219 results, configured to fail if != 0
[0m14:11:43.157295 [info ] [MainThread]: 
[0m14:11:43.157469 [info ] [MainThread]:   compiled code at target/compiled/hw4_dbt/models/staging/stg_transactions.yml/relationships_stg_transactions_7d3f1ff2342211cfa9d729d2627277a6.sql
[0m14:11:43.157622 [info ] [MainThread]: 
[0m14:11:43.157842 [error] [MainThread]: [31mFailure in test source_accepted_values_transactions_db_transactions_us_state__AL__AK__AZ__AR__CA__CO__CT__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY (models/sources/sources.yml)[0m
[0m14:11:43.158045 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m14:11:43.158181 [info ] [MainThread]: 
[0m14:11:43.158354 [info ] [MainThread]:   compiled code at target/compiled/hw4_dbt/models/sources/sources.yml/source_accepted_values_transac_672f1e0516ca096f93c422237b553e0a.sql
[0m14:11:43.158542 [info ] [MainThread]: 
[0m14:11:43.158709 [info ] [MainThread]: Done. PASS=54 WARN=0 ERROR=2 SKIP=0 TOTAL=56
[0m14:11:43.160751 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 2.0695076, "process_user_time": 4.442283, "process_kernel_time": 0.511064, "process_mem_max_rss": "352256000", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:11:43.161321 [debug] [MainThread]: Command `dbt test` failed at 14:11:43.161056 after 2.07 seconds
[0m14:11:43.161611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102279090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102316f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102317290>]}
[0m14:11:43.161888 [debug] [MainThread]: Flushing usage events
[0m14:12:17.336572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a2c6910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a540d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a541410>]}


============================== 14:12:17.340713 | 237a4503-b42f-4158-8d21-c7446c055dac ==============================
[0m14:12:17.340713 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:12:17.341110 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/roman/Desktop/hw4-mlops-bokhyan/dbt/logs', 'profiles_dir': '.', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt seed --select states', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:12:17.538091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '237a4503-b42f-4158-8d21-c7446c055dac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a5a6190>]}
[0m14:12:17.571661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '237a4503-b42f-4158-8d21-c7446c055dac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cb4090>]}
[0m14:12:17.573248 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m14:12:17.640022 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m14:12:17.747041 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m14:12:17.748353 [debug] [MainThread]: Partial parsing: updated file: hw4_dbt://models/sources/sources.yml
[0m14:12:17.748573 [debug] [MainThread]: Partial parsing: updated file: hw4_dbt://seeds/states.csv
[0m14:12:18.072050 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:12:18.072449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '237a4503-b42f-4158-8d21-c7446c055dac', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b87cad0>]}
[0m14:12:18.316516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '237a4503-b42f-4158-8d21-c7446c055dac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bf62250>]}
[0m14:12:18.409002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '237a4503-b42f-4158-8d21-c7446c055dac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c13b310>]}
[0m14:12:18.409461 [info ] [MainThread]: Found 2 seeds, 7 models, 56 data tests, 1 source, 805 macros
[0m14:12:18.409672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '237a4503-b42f-4158-8d21-c7446c055dac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118148290>]}
[0m14:12:18.412387 [info ] [MainThread]: 
[0m14:12:18.413541 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:12:18.414124 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_transactions'
[0m14:12:18.447296 [debug] [ThreadPool]: Using duckdb connection "list_transactions"
[0m14:12:18.447648 [debug] [ThreadPool]: On list_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "connection_name": "list_transactions"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'transactions'
    
  
  
[0m14:12:18.447817 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:18.465986 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m14:12:18.467056 [debug] [ThreadPool]: On list_transactions: Close
[0m14:12:18.471547 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transactions, now list_transactions_main_transactions_db)
[0m14:12:18.471926 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_transactions_main_staging'
[0m14:12:18.472260 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_transactions_main_marts'
[0m14:12:18.475922 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_transactions_db"
[0m14:12:18.523451 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_staging"
[0m14:12:18.525027 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_marts"
[0m14:12:18.525439 [debug] [ThreadPool]: On list_transactions_main_transactions_db: BEGIN
[0m14:12:18.525735 [debug] [ThreadPool]: On list_transactions_main_staging: BEGIN
[0m14:12:18.525896 [debug] [ThreadPool]: On list_transactions_main_marts: BEGIN
[0m14:12:18.526050 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:12:18.526190 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:18.526326 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:18.534857 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m14:12:18.535194 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m14:12:18.535383 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m14:12:18.535551 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_transactions_db"
[0m14:12:18.535757 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_marts"
[0m14:12:18.535907 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_staging"
[0m14:12:18.536108 [debug] [ThreadPool]: On list_transactions_main_transactions_db: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "connection_name": "list_transactions_main_transactions_db"} */
select
      'transactions' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_transactions_db'
    and table_catalog = 'transactions'
  
[0m14:12:18.536286 [debug] [ThreadPool]: On list_transactions_main_marts: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "connection_name": "list_transactions_main_marts"} */
select
      'transactions' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_marts'
    and table_catalog = 'transactions'
  
[0m14:12:18.536449 [debug] [ThreadPool]: On list_transactions_main_staging: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "connection_name": "list_transactions_main_staging"} */
select
      'transactions' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_staging'
    and table_catalog = 'transactions'
  
[0m14:12:18.548278 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m14:12:18.548570 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m14:12:18.548804 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m14:12:18.549935 [debug] [ThreadPool]: On list_transactions_main_marts: ROLLBACK
[0m14:12:18.550506 [debug] [ThreadPool]: On list_transactions_main_transactions_db: ROLLBACK
[0m14:12:18.551271 [debug] [ThreadPool]: On list_transactions_main_staging: ROLLBACK
[0m14:12:18.552180 [debug] [ThreadPool]: Failed to rollback 'list_transactions_main_transactions_db'
[0m14:12:18.552413 [debug] [ThreadPool]: Failed to rollback 'list_transactions_main_marts'
[0m14:12:18.552615 [debug] [ThreadPool]: Failed to rollback 'list_transactions_main_staging'
[0m14:12:18.552808 [debug] [ThreadPool]: On list_transactions_main_transactions_db: Close
[0m14:12:18.553074 [debug] [ThreadPool]: On list_transactions_main_marts: Close
[0m14:12:18.553314 [debug] [ThreadPool]: On list_transactions_main_staging: Close
[0m14:12:18.556124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '237a4503-b42f-4158-8d21-c7446c055dac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118029d50>]}
[0m14:12:18.556535 [debug] [MainThread]: Using duckdb connection "master"
[0m14:12:18.556707 [debug] [MainThread]: On master: BEGIN
[0m14:12:18.556863 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:12:18.565245 [debug] [MainThread]: SQL status: OK in 0.008 seconds
[0m14:12:18.565538 [debug] [MainThread]: On master: COMMIT
[0m14:12:18.566175 [debug] [MainThread]: Using duckdb connection "master"
[0m14:12:18.566525 [debug] [MainThread]: On master: COMMIT
[0m14:12:18.567027 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:12:18.568748 [debug] [MainThread]: On master: Close
[0m14:12:18.570296 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:12:18.570766 [info ] [MainThread]: 
[0m14:12:18.573014 [debug] [Thread-1 (]: Began running node seed.hw4_dbt.states
[0m14:12:18.573345 [info ] [Thread-1 (]: 1 of 1 START seed file main_transactions_db.states ............................. [RUN]
[0m14:12:18.574794 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_transactions_main_transactions_db, now seed.hw4_dbt.states)
[0m14:12:18.575142 [debug] [Thread-1 (]: Began compiling node seed.hw4_dbt.states
[0m14:12:18.575406 [debug] [Thread-1 (]: Began executing node seed.hw4_dbt.states
[0m14:12:18.593013 [debug] [Thread-1 (]: Using duckdb connection "seed.hw4_dbt.states"
[0m14:12:18.593346 [debug] [Thread-1 (]: On seed.hw4_dbt.states: BEGIN
[0m14:12:18.594068 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:18.602956 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m14:12:18.604130 [debug] [Thread-1 (]: Using duckdb connection "seed.hw4_dbt.states"
[0m14:12:18.604505 [debug] [Thread-1 (]: On seed.hw4_dbt.states: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "seed.hw4_dbt.states"} */
truncate table "transactions"."main_transactions_db"."states"
[0m14:12:18.606619 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:12:18.612927 [debug] [Thread-1 (]: Using duckdb connection "seed.hw4_dbt.states"
[0m14:12:18.613442 [debug] [Thread-1 (]: On seed.hw4_dbt.states: 
          COPY transactions.main_transactions_db.states FROM '/Users/roman/Desktop/hw4-mlops-bokhyan/dbt/seeds/states.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m14:12:18.619748 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m14:12:18.623117 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.hw4_dbt.states"
[0m14:12:18.630797 [debug] [Thread-1 (]: On seed.hw4_dbt.states: COMMIT
[0m14:12:18.631090 [debug] [Thread-1 (]: Using duckdb connection "seed.hw4_dbt.states"
[0m14:12:18.631254 [debug] [Thread-1 (]: On seed.hw4_dbt.states: COMMIT
[0m14:12:18.632206 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:12:18.633291 [debug] [Thread-1 (]: On seed.hw4_dbt.states: Close
[0m14:12:18.647805 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '237a4503-b42f-4158-8d21-c7446c055dac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c0e8150>]}
[0m14:12:18.648192 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file main_transactions_db.states ......................... [[32mINSERT 51[0m in 0.07s]
[0m14:12:18.648475 [debug] [Thread-1 (]: Finished running node seed.hw4_dbt.states
[0m14:12:18.649408 [debug] [MainThread]: Using duckdb connection "master"
[0m14:12:18.649616 [debug] [MainThread]: On master: BEGIN
[0m14:12:18.649956 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:12:18.657972 [debug] [MainThread]: SQL status: OK in 0.008 seconds
[0m14:12:18.658250 [debug] [MainThread]: On master: COMMIT
[0m14:12:18.658396 [debug] [MainThread]: Using duckdb connection "master"
[0m14:12:18.658533 [debug] [MainThread]: On master: COMMIT
[0m14:12:18.658770 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:12:18.658912 [debug] [MainThread]: On master: Close
[0m14:12:18.660201 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:12:18.660381 [debug] [MainThread]: Connection 'seed.hw4_dbt.states' was properly closed.
[0m14:12:18.660518 [debug] [MainThread]: Connection 'list_transactions_main_staging' was properly closed.
[0m14:12:18.660642 [debug] [MainThread]: Connection 'list_transactions_main_marts' was properly closed.
[0m14:12:18.660794 [info ] [MainThread]: 
[0m14:12:18.660948 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m14:12:18.661250 [debug] [MainThread]: Command end result
[0m14:12:18.690006 [info ] [MainThread]: 
[0m14:12:18.690333 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:12:18.690719 [info ] [MainThread]: 
[0m14:12:18.691476 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:12:18.693671 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 1.4057213, "process_user_time": 1.867837, "process_kernel_time": 0.339186, "process_mem_max_rss": "168132608", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:12:18.694043 [debug] [MainThread]: Command `dbt seed` succeeded at 14:12:18.693995 after 1.41 seconds
[0m14:12:18.694263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c29050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cc6ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cc6d90>]}
[0m14:12:18.694459 [debug] [MainThread]: Flushing usage events
[0m14:12:26.878912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11071c790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11071ca50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110482c90>]}


============================== 14:12:26.882354 | b6f45c1c-ce2e-4539-a089-6d90a1c4add5 ==============================
[0m14:12:26.882354 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:12:26.882853 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '.', 'log_path': '/Users/roman/Desktop/hw4-mlops-bokhyan/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:12:27.021803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6f45c1c-ce2e-4539-a089-6d90a1c4add5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110659450>]}
[0m14:12:27.056590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6f45c1c-ce2e-4539-a089-6d90a1c4add5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10528ced0>]}
[0m14:12:27.057229 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m14:12:27.121696 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m14:12:27.233136 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:12:27.233435 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:12:27.266750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6f45c1c-ce2e-4539-a089-6d90a1c4add5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11106ac10>]}
[0m14:12:27.354151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6f45c1c-ce2e-4539-a089-6d90a1c4add5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fcb450>]}
[0m14:12:27.354497 [info ] [MainThread]: Found 2 seeds, 7 models, 56 data tests, 1 source, 805 macros
[0m14:12:27.354785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6f45c1c-ce2e-4539-a089-6d90a1c4add5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e15c90>]}
[0m14:12:27.356544 [info ] [MainThread]: 
[0m14:12:27.356903 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:12:27.359538 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_transactions'
[0m14:12:27.359948 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_transactions'
[0m14:12:27.434094 [debug] [ThreadPool]: Using duckdb connection "list_transactions"
[0m14:12:27.434340 [debug] [ThreadPool]: Using duckdb connection "list_transactions"
[0m14:12:27.434648 [debug] [ThreadPool]: On list_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "connection_name": "list_transactions"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'transactions'
    
  
  
[0m14:12:27.435890 [debug] [ThreadPool]: On list_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "connection_name": "list_transactions"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'transactions'
    
  
  
[0m14:12:27.436154 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:27.436393 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:27.445870 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m14:12:27.446098 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m14:12:27.447004 [debug] [ThreadPool]: On list_transactions: Close
[0m14:12:27.447611 [debug] [ThreadPool]: On list_transactions: Close
[0m14:12:27.449803 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transactions, now list_transactions_main_transactions_db)
[0m14:12:27.450111 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transactions, now list_transactions_main_marts)
[0m14:12:27.450402 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_transactions_main_staging'
[0m14:12:27.453381 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_transactions_db"
[0m14:12:27.454546 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_marts"
[0m14:12:27.455855 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_staging"
[0m14:12:27.456159 [debug] [ThreadPool]: On list_transactions_main_transactions_db: BEGIN
[0m14:12:27.456387 [debug] [ThreadPool]: On list_transactions_main_marts: BEGIN
[0m14:12:27.456541 [debug] [ThreadPool]: On list_transactions_main_staging: BEGIN
[0m14:12:27.456678 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:12:27.456806 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:12:27.456925 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:27.465506 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m14:12:27.465797 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m14:12:27.465940 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m14:12:27.466122 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_transactions_db"
[0m14:12:27.466356 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_staging"
[0m14:12:27.466501 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_marts"
[0m14:12:27.466658 [debug] [ThreadPool]: On list_transactions_main_transactions_db: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "connection_name": "list_transactions_main_transactions_db"} */
select
      'transactions' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_transactions_db'
    and table_catalog = 'transactions'
  
[0m14:12:27.466822 [debug] [ThreadPool]: On list_transactions_main_staging: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "connection_name": "list_transactions_main_staging"} */
select
      'transactions' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_staging'
    and table_catalog = 'transactions'
  
[0m14:12:27.467096 [debug] [ThreadPool]: On list_transactions_main_marts: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "connection_name": "list_transactions_main_marts"} */
select
      'transactions' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_marts'
    and table_catalog = 'transactions'
  
[0m14:12:27.476480 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m14:12:27.476805 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m14:12:27.477063 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m14:12:27.477853 [debug] [ThreadPool]: On list_transactions_main_transactions_db: ROLLBACK
[0m14:12:27.478667 [debug] [ThreadPool]: On list_transactions_main_marts: ROLLBACK
[0m14:12:27.479173 [debug] [ThreadPool]: On list_transactions_main_staging: ROLLBACK
[0m14:12:27.479759 [debug] [ThreadPool]: Failed to rollback 'list_transactions_main_transactions_db'
[0m14:12:27.480090 [debug] [ThreadPool]: Failed to rollback 'list_transactions_main_marts'
[0m14:12:27.480352 [debug] [ThreadPool]: Failed to rollback 'list_transactions_main_staging'
[0m14:12:27.480506 [debug] [ThreadPool]: On list_transactions_main_transactions_db: Close
[0m14:12:27.480789 [debug] [ThreadPool]: On list_transactions_main_marts: Close
[0m14:12:27.481021 [debug] [ThreadPool]: On list_transactions_main_staging: Close
[0m14:12:27.483622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6f45c1c-ce2e-4539-a089-6d90a1c4add5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10528e910>]}
[0m14:12:27.483990 [debug] [MainThread]: Using duckdb connection "master"
[0m14:12:27.484213 [debug] [MainThread]: On master: BEGIN
[0m14:12:27.484373 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:12:27.492764 [debug] [MainThread]: SQL status: OK in 0.008 seconds
[0m14:12:27.493048 [debug] [MainThread]: On master: COMMIT
[0m14:12:27.493197 [debug] [MainThread]: Using duckdb connection "master"
[0m14:12:27.493331 [debug] [MainThread]: On master: COMMIT
[0m14:12:27.493834 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:12:27.494059 [debug] [MainThread]: On master: Close
[0m14:12:27.495432 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:12:27.495676 [info ] [MainThread]: 
[0m14:12:27.498007 [debug] [Thread-1 (]: Began running node model.hw4_dbt.stg_transactions
[0m14:12:27.498368 [info ] [Thread-1 (]: 1 of 7 START sql view model main_staging.stg_transactions ...................... [RUN]
[0m14:12:27.498742 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_transactions_main_transactions_db, now model.hw4_dbt.stg_transactions)
[0m14:12:27.499104 [debug] [Thread-1 (]: Began compiling node model.hw4_dbt.stg_transactions
[0m14:12:27.513147 [debug] [Thread-1 (]: Writing injected SQL for node "model.hw4_dbt.stg_transactions"
[0m14:12:27.513931 [debug] [Thread-1 (]: Began executing node model.hw4_dbt.stg_transactions
[0m14:12:27.530944 [debug] [Thread-1 (]: Writing runtime sql for node "model.hw4_dbt.stg_transactions"
[0m14:12:27.531508 [debug] [Thread-1 (]: Using duckdb connection "model.hw4_dbt.stg_transactions"
[0m14:12:27.531679 [debug] [Thread-1 (]: On model.hw4_dbt.stg_transactions: BEGIN
[0m14:12:27.531828 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:27.540238 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m14:12:27.540535 [debug] [Thread-1 (]: Using duckdb connection "model.hw4_dbt.stg_transactions"
[0m14:12:27.540805 [debug] [Thread-1 (]: On model.hw4_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "model.hw4_dbt.stg_transactions"} */

  
  create view transactions.main_staging.stg_transactions__dbt_tmp as (
    with source as (
    select * from transactions.main_transactions_db.transactions
),
renamed as (
    select
        md5(cast(coalesce(cast(transaction_time as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(merch as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(amount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(cat_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(post_code as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as transaction_id,
        cast(transaction_time as timestamp) as transaction_ts,
        cast(date(transaction_time) as date) as transaction_date,
        date_trunc('hour', cast(transaction_time as timestamp)) as transaction_hour,
        substr(dayname(cast(transaction_time as timestamp)), 1, 3) as day_name,
        merch as merchant_name,
        md5(cast(coalesce(cast(merch as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as merchant_id,
        cat_id,
        cast(amount as double) as amount,
        
    case
        when cast(amount as double) is null then 'unknown'
        when cast(amount as double) < 50 then 'small'
        when cast(amount as double) < 200 then 'medium'
        when cast(amount as double) < 500 then 'large'
        else 'extra_large'
    end
 as amount_bucket,
        case
            when upper(gender) in ('M', 'MALE') then 'M'
            when upper(gender) in ('F', 'FEMALE') then 'F'
            else 'U'
        end as gender,
        md5(cast(coalesce(cast(name_1 as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(name_2 as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(street as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(post_code as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
        concat_ws(' ', nullif(name_1, ''), nullif(name_2, '')) as customer_full_name,
        street,
        one_city as city,
        upper(us_state) as us_state,
        post_code,
        cast(lat as double) as customer_lat,
        cast(lon as double) as customer_lon,
        cast(merchant_lat as double) as merchant_lat,
        cast(merchant_lon as double) as merchant_lon,
        nullif(jobs, '') as job_title,
        cast(population_city as bigint) as population_city,
        cast(target as integer) as is_fraud,
        case when 
    case
        when cast(amount as double) is null then 'unknown'
        when cast(amount as double) < 50 then 'small'
        when cast(amount as double) < 200 then 'medium'
        when cast(amount as double) < 500 then 'large'
        else 'extra_large'
    end
 in ('large', 'extra_large') then 1 else 0 end as is_large_amount
    from source
),
with_states as (
    select
        r.*,
        s.state_name
    from renamed r
    left join transactions.main_transactions_db.states s
        on r.us_state = s.state_code
)
select * from with_states
  );

[0m14:12:27.542567 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:12:27.546191 [debug] [Thread-1 (]: Using duckdb connection "model.hw4_dbt.stg_transactions"
[0m14:12:27.546441 [debug] [Thread-1 (]: On model.hw4_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "model.hw4_dbt.stg_transactions"} */
alter view "transactions"."main_staging"."stg_transactions" rename to stg_transactions__dbt_backup
[0m14:12:27.547913 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:12:27.549807 [debug] [Thread-1 (]: Using duckdb connection "model.hw4_dbt.stg_transactions"
[0m14:12:27.550046 [debug] [Thread-1 (]: On model.hw4_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "model.hw4_dbt.stg_transactions"} */
alter view transactions.main_staging.stg_transactions__dbt_tmp rename to stg_transactions
[0m14:12:27.550540 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:12:27.557979 [debug] [Thread-1 (]: On model.hw4_dbt.stg_transactions: COMMIT
[0m14:12:27.558249 [debug] [Thread-1 (]: Using duckdb connection "model.hw4_dbt.stg_transactions"
[0m14:12:27.558406 [debug] [Thread-1 (]: On model.hw4_dbt.stg_transactions: COMMIT
[0m14:12:27.559882 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:12:27.562514 [debug] [Thread-1 (]: Using duckdb connection "model.hw4_dbt.stg_transactions"
[0m14:12:27.562707 [debug] [Thread-1 (]: On model.hw4_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "model.hw4_dbt.stg_transactions"} */
drop view if exists transactions.main_staging.stg_transactions__dbt_backup cascade
[0m14:12:27.563394 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:12:27.564707 [debug] [Thread-1 (]: On model.hw4_dbt.stg_transactions: Close
[0m14:12:27.578451 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6f45c1c-ce2e-4539-a089-6d90a1c4add5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11174c650>]}
[0m14:12:27.579230 [info ] [Thread-1 (]: 1 of 7 OK created sql view model main_staging.stg_transactions ................. [[32mOK[0m in 0.08s]
[0m14:12:27.580221 [debug] [Thread-1 (]: Finished running node model.hw4_dbt.stg_transactions
[0m14:12:27.581227 [debug] [Thread-3 (]: Began running node model.hw4_dbt.mart_customer_risk_profile
[0m14:12:27.581522 [debug] [Thread-4 (]: Began running node model.hw4_dbt.mart_daily_state_metrics
[0m14:12:27.581712 [debug] [Thread-2 (]: Began running node model.hw4_dbt.mart_fraud_by_category
[0m14:12:27.581894 [debug] [Thread-1 (]: Began running node model.hw4_dbt.mart_fraud_by_state
[0m14:12:27.582649 [info ] [Thread-3 (]: 2 of 7 START sql table model main_marts.mart_customer_risk_profile ............. [RUN]
[0m14:12:27.583037 [info ] [Thread-4 (]: 3 of 7 START sql table model main_marts.mart_daily_state_metrics ............... [RUN]
[0m14:12:27.585712 [info ] [Thread-2 (]: 4 of 7 START sql table model main_marts.mart_fraud_by_category ................. [RUN]
[0m14:12:27.586243 [info ] [Thread-1 (]: 5 of 7 START sql table model main_marts.mart_fraud_by_state .................... [RUN]
[0m14:12:27.587520 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_transactions_main_staging, now model.hw4_dbt.mart_customer_risk_profile)
[0m14:12:27.587909 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.hw4_dbt.mart_daily_state_metrics'
[0m14:12:27.588340 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_transactions_main_marts, now model.hw4_dbt.mart_fraud_by_category)
[0m14:12:27.588805 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.hw4_dbt.stg_transactions, now model.hw4_dbt.mart_fraud_by_state)
[0m14:12:27.589065 [debug] [Thread-3 (]: Began compiling node model.hw4_dbt.mart_customer_risk_profile
[0m14:12:27.589414 [debug] [Thread-4 (]: Began compiling node model.hw4_dbt.mart_daily_state_metrics
[0m14:12:27.589687 [debug] [Thread-2 (]: Began compiling node model.hw4_dbt.mart_fraud_by_category
[0m14:12:27.589930 [debug] [Thread-1 (]: Began compiling node model.hw4_dbt.mart_fraud_by_state
[0m14:12:27.592075 [debug] [Thread-3 (]: Writing injected SQL for node "model.hw4_dbt.mart_customer_risk_profile"
[0m14:12:27.596923 [debug] [Thread-4 (]: Writing injected SQL for node "model.hw4_dbt.mart_daily_state_metrics"
[0m14:12:27.598774 [debug] [Thread-2 (]: Writing injected SQL for node "model.hw4_dbt.mart_fraud_by_category"
[0m14:12:27.601224 [debug] [Thread-1 (]: Writing injected SQL for node "model.hw4_dbt.mart_fraud_by_state"
[0m14:12:27.602289 [debug] [Thread-3 (]: Began executing node model.hw4_dbt.mart_customer_risk_profile
[0m14:12:27.609156 [debug] [Thread-2 (]: Began executing node model.hw4_dbt.mart_fraud_by_category
[0m14:12:27.609506 [debug] [Thread-4 (]: Began executing node model.hw4_dbt.mart_daily_state_metrics
[0m14:12:27.614017 [debug] [Thread-3 (]: Writing runtime sql for node "model.hw4_dbt.mart_customer_risk_profile"
[0m14:12:27.618414 [debug] [Thread-2 (]: Writing runtime sql for node "model.hw4_dbt.mart_fraud_by_category"
[0m14:12:27.621990 [debug] [Thread-4 (]: Writing runtime sql for node "model.hw4_dbt.mart_daily_state_metrics"
[0m14:12:27.622306 [debug] [Thread-1 (]: Began executing node model.hw4_dbt.mart_fraud_by_state
[0m14:12:27.625382 [debug] [Thread-1 (]: Writing runtime sql for node "model.hw4_dbt.mart_fraud_by_state"
[0m14:12:27.626494 [debug] [Thread-3 (]: Using duckdb connection "model.hw4_dbt.mart_customer_risk_profile"
[0m14:12:27.626770 [debug] [Thread-4 (]: Using duckdb connection "model.hw4_dbt.mart_daily_state_metrics"
[0m14:12:27.626985 [debug] [Thread-2 (]: Using duckdb connection "model.hw4_dbt.mart_fraud_by_category"
[0m14:12:27.628806 [debug] [Thread-3 (]: On model.hw4_dbt.mart_customer_risk_profile: BEGIN
[0m14:12:27.629090 [debug] [Thread-1 (]: Using duckdb connection "model.hw4_dbt.mart_fraud_by_state"
[0m14:12:27.629850 [debug] [Thread-4 (]: On model.hw4_dbt.mart_daily_state_metrics: BEGIN
[0m14:12:27.630272 [debug] [Thread-2 (]: On model.hw4_dbt.mart_fraud_by_category: BEGIN
[0m14:12:27.630539 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:12:27.630803 [debug] [Thread-1 (]: On model.hw4_dbt.mart_fraud_by_state: BEGIN
[0m14:12:27.631032 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:12:27.631249 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:12:27.631661 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:27.640801 [debug] [Thread-4 (]: SQL status: OK in 0.010 seconds
[0m14:12:27.641069 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m14:12:27.641262 [debug] [Thread-3 (]: SQL status: OK in 0.011 seconds
[0m14:12:27.641427 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m14:12:27.641640 [debug] [Thread-4 (]: Using duckdb connection "model.hw4_dbt.mart_daily_state_metrics"
[0m14:12:27.641855 [debug] [Thread-2 (]: Using duckdb connection "model.hw4_dbt.mart_fraud_by_category"
[0m14:12:27.642117 [debug] [Thread-3 (]: Using duckdb connection "model.hw4_dbt.mart_customer_risk_profile"
[0m14:12:27.642443 [debug] [Thread-1 (]: Using duckdb connection "model.hw4_dbt.mart_fraud_by_state"
[0m14:12:27.642810 [debug] [Thread-4 (]: On model.hw4_dbt.mart_daily_state_metrics: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "model.hw4_dbt.mart_daily_state_metrics"} */

  
    
    

    create  table
      transactions.main_marts.mart_daily_state_metrics__dbt_tmp
  
    as (
      with base as (
    select
        transaction_date,
        us_state,
        amount,
        amount_bucket,
        is_fraud
    from transactions.main_staging.stg_transactions
),
agg as (
    select
        transaction_date,
        us_state,
        count(*) as transaction_count,
        sum(amount) as total_amount,
        avg(amount) as avg_amount,
        percentile_cont(0.95) within group (order by amount) as p95_amount,
        sum(case when amount_bucket in ('large', 'extra_large') then 1 else 0 end) as large_txn_count,
        sum(is_fraud) as fraud_count,
        sum(case when is_fraud = 1 then amount else 0 end) as fraud_amount
    from base
    group by transaction_date, us_state
)
select
    transaction_date,
    us_state,
    transaction_count,
    total_amount,
    avg_amount,
    p95_amount,
    large_txn_count,
    case when transaction_count = 0 then 0 else large_txn_count * 1.0 / transaction_count end as large_txn_share,
    fraud_count,
    fraud_amount,
    case when transaction_count = 0 then 0 else fraud_count * 1.0 / transaction_count end as fraud_rate
from agg
    );
  
  
[0m14:12:27.643237 [debug] [Thread-2 (]: On model.hw4_dbt.mart_fraud_by_category: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "model.hw4_dbt.mart_fraud_by_category"} */

  
    
    

    create  table
      transactions.main_marts.mart_fraud_by_category__dbt_tmp
  
    as (
      with base as (
    select
        cat_id,
        amount,
        is_fraud
    from transactions.main_staging.stg_transactions
),
agg as (
    select
        cat_id,
        count(*) as transaction_count,
        sum(is_fraud) as fraud_count,
        sum(amount) as total_amount,
        sum(case when is_fraud = 1 then amount else 0 end) as fraud_amount,
        avg(amount) as avg_amount
    from base
    group by cat_id
)
select
    cat_id,
    transaction_count,
    fraud_count,
    case when transaction_count = 0 then 0 else fraud_count * 100.0 / transaction_count end as fraud_rate,
    total_amount,
    fraud_amount,
    avg_amount
from agg
order by fraud_rate desc
    );
  
  
[0m14:12:27.643596 [debug] [Thread-3 (]: On model.hw4_dbt.mart_customer_risk_profile: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "model.hw4_dbt.mart_customer_risk_profile"} */

  
    
    

    create  table
      transactions.main_marts.mart_customer_risk_profile__dbt_tmp
  
    as (
      with base as (
    select
        customer_id,
        customer_full_name,
        us_state,
        amount,
        amount_bucket,
        is_fraud,
        merchant_id,
        transaction_date
    from transactions.main_staging.stg_transactions
),
agg as (
    select
        customer_id,
        max(customer_full_name) as customer_full_name,
        max(us_state) as home_state,
        count(*) as transaction_count,
        sum(is_fraud) as fraud_count,
        case when count(*) = 0 then 0 else sum(is_fraud) * 100.0 / count(*) end as fraud_rate,
        sum(amount) as total_amount,
        avg(amount) as avg_amount,
        max(transaction_date) as last_transaction_date,
        sum(case when amount_bucket in ('large', 'extra_large') then 1 else 0 end) as large_txn_count,
        count(distinct merchant_id) as merchant_diversity
    from base
    group by customer_id
),
scored as (
    select
        *,
        case when transaction_count = 0 then 0 else large_txn_count * 1.0 / transaction_count end as large_txn_share
    from agg
),
final as (
    select
        customer_id,
        customer_full_name,
        home_state,
        transaction_count,
        fraud_count,
        fraud_rate,
        total_amount,
        avg_amount,
        last_transaction_date,
        large_txn_share,
        merchant_diversity,
        case
            when fraud_rate >= 5 or large_txn_share >= 0.4 then 'HIGH'
            when fraud_rate >= 2 or large_txn_share >= 0.2 then 'MEDIUM'
            else 'LOW'
        end as risk_level
    from scored
)
select * from final
    );
  
  
[0m14:12:27.643962 [debug] [Thread-1 (]: On model.hw4_dbt.mart_fraud_by_state: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "model.hw4_dbt.mart_fraud_by_state"} */

  
    
    

    create  table
      transactions.main_marts.mart_fraud_by_state__dbt_tmp
  
    as (
      with base as (
    select
        us_state,
        amount,
        is_fraud,
        customer_id,
        merchant_id
    from transactions.main_staging.stg_transactions
),
agg as (
    select
        us_state,
        count(*) as transaction_count,
        count(distinct customer_id) as unique_customers,
        count(distinct merchant_id) as unique_merchants,
        sum(is_fraud) as fraud_count,
        sum(amount) as total_amount,
        sum(case when is_fraud = 1 then amount else 0 end) as fraud_amount,
        avg(amount) as avg_amount
    from base
    group by us_state
)
select
    us_state,
    transaction_count,
    unique_customers,
    unique_merchants,
    total_amount,
    fraud_amount,
    avg_amount,
    fraud_count,
    case when transaction_count = 0 then 0 else fraud_count * 100.0 / transaction_count end as fraud_rate
from agg
order by fraud_rate desc
    );
  
  
[0m14:12:27.768999 [debug] [Thread-2 (]: SQL status: OK in 0.121 seconds
[0m14:12:27.779317 [debug] [Thread-2 (]: Using duckdb connection "model.hw4_dbt.mart_fraud_by_category"
[0m14:12:27.780421 [debug] [Thread-2 (]: On model.hw4_dbt.mart_fraud_by_category: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "model.hw4_dbt.mart_fraud_by_category"} */
alter table "transactions"."main_marts"."mart_fraud_by_category" rename to mart_fraud_by_category__dbt_backup
[0m14:12:27.783650 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m14:12:27.788087 [debug] [Thread-2 (]: Using duckdb connection "model.hw4_dbt.mart_fraud_by_category"
[0m14:12:27.788428 [debug] [Thread-2 (]: On model.hw4_dbt.mart_fraud_by_category: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "model.hw4_dbt.mart_fraud_by_category"} */
alter table transactions.main_marts.mart_fraud_by_category__dbt_tmp rename to mart_fraud_by_category
[0m14:12:27.788922 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m14:12:27.795037 [debug] [Thread-2 (]: On model.hw4_dbt.mart_fraud_by_category: COMMIT
[0m14:12:27.796089 [debug] [Thread-2 (]: Using duckdb connection "model.hw4_dbt.mart_fraud_by_category"
[0m14:12:27.796440 [debug] [Thread-2 (]: On model.hw4_dbt.mart_fraud_by_category: COMMIT
[0m14:12:27.806391 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m14:12:27.811214 [debug] [Thread-2 (]: Using duckdb connection "model.hw4_dbt.mart_fraud_by_category"
[0m14:12:27.811950 [debug] [Thread-2 (]: On model.hw4_dbt.mart_fraud_by_category: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "model.hw4_dbt.mart_fraud_by_category"} */
drop table if exists transactions.main_marts.mart_fraud_by_category__dbt_backup cascade
[0m14:12:27.812617 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m14:12:27.815234 [debug] [Thread-2 (]: On model.hw4_dbt.mart_fraud_by_category: Close
[0m14:12:27.815906 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6f45c1c-ce2e-4539-a089-6d90a1c4add5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119391d0>]}
[0m14:12:27.816412 [info ] [Thread-2 (]: 4 of 7 OK created sql table model main_marts.mart_fraud_by_category ............ [[32mOK[0m in 0.23s]
[0m14:12:27.816772 [debug] [Thread-2 (]: Finished running node model.hw4_dbt.mart_fraud_by_category
[0m14:12:27.817039 [debug] [Thread-2 (]: Began running node model.hw4_dbt.mart_hourly_fraud_pattern
[0m14:12:27.817425 [info ] [Thread-2 (]: 6 of 7 START sql table model main_marts.mart_hourly_fraud_pattern .............. [RUN]
[0m14:12:27.817743 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.hw4_dbt.mart_fraud_by_category, now model.hw4_dbt.mart_hourly_fraud_pattern)
[0m14:12:27.819927 [debug] [Thread-2 (]: Began compiling node model.hw4_dbt.mart_hourly_fraud_pattern
[0m14:12:27.824334 [debug] [Thread-2 (]: Writing injected SQL for node "model.hw4_dbt.mart_hourly_fraud_pattern"
[0m14:12:27.835315 [debug] [Thread-2 (]: Began executing node model.hw4_dbt.mart_hourly_fraud_pattern
[0m14:12:27.837640 [debug] [Thread-2 (]: Writing runtime sql for node "model.hw4_dbt.mart_hourly_fraud_pattern"
[0m14:12:27.839012 [debug] [Thread-2 (]: Using duckdb connection "model.hw4_dbt.mart_hourly_fraud_pattern"
[0m14:12:27.839291 [debug] [Thread-2 (]: On model.hw4_dbt.mart_hourly_fraud_pattern: BEGIN
[0m14:12:27.841747 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:12:27.842337 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m14:12:27.842534 [debug] [Thread-2 (]: Using duckdb connection "model.hw4_dbt.mart_hourly_fraud_pattern"
[0m14:12:27.842733 [debug] [Thread-2 (]: On model.hw4_dbt.mart_hourly_fraud_pattern: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "model.hw4_dbt.mart_hourly_fraud_pattern"} */

  
    
    

    create  table
      transactions.main_marts.mart_hourly_fraud_pattern__dbt_tmp
  
    as (
      with base as (
    select
        day_name,
        transaction_hour,
        amount,
        is_fraud
    from transactions.main_staging.stg_transactions
),
bucketed as (
    select
        day_name,
        extract(hour from transaction_hour) as hour_of_day,
        amount,
        is_fraud
    from base
)
select
    day_name,
    hour_of_day,
    count(*) as transaction_count,
    sum(is_fraud) as fraud_count,
    case when count(*) = 0 then 0 else sum(is_fraud) * 100.0 / count(*) end as fraud_rate,
    avg(amount) as avg_amount,
    percentile_cont(0.95) within group (order by amount) as p95_amount
from bucketed
group by day_name, hour_of_day
order by fraud_rate desc
    );
  
  
[0m14:12:27.980132 [debug] [Thread-4 (]: SQL status: OK in 0.336 seconds
[0m14:12:27.983915 [debug] [Thread-4 (]: Using duckdb connection "model.hw4_dbt.mart_daily_state_metrics"
[0m14:12:27.984702 [debug] [Thread-4 (]: On model.hw4_dbt.mart_daily_state_metrics: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "model.hw4_dbt.mart_daily_state_metrics"} */
alter table "transactions"."main_marts"."mart_daily_state_metrics" rename to mart_daily_state_metrics__dbt_backup
[0m14:12:27.986125 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:12:27.988139 [debug] [Thread-4 (]: Using duckdb connection "model.hw4_dbt.mart_daily_state_metrics"
[0m14:12:27.988516 [debug] [Thread-4 (]: On model.hw4_dbt.mart_daily_state_metrics: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "model.hw4_dbt.mart_daily_state_metrics"} */
alter table transactions.main_marts.mart_daily_state_metrics__dbt_tmp rename to mart_daily_state_metrics
[0m14:12:27.990242 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m14:12:27.991041 [debug] [Thread-4 (]: On model.hw4_dbt.mart_daily_state_metrics: COMMIT
[0m14:12:27.991232 [debug] [Thread-4 (]: Using duckdb connection "model.hw4_dbt.mart_daily_state_metrics"
[0m14:12:27.991397 [debug] [Thread-4 (]: On model.hw4_dbt.mart_daily_state_metrics: COMMIT
[0m14:12:28.001683 [debug] [Thread-4 (]: SQL status: OK in 0.010 seconds
[0m14:12:28.007215 [debug] [Thread-4 (]: Using duckdb connection "model.hw4_dbt.mart_daily_state_metrics"
[0m14:12:28.007865 [debug] [Thread-4 (]: On model.hw4_dbt.mart_daily_state_metrics: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "model.hw4_dbt.mart_daily_state_metrics"} */
drop table if exists transactions.main_marts.mart_daily_state_metrics__dbt_backup cascade
[0m14:12:28.008572 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m14:12:28.010018 [debug] [Thread-4 (]: On model.hw4_dbt.mart_daily_state_metrics: Close
[0m14:12:28.010356 [debug] [Thread-2 (]: SQL status: OK in 0.167 seconds
[0m14:12:28.011336 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6f45c1c-ce2e-4539-a089-6d90a1c4add5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b71410>]}
[0m14:12:28.013485 [debug] [Thread-2 (]: Using duckdb connection "model.hw4_dbt.mart_hourly_fraud_pattern"
[0m14:12:28.015476 [info ] [Thread-4 (]: 3 of 7 OK created sql table model main_marts.mart_daily_state_metrics .......... [[32mOK[0m in 0.42s]
[0m14:12:28.016517 [debug] [Thread-2 (]: On model.hw4_dbt.mart_hourly_fraud_pattern: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "model.hw4_dbt.mart_hourly_fraud_pattern"} */
alter table "transactions"."main_marts"."mart_hourly_fraud_pattern" rename to mart_hourly_fraud_pattern__dbt_backup
[0m14:12:28.017110 [debug] [Thread-4 (]: Finished running node model.hw4_dbt.mart_daily_state_metrics
[0m14:12:28.019747 [debug] [Thread-4 (]: Began running node model.hw4_dbt.mart_merchant_analytics
[0m14:12:28.020230 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:12:28.020545 [info ] [Thread-4 (]: 7 of 7 START sql table model main_marts.mart_merchant_analytics ................ [RUN]
[0m14:12:28.024458 [debug] [Thread-2 (]: Using duckdb connection "model.hw4_dbt.mart_hourly_fraud_pattern"
[0m14:12:28.028383 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.hw4_dbt.mart_daily_state_metrics, now model.hw4_dbt.mart_merchant_analytics)
[0m14:12:28.030862 [debug] [Thread-2 (]: On model.hw4_dbt.mart_hourly_fraud_pattern: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "model.hw4_dbt.mart_hourly_fraud_pattern"} */
alter table transactions.main_marts.mart_hourly_fraud_pattern__dbt_tmp rename to mart_hourly_fraud_pattern
[0m14:12:28.031335 [debug] [Thread-4 (]: Began compiling node model.hw4_dbt.mart_merchant_analytics
[0m14:12:28.034254 [debug] [Thread-4 (]: Writing injected SQL for node "model.hw4_dbt.mart_merchant_analytics"
[0m14:12:28.035941 [debug] [Thread-4 (]: Began executing node model.hw4_dbt.mart_merchant_analytics
[0m14:12:28.039341 [debug] [Thread-4 (]: Writing runtime sql for node "model.hw4_dbt.mart_merchant_analytics"
[0m14:12:28.040745 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m14:12:28.041355 [debug] [Thread-4 (]: Using duckdb connection "model.hw4_dbt.mart_merchant_analytics"
[0m14:12:28.042261 [debug] [Thread-2 (]: On model.hw4_dbt.mart_hourly_fraud_pattern: COMMIT
[0m14:12:28.042552 [debug] [Thread-4 (]: On model.hw4_dbt.mart_merchant_analytics: BEGIN
[0m14:12:28.042809 [debug] [Thread-2 (]: Using duckdb connection "model.hw4_dbt.mart_hourly_fraud_pattern"
[0m14:12:28.043115 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:12:28.043291 [debug] [Thread-3 (]: SQL status: OK in 0.398 seconds
[0m14:12:28.044215 [debug] [Thread-2 (]: On model.hw4_dbt.mart_hourly_fraud_pattern: COMMIT
[0m14:12:28.046438 [debug] [Thread-3 (]: Using duckdb connection "model.hw4_dbt.mart_customer_risk_profile"
[0m14:12:28.046715 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m14:12:28.047128 [debug] [Thread-3 (]: On model.hw4_dbt.mart_customer_risk_profile: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "model.hw4_dbt.mart_customer_risk_profile"} */
alter table "transactions"."main_marts"."mart_customer_risk_profile" rename to mart_customer_risk_profile__dbt_backup
[0m14:12:28.048886 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m14:12:28.047789 [debug] [Thread-4 (]: Using duckdb connection "model.hw4_dbt.mart_merchant_analytics"
[0m14:12:28.054013 [debug] [Thread-3 (]: Using duckdb connection "model.hw4_dbt.mart_customer_risk_profile"
[0m14:12:28.054524 [debug] [Thread-4 (]: On model.hw4_dbt.mart_merchant_analytics: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "model.hw4_dbt.mart_merchant_analytics"} */

  
    
    

    create  table
      transactions.main_marts.mart_merchant_analytics__dbt_tmp
  
    as (
      with base as (
    select
        merchant_id,
        merchant_name,
        us_state,
        amount,
        amount_bucket,
        is_fraud,
        customer_id
    from transactions.main_staging.stg_transactions
),
state_pref as (
    select
        merchant_id,
        us_state,
        count(*) as txn_count,
        row_number() over (partition by merchant_id order by count(*) desc) as rn
    from base
    group by merchant_id, us_state
),
primary_state as (
    select merchant_id, us_state as primary_state from state_pref where rn = 1
),
agg as (
    select
        merchant_id,
        max(merchant_name) as merchant_name,
        count(*) as transaction_count,
        sum(is_fraud) as fraud_count,
        sum(amount) as total_amount,
        avg(amount) as avg_amount,
        sum(case when amount_bucket in ('large', 'extra_large') then 1 else 0 end) as large_txn_count,
        count(distinct customer_id) as unique_customers
    from base
    group by merchant_id
),
scored as (
    select
        a.merchant_id,
        a.merchant_name,
        coalesce(p.primary_state, 'NA') as primary_state,
        a.transaction_count,
        a.total_amount,
        a.avg_amount,
        a.fraud_count,
        a.large_txn_count,
        a.unique_customers,
        case when a.transaction_count = 0 then 0 else a.fraud_count * 100.0 / a.transaction_count end as fraud_rate,
        case when a.transaction_count = 0 then 0 else a.large_txn_count * 1.0 / a.transaction_count end as large_txn_share
    from agg a
    left join primary_state p on a.merchant_id = p.merchant_id
)
select
    *,
    case when fraud_rate >= 5 or large_txn_share >= 0.4 then 1 else 0 end as suspicious_flag
from scored
order by fraud_rate desc
    );
  
  
[0m14:12:28.054856 [debug] [Thread-3 (]: On model.hw4_dbt.mart_customer_risk_profile: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "model.hw4_dbt.mart_customer_risk_profile"} */
alter table transactions.main_marts.mart_customer_risk_profile__dbt_tmp rename to mart_customer_risk_profile
[0m14:12:28.055359 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m14:12:28.056053 [debug] [Thread-1 (]: SQL status: OK in 0.411 seconds
[0m14:12:28.058774 [debug] [Thread-2 (]: Using duckdb connection "model.hw4_dbt.mart_hourly_fraud_pattern"
[0m14:12:28.059083 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:12:28.062557 [debug] [Thread-1 (]: Using duckdb connection "model.hw4_dbt.mart_fraud_by_state"
[0m14:12:28.082347 [debug] [Thread-1 (]: On model.hw4_dbt.mart_fraud_by_state: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "model.hw4_dbt.mart_fraud_by_state"} */
alter table "transactions"."main_marts"."mart_fraud_by_state" rename to mart_fraud_by_state__dbt_backup
[0m14:12:28.083016 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:12:28.079953 [debug] [Thread-3 (]: On model.hw4_dbt.mart_customer_risk_profile: COMMIT
[0m14:12:28.085221 [debug] [Thread-1 (]: Using duckdb connection "model.hw4_dbt.mart_fraud_by_state"
[0m14:12:28.086775 [debug] [Thread-1 (]: On model.hw4_dbt.mart_fraud_by_state: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "model.hw4_dbt.mart_fraud_by_state"} */
alter table transactions.main_marts.mart_fraud_by_state__dbt_tmp rename to mart_fraud_by_state
[0m14:12:28.086112 [debug] [Thread-3 (]: Using duckdb connection "model.hw4_dbt.mart_customer_risk_profile"
[0m14:12:28.088060 [debug] [Thread-3 (]: On model.hw4_dbt.mart_customer_risk_profile: COMMIT
[0m14:12:28.087312 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:12:28.077757 [debug] [Thread-2 (]: On model.hw4_dbt.mart_hourly_fraud_pattern: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "model.hw4_dbt.mart_hourly_fraud_pattern"} */
drop table if exists transactions.main_marts.mart_hourly_fraud_pattern__dbt_backup cascade
[0m14:12:28.089648 [debug] [Thread-1 (]: On model.hw4_dbt.mart_fraud_by_state: COMMIT
[0m14:12:28.091111 [debug] [Thread-1 (]: Using duckdb connection "model.hw4_dbt.mart_fraud_by_state"
[0m14:12:28.091414 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m14:12:28.091776 [debug] [Thread-1 (]: On model.hw4_dbt.mart_fraud_by_state: COMMIT
[0m14:12:28.091942 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m14:12:28.095154 [debug] [Thread-3 (]: Using duckdb connection "model.hw4_dbt.mart_customer_risk_profile"
[0m14:12:28.097142 [debug] [Thread-2 (]: On model.hw4_dbt.mart_hourly_fraud_pattern: Close
[0m14:12:28.098467 [debug] [Thread-3 (]: On model.hw4_dbt.mart_customer_risk_profile: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "model.hw4_dbt.mart_customer_risk_profile"} */
drop table if exists transactions.main_marts.mart_customer_risk_profile__dbt_backup cascade
[0m14:12:28.098994 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:12:28.100024 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6f45c1c-ce2e-4539-a089-6d90a1c4add5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111922d90>]}
[0m14:12:28.103908 [debug] [Thread-1 (]: Using duckdb connection "model.hw4_dbt.mart_fraud_by_state"
[0m14:12:28.106472 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m14:12:28.107197 [info ] [Thread-2 (]: 6 of 7 OK created sql table model main_marts.mart_hourly_fraud_pattern ......... [[32mOK[0m in 0.28s]
[0m14:12:28.108623 [debug] [Thread-1 (]: On model.hw4_dbt.mart_fraud_by_state: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "model.hw4_dbt.mart_fraud_by_state"} */
drop table if exists transactions.main_marts.mart_fraud_by_state__dbt_backup cascade
[0m14:12:28.110357 [debug] [Thread-3 (]: On model.hw4_dbt.mart_customer_risk_profile: Close
[0m14:12:28.112139 [debug] [Thread-2 (]: Finished running node model.hw4_dbt.mart_hourly_fraud_pattern
[0m14:12:28.113468 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:12:28.114519 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6f45c1c-ce2e-4539-a089-6d90a1c4add5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11173a090>]}
[0m14:12:28.121050 [debug] [Thread-1 (]: On model.hw4_dbt.mart_fraud_by_state: Close
[0m14:12:28.123551 [info ] [Thread-3 (]: 2 of 7 OK created sql table model main_marts.mart_customer_risk_profile ........ [[32mOK[0m in 0.53s]
[0m14:12:28.125603 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6f45c1c-ce2e-4539-a089-6d90a1c4add5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117386d0>]}
[0m14:12:28.126183 [debug] [Thread-3 (]: Finished running node model.hw4_dbt.mart_customer_risk_profile
[0m14:12:28.127122 [info ] [Thread-1 (]: 5 of 7 OK created sql table model main_marts.mart_fraud_by_state ............... [[32mOK[0m in 0.54s]
[0m14:12:28.128053 [debug] [Thread-1 (]: Finished running node model.hw4_dbt.mart_fraud_by_state
[0m14:12:28.261901 [debug] [Thread-4 (]: SQL status: OK in 0.205 seconds
[0m14:12:28.264403 [debug] [Thread-4 (]: Using duckdb connection "model.hw4_dbt.mart_merchant_analytics"
[0m14:12:28.265222 [debug] [Thread-4 (]: On model.hw4_dbt.mart_merchant_analytics: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "model.hw4_dbt.mart_merchant_analytics"} */
alter table "transactions"."main_marts"."mart_merchant_analytics" rename to mart_merchant_analytics__dbt_backup
[0m14:12:28.265933 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m14:12:28.268231 [debug] [Thread-4 (]: Using duckdb connection "model.hw4_dbt.mart_merchant_analytics"
[0m14:12:28.268977 [debug] [Thread-4 (]: On model.hw4_dbt.mart_merchant_analytics: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "model.hw4_dbt.mart_merchant_analytics"} */
alter table transactions.main_marts.mart_merchant_analytics__dbt_tmp rename to mart_merchant_analytics
[0m14:12:28.270114 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m14:12:28.270959 [debug] [Thread-4 (]: On model.hw4_dbt.mart_merchant_analytics: COMMIT
[0m14:12:28.271852 [debug] [Thread-4 (]: Using duckdb connection "model.hw4_dbt.mart_merchant_analytics"
[0m14:12:28.272120 [debug] [Thread-4 (]: On model.hw4_dbt.mart_merchant_analytics: COMMIT
[0m14:12:28.273928 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:12:28.275417 [debug] [Thread-4 (]: Using duckdb connection "model.hw4_dbt.mart_merchant_analytics"
[0m14:12:28.275604 [debug] [Thread-4 (]: On model.hw4_dbt.mart_merchant_analytics: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "model.hw4_dbt.mart_merchant_analytics"} */
drop table if exists transactions.main_marts.mart_merchant_analytics__dbt_backup cascade
[0m14:12:28.276397 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:12:28.278195 [debug] [Thread-4 (]: On model.hw4_dbt.mart_merchant_analytics: Close
[0m14:12:28.327949 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6f45c1c-ce2e-4539-a089-6d90a1c4add5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f19f10>]}
[0m14:12:28.328425 [info ] [Thread-4 (]: 7 of 7 OK created sql table model main_marts.mart_merchant_analytics ........... [[32mOK[0m in 0.30s]
[0m14:12:28.328717 [debug] [Thread-4 (]: Finished running node model.hw4_dbt.mart_merchant_analytics
[0m14:12:28.329987 [debug] [MainThread]: Using duckdb connection "master"
[0m14:12:28.330484 [debug] [MainThread]: On master: BEGIN
[0m14:12:28.330737 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:12:28.340095 [debug] [MainThread]: SQL status: OK in 0.009 seconds
[0m14:12:28.340427 [debug] [MainThread]: On master: COMMIT
[0m14:12:28.340592 [debug] [MainThread]: Using duckdb connection "master"
[0m14:12:28.340743 [debug] [MainThread]: On master: COMMIT
[0m14:12:28.341039 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:12:28.341196 [debug] [MainThread]: On master: Close
[0m14:12:28.342663 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:12:28.343881 [debug] [MainThread]: Connection 'model.hw4_dbt.mart_fraud_by_state' was properly closed.
[0m14:12:28.344116 [debug] [MainThread]: Connection 'model.hw4_dbt.mart_hourly_fraud_pattern' was properly closed.
[0m14:12:28.344278 [debug] [MainThread]: Connection 'model.hw4_dbt.mart_customer_risk_profile' was properly closed.
[0m14:12:28.344414 [debug] [MainThread]: Connection 'model.hw4_dbt.mart_merchant_analytics' was properly closed.
[0m14:12:28.344649 [info ] [MainThread]: 
[0m14:12:28.344966 [info ] [MainThread]: Finished running 1 view model, 6 table models in 0 hours 0 minutes and 0.99 seconds (0.99s).
[0m14:12:28.345846 [debug] [MainThread]: Command end result
[0m14:12:28.379730 [info ] [MainThread]: 
[0m14:12:28.380019 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:12:28.380181 [info ] [MainThread]: 
[0m14:12:28.380716 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m14:12:28.382880 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.543035, "process_user_time": 3.467014, "process_kernel_time": 0.508186, "process_mem_max_rss": "700350464", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:12:28.383217 [debug] [MainThread]: Command `dbt run` succeeded at 14:12:28.383169 after 1.54 seconds
[0m14:12:28.383444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e05090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11070fd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110502410>]}
[0m14:12:28.383657 [debug] [MainThread]: Flushing usage events
[0m14:12:36.367038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f1f7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f81490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b82c90>]}


============================== 14:12:36.370783 | d5e43c31-9be2-4ea5-8aca-ff1db18e4ca5 ==============================
[0m14:12:36.370783 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:12:36.371257 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/roman/Desktop/hw4-mlops-bokhyan/dbt/logs', 'debug': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:12:36.509541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5e43c31-9be2-4ea5-8aca-ff1db18e4ca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f42690>]}
[0m14:12:36.545479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd5e43c31-9be2-4ea5-8aca-ff1db18e4ca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112416fd0>]}
[0m14:12:36.546129 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m14:12:36.608382 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m14:12:36.703541 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:12:36.703845 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:12:36.735512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd5e43c31-9be2-4ea5-8aca-ff1db18e4ca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112480650>]}
[0m14:12:36.818697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd5e43c31-9be2-4ea5-8aca-ff1db18e4ca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112604650>]}
[0m14:12:36.819092 [info ] [MainThread]: Found 2 seeds, 7 models, 56 data tests, 1 source, 805 macros
[0m14:12:36.819295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5e43c31-9be2-4ea5-8aca-ff1db18e4ca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fcb290>]}
[0m14:12:36.859118 [info ] [MainThread]: 
[0m14:12:36.859573 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:12:36.862437 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_transactions_main_marts'
[0m14:12:36.862862 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_transactions_main_transactions_db'
[0m14:12:36.863233 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_transactions_main_staging'
[0m14:12:36.898495 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_marts"
[0m14:12:36.898828 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_transactions_db"
[0m14:12:36.899101 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_staging"
[0m14:12:36.899704 [debug] [ThreadPool]: On list_transactions_main_marts: BEGIN
[0m14:12:36.899873 [debug] [ThreadPool]: On list_transactions_main_transactions_db: BEGIN
[0m14:12:36.900020 [debug] [ThreadPool]: On list_transactions_main_staging: BEGIN
[0m14:12:36.900156 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:36.900288 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:36.900420 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:36.910521 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m14:12:36.910830 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m14:12:36.911025 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m14:12:36.911165 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_transactions_db"
[0m14:12:36.911348 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_staging"
[0m14:12:36.911491 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_marts"
[0m14:12:36.911663 [debug] [ThreadPool]: On list_transactions_main_transactions_db: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "connection_name": "list_transactions_main_transactions_db"} */
select
      'transactions' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_transactions_db'
    and table_catalog = 'transactions'
  
[0m14:12:36.911832 [debug] [ThreadPool]: On list_transactions_main_staging: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "connection_name": "list_transactions_main_staging"} */
select
      'transactions' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_staging'
    and table_catalog = 'transactions'
  
[0m14:12:36.911999 [debug] [ThreadPool]: On list_transactions_main_marts: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "connection_name": "list_transactions_main_marts"} */
select
      'transactions' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_marts'
    and table_catalog = 'transactions'
  
[0m14:12:36.921412 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m14:12:36.921739 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m14:12:36.921939 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m14:12:36.922928 [debug] [ThreadPool]: On list_transactions_main_marts: ROLLBACK
[0m14:12:36.923515 [debug] [ThreadPool]: On list_transactions_main_staging: ROLLBACK
[0m14:12:36.924337 [debug] [ThreadPool]: On list_transactions_main_transactions_db: ROLLBACK
[0m14:12:36.924987 [debug] [ThreadPool]: Failed to rollback 'list_transactions_main_staging'
[0m14:12:36.925193 [debug] [ThreadPool]: Failed to rollback 'list_transactions_main_transactions_db'
[0m14:12:36.925490 [debug] [ThreadPool]: Failed to rollback 'list_transactions_main_marts'
[0m14:12:36.925666 [debug] [ThreadPool]: On list_transactions_main_staging: Close
[0m14:12:36.925809 [debug] [ThreadPool]: On list_transactions_main_transactions_db: Close
[0m14:12:36.925942 [debug] [ThreadPool]: On list_transactions_main_marts: Close
[0m14:12:36.928870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5e43c31-9be2-4ea5-8aca-ff1db18e4ca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061fd790>]}
[0m14:12:36.929314 [debug] [MainThread]: Using duckdb connection "master"
[0m14:12:36.929472 [debug] [MainThread]: On master: BEGIN
[0m14:12:36.929607 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:12:36.937679 [debug] [MainThread]: SQL status: OK in 0.008 seconds
[0m14:12:36.938036 [debug] [MainThread]: On master: COMMIT
[0m14:12:36.938290 [debug] [MainThread]: Using duckdb connection "master"
[0m14:12:36.938441 [debug] [MainThread]: On master: COMMIT
[0m14:12:36.938701 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:12:36.938856 [debug] [MainThread]: On master: Close
[0m14:12:36.940256 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:12:36.940496 [info ] [MainThread]: 
[0m14:12:36.942694 [debug] [Thread-1 (]: Began running node test.hw4_dbt.accepted_values_mart_customer_risk_profile_risk_level__HIGH__MEDIUM__LOW.95fabd3536
[0m14:12:36.942956 [debug] [Thread-2 (]: Began running node test.hw4_dbt.accepted_values_mart_merchant_analytics_suspicious_flag__0__1.221ef94aff
[0m14:12:36.943385 [debug] [Thread-3 (]: Began running node test.hw4_dbt.accepted_values_stg_transactions_amount_bucket__small__medium__large__extra_large__unknown.f09a27d70f
[0m14:12:36.943767 [debug] [Thread-4 (]: Began running node test.hw4_dbt.accepted_values_stg_transactions_gender__M__F__U.ae8f0c87a0
[0m14:12:36.944267 [info ] [Thread-1 (]: 1 of 56 START test accepted_values_mart_customer_risk_profile_risk_level__HIGH__MEDIUM__LOW  [RUN]
[0m14:12:36.944628 [info ] [Thread-2 (]: 2 of 56 START test accepted_values_mart_merchant_analytics_suspicious_flag__0__1  [RUN]
[0m14:12:36.945130 [info ] [Thread-3 (]: 3 of 56 START test accepted_values_stg_transactions_amount_bucket__small__medium__large__extra_large__unknown  [RUN]
[0m14:12:36.945847 [info ] [Thread-4 (]: 4 of 56 START test accepted_values_stg_transactions_gender__M__F__U ............ [RUN]
[0m14:12:36.946212 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_transactions_main_marts, now test.hw4_dbt.accepted_values_mart_customer_risk_profile_risk_level__HIGH__MEDIUM__LOW.95fabd3536)
[0m14:12:36.946473 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_transactions_main_transactions_db, now test.hw4_dbt.accepted_values_mart_merchant_analytics_suspicious_flag__0__1.221ef94aff)
[0m14:12:36.946666 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_transactions_main_staging, now test.hw4_dbt.accepted_values_stg_transactions_amount_bucket__small__medium__large__extra_large__unknown.f09a27d70f)
[0m14:12:36.946907 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.hw4_dbt.accepted_values_stg_transactions_gender__M__F__U.ae8f0c87a0'
[0m14:12:36.947109 [debug] [Thread-1 (]: Began compiling node test.hw4_dbt.accepted_values_mart_customer_risk_profile_risk_level__HIGH__MEDIUM__LOW.95fabd3536
[0m14:12:36.947274 [debug] [Thread-2 (]: Began compiling node test.hw4_dbt.accepted_values_mart_merchant_analytics_suspicious_flag__0__1.221ef94aff
[0m14:12:36.947497 [debug] [Thread-3 (]: Began compiling node test.hw4_dbt.accepted_values_stg_transactions_amount_bucket__small__medium__large__extra_large__unknown.f09a27d70f
[0m14:12:36.947674 [debug] [Thread-4 (]: Began compiling node test.hw4_dbt.accepted_values_stg_transactions_gender__M__F__U.ae8f0c87a0
[0m14:12:36.957985 [debug] [Thread-1 (]: Writing injected SQL for node "test.hw4_dbt.accepted_values_mart_customer_risk_profile_risk_level__HIGH__MEDIUM__LOW.95fabd3536"
[0m14:12:36.960388 [debug] [Thread-2 (]: Writing injected SQL for node "test.hw4_dbt.accepted_values_mart_merchant_analytics_suspicious_flag__0__1.221ef94aff"
[0m14:12:36.963847 [debug] [Thread-3 (]: Writing injected SQL for node "test.hw4_dbt.accepted_values_stg_transactions_amount_bucket__small__medium__large__extra_large__unknown.f09a27d70f"
[0m14:12:36.967411 [debug] [Thread-4 (]: Writing injected SQL for node "test.hw4_dbt.accepted_values_stg_transactions_gender__M__F__U.ae8f0c87a0"
[0m14:12:36.968136 [debug] [Thread-1 (]: Began executing node test.hw4_dbt.accepted_values_mart_customer_risk_profile_risk_level__HIGH__MEDIUM__LOW.95fabd3536
[0m14:12:36.968317 [debug] [Thread-2 (]: Began executing node test.hw4_dbt.accepted_values_mart_merchant_analytics_suspicious_flag__0__1.221ef94aff
[0m14:12:36.977292 [debug] [Thread-1 (]: Writing runtime sql for node "test.hw4_dbt.accepted_values_mart_customer_risk_profile_risk_level__HIGH__MEDIUM__LOW.95fabd3536"
[0m14:12:36.978901 [debug] [Thread-2 (]: Writing runtime sql for node "test.hw4_dbt.accepted_values_mart_merchant_analytics_suspicious_flag__0__1.221ef94aff"
[0m14:12:36.979361 [debug] [Thread-3 (]: Began executing node test.hw4_dbt.accepted_values_stg_transactions_amount_bucket__small__medium__large__extra_large__unknown.f09a27d70f
[0m14:12:36.979630 [debug] [Thread-4 (]: Began executing node test.hw4_dbt.accepted_values_stg_transactions_gender__M__F__U.ae8f0c87a0
[0m14:12:36.982263 [debug] [Thread-3 (]: Writing runtime sql for node "test.hw4_dbt.accepted_values_stg_transactions_amount_bucket__small__medium__large__extra_large__unknown.f09a27d70f"
[0m14:12:36.983783 [debug] [Thread-4 (]: Writing runtime sql for node "test.hw4_dbt.accepted_values_stg_transactions_gender__M__F__U.ae8f0c87a0"
[0m14:12:36.984081 [debug] [Thread-1 (]: Using duckdb connection "test.hw4_dbt.accepted_values_mart_customer_risk_profile_risk_level__HIGH__MEDIUM__LOW.95fabd3536"
[0m14:12:36.984485 [debug] [Thread-2 (]: Using duckdb connection "test.hw4_dbt.accepted_values_mart_merchant_analytics_suspicious_flag__0__1.221ef94aff"
[0m14:12:36.984852 [debug] [Thread-3 (]: Using duckdb connection "test.hw4_dbt.accepted_values_stg_transactions_amount_bucket__small__medium__large__extra_large__unknown.f09a27d70f"
[0m14:12:36.985258 [debug] [Thread-1 (]: On test.hw4_dbt.accepted_values_mart_customer_risk_profile_risk_level__HIGH__MEDIUM__LOW.95fabd3536: BEGIN
[0m14:12:36.985516 [debug] [Thread-4 (]: Using duckdb connection "test.hw4_dbt.accepted_values_stg_transactions_gender__M__F__U.ae8f0c87a0"
[0m14:12:36.985715 [debug] [Thread-2 (]: On test.hw4_dbt.accepted_values_mart_merchant_analytics_suspicious_flag__0__1.221ef94aff: BEGIN
[0m14:12:36.985990 [debug] [Thread-3 (]: On test.hw4_dbt.accepted_values_stg_transactions_amount_bucket__small__medium__large__extra_large__unknown.f09a27d70f: BEGIN
[0m14:12:36.986220 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:36.986445 [debug] [Thread-4 (]: On test.hw4_dbt.accepted_values_stg_transactions_gender__M__F__U.ae8f0c87a0: BEGIN
[0m14:12:36.986621 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:12:36.986824 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:12:36.987129 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:12:36.995079 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m14:12:36.995394 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m14:12:36.995611 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m14:12:36.995838 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m14:12:36.996062 [debug] [Thread-1 (]: Using duckdb connection "test.hw4_dbt.accepted_values_mart_customer_risk_profile_risk_level__HIGH__MEDIUM__LOW.95fabd3536"
[0m14:12:36.996300 [debug] [Thread-3 (]: Using duckdb connection "test.hw4_dbt.accepted_values_stg_transactions_amount_bucket__small__medium__large__extra_large__unknown.f09a27d70f"
[0m14:12:36.996593 [debug] [Thread-2 (]: Using duckdb connection "test.hw4_dbt.accepted_values_mart_merchant_analytics_suspicious_flag__0__1.221ef94aff"
[0m14:12:36.996791 [debug] [Thread-4 (]: Using duckdb connection "test.hw4_dbt.accepted_values_stg_transactions_gender__M__F__U.ae8f0c87a0"
[0m14:12:36.997010 [debug] [Thread-1 (]: On test.hw4_dbt.accepted_values_mart_customer_risk_profile_risk_level__HIGH__MEDIUM__LOW.95fabd3536: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.accepted_values_mart_customer_risk_profile_risk_level__HIGH__MEDIUM__LOW.95fabd3536"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        risk_level as value_field,
        count(*) as n_records

    from transactions.main_marts.mart_customer_risk_profile
    group by risk_level

)

select *
from all_values
where value_field not in (
    'HIGH','MEDIUM','LOW'
)



      
    ) dbt_internal_test
[0m14:12:36.997329 [debug] [Thread-3 (]: On test.hw4_dbt.accepted_values_stg_transactions_amount_bucket__small__medium__large__extra_large__unknown.f09a27d70f: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.accepted_values_stg_transactions_amount_bucket__small__medium__large__extra_large__unknown.f09a27d70f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        amount_bucket as value_field,
        count(*) as n_records

    from transactions.main_staging.stg_transactions
    group by amount_bucket

)

select *
from all_values
where value_field not in (
    'small','medium','large','extra_large','unknown'
)



      
    ) dbt_internal_test
[0m14:12:36.998294 [debug] [Thread-2 (]: On test.hw4_dbt.accepted_values_mart_merchant_analytics_suspicious_flag__0__1.221ef94aff: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.accepted_values_mart_merchant_analytics_suspicious_flag__0__1.221ef94aff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        suspicious_flag as value_field,
        count(*) as n_records

    from transactions.main_marts.mart_merchant_analytics
    group by suspicious_flag

)

select *
from all_values
where value_field not in (
    '0','1'
)



      
    ) dbt_internal_test
[0m14:12:36.998994 [debug] [Thread-4 (]: On test.hw4_dbt.accepted_values_stg_transactions_gender__M__F__U.ae8f0c87a0: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.accepted_values_stg_transactions_gender__M__F__U.ae8f0c87a0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        gender as value_field,
        count(*) as n_records

    from transactions.main_staging.stg_transactions
    group by gender

)

select *
from all_values
where value_field not in (
    'M','F','U'
)



      
    ) dbt_internal_test
[0m14:12:37.000576 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:12:37.000909 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:12:37.005509 [debug] [Thread-2 (]: On test.hw4_dbt.accepted_values_mart_merchant_analytics_suspicious_flag__0__1.221ef94aff: ROLLBACK
[0m14:12:37.007061 [debug] [Thread-2 (]: Failed to rollback 'test.hw4_dbt.accepted_values_mart_merchant_analytics_suspicious_flag__0__1.221ef94aff'
[0m14:12:37.013538 [debug] [Thread-2 (]: On test.hw4_dbt.accepted_values_mart_merchant_analytics_suspicious_flag__0__1.221ef94aff: Close
[0m14:12:37.014994 [debug] [Thread-1 (]: On test.hw4_dbt.accepted_values_mart_customer_risk_profile_risk_level__HIGH__MEDIUM__LOW.95fabd3536: ROLLBACK
[0m14:12:37.016141 [info ] [Thread-2 (]: 2 of 56 PASS accepted_values_mart_merchant_analytics_suspicious_flag__0__1 ..... [[32mPASS[0m in 0.07s]
[0m14:12:37.016559 [debug] [Thread-3 (]: SQL status: OK in 0.017 seconds
[0m14:12:37.016970 [debug] [Thread-4 (]: SQL status: OK in 0.017 seconds
[0m14:12:37.017330 [debug] [Thread-1 (]: Failed to rollback 'test.hw4_dbt.accepted_values_mart_customer_risk_profile_risk_level__HIGH__MEDIUM__LOW.95fabd3536'
[0m14:12:37.017695 [debug] [Thread-2 (]: Finished running node test.hw4_dbt.accepted_values_mart_merchant_analytics_suspicious_flag__0__1.221ef94aff
[0m14:12:37.018060 [debug] [Thread-1 (]: On test.hw4_dbt.accepted_values_mart_customer_risk_profile_risk_level__HIGH__MEDIUM__LOW.95fabd3536: Close
[0m14:12:37.019057 [debug] [Thread-3 (]: On test.hw4_dbt.accepted_values_stg_transactions_amount_bucket__small__medium__large__extra_large__unknown.f09a27d70f: ROLLBACK
[0m14:12:37.020021 [debug] [Thread-4 (]: On test.hw4_dbt.accepted_values_stg_transactions_gender__M__F__U.ae8f0c87a0: ROLLBACK
[0m14:12:37.020373 [debug] [Thread-2 (]: Began running node test.hw4_dbt.accepted_values_stg_transactions_is_fraud__0__1.f6d9ff0fc6
[0m14:12:37.020732 [info ] [Thread-1 (]: 1 of 56 PASS accepted_values_mart_customer_risk_profile_risk_level__HIGH__MEDIUM__LOW  [[32mPASS[0m in 0.07s]
[0m14:12:37.021063 [debug] [Thread-3 (]: Failed to rollback 'test.hw4_dbt.accepted_values_stg_transactions_amount_bucket__small__medium__large__extra_large__unknown.f09a27d70f'
[0m14:12:37.021403 [debug] [Thread-4 (]: Failed to rollback 'test.hw4_dbt.accepted_values_stg_transactions_gender__M__F__U.ae8f0c87a0'
[0m14:12:37.021600 [info ] [Thread-2 (]: 5 of 56 START test accepted_values_stg_transactions_is_fraud__0__1 ............. [RUN]
[0m14:12:37.022038 [debug] [Thread-1 (]: Finished running node test.hw4_dbt.accepted_values_mart_customer_risk_profile_risk_level__HIGH__MEDIUM__LOW.95fabd3536
[0m14:12:37.022485 [debug] [Thread-3 (]: On test.hw4_dbt.accepted_values_stg_transactions_amount_bucket__small__medium__large__extra_large__unknown.f09a27d70f: Close
[0m14:12:37.022853 [debug] [Thread-4 (]: On test.hw4_dbt.accepted_values_stg_transactions_gender__M__F__U.ae8f0c87a0: Close
[0m14:12:37.023247 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.accepted_values_mart_merchant_analytics_suspicious_flag__0__1.221ef94aff, now test.hw4_dbt.accepted_values_stg_transactions_is_fraud__0__1.f6d9ff0fc6)
[0m14:12:37.023542 [debug] [Thread-1 (]: Began running node test.hw4_dbt.assert_fraud_rate_bounds
[0m14:12:37.023955 [info ] [Thread-3 (]: 3 of 56 PASS accepted_values_stg_transactions_amount_bucket__small__medium__large__extra_large__unknown  [[32mPASS[0m in 0.08s]
[0m14:12:37.024356 [debug] [Thread-2 (]: Began compiling node test.hw4_dbt.accepted_values_stg_transactions_is_fraud__0__1.f6d9ff0fc6
[0m14:12:37.024900 [info ] [Thread-1 (]: 6 of 56 START test assert_fraud_rate_bounds .................................... [RUN]
[0m14:12:37.025502 [debug] [Thread-3 (]: Finished running node test.hw4_dbt.accepted_values_stg_transactions_amount_bucket__small__medium__large__extra_large__unknown.f09a27d70f
[0m14:12:37.028444 [debug] [Thread-2 (]: Writing injected SQL for node "test.hw4_dbt.accepted_values_stg_transactions_is_fraud__0__1.f6d9ff0fc6"
[0m14:12:37.028841 [info ] [Thread-4 (]: 4 of 56 PASS accepted_values_stg_transactions_gender__M__F__U .................. [[32mPASS[0m in 0.08s]
[0m14:12:37.029243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.accepted_values_mart_customer_risk_profile_risk_level__HIGH__MEDIUM__LOW.95fabd3536, now test.hw4_dbt.assert_fraud_rate_bounds)
[0m14:12:37.029518 [debug] [Thread-3 (]: Began running node test.hw4_dbt.assert_no_negative_amounts
[0m14:12:37.029920 [debug] [Thread-4 (]: Finished running node test.hw4_dbt.accepted_values_stg_transactions_gender__M__F__U.ae8f0c87a0
[0m14:12:37.030163 [debug] [Thread-1 (]: Began compiling node test.hw4_dbt.assert_fraud_rate_bounds
[0m14:12:37.030422 [info ] [Thread-3 (]: 7 of 56 START test assert_no_negative_amounts .................................. [RUN]
[0m14:12:37.030755 [debug] [Thread-2 (]: Began executing node test.hw4_dbt.accepted_values_stg_transactions_is_fraud__0__1.f6d9ff0fc6
[0m14:12:37.031151 [debug] [Thread-4 (]: Began running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_customer_risk_profile_fraud_rate__100__0.ee441b99d9
[0m14:12:37.033350 [debug] [Thread-1 (]: Writing injected SQL for node "test.hw4_dbt.assert_fraud_rate_bounds"
[0m14:12:37.033713 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.accepted_values_stg_transactions_amount_bucket__small__medium__large__extra_large__unknown.f09a27d70f, now test.hw4_dbt.assert_no_negative_amounts)
[0m14:12:37.035362 [debug] [Thread-2 (]: Writing runtime sql for node "test.hw4_dbt.accepted_values_stg_transactions_is_fraud__0__1.f6d9ff0fc6"
[0m14:12:37.035799 [info ] [Thread-4 (]: 8 of 56 START test dbt_expectations_expect_column_values_to_be_between_mart_customer_risk_profile_fraud_rate__100__0  [RUN]
[0m14:12:37.036571 [debug] [Thread-3 (]: Began compiling node test.hw4_dbt.assert_no_negative_amounts
[0m14:12:37.037071 [debug] [Thread-1 (]: Began executing node test.hw4_dbt.assert_fraud_rate_bounds
[0m14:12:37.037369 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.accepted_values_stg_transactions_gender__M__F__U.ae8f0c87a0, now test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_customer_risk_profile_fraud_rate__100__0.ee441b99d9)
[0m14:12:37.039318 [debug] [Thread-3 (]: Writing injected SQL for node "test.hw4_dbt.assert_no_negative_amounts"
[0m14:12:37.040851 [debug] [Thread-1 (]: Writing runtime sql for node "test.hw4_dbt.assert_fraud_rate_bounds"
[0m14:12:37.041152 [debug] [Thread-2 (]: Using duckdb connection "test.hw4_dbt.accepted_values_stg_transactions_is_fraud__0__1.f6d9ff0fc6"
[0m14:12:37.041447 [debug] [Thread-4 (]: Began compiling node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_customer_risk_profile_fraud_rate__100__0.ee441b99d9
[0m14:12:37.041872 [debug] [Thread-2 (]: On test.hw4_dbt.accepted_values_stg_transactions_is_fraud__0__1.f6d9ff0fc6: BEGIN
[0m14:12:37.051656 [debug] [Thread-4 (]: Writing injected SQL for node "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_customer_risk_profile_fraud_rate__100__0.ee441b99d9"
[0m14:12:37.052038 [debug] [Thread-1 (]: Using duckdb connection "test.hw4_dbt.assert_fraud_rate_bounds"
[0m14:12:37.052355 [debug] [Thread-3 (]: Began executing node test.hw4_dbt.assert_no_negative_amounts
[0m14:12:37.052675 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:12:37.053009 [debug] [Thread-1 (]: On test.hw4_dbt.assert_fraud_rate_bounds: BEGIN
[0m14:12:37.054616 [debug] [Thread-3 (]: Writing runtime sql for node "test.hw4_dbt.assert_no_negative_amounts"
[0m14:12:37.054975 [debug] [Thread-4 (]: Began executing node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_customer_risk_profile_fraud_rate__100__0.ee441b99d9
[0m14:12:37.055216 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:37.056841 [debug] [Thread-4 (]: Writing runtime sql for node "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_customer_risk_profile_fraud_rate__100__0.ee441b99d9"
[0m14:12:37.057319 [debug] [Thread-3 (]: Using duckdb connection "test.hw4_dbt.assert_no_negative_amounts"
[0m14:12:37.057637 [debug] [Thread-3 (]: On test.hw4_dbt.assert_no_negative_amounts: BEGIN
[0m14:12:37.057883 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:12:37.058131 [debug] [Thread-4 (]: Using duckdb connection "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_customer_risk_profile_fraud_rate__100__0.ee441b99d9"
[0m14:12:37.058327 [debug] [Thread-4 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_customer_risk_profile_fraud_rate__100__0.ee441b99d9: BEGIN
[0m14:12:37.058581 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:12:37.063053 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m14:12:37.063281 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m14:12:37.063465 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m14:12:37.063647 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m14:12:37.063855 [debug] [Thread-2 (]: Using duckdb connection "test.hw4_dbt.accepted_values_stg_transactions_is_fraud__0__1.f6d9ff0fc6"
[0m14:12:37.064034 [debug] [Thread-3 (]: Using duckdb connection "test.hw4_dbt.assert_no_negative_amounts"
[0m14:12:37.064223 [debug] [Thread-1 (]: Using duckdb connection "test.hw4_dbt.assert_fraud_rate_bounds"
[0m14:12:37.064563 [debug] [Thread-4 (]: Using duckdb connection "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_customer_risk_profile_fraud_rate__100__0.ee441b99d9"
[0m14:12:37.064876 [debug] [Thread-2 (]: On test.hw4_dbt.accepted_values_stg_transactions_is_fraud__0__1.f6d9ff0fc6: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.accepted_values_stg_transactions_is_fraud__0__1.f6d9ff0fc6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        is_fraud as value_field,
        count(*) as n_records

    from transactions.main_staging.stg_transactions
    group by is_fraud

)

select *
from all_values
where value_field not in (
    '0','1'
)



      
    ) dbt_internal_test
[0m14:12:37.065243 [debug] [Thread-3 (]: On test.hw4_dbt.assert_no_negative_amounts: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.assert_no_negative_amounts"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * from transactions.main_staging.stg_transactions where amount < 0
      
    ) dbt_internal_test
[0m14:12:37.065549 [debug] [Thread-1 (]: On test.hw4_dbt.assert_fraud_rate_bounds: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.assert_fraud_rate_bounds"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select *
from transactions.main_marts.mart_fraud_by_category
where fraud_rate < 0 or fraud_rate > 100
      
    ) dbt_internal_test
[0m14:12:37.065809 [debug] [Thread-4 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_customer_risk_profile_fraud_rate__100__0.ee441b99d9: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_customer_risk_profile_fraud_rate__100__0.ee441b99d9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and fraud_rate >= 0 and fraud_rate <= 100
)
 as expression


    from transactions.main_marts.mart_customer_risk_profile
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m14:12:37.067191 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:12:37.067658 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:12:37.068520 [debug] [Thread-1 (]: On test.hw4_dbt.assert_fraud_rate_bounds: ROLLBACK
[0m14:12:37.070687 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m14:12:37.071589 [debug] [Thread-4 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_customer_risk_profile_fraud_rate__100__0.ee441b99d9: ROLLBACK
[0m14:12:37.071802 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m14:12:37.074577 [debug] [Thread-1 (]: Failed to rollback 'test.hw4_dbt.assert_fraud_rate_bounds'
[0m14:12:37.075381 [debug] [Thread-3 (]: On test.hw4_dbt.assert_no_negative_amounts: ROLLBACK
[0m14:12:37.075677 [debug] [Thread-4 (]: Failed to rollback 'test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_customer_risk_profile_fraud_rate__100__0.ee441b99d9'
[0m14:12:37.076665 [debug] [Thread-2 (]: On test.hw4_dbt.accepted_values_stg_transactions_is_fraud__0__1.f6d9ff0fc6: ROLLBACK
[0m14:12:37.076895 [debug] [Thread-1 (]: On test.hw4_dbt.assert_fraud_rate_bounds: Close
[0m14:12:37.077699 [debug] [Thread-4 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_customer_risk_profile_fraud_rate__100__0.ee441b99d9: Close
[0m14:12:37.077997 [debug] [Thread-3 (]: Failed to rollback 'test.hw4_dbt.assert_no_negative_amounts'
[0m14:12:37.078828 [debug] [Thread-2 (]: Failed to rollback 'test.hw4_dbt.accepted_values_stg_transactions_is_fraud__0__1.f6d9ff0fc6'
[0m14:12:37.079468 [info ] [Thread-1 (]: 6 of 56 PASS assert_fraud_rate_bounds .......................................... [[32mPASS[0m in 0.05s]
[0m14:12:37.079788 [info ] [Thread-4 (]: 8 of 56 PASS dbt_expectations_expect_column_values_to_be_between_mart_customer_risk_profile_fraud_rate__100__0  [[32mPASS[0m in 0.04s]
[0m14:12:37.080201 [debug] [Thread-3 (]: On test.hw4_dbt.assert_no_negative_amounts: Close
[0m14:12:37.080522 [debug] [Thread-2 (]: On test.hw4_dbt.accepted_values_stg_transactions_is_fraud__0__1.f6d9ff0fc6: Close
[0m14:12:37.081691 [debug] [Thread-1 (]: Finished running node test.hw4_dbt.assert_fraud_rate_bounds
[0m14:12:37.082008 [debug] [Thread-4 (]: Finished running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_customer_risk_profile_fraud_rate__100__0.ee441b99d9
[0m14:12:37.082351 [info ] [Thread-3 (]: 7 of 56 PASS assert_no_negative_amounts ........................................ [[32mPASS[0m in 0.05s]
[0m14:12:37.087031 [debug] [Thread-1 (]: Began running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_fraud_rate__1__0.59ce56cc94
[0m14:12:37.088144 [info ] [Thread-2 (]: 5 of 56 PASS accepted_values_stg_transactions_is_fraud__0__1 ................... [[32mPASS[0m in 0.06s]
[0m14:12:37.088518 [debug] [Thread-4 (]: Began running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_large_txn_share__1__0.d93f9f3127
[0m14:12:37.088849 [debug] [Thread-3 (]: Finished running node test.hw4_dbt.assert_no_negative_amounts
[0m14:12:37.089352 [info ] [Thread-1 (]: 9 of 56 START test dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_fraud_rate__1__0  [RUN]
[0m14:12:37.090272 [debug] [Thread-2 (]: Finished running node test.hw4_dbt.accepted_values_stg_transactions_is_fraud__0__1.f6d9ff0fc6
[0m14:12:37.090580 [info ] [Thread-4 (]: 10 of 56 START test dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_large_txn_share__1__0  [RUN]
[0m14:12:37.091141 [debug] [Thread-3 (]: Began running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_category_fraud_rate__100__0.60b2512acf
[0m14:12:37.091741 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.assert_fraud_rate_bounds, now test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_fraud_rate__1__0.59ce56cc94)
[0m14:12:37.093219 [debug] [Thread-2 (]: Began running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_state_fraud_rate__100__0.ad1018ee37
[0m14:12:37.093735 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_customer_risk_profile_fraud_rate__100__0.ee441b99d9, now test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_large_txn_share__1__0.d93f9f3127)
[0m14:12:37.095161 [info ] [Thread-3 (]: 11 of 56 START test dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_category_fraud_rate__100__0  [RUN]
[0m14:12:37.095461 [debug] [Thread-1 (]: Began compiling node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_fraud_rate__1__0.59ce56cc94
[0m14:12:37.095820 [info ] [Thread-2 (]: 12 of 56 START test dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_state_fraud_rate__100__0  [RUN]
[0m14:12:37.096799 [debug] [Thread-4 (]: Began compiling node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_large_txn_share__1__0.d93f9f3127
[0m14:12:37.097373 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.assert_no_negative_amounts, now test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_category_fraud_rate__100__0.60b2512acf)
[0m14:12:37.100794 [debug] [Thread-1 (]: Writing injected SQL for node "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_fraud_rate__1__0.59ce56cc94"
[0m14:12:37.101185 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.accepted_values_stg_transactions_is_fraud__0__1.f6d9ff0fc6, now test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_state_fraud_rate__100__0.ad1018ee37)
[0m14:12:37.104685 [debug] [Thread-4 (]: Writing injected SQL for node "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_large_txn_share__1__0.d93f9f3127"
[0m14:12:37.104953 [debug] [Thread-3 (]: Began compiling node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_category_fraud_rate__100__0.60b2512acf
[0m14:12:37.106146 [debug] [Thread-2 (]: Began compiling node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_state_fraud_rate__100__0.ad1018ee37
[0m14:12:37.107890 [debug] [Thread-1 (]: Began executing node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_fraud_rate__1__0.59ce56cc94
[0m14:12:37.110176 [debug] [Thread-3 (]: Writing injected SQL for node "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_category_fraud_rate__100__0.60b2512acf"
[0m14:12:37.113118 [debug] [Thread-2 (]: Writing injected SQL for node "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_state_fraud_rate__100__0.ad1018ee37"
[0m14:12:37.113412 [debug] [Thread-4 (]: Began executing node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_large_txn_share__1__0.d93f9f3127
[0m14:12:37.115065 [debug] [Thread-1 (]: Writing runtime sql for node "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_fraud_rate__1__0.59ce56cc94"
[0m14:12:37.117772 [debug] [Thread-4 (]: Writing runtime sql for node "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_large_txn_share__1__0.d93f9f3127"
[0m14:12:37.118920 [debug] [Thread-3 (]: Began executing node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_category_fraud_rate__100__0.60b2512acf
[0m14:12:37.119223 [debug] [Thread-2 (]: Began executing node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_state_fraud_rate__100__0.ad1018ee37
[0m14:12:37.121610 [debug] [Thread-3 (]: Writing runtime sql for node "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_category_fraud_rate__100__0.60b2512acf"
[0m14:12:37.121834 [debug] [Thread-4 (]: Using duckdb connection "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_large_txn_share__1__0.d93f9f3127"
[0m14:12:37.122086 [debug] [Thread-1 (]: Using duckdb connection "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_fraud_rate__1__0.59ce56cc94"
[0m14:12:37.123808 [debug] [Thread-2 (]: Writing runtime sql for node "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_state_fraud_rate__100__0.ad1018ee37"
[0m14:12:37.124569 [debug] [Thread-4 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_large_txn_share__1__0.d93f9f3127: BEGIN
[0m14:12:37.124908 [debug] [Thread-1 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_fraud_rate__1__0.59ce56cc94: BEGIN
[0m14:12:37.125165 [debug] [Thread-3 (]: Using duckdb connection "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_category_fraud_rate__100__0.60b2512acf"
[0m14:12:37.127199 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:12:37.127698 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:37.127955 [debug] [Thread-2 (]: Using duckdb connection "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_state_fraud_rate__100__0.ad1018ee37"
[0m14:12:37.128315 [debug] [Thread-3 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_category_fraud_rate__100__0.60b2512acf: BEGIN
[0m14:12:37.128691 [debug] [Thread-2 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_state_fraud_rate__100__0.ad1018ee37: BEGIN
[0m14:12:37.128933 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:12:37.129155 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:12:37.137656 [debug] [Thread-4 (]: SQL status: OK in 0.010 seconds
[0m14:12:37.137951 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m14:12:37.138112 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m14:12:37.138266 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m14:12:37.138560 [debug] [Thread-4 (]: Using duckdb connection "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_large_txn_share__1__0.d93f9f3127"
[0m14:12:37.138884 [debug] [Thread-3 (]: Using duckdb connection "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_category_fraud_rate__100__0.60b2512acf"
[0m14:12:37.139169 [debug] [Thread-1 (]: Using duckdb connection "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_fraud_rate__1__0.59ce56cc94"
[0m14:12:37.139484 [debug] [Thread-2 (]: Using duckdb connection "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_state_fraud_rate__100__0.ad1018ee37"
[0m14:12:37.139769 [debug] [Thread-4 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_large_txn_share__1__0.d93f9f3127: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_large_txn_share__1__0.d93f9f3127"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and large_txn_share >= 0 and large_txn_share <= 1
)
 as expression


    from transactions.main_marts.mart_daily_state_metrics
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m14:12:37.140123 [debug] [Thread-3 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_category_fraud_rate__100__0.60b2512acf: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_category_fraud_rate__100__0.60b2512acf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and fraud_rate >= 0 and fraud_rate <= 100
)
 as expression


    from transactions.main_marts.mart_fraud_by_category
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m14:12:37.140413 [debug] [Thread-1 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_fraud_rate__1__0.59ce56cc94: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_fraud_rate__1__0.59ce56cc94"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and fraud_rate >= 0 and fraud_rate <= 1
)
 as expression


    from transactions.main_marts.mart_daily_state_metrics
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m14:12:37.141119 [debug] [Thread-2 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_state_fraud_rate__100__0.ad1018ee37: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_state_fraud_rate__100__0.ad1018ee37"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and fraud_rate >= 0 and fraud_rate <= 100
)
 as expression


    from transactions.main_marts.mart_fraud_by_state
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m14:12:37.142453 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:12:37.142769 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:12:37.142940 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:12:37.143149 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:12:37.144019 [debug] [Thread-3 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_category_fraud_rate__100__0.60b2512acf: ROLLBACK
[0m14:12:37.145118 [debug] [Thread-1 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_fraud_rate__1__0.59ce56cc94: ROLLBACK
[0m14:12:37.145797 [debug] [Thread-4 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_large_txn_share__1__0.d93f9f3127: ROLLBACK
[0m14:12:37.146422 [debug] [Thread-2 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_state_fraud_rate__100__0.ad1018ee37: ROLLBACK
[0m14:12:37.146721 [debug] [Thread-3 (]: Failed to rollback 'test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_category_fraud_rate__100__0.60b2512acf'
[0m14:12:37.147069 [debug] [Thread-1 (]: Failed to rollback 'test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_fraud_rate__1__0.59ce56cc94'
[0m14:12:37.147437 [debug] [Thread-4 (]: Failed to rollback 'test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_large_txn_share__1__0.d93f9f3127'
[0m14:12:37.147828 [debug] [Thread-2 (]: Failed to rollback 'test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_state_fraud_rate__100__0.ad1018ee37'
[0m14:12:37.148141 [debug] [Thread-3 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_category_fraud_rate__100__0.60b2512acf: Close
[0m14:12:37.148719 [debug] [Thread-1 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_fraud_rate__1__0.59ce56cc94: Close
[0m14:12:37.149054 [debug] [Thread-4 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_large_txn_share__1__0.d93f9f3127: Close
[0m14:12:37.149596 [debug] [Thread-2 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_state_fraud_rate__100__0.ad1018ee37: Close
[0m14:12:37.150059 [info ] [Thread-3 (]: 11 of 56 PASS dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_category_fraud_rate__100__0  [[32mPASS[0m in 0.05s]
[0m14:12:37.150600 [info ] [Thread-1 (]: 9 of 56 PASS dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_fraud_rate__1__0  [[32mPASS[0m in 0.06s]
[0m14:12:37.151303 [info ] [Thread-4 (]: 10 of 56 PASS dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_large_txn_share__1__0  [[32mPASS[0m in 0.06s]
[0m14:12:37.152429 [debug] [Thread-3 (]: Finished running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_category_fraud_rate__100__0.60b2512acf
[0m14:12:37.153202 [debug] [Thread-1 (]: Finished running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_fraud_rate__1__0.59ce56cc94
[0m14:12:37.153884 [debug] [Thread-4 (]: Finished running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_large_txn_share__1__0.d93f9f3127
[0m14:12:37.154276 [info ] [Thread-2 (]: 12 of 56 PASS dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_state_fraud_rate__100__0  [[32mPASS[0m in 0.05s]
[0m14:12:37.154718 [debug] [Thread-3 (]: Began running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_hourly_fraud_pattern_fraud_rate__100__0.870771d265
[0m14:12:37.155069 [debug] [Thread-1 (]: Began running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_merchant_analytics_fraud_rate__100__0.8aedb505c1
[0m14:12:37.155371 [debug] [Thread-4 (]: Began running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_stg_transactions_amount__0__True.047010278b
[0m14:12:37.155697 [debug] [Thread-2 (]: Finished running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_state_fraud_rate__100__0.ad1018ee37
[0m14:12:37.155937 [info ] [Thread-3 (]: 13 of 56 START test dbt_expectations_expect_column_values_to_be_between_mart_hourly_fraud_pattern_fraud_rate__100__0  [RUN]
[0m14:12:37.156528 [info ] [Thread-1 (]: 14 of 56 START test dbt_expectations_expect_column_values_to_be_between_mart_merchant_analytics_fraud_rate__100__0  [RUN]
[0m14:12:37.157062 [info ] [Thread-4 (]: 15 of 56 START test dbt_expectations_expect_column_values_to_be_between_stg_transactions_amount__0__True  [RUN]
[0m14:12:37.157515 [debug] [Thread-2 (]: Began running node test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_daily_state_metrics_transaction_date__us_state.36d7185b4c
[0m14:12:37.157854 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_category_fraud_rate__100__0.60b2512acf, now test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_hourly_fraud_pattern_fraud_rate__100__0.870771d265)
[0m14:12:37.158522 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_fraud_rate__1__0.59ce56cc94, now test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_merchant_analytics_fraud_rate__100__0.8aedb505c1)
[0m14:12:37.159533 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_large_txn_share__1__0.d93f9f3127, now test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_stg_transactions_amount__0__True.047010278b)
[0m14:12:37.160237 [info ] [Thread-2 (]: 16 of 56 START test dbt_utils_unique_combination_of_columns_mart_daily_state_metrics_transaction_date__us_state  [RUN]
[0m14:12:37.161135 [debug] [Thread-3 (]: Began compiling node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_hourly_fraud_pattern_fraud_rate__100__0.870771d265
[0m14:12:37.161879 [debug] [Thread-1 (]: Began compiling node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_merchant_analytics_fraud_rate__100__0.8aedb505c1
[0m14:12:37.162131 [debug] [Thread-4 (]: Began compiling node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_stg_transactions_amount__0__True.047010278b
[0m14:12:37.163069 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_state_fraud_rate__100__0.ad1018ee37, now test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_daily_state_metrics_transaction_date__us_state.36d7185b4c)
[0m14:12:37.166423 [debug] [Thread-3 (]: Writing injected SQL for node "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_hourly_fraud_pattern_fraud_rate__100__0.870771d265"
[0m14:12:37.169556 [debug] [Thread-1 (]: Writing injected SQL for node "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_merchant_analytics_fraud_rate__100__0.8aedb505c1"
[0m14:12:37.172604 [debug] [Thread-4 (]: Writing injected SQL for node "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_stg_transactions_amount__0__True.047010278b"
[0m14:12:37.172949 [debug] [Thread-2 (]: Began compiling node test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_daily_state_metrics_transaction_date__us_state.36d7185b4c
[0m14:12:37.179622 [debug] [Thread-2 (]: Writing injected SQL for node "test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_daily_state_metrics_transaction_date__us_state.36d7185b4c"
[0m14:12:37.180865 [debug] [Thread-4 (]: Began executing node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_stg_transactions_amount__0__True.047010278b
[0m14:12:37.181144 [debug] [Thread-3 (]: Began executing node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_hourly_fraud_pattern_fraud_rate__100__0.870771d265
[0m14:12:37.181370 [debug] [Thread-1 (]: Began executing node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_merchant_analytics_fraud_rate__100__0.8aedb505c1
[0m14:12:37.184168 [debug] [Thread-4 (]: Writing runtime sql for node "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_stg_transactions_amount__0__True.047010278b"
[0m14:12:37.186177 [debug] [Thread-3 (]: Writing runtime sql for node "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_hourly_fraud_pattern_fraud_rate__100__0.870771d265"
[0m14:12:37.187230 [debug] [Thread-2 (]: Began executing node test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_daily_state_metrics_transaction_date__us_state.36d7185b4c
[0m14:12:37.188665 [debug] [Thread-1 (]: Writing runtime sql for node "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_merchant_analytics_fraud_rate__100__0.8aedb505c1"
[0m14:12:37.191099 [debug] [Thread-2 (]: Writing runtime sql for node "test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_daily_state_metrics_transaction_date__us_state.36d7185b4c"
[0m14:12:37.191634 [debug] [Thread-3 (]: Using duckdb connection "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_hourly_fraud_pattern_fraud_rate__100__0.870771d265"
[0m14:12:37.191837 [debug] [Thread-4 (]: Using duckdb connection "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_stg_transactions_amount__0__True.047010278b"
[0m14:12:37.192133 [debug] [Thread-3 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_hourly_fraud_pattern_fraud_rate__100__0.870771d265: BEGIN
[0m14:12:37.192399 [debug] [Thread-1 (]: Using duckdb connection "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_merchant_analytics_fraud_rate__100__0.8aedb505c1"
[0m14:12:37.192665 [debug] [Thread-2 (]: Using duckdb connection "test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_daily_state_metrics_transaction_date__us_state.36d7185b4c"
[0m14:12:37.193570 [debug] [Thread-4 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_stg_transactions_amount__0__True.047010278b: BEGIN
[0m14:12:37.194161 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:12:37.194539 [debug] [Thread-1 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_merchant_analytics_fraud_rate__100__0.8aedb505c1: BEGIN
[0m14:12:37.195166 [debug] [Thread-2 (]: On test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_daily_state_metrics_transaction_date__us_state.36d7185b4c: BEGIN
[0m14:12:37.195545 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:12:37.196287 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:37.197512 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:12:37.205085 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m14:12:37.205354 [debug] [Thread-3 (]: SQL status: OK in 0.011 seconds
[0m14:12:37.205601 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m14:12:37.205994 [debug] [Thread-4 (]: SQL status: OK in 0.010 seconds
[0m14:12:37.206305 [debug] [Thread-1 (]: Using duckdb connection "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_merchant_analytics_fraud_rate__100__0.8aedb505c1"
[0m14:12:37.206989 [debug] [Thread-3 (]: Using duckdb connection "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_hourly_fraud_pattern_fraud_rate__100__0.870771d265"
[0m14:12:37.207294 [debug] [Thread-2 (]: Using duckdb connection "test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_daily_state_metrics_transaction_date__us_state.36d7185b4c"
[0m14:12:37.207529 [debug] [Thread-4 (]: Using duckdb connection "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_stg_transactions_amount__0__True.047010278b"
[0m14:12:37.207799 [debug] [Thread-1 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_merchant_analytics_fraud_rate__100__0.8aedb505c1: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_merchant_analytics_fraud_rate__100__0.8aedb505c1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and fraud_rate >= 0 and fraud_rate <= 100
)
 as expression


    from transactions.main_marts.mart_merchant_analytics
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m14:12:37.208064 [debug] [Thread-3 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_hourly_fraud_pattern_fraud_rate__100__0.870771d265: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_hourly_fraud_pattern_fraud_rate__100__0.870771d265"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and fraud_rate >= 0 and fraud_rate <= 100
)
 as expression


    from transactions.main_marts.mart_hourly_fraud_pattern
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m14:12:37.208378 [debug] [Thread-2 (]: On test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_daily_state_metrics_transaction_date__us_state.36d7185b4c: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_daily_state_metrics_transaction_date__us_state.36d7185b4c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        transaction_date, us_state
    from transactions.main_marts.mart_daily_state_metrics
    group by transaction_date, us_state
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m14:12:37.208642 [debug] [Thread-4 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_stg_transactions_amount__0__True.047010278b: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_stg_transactions_amount__0__True.047010278b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and amount > 0
)
 as expression


    from transactions.main_staging.stg_transactions
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m14:12:37.209623 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:12:37.210612 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:12:37.212590 [debug] [Thread-1 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_merchant_analytics_fraud_rate__100__0.8aedb505c1: ROLLBACK
[0m14:12:37.212962 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m14:12:37.213665 [debug] [Thread-3 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_hourly_fraud_pattern_fraud_rate__100__0.870771d265: ROLLBACK
[0m14:12:37.213897 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m14:12:37.214170 [debug] [Thread-1 (]: Failed to rollback 'test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_merchant_analytics_fraud_rate__100__0.8aedb505c1'
[0m14:12:37.215502 [debug] [Thread-2 (]: On test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_daily_state_metrics_transaction_date__us_state.36d7185b4c: ROLLBACK
[0m14:12:37.215913 [debug] [Thread-3 (]: Failed to rollback 'test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_hourly_fraud_pattern_fraud_rate__100__0.870771d265'
[0m14:12:37.216299 [debug] [Thread-1 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_merchant_analytics_fraud_rate__100__0.8aedb505c1: Close
[0m14:12:37.216977 [debug] [Thread-4 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_stg_transactions_amount__0__True.047010278b: ROLLBACK
[0m14:12:37.217263 [debug] [Thread-2 (]: Failed to rollback 'test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_daily_state_metrics_transaction_date__us_state.36d7185b4c'
[0m14:12:37.217457 [debug] [Thread-3 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_hourly_fraud_pattern_fraud_rate__100__0.870771d265: Close
[0m14:12:37.217851 [info ] [Thread-1 (]: 14 of 56 PASS dbt_expectations_expect_column_values_to_be_between_mart_merchant_analytics_fraud_rate__100__0  [[32mPASS[0m in 0.06s]
[0m14:12:37.218183 [debug] [Thread-4 (]: Failed to rollback 'test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_stg_transactions_amount__0__True.047010278b'
[0m14:12:37.218617 [debug] [Thread-2 (]: On test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_daily_state_metrics_transaction_date__us_state.36d7185b4c: Close
[0m14:12:37.219215 [info ] [Thread-3 (]: 13 of 56 PASS dbt_expectations_expect_column_values_to_be_between_mart_hourly_fraud_pattern_fraud_rate__100__0  [[32mPASS[0m in 0.06s]
[0m14:12:37.219736 [debug] [Thread-1 (]: Finished running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_merchant_analytics_fraud_rate__100__0.8aedb505c1
[0m14:12:37.220178 [debug] [Thread-4 (]: On test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_stg_transactions_amount__0__True.047010278b: Close
[0m14:12:37.220596 [info ] [Thread-2 (]: 16 of 56 PASS dbt_utils_unique_combination_of_columns_mart_daily_state_metrics_transaction_date__us_state  [[32mPASS[0m in 0.06s]
[0m14:12:37.220963 [debug] [Thread-3 (]: Finished running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_hourly_fraud_pattern_fraud_rate__100__0.870771d265
[0m14:12:37.221414 [debug] [Thread-1 (]: Began running node test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_hourly_fraud_pattern_day_name__hour_of_day.f8d797f239
[0m14:12:37.221915 [debug] [Thread-2 (]: Finished running node test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_daily_state_metrics_transaction_date__us_state.36d7185b4c
[0m14:12:37.222203 [debug] [Thread-3 (]: Began running node test.hw4_dbt.dbt_utils_unique_combination_of_columns_stg_transactions_transaction_id.9f8e8cbeb8
[0m14:12:37.222504 [info ] [Thread-1 (]: 17 of 56 START test dbt_utils_unique_combination_of_columns_mart_hourly_fraud_pattern_day_name__hour_of_day  [RUN]
[0m14:12:37.223302 [debug] [Thread-2 (]: Began running node test.hw4_dbt.not_null_mart_customer_risk_profile_customer_id.c066ff7487
[0m14:12:37.223937 [info ] [Thread-4 (]: 15 of 56 PASS dbt_expectations_expect_column_values_to_be_between_stg_transactions_amount__0__True  [[32mPASS[0m in 0.06s]
[0m14:12:37.224293 [info ] [Thread-3 (]: 18 of 56 START test dbt_utils_unique_combination_of_columns_stg_transactions_transaction_id  [RUN]
[0m14:12:37.224757 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_merchant_analytics_fraud_rate__100__0.8aedb505c1, now test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_hourly_fraud_pattern_day_name__hour_of_day.f8d797f239)
[0m14:12:37.225046 [info ] [Thread-2 (]: 19 of 56 START test not_null_mart_customer_risk_profile_customer_id ............ [RUN]
[0m14:12:37.225345 [debug] [Thread-4 (]: Finished running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_stg_transactions_amount__0__True.047010278b
[0m14:12:37.225567 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_hourly_fraud_pattern_fraud_rate__100__0.870771d265, now test.hw4_dbt.dbt_utils_unique_combination_of_columns_stg_transactions_transaction_id.9f8e8cbeb8)
[0m14:12:37.225779 [debug] [Thread-1 (]: Began compiling node test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_hourly_fraud_pattern_day_name__hour_of_day.f8d797f239
[0m14:12:37.225986 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_daily_state_metrics_transaction_date__us_state.36d7185b4c, now test.hw4_dbt.not_null_mart_customer_risk_profile_customer_id.c066ff7487)
[0m14:12:37.226220 [debug] [Thread-4 (]: Began running node test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_count.44f9f89c45
[0m14:12:37.226483 [debug] [Thread-3 (]: Began compiling node test.hw4_dbt.dbt_utils_unique_combination_of_columns_stg_transactions_transaction_id.9f8e8cbeb8
[0m14:12:37.230144 [debug] [Thread-1 (]: Writing injected SQL for node "test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_hourly_fraud_pattern_day_name__hour_of_day.f8d797f239"
[0m14:12:37.230568 [debug] [Thread-2 (]: Began compiling node test.hw4_dbt.not_null_mart_customer_risk_profile_customer_id.c066ff7487
[0m14:12:37.230829 [info ] [Thread-4 (]: 20 of 56 START test not_null_mart_daily_state_metrics_transaction_count ........ [RUN]
[0m14:12:37.262865 [debug] [Thread-3 (]: Writing injected SQL for node "test.hw4_dbt.dbt_utils_unique_combination_of_columns_stg_transactions_transaction_id.9f8e8cbeb8"
[0m14:12:37.273445 [debug] [Thread-2 (]: Writing injected SQL for node "test.hw4_dbt.not_null_mart_customer_risk_profile_customer_id.c066ff7487"
[0m14:12:37.274204 [debug] [Thread-1 (]: Began executing node test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_hourly_fraud_pattern_day_name__hour_of_day.f8d797f239
[0m14:12:37.274659 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_stg_transactions_amount__0__True.047010278b, now test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_count.44f9f89c45)
[0m14:12:37.276481 [debug] [Thread-1 (]: Writing runtime sql for node "test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_hourly_fraud_pattern_day_name__hour_of_day.f8d797f239"
[0m14:12:37.276889 [debug] [Thread-4 (]: Began compiling node test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_count.44f9f89c45
[0m14:12:37.277352 [debug] [Thread-3 (]: Began executing node test.hw4_dbt.dbt_utils_unique_combination_of_columns_stg_transactions_transaction_id.9f8e8cbeb8
[0m14:12:37.278040 [debug] [Thread-2 (]: Began executing node test.hw4_dbt.not_null_mart_customer_risk_profile_customer_id.c066ff7487
[0m14:12:37.282473 [debug] [Thread-4 (]: Writing injected SQL for node "test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_count.44f9f89c45"
[0m14:12:37.284116 [debug] [Thread-3 (]: Writing runtime sql for node "test.hw4_dbt.dbt_utils_unique_combination_of_columns_stg_transactions_transaction_id.9f8e8cbeb8"
[0m14:12:37.284404 [debug] [Thread-1 (]: Using duckdb connection "test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_hourly_fraud_pattern_day_name__hour_of_day.f8d797f239"
[0m14:12:37.286078 [debug] [Thread-2 (]: Writing runtime sql for node "test.hw4_dbt.not_null_mart_customer_risk_profile_customer_id.c066ff7487"
[0m14:12:37.286678 [debug] [Thread-1 (]: On test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_hourly_fraud_pattern_day_name__hour_of_day.f8d797f239: BEGIN
[0m14:12:37.287033 [debug] [Thread-4 (]: Began executing node test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_count.44f9f89c45
[0m14:12:37.287313 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:37.287570 [debug] [Thread-3 (]: Using duckdb connection "test.hw4_dbt.dbt_utils_unique_combination_of_columns_stg_transactions_transaction_id.9f8e8cbeb8"
[0m14:12:37.289125 [debug] [Thread-4 (]: Writing runtime sql for node "test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_count.44f9f89c45"
[0m14:12:37.289485 [debug] [Thread-2 (]: Using duckdb connection "test.hw4_dbt.not_null_mart_customer_risk_profile_customer_id.c066ff7487"
[0m14:12:37.289874 [debug] [Thread-3 (]: On test.hw4_dbt.dbt_utils_unique_combination_of_columns_stg_transactions_transaction_id.9f8e8cbeb8: BEGIN
[0m14:12:37.290254 [debug] [Thread-2 (]: On test.hw4_dbt.not_null_mart_customer_risk_profile_customer_id.c066ff7487: BEGIN
[0m14:12:37.290513 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:12:37.290743 [debug] [Thread-4 (]: Using duckdb connection "test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_count.44f9f89c45"
[0m14:12:37.290933 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:12:37.291146 [debug] [Thread-4 (]: On test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_count.44f9f89c45: BEGIN
[0m14:12:37.291381 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:12:37.298275 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m14:12:37.298682 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m14:12:37.298853 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m14:12:37.299049 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m14:12:37.299238 [debug] [Thread-1 (]: Using duckdb connection "test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_hourly_fraud_pattern_day_name__hour_of_day.f8d797f239"
[0m14:12:37.299482 [debug] [Thread-3 (]: Using duckdb connection "test.hw4_dbt.dbt_utils_unique_combination_of_columns_stg_transactions_transaction_id.9f8e8cbeb8"
[0m14:12:37.299699 [debug] [Thread-2 (]: Using duckdb connection "test.hw4_dbt.not_null_mart_customer_risk_profile_customer_id.c066ff7487"
[0m14:12:37.299881 [debug] [Thread-4 (]: Using duckdb connection "test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_count.44f9f89c45"
[0m14:12:37.300091 [debug] [Thread-1 (]: On test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_hourly_fraud_pattern_day_name__hour_of_day.f8d797f239: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_hourly_fraud_pattern_day_name__hour_of_day.f8d797f239"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        day_name, hour_of_day
    from transactions.main_marts.mart_hourly_fraud_pattern
    group by day_name, hour_of_day
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m14:12:37.300366 [debug] [Thread-3 (]: On test.hw4_dbt.dbt_utils_unique_combination_of_columns_stg_transactions_transaction_id.9f8e8cbeb8: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.dbt_utils_unique_combination_of_columns_stg_transactions_transaction_id.9f8e8cbeb8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        transaction_id
    from transactions.main_staging.stg_transactions
    group by transaction_id
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m14:12:37.300610 [debug] [Thread-2 (]: On test.hw4_dbt.not_null_mart_customer_risk_profile_customer_id.c066ff7487: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.not_null_mart_customer_risk_profile_customer_id.c066ff7487"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from transactions.main_marts.mart_customer_risk_profile
where customer_id is null



      
    ) dbt_internal_test
[0m14:12:37.300849 [debug] [Thread-4 (]: On test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_count.44f9f89c45: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_count.44f9f89c45"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_count
from transactions.main_marts.mart_daily_state_metrics
where transaction_count is null



      
    ) dbt_internal_test
[0m14:12:37.301835 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m14:12:37.302154 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:12:37.303468 [debug] [Thread-4 (]: On test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_count.44f9f89c45: ROLLBACK
[0m14:12:37.303813 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:12:37.304525 [debug] [Thread-4 (]: Failed to rollback 'test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_count.44f9f89c45'
[0m14:12:37.319174 [debug] [Thread-4 (]: On test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_count.44f9f89c45: Close
[0m14:12:37.306208 [debug] [Thread-2 (]: On test.hw4_dbt.not_null_mart_customer_risk_profile_customer_id.c066ff7487: ROLLBACK
[0m14:12:37.329340 [debug] [Thread-2 (]: Failed to rollback 'test.hw4_dbt.not_null_mart_customer_risk_profile_customer_id.c066ff7487'
[0m14:12:37.329592 [debug] [Thread-2 (]: On test.hw4_dbt.not_null_mart_customer_risk_profile_customer_id.c066ff7487: Close
[0m14:12:37.329935 [info ] [Thread-2 (]: 19 of 56 PASS not_null_mart_customer_risk_profile_customer_id .................. [[32mPASS[0m in 0.10s]
[0m14:12:37.325178 [debug] [Thread-1 (]: On test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_hourly_fraud_pattern_day_name__hour_of_day.f8d797f239: ROLLBACK
[0m14:12:37.335762 [debug] [Thread-1 (]: Failed to rollback 'test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_hourly_fraud_pattern_day_name__hour_of_day.f8d797f239'
[0m14:12:37.336407 [debug] [Thread-1 (]: On test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_hourly_fraud_pattern_day_name__hour_of_day.f8d797f239: Close
[0m14:12:37.336828 [info ] [Thread-1 (]: 17 of 56 PASS dbt_utils_unique_combination_of_columns_mart_hourly_fraud_pattern_day_name__hour_of_day  [[32mPASS[0m in 0.11s]
[0m14:12:37.337134 [debug] [Thread-1 (]: Finished running node test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_hourly_fraud_pattern_day_name__hour_of_day.f8d797f239
[0m14:12:37.337358 [debug] [Thread-1 (]: Began running node test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_date.27b2c6ebe0
[0m14:12:37.337540 [info ] [Thread-1 (]: 21 of 56 START test not_null_mart_daily_state_metrics_transaction_date ......... [RUN]
[0m14:12:37.332241 [debug] [Thread-2 (]: Finished running node test.hw4_dbt.not_null_mart_customer_risk_profile_customer_id.c066ff7487
[0m14:12:37.337756 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_hourly_fraud_pattern_day_name__hour_of_day.f8d797f239, now test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_date.27b2c6ebe0)
[0m14:12:37.350702 [debug] [Thread-1 (]: Began compiling node test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_date.27b2c6ebe0
[0m14:12:37.340945 [debug] [Thread-2 (]: Began running node test.hw4_dbt.not_null_mart_daily_state_metrics_us_state.e9c98cd892
[0m14:12:37.355307 [debug] [Thread-1 (]: Writing injected SQL for node "test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_date.27b2c6ebe0"
[0m14:12:37.326221 [info ] [Thread-4 (]: 20 of 56 PASS not_null_mart_daily_state_metrics_transaction_count .............. [[32mPASS[0m in 0.05s]
[0m14:12:37.359764 [info ] [Thread-2 (]: 22 of 56 START test not_null_mart_daily_state_metrics_us_state ................. [RUN]
[0m14:12:37.362110 [debug] [Thread-1 (]: Began executing node test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_date.27b2c6ebe0
[0m14:12:37.368848 [debug] [Thread-4 (]: Finished running node test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_count.44f9f89c45
[0m14:12:37.381323 [debug] [Thread-4 (]: Began running node test.hw4_dbt.not_null_mart_fraud_by_category_cat_id.1d7340ccc5
[0m14:12:37.381775 [info ] [Thread-4 (]: 23 of 56 START test not_null_mart_fraud_by_category_cat_id ..................... [RUN]
[0m14:12:37.375273 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_mart_customer_risk_profile_customer_id.c066ff7487, now test.hw4_dbt.not_null_mart_daily_state_metrics_us_state.e9c98cd892)
[0m14:12:37.388417 [debug] [Thread-2 (]: Began compiling node test.hw4_dbt.not_null_mart_daily_state_metrics_us_state.e9c98cd892
[0m14:12:37.396477 [debug] [Thread-2 (]: Writing injected SQL for node "test.hw4_dbt.not_null_mart_daily_state_metrics_us_state.e9c98cd892"
[0m14:12:37.397065 [debug] [Thread-2 (]: Began executing node test.hw4_dbt.not_null_mart_daily_state_metrics_us_state.e9c98cd892
[0m14:12:37.376939 [debug] [Thread-1 (]: Writing runtime sql for node "test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_date.27b2c6ebe0"
[0m14:12:37.401982 [debug] [Thread-2 (]: Writing runtime sql for node "test.hw4_dbt.not_null_mart_daily_state_metrics_us_state.e9c98cd892"
[0m14:12:37.384361 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_count.44f9f89c45, now test.hw4_dbt.not_null_mart_fraud_by_category_cat_id.1d7340ccc5)
[0m14:12:37.407386 [debug] [Thread-4 (]: Began compiling node test.hw4_dbt.not_null_mart_fraud_by_category_cat_id.1d7340ccc5
[0m14:12:37.411940 [debug] [Thread-4 (]: Writing injected SQL for node "test.hw4_dbt.not_null_mart_fraud_by_category_cat_id.1d7340ccc5"
[0m14:12:37.412583 [debug] [Thread-1 (]: Using duckdb connection "test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_date.27b2c6ebe0"
[0m14:12:37.413548 [debug] [Thread-2 (]: Using duckdb connection "test.hw4_dbt.not_null_mart_daily_state_metrics_us_state.e9c98cd892"
[0m14:12:37.414269 [debug] [Thread-1 (]: On test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_date.27b2c6ebe0: BEGIN
[0m14:12:37.415354 [debug] [Thread-2 (]: On test.hw4_dbt.not_null_mart_daily_state_metrics_us_state.e9c98cd892: BEGIN
[0m14:12:37.416194 [debug] [Thread-4 (]: Began executing node test.hw4_dbt.not_null_mart_fraud_by_category_cat_id.1d7340ccc5
[0m14:12:37.417598 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:37.417995 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:12:37.421398 [debug] [Thread-4 (]: Writing runtime sql for node "test.hw4_dbt.not_null_mart_fraud_by_category_cat_id.1d7340ccc5"
[0m14:12:37.422787 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m14:12:37.423863 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m14:12:37.424376 [debug] [Thread-2 (]: Using duckdb connection "test.hw4_dbt.not_null_mart_daily_state_metrics_us_state.e9c98cd892"
[0m14:12:37.424993 [debug] [Thread-4 (]: Using duckdb connection "test.hw4_dbt.not_null_mart_fraud_by_category_cat_id.1d7340ccc5"
[0m14:12:37.425261 [debug] [Thread-1 (]: Using duckdb connection "test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_date.27b2c6ebe0"
[0m14:12:37.425642 [debug] [Thread-2 (]: On test.hw4_dbt.not_null_mart_daily_state_metrics_us_state.e9c98cd892: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.not_null_mart_daily_state_metrics_us_state.e9c98cd892"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select us_state
from transactions.main_marts.mart_daily_state_metrics
where us_state is null



      
    ) dbt_internal_test
[0m14:12:37.425968 [debug] [Thread-4 (]: On test.hw4_dbt.not_null_mart_fraud_by_category_cat_id.1d7340ccc5: BEGIN
[0m14:12:37.426311 [debug] [Thread-1 (]: On test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_date.27b2c6ebe0: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_date.27b2c6ebe0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_date
from transactions.main_marts.mart_daily_state_metrics
where transaction_date is null



      
    ) dbt_internal_test
[0m14:12:37.426883 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:12:37.428062 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:12:37.430584 [debug] [Thread-2 (]: On test.hw4_dbt.not_null_mart_daily_state_metrics_us_state.e9c98cd892: ROLLBACK
[0m14:12:37.431038 [debug] [Thread-2 (]: Failed to rollback 'test.hw4_dbt.not_null_mart_daily_state_metrics_us_state.e9c98cd892'
[0m14:12:37.428481 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:12:37.432313 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m14:12:37.438949 [debug] [Thread-4 (]: Using duckdb connection "test.hw4_dbt.not_null_mart_fraud_by_category_cat_id.1d7340ccc5"
[0m14:12:37.436573 [debug] [Thread-1 (]: On test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_date.27b2c6ebe0: ROLLBACK
[0m14:12:37.433546 [debug] [Thread-2 (]: On test.hw4_dbt.not_null_mart_daily_state_metrics_us_state.e9c98cd892: Close
[0m14:12:37.439856 [debug] [Thread-1 (]: Failed to rollback 'test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_date.27b2c6ebe0'
[0m14:12:37.439460 [debug] [Thread-4 (]: On test.hw4_dbt.not_null_mart_fraud_by_category_cat_id.1d7340ccc5: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.not_null_mart_fraud_by_category_cat_id.1d7340ccc5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select cat_id
from transactions.main_marts.mart_fraud_by_category
where cat_id is null



      
    ) dbt_internal_test
[0m14:12:37.441223 [info ] [Thread-2 (]: 22 of 56 PASS not_null_mart_daily_state_metrics_us_state ....................... [[32mPASS[0m in 0.07s]
[0m14:12:37.441656 [debug] [Thread-1 (]: On test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_date.27b2c6ebe0: Close
[0m14:12:37.442194 [debug] [Thread-3 (]: SQL status: OK in 0.141 seconds
[0m14:12:37.442691 [debug] [Thread-2 (]: Finished running node test.hw4_dbt.not_null_mart_daily_state_metrics_us_state.e9c98cd892
[0m14:12:37.442939 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:12:37.443382 [info ] [Thread-1 (]: 21 of 56 PASS not_null_mart_daily_state_metrics_transaction_date ............... [[32mPASS[0m in 0.11s]
[0m14:12:37.444532 [debug] [Thread-3 (]: On test.hw4_dbt.dbt_utils_unique_combination_of_columns_stg_transactions_transaction_id.9f8e8cbeb8: ROLLBACK
[0m14:12:37.445190 [debug] [Thread-2 (]: Began running node test.hw4_dbt.not_null_mart_fraud_by_state_unique_customers.afa2f0b8db
[0m14:12:37.446449 [debug] [Thread-4 (]: On test.hw4_dbt.not_null_mart_fraud_by_category_cat_id.1d7340ccc5: ROLLBACK
[0m14:12:37.446769 [debug] [Thread-1 (]: Finished running node test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_date.27b2c6ebe0
[0m14:12:37.447160 [debug] [Thread-3 (]: Failed to rollback 'test.hw4_dbt.dbt_utils_unique_combination_of_columns_stg_transactions_transaction_id.9f8e8cbeb8'
[0m14:12:37.447478 [info ] [Thread-2 (]: 24 of 56 START test not_null_mart_fraud_by_state_unique_customers .............. [RUN]
[0m14:12:37.448021 [debug] [Thread-4 (]: Failed to rollback 'test.hw4_dbt.not_null_mart_fraud_by_category_cat_id.1d7340ccc5'
[0m14:12:37.448467 [debug] [Thread-1 (]: Began running node test.hw4_dbt.not_null_mart_fraud_by_state_us_state.95ac4eba19
[0m14:12:37.448870 [debug] [Thread-3 (]: On test.hw4_dbt.dbt_utils_unique_combination_of_columns_stg_transactions_transaction_id.9f8e8cbeb8: Close
[0m14:12:37.449406 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_mart_daily_state_metrics_us_state.e9c98cd892, now test.hw4_dbt.not_null_mart_fraud_by_state_unique_customers.afa2f0b8db)
[0m14:12:37.449654 [debug] [Thread-4 (]: On test.hw4_dbt.not_null_mart_fraud_by_category_cat_id.1d7340ccc5: Close
[0m14:12:37.449945 [info ] [Thread-1 (]: 25 of 56 START test not_null_mart_fraud_by_state_us_state ...................... [RUN]
[0m14:12:37.450653 [info ] [Thread-3 (]: 18 of 56 PASS dbt_utils_unique_combination_of_columns_stg_transactions_transaction_id  [[32mPASS[0m in 0.22s]
[0m14:12:37.450924 [debug] [Thread-2 (]: Began compiling node test.hw4_dbt.not_null_mart_fraud_by_state_unique_customers.afa2f0b8db
[0m14:12:37.451312 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_date.27b2c6ebe0, now test.hw4_dbt.not_null_mart_fraud_by_state_us_state.95ac4eba19)
[0m14:12:37.451643 [debug] [Thread-3 (]: Finished running node test.hw4_dbt.dbt_utils_unique_combination_of_columns_stg_transactions_transaction_id.9f8e8cbeb8
[0m14:12:37.454794 [debug] [Thread-2 (]: Writing injected SQL for node "test.hw4_dbt.not_null_mart_fraud_by_state_unique_customers.afa2f0b8db"
[0m14:12:37.455147 [info ] [Thread-4 (]: 23 of 56 PASS not_null_mart_fraud_by_category_cat_id ........................... [[32mPASS[0m in 0.07s]
[0m14:12:37.455966 [debug] [Thread-1 (]: Began compiling node test.hw4_dbt.not_null_mart_fraud_by_state_us_state.95ac4eba19
[0m14:12:37.456258 [debug] [Thread-3 (]: Began running node test.hw4_dbt.not_null_mart_hourly_fraud_pattern_day_name.cc79fdc01d
[0m14:12:37.456740 [debug] [Thread-4 (]: Finished running node test.hw4_dbt.not_null_mart_fraud_by_category_cat_id.1d7340ccc5
[0m14:12:37.459840 [debug] [Thread-1 (]: Writing injected SQL for node "test.hw4_dbt.not_null_mart_fraud_by_state_us_state.95ac4eba19"
[0m14:12:37.460327 [info ] [Thread-3 (]: 26 of 56 START test not_null_mart_hourly_fraud_pattern_day_name ................ [RUN]
[0m14:12:37.460642 [debug] [Thread-2 (]: Began executing node test.hw4_dbt.not_null_mart_fraud_by_state_unique_customers.afa2f0b8db
[0m14:12:37.461095 [debug] [Thread-4 (]: Began running node test.hw4_dbt.not_null_mart_hourly_fraud_pattern_hour_of_day.7bbb67dbe4
[0m14:12:37.461531 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.dbt_utils_unique_combination_of_columns_stg_transactions_transaction_id.9f8e8cbeb8, now test.hw4_dbt.not_null_mart_hourly_fraud_pattern_day_name.cc79fdc01d)
[0m14:12:37.464748 [debug] [Thread-2 (]: Writing runtime sql for node "test.hw4_dbt.not_null_mart_fraud_by_state_unique_customers.afa2f0b8db"
[0m14:12:37.467279 [debug] [Thread-1 (]: Began executing node test.hw4_dbt.not_null_mart_fraud_by_state_us_state.95ac4eba19
[0m14:12:37.467079 [info ] [Thread-4 (]: 27 of 56 START test not_null_mart_hourly_fraud_pattern_hour_of_day ............. [RUN]
[0m14:12:37.467636 [debug] [Thread-3 (]: Began compiling node test.hw4_dbt.not_null_mart_hourly_fraud_pattern_day_name.cc79fdc01d
[0m14:12:37.469459 [debug] [Thread-1 (]: Writing runtime sql for node "test.hw4_dbt.not_null_mart_fraud_by_state_us_state.95ac4eba19"
[0m14:12:37.469881 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_mart_fraud_by_category_cat_id.1d7340ccc5, now test.hw4_dbt.not_null_mart_hourly_fraud_pattern_hour_of_day.7bbb67dbe4)
[0m14:12:37.470192 [debug] [Thread-2 (]: Using duckdb connection "test.hw4_dbt.not_null_mart_fraud_by_state_unique_customers.afa2f0b8db"
[0m14:12:37.472654 [debug] [Thread-3 (]: Writing injected SQL for node "test.hw4_dbt.not_null_mart_hourly_fraud_pattern_day_name.cc79fdc01d"
[0m14:12:37.473071 [debug] [Thread-4 (]: Began compiling node test.hw4_dbt.not_null_mart_hourly_fraud_pattern_hour_of_day.7bbb67dbe4
[0m14:12:37.473347 [debug] [Thread-2 (]: On test.hw4_dbt.not_null_mart_fraud_by_state_unique_customers.afa2f0b8db: BEGIN
[0m14:12:37.473725 [debug] [Thread-1 (]: Using duckdb connection "test.hw4_dbt.not_null_mart_fraud_by_state_us_state.95ac4eba19"
[0m14:12:37.477688 [debug] [Thread-4 (]: Writing injected SQL for node "test.hw4_dbt.not_null_mart_hourly_fraud_pattern_hour_of_day.7bbb67dbe4"
[0m14:12:37.478057 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:12:37.478326 [debug] [Thread-3 (]: Began executing node test.hw4_dbt.not_null_mart_hourly_fraud_pattern_day_name.cc79fdc01d
[0m14:12:37.478556 [debug] [Thread-1 (]: On test.hw4_dbt.not_null_mart_fraud_by_state_us_state.95ac4eba19: BEGIN
[0m14:12:37.481320 [debug] [Thread-3 (]: Writing runtime sql for node "test.hw4_dbt.not_null_mart_hourly_fraud_pattern_day_name.cc79fdc01d"
[0m14:12:37.481736 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:37.482050 [debug] [Thread-4 (]: Began executing node test.hw4_dbt.not_null_mart_hourly_fraud_pattern_hour_of_day.7bbb67dbe4
[0m14:12:37.483842 [debug] [Thread-4 (]: Writing runtime sql for node "test.hw4_dbt.not_null_mart_hourly_fraud_pattern_hour_of_day.7bbb67dbe4"
[0m14:12:37.484326 [debug] [Thread-3 (]: Using duckdb connection "test.hw4_dbt.not_null_mart_hourly_fraud_pattern_day_name.cc79fdc01d"
[0m14:12:37.484896 [debug] [Thread-3 (]: On test.hw4_dbt.not_null_mart_hourly_fraud_pattern_day_name.cc79fdc01d: BEGIN
[0m14:12:37.485308 [debug] [Thread-4 (]: Using duckdb connection "test.hw4_dbt.not_null_mart_hourly_fraud_pattern_hour_of_day.7bbb67dbe4"
[0m14:12:37.485619 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:12:37.485818 [debug] [Thread-4 (]: On test.hw4_dbt.not_null_mart_hourly_fraud_pattern_hour_of_day.7bbb67dbe4: BEGIN
[0m14:12:37.486111 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:12:37.488667 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m14:12:37.488932 [debug] [Thread-2 (]: SQL status: OK in 0.011 seconds
[0m14:12:37.489388 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m14:12:37.489728 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m14:12:37.490048 [debug] [Thread-1 (]: Using duckdb connection "test.hw4_dbt.not_null_mart_fraud_by_state_us_state.95ac4eba19"
[0m14:12:37.490439 [debug] [Thread-2 (]: Using duckdb connection "test.hw4_dbt.not_null_mart_fraud_by_state_unique_customers.afa2f0b8db"
[0m14:12:37.490735 [debug] [Thread-3 (]: Using duckdb connection "test.hw4_dbt.not_null_mart_hourly_fraud_pattern_day_name.cc79fdc01d"
[0m14:12:37.491061 [debug] [Thread-4 (]: Using duckdb connection "test.hw4_dbt.not_null_mart_hourly_fraud_pattern_hour_of_day.7bbb67dbe4"
[0m14:12:37.491319 [debug] [Thread-1 (]: On test.hw4_dbt.not_null_mart_fraud_by_state_us_state.95ac4eba19: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.not_null_mart_fraud_by_state_us_state.95ac4eba19"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select us_state
from transactions.main_marts.mart_fraud_by_state
where us_state is null



      
    ) dbt_internal_test
[0m14:12:37.491892 [debug] [Thread-2 (]: On test.hw4_dbt.not_null_mart_fraud_by_state_unique_customers.afa2f0b8db: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.not_null_mart_fraud_by_state_unique_customers.afa2f0b8db"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select unique_customers
from transactions.main_marts.mart_fraud_by_state
where unique_customers is null



      
    ) dbt_internal_test
[0m14:12:37.493023 [debug] [Thread-3 (]: On test.hw4_dbt.not_null_mart_hourly_fraud_pattern_day_name.cc79fdc01d: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.not_null_mart_hourly_fraud_pattern_day_name.cc79fdc01d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select day_name
from transactions.main_marts.mart_hourly_fraud_pattern
where day_name is null



      
    ) dbt_internal_test
[0m14:12:37.493455 [debug] [Thread-4 (]: On test.hw4_dbt.not_null_mart_hourly_fraud_pattern_hour_of_day.7bbb67dbe4: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.not_null_mart_hourly_fraud_pattern_hour_of_day.7bbb67dbe4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select hour_of_day
from transactions.main_marts.mart_hourly_fraud_pattern
where hour_of_day is null



      
    ) dbt_internal_test
[0m14:12:37.494480 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:12:37.494883 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:12:37.497484 [debug] [Thread-1 (]: On test.hw4_dbt.not_null_mart_fraud_by_state_us_state.95ac4eba19: ROLLBACK
[0m14:12:37.497778 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m14:12:37.498049 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m14:12:37.498929 [debug] [Thread-1 (]: Failed to rollback 'test.hw4_dbt.not_null_mart_fraud_by_state_us_state.95ac4eba19'
[0m14:12:37.500930 [debug] [Thread-2 (]: On test.hw4_dbt.not_null_mart_fraud_by_state_unique_customers.afa2f0b8db: ROLLBACK
[0m14:12:37.504166 [debug] [Thread-2 (]: Failed to rollback 'test.hw4_dbt.not_null_mart_fraud_by_state_unique_customers.afa2f0b8db'
[0m14:12:37.504398 [debug] [Thread-2 (]: On test.hw4_dbt.not_null_mart_fraud_by_state_unique_customers.afa2f0b8db: Close
[0m14:12:37.501952 [debug] [Thread-3 (]: On test.hw4_dbt.not_null_mart_hourly_fraud_pattern_day_name.cc79fdc01d: ROLLBACK
[0m14:12:37.504944 [info ] [Thread-2 (]: 24 of 56 PASS not_null_mart_fraud_by_state_unique_customers .................... [[32mPASS[0m in 0.06s]
[0m14:12:37.503222 [debug] [Thread-4 (]: On test.hw4_dbt.not_null_mart_hourly_fraud_pattern_hour_of_day.7bbb67dbe4: ROLLBACK
[0m14:12:37.503674 [debug] [Thread-1 (]: On test.hw4_dbt.not_null_mart_fraud_by_state_us_state.95ac4eba19: Close
[0m14:12:37.505661 [debug] [Thread-2 (]: Finished running node test.hw4_dbt.not_null_mart_fraud_by_state_unique_customers.afa2f0b8db
[0m14:12:37.505976 [debug] [Thread-3 (]: Failed to rollback 'test.hw4_dbt.not_null_mart_hourly_fraud_pattern_day_name.cc79fdc01d'
[0m14:12:37.506803 [debug] [Thread-4 (]: Failed to rollback 'test.hw4_dbt.not_null_mart_hourly_fraud_pattern_hour_of_day.7bbb67dbe4'
[0m14:12:37.507522 [info ] [Thread-1 (]: 25 of 56 PASS not_null_mart_fraud_by_state_us_state ............................ [[32mPASS[0m in 0.06s]
[0m14:12:37.507930 [debug] [Thread-2 (]: Began running node test.hw4_dbt.not_null_mart_merchant_analytics_merchant_id.61b4b4d63c
[0m14:12:37.508391 [debug] [Thread-3 (]: On test.hw4_dbt.not_null_mart_hourly_fraud_pattern_day_name.cc79fdc01d: Close
[0m14:12:37.508690 [debug] [Thread-4 (]: On test.hw4_dbt.not_null_mart_hourly_fraud_pattern_hour_of_day.7bbb67dbe4: Close
[0m14:12:37.509178 [debug] [Thread-1 (]: Finished running node test.hw4_dbt.not_null_mart_fraud_by_state_us_state.95ac4eba19
[0m14:12:37.509470 [info ] [Thread-2 (]: 28 of 56 START test not_null_mart_merchant_analytics_merchant_id ............... [RUN]
[0m14:12:37.510065 [info ] [Thread-3 (]: 26 of 56 PASS not_null_mart_hourly_fraud_pattern_day_name ...................... [[32mPASS[0m in 0.05s]
[0m14:12:37.510690 [debug] [Thread-1 (]: Began running node test.hw4_dbt.not_null_states_state_code.4c83882290
[0m14:12:37.512615 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_mart_fraud_by_state_unique_customers.afa2f0b8db, now test.hw4_dbt.not_null_mart_merchant_analytics_merchant_id.61b4b4d63c)
[0m14:12:37.513072 [info ] [Thread-4 (]: 27 of 56 PASS not_null_mart_hourly_fraud_pattern_hour_of_day ................... [[32mPASS[0m in 0.04s]
[0m14:12:37.513442 [debug] [Thread-3 (]: Finished running node test.hw4_dbt.not_null_mart_hourly_fraud_pattern_day_name.cc79fdc01d
[0m14:12:37.513870 [info ] [Thread-1 (]: 29 of 56 START test not_null_states_state_code ................................. [RUN]
[0m14:12:37.514308 [debug] [Thread-2 (]: Began compiling node test.hw4_dbt.not_null_mart_merchant_analytics_merchant_id.61b4b4d63c
[0m14:12:37.514802 [debug] [Thread-4 (]: Finished running node test.hw4_dbt.not_null_mart_hourly_fraud_pattern_hour_of_day.7bbb67dbe4
[0m14:12:37.515127 [debug] [Thread-3 (]: Began running node test.hw4_dbt.not_null_states_state_name.f652068228
[0m14:12:37.515492 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_mart_fraud_by_state_us_state.95ac4eba19, now test.hw4_dbt.not_null_states_state_code.4c83882290)
[0m14:12:37.519905 [debug] [Thread-2 (]: Writing injected SQL for node "test.hw4_dbt.not_null_mart_merchant_analytics_merchant_id.61b4b4d63c"
[0m14:12:37.521981 [debug] [Thread-4 (]: Began running node test.hw4_dbt.not_null_stg_transactions_amount.3629b5421e
[0m14:12:37.522524 [info ] [Thread-3 (]: 30 of 56 START test not_null_states_state_name ................................. [RUN]
[0m14:12:37.523045 [debug] [Thread-1 (]: Began compiling node test.hw4_dbt.not_null_states_state_code.4c83882290
[0m14:12:37.523595 [info ] [Thread-4 (]: 31 of 56 START test not_null_stg_transactions_amount ........................... [RUN]
[0m14:12:37.524146 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_mart_hourly_fraud_pattern_day_name.cc79fdc01d, now test.hw4_dbt.not_null_states_state_name.f652068228)
[0m14:12:37.524342 [debug] [Thread-2 (]: Began executing node test.hw4_dbt.not_null_mart_merchant_analytics_merchant_id.61b4b4d63c
[0m14:12:37.527365 [debug] [Thread-1 (]: Writing injected SQL for node "test.hw4_dbt.not_null_states_state_code.4c83882290"
[0m14:12:37.528161 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_mart_hourly_fraud_pattern_hour_of_day.7bbb67dbe4, now test.hw4_dbt.not_null_stg_transactions_amount.3629b5421e)
[0m14:12:37.528560 [debug] [Thread-3 (]: Began compiling node test.hw4_dbt.not_null_states_state_name.f652068228
[0m14:12:37.530356 [debug] [Thread-2 (]: Writing runtime sql for node "test.hw4_dbt.not_null_mart_merchant_analytics_merchant_id.61b4b4d63c"
[0m14:12:37.530710 [debug] [Thread-4 (]: Began compiling node test.hw4_dbt.not_null_stg_transactions_amount.3629b5421e
[0m14:12:37.533543 [debug] [Thread-3 (]: Writing injected SQL for node "test.hw4_dbt.not_null_states_state_name.f652068228"
[0m14:12:37.533884 [debug] [Thread-1 (]: Began executing node test.hw4_dbt.not_null_states_state_code.4c83882290
[0m14:12:37.536495 [debug] [Thread-4 (]: Writing injected SQL for node "test.hw4_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m14:12:37.536980 [debug] [Thread-2 (]: Using duckdb connection "test.hw4_dbt.not_null_mart_merchant_analytics_merchant_id.61b4b4d63c"
[0m14:12:37.541426 [debug] [Thread-1 (]: Writing runtime sql for node "test.hw4_dbt.not_null_states_state_code.4c83882290"
[0m14:12:37.541845 [debug] [Thread-3 (]: Began executing node test.hw4_dbt.not_null_states_state_name.f652068228
[0m14:12:37.542068 [debug] [Thread-2 (]: On test.hw4_dbt.not_null_mart_merchant_analytics_merchant_id.61b4b4d63c: BEGIN
[0m14:12:37.542357 [debug] [Thread-4 (]: Began executing node test.hw4_dbt.not_null_stg_transactions_amount.3629b5421e
[0m14:12:37.544312 [debug] [Thread-3 (]: Writing runtime sql for node "test.hw4_dbt.not_null_states_state_name.f652068228"
[0m14:12:37.544700 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:12:37.544947 [debug] [Thread-1 (]: Using duckdb connection "test.hw4_dbt.not_null_states_state_code.4c83882290"
[0m14:12:37.546550 [debug] [Thread-4 (]: Writing runtime sql for node "test.hw4_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m14:12:37.546956 [debug] [Thread-1 (]: On test.hw4_dbt.not_null_states_state_code.4c83882290: BEGIN
[0m14:12:37.547388 [debug] [Thread-3 (]: Using duckdb connection "test.hw4_dbt.not_null_states_state_name.f652068228"
[0m14:12:37.547602 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:37.548035 [debug] [Thread-3 (]: On test.hw4_dbt.not_null_states_state_name.f652068228: BEGIN
[0m14:12:37.548467 [debug] [Thread-4 (]: Using duckdb connection "test.hw4_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m14:12:37.548772 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:12:37.549039 [debug] [Thread-4 (]: On test.hw4_dbt.not_null_stg_transactions_amount.3629b5421e: BEGIN
[0m14:12:37.549271 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:12:37.556055 [debug] [Thread-2 (]: SQL status: OK in 0.011 seconds
[0m14:12:37.556309 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m14:12:37.556495 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m14:12:37.556715 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m14:12:37.556977 [debug] [Thread-2 (]: Using duckdb connection "test.hw4_dbt.not_null_mart_merchant_analytics_merchant_id.61b4b4d63c"
[0m14:12:37.557347 [debug] [Thread-3 (]: Using duckdb connection "test.hw4_dbt.not_null_states_state_name.f652068228"
[0m14:12:37.557601 [debug] [Thread-1 (]: Using duckdb connection "test.hw4_dbt.not_null_states_state_code.4c83882290"
[0m14:12:37.557846 [debug] [Thread-4 (]: Using duckdb connection "test.hw4_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m14:12:37.558165 [debug] [Thread-2 (]: On test.hw4_dbt.not_null_mart_merchant_analytics_merchant_id.61b4b4d63c: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.not_null_mart_merchant_analytics_merchant_id.61b4b4d63c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select merchant_id
from transactions.main_marts.mart_merchant_analytics
where merchant_id is null



      
    ) dbt_internal_test
[0m14:12:37.558409 [debug] [Thread-3 (]: On test.hw4_dbt.not_null_states_state_name.f652068228: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.not_null_states_state_name.f652068228"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select state_name
from transactions.main_transactions_db.states
where state_name is null



      
    ) dbt_internal_test
[0m14:12:37.558654 [debug] [Thread-1 (]: On test.hw4_dbt.not_null_states_state_code.4c83882290: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.not_null_states_state_code.4c83882290"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select state_code
from transactions.main_transactions_db.states
where state_code is null



      
    ) dbt_internal_test
[0m14:12:37.561230 [debug] [Thread-4 (]: On test.hw4_dbt.not_null_stg_transactions_amount.3629b5421e: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.not_null_stg_transactions_amount.3629b5421e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select amount
from transactions.main_staging.stg_transactions
where amount is null



      
    ) dbt_internal_test
[0m14:12:37.562615 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:12:37.562948 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:12:37.563897 [debug] [Thread-2 (]: On test.hw4_dbt.not_null_mart_merchant_analytics_merchant_id.61b4b4d63c: ROLLBACK
[0m14:12:37.564800 [debug] [Thread-3 (]: On test.hw4_dbt.not_null_states_state_name.f652068228: ROLLBACK
[0m14:12:37.565279 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:12:37.566640 [debug] [Thread-2 (]: Failed to rollback 'test.hw4_dbt.not_null_mart_merchant_analytics_merchant_id.61b4b4d63c'
[0m14:12:37.566974 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m14:12:37.567804 [debug] [Thread-3 (]: Failed to rollback 'test.hw4_dbt.not_null_states_state_name.f652068228'
[0m14:12:37.568982 [debug] [Thread-1 (]: On test.hw4_dbt.not_null_states_state_code.4c83882290: ROLLBACK
[0m14:12:37.569544 [debug] [Thread-2 (]: On test.hw4_dbt.not_null_mart_merchant_analytics_merchant_id.61b4b4d63c: Close
[0m14:12:37.570773 [debug] [Thread-4 (]: On test.hw4_dbt.not_null_stg_transactions_amount.3629b5421e: ROLLBACK
[0m14:12:37.571125 [debug] [Thread-3 (]: On test.hw4_dbt.not_null_states_state_name.f652068228: Close
[0m14:12:37.571559 [debug] [Thread-1 (]: Failed to rollback 'test.hw4_dbt.not_null_states_state_code.4c83882290'
[0m14:12:37.572059 [debug] [Thread-4 (]: Failed to rollback 'test.hw4_dbt.not_null_stg_transactions_amount.3629b5421e'
[0m14:12:37.572952 [debug] [Thread-1 (]: On test.hw4_dbt.not_null_states_state_code.4c83882290: Close
[0m14:12:37.572615 [info ] [Thread-2 (]: 28 of 56 PASS not_null_mart_merchant_analytics_merchant_id ..................... [[32mPASS[0m in 0.06s]
[0m14:12:37.574540 [debug] [Thread-4 (]: On test.hw4_dbt.not_null_stg_transactions_amount.3629b5421e: Close
[0m14:12:37.574099 [info ] [Thread-3 (]: 30 of 56 PASS not_null_states_state_name ....................................... [[32mPASS[0m in 0.05s]
[0m14:12:37.575362 [info ] [Thread-1 (]: 29 of 56 PASS not_null_states_state_code ....................................... [[32mPASS[0m in 0.06s]
[0m14:12:37.575784 [debug] [Thread-2 (]: Finished running node test.hw4_dbt.not_null_mart_merchant_analytics_merchant_id.61b4b4d63c
[0m14:12:37.576346 [debug] [Thread-3 (]: Finished running node test.hw4_dbt.not_null_states_state_name.f652068228
[0m14:12:37.576616 [debug] [Thread-1 (]: Finished running node test.hw4_dbt.not_null_states_state_code.4c83882290
[0m14:12:37.576966 [debug] [Thread-2 (]: Began running node test.hw4_dbt.not_null_stg_transactions_amount_bucket.ddccfce050
[0m14:12:37.577663 [debug] [Thread-3 (]: Began running node test.hw4_dbt.not_null_stg_transactions_cat_id.81205306d9
[0m14:12:37.581014 [info ] [Thread-3 (]: 33 of 56 START test not_null_stg_transactions_cat_id ........................... [RUN]
[0m14:12:37.579410 [debug] [Thread-1 (]: Began running node test.hw4_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m14:12:37.580623 [info ] [Thread-2 (]: 32 of 56 START test not_null_stg_transactions_amount_bucket .................... [RUN]
[0m14:12:37.578749 [info ] [Thread-4 (]: 31 of 56 PASS not_null_stg_transactions_amount ................................. [[32mPASS[0m in 0.05s]
[0m14:12:37.582485 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_states_state_name.f652068228, now test.hw4_dbt.not_null_stg_transactions_cat_id.81205306d9)
[0m14:12:37.584392 [info ] [Thread-1 (]: 34 of 56 START test not_null_stg_transactions_customer_id ...................... [RUN]
[0m14:12:37.585050 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_mart_merchant_analytics_merchant_id.61b4b4d63c, now test.hw4_dbt.not_null_stg_transactions_amount_bucket.ddccfce050)
[0m14:12:37.586282 [debug] [Thread-4 (]: Finished running node test.hw4_dbt.not_null_stg_transactions_amount.3629b5421e
[0m14:12:37.586571 [debug] [Thread-3 (]: Began compiling node test.hw4_dbt.not_null_stg_transactions_cat_id.81205306d9
[0m14:12:37.586954 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_states_state_code.4c83882290, now test.hw4_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf)
[0m14:12:37.587231 [debug] [Thread-2 (]: Began compiling node test.hw4_dbt.not_null_stg_transactions_amount_bucket.ddccfce050
[0m14:12:37.587489 [debug] [Thread-4 (]: Began running node test.hw4_dbt.not_null_stg_transactions_is_fraud.c832a79395
[0m14:12:37.590913 [debug] [Thread-3 (]: Writing injected SQL for node "test.hw4_dbt.not_null_stg_transactions_cat_id.81205306d9"
[0m14:12:37.591239 [debug] [Thread-1 (]: Began compiling node test.hw4_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m14:12:37.594664 [debug] [Thread-2 (]: Writing injected SQL for node "test.hw4_dbt.not_null_stg_transactions_amount_bucket.ddccfce050"
[0m14:12:37.595019 [info ] [Thread-4 (]: 35 of 56 START test not_null_stg_transactions_is_fraud ......................... [RUN]
[0m14:12:37.597722 [debug] [Thread-1 (]: Writing injected SQL for node "test.hw4_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m14:12:37.598503 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_stg_transactions_amount.3629b5421e, now test.hw4_dbt.not_null_stg_transactions_is_fraud.c832a79395)
[0m14:12:37.599033 [debug] [Thread-2 (]: Began executing node test.hw4_dbt.not_null_stg_transactions_amount_bucket.ddccfce050
[0m14:12:37.599362 [debug] [Thread-3 (]: Began executing node test.hw4_dbt.not_null_stg_transactions_cat_id.81205306d9
[0m14:12:37.599768 [debug] [Thread-4 (]: Began compiling node test.hw4_dbt.not_null_stg_transactions_is_fraud.c832a79395
[0m14:12:37.601391 [debug] [Thread-2 (]: Writing runtime sql for node "test.hw4_dbt.not_null_stg_transactions_amount_bucket.ddccfce050"
[0m14:12:37.602917 [debug] [Thread-3 (]: Writing runtime sql for node "test.hw4_dbt.not_null_stg_transactions_cat_id.81205306d9"
[0m14:12:37.603194 [debug] [Thread-1 (]: Began executing node test.hw4_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m14:12:37.607108 [debug] [Thread-4 (]: Writing injected SQL for node "test.hw4_dbt.not_null_stg_transactions_is_fraud.c832a79395"
[0m14:12:37.609901 [debug] [Thread-1 (]: Writing runtime sql for node "test.hw4_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m14:12:37.610477 [debug] [Thread-3 (]: Using duckdb connection "test.hw4_dbt.not_null_stg_transactions_cat_id.81205306d9"
[0m14:12:37.610860 [debug] [Thread-2 (]: Using duckdb connection "test.hw4_dbt.not_null_stg_transactions_amount_bucket.ddccfce050"
[0m14:12:37.611070 [debug] [Thread-3 (]: On test.hw4_dbt.not_null_stg_transactions_cat_id.81205306d9: BEGIN
[0m14:12:37.612143 [debug] [Thread-2 (]: On test.hw4_dbt.not_null_stg_transactions_amount_bucket.ddccfce050: BEGIN
[0m14:12:37.613206 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:12:37.613522 [debug] [Thread-4 (]: Began executing node test.hw4_dbt.not_null_stg_transactions_is_fraud.c832a79395
[0m14:12:37.613808 [debug] [Thread-1 (]: Using duckdb connection "test.hw4_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m14:12:37.614174 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:12:37.616539 [debug] [Thread-4 (]: Writing runtime sql for node "test.hw4_dbt.not_null_stg_transactions_is_fraud.c832a79395"
[0m14:12:37.616890 [debug] [Thread-1 (]: On test.hw4_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: BEGIN
[0m14:12:37.617397 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:37.617769 [debug] [Thread-4 (]: Using duckdb connection "test.hw4_dbt.not_null_stg_transactions_is_fraud.c832a79395"
[0m14:12:37.618016 [debug] [Thread-4 (]: On test.hw4_dbt.not_null_stg_transactions_is_fraud.c832a79395: BEGIN
[0m14:12:37.618335 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:12:37.623681 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m14:12:37.623990 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m14:12:37.624247 [debug] [Thread-3 (]: SQL status: OK in 0.011 seconds
[0m14:12:37.624571 [debug] [Thread-1 (]: Using duckdb connection "test.hw4_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m14:12:37.624825 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m14:12:37.625097 [debug] [Thread-2 (]: Using duckdb connection "test.hw4_dbt.not_null_stg_transactions_amount_bucket.ddccfce050"
[0m14:12:37.625378 [debug] [Thread-3 (]: Using duckdb connection "test.hw4_dbt.not_null_stg_transactions_cat_id.81205306d9"
[0m14:12:37.625715 [debug] [Thread-1 (]: On test.hw4_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from transactions.main_staging.stg_transactions
where customer_id is null



      
    ) dbt_internal_test
[0m14:12:37.626035 [debug] [Thread-4 (]: Using duckdb connection "test.hw4_dbt.not_null_stg_transactions_is_fraud.c832a79395"
[0m14:12:37.626325 [debug] [Thread-2 (]: On test.hw4_dbt.not_null_stg_transactions_amount_bucket.ddccfce050: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.not_null_stg_transactions_amount_bucket.ddccfce050"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select amount_bucket
from transactions.main_staging.stg_transactions
where amount_bucket is null



      
    ) dbt_internal_test
[0m14:12:37.626671 [debug] [Thread-3 (]: On test.hw4_dbt.not_null_stg_transactions_cat_id.81205306d9: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.not_null_stg_transactions_cat_id.81205306d9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select cat_id
from transactions.main_staging.stg_transactions
where cat_id is null



      
    ) dbt_internal_test
[0m14:12:37.627147 [debug] [Thread-4 (]: On test.hw4_dbt.not_null_stg_transactions_is_fraud.c832a79395: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.not_null_stg_transactions_is_fraud.c832a79395"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_fraud
from transactions.main_staging.stg_transactions
where is_fraud is null



      
    ) dbt_internal_test
[0m14:12:37.639220 [debug] [Thread-3 (]: SQL status: OK in 0.011 seconds
[0m14:12:37.647863 [debug] [Thread-4 (]: SQL status: OK in 0.020 seconds
[0m14:12:37.656091 [debug] [Thread-4 (]: On test.hw4_dbt.not_null_stg_transactions_is_fraud.c832a79395: ROLLBACK
[0m14:12:37.657488 [debug] [Thread-4 (]: Failed to rollback 'test.hw4_dbt.not_null_stg_transactions_is_fraud.c832a79395'
[0m14:12:37.657739 [debug] [Thread-4 (]: On test.hw4_dbt.not_null_stg_transactions_is_fraud.c832a79395: Close
[0m14:12:37.658080 [info ] [Thread-4 (]: 35 of 56 PASS not_null_stg_transactions_is_fraud ............................... [[32mPASS[0m in 0.06s]
[0m14:12:37.658349 [debug] [Thread-4 (]: Finished running node test.hw4_dbt.not_null_stg_transactions_is_fraud.c832a79395
[0m14:12:37.658548 [debug] [Thread-4 (]: Began running node test.hw4_dbt.not_null_stg_transactions_merchant_id.b64621d2d7
[0m14:12:37.659305 [info ] [Thread-4 (]: 36 of 56 START test not_null_stg_transactions_merchant_id ...................... [RUN]
[0m14:12:37.647625 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m14:12:37.659693 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_stg_transactions_is_fraud.c832a79395, now test.hw4_dbt.not_null_stg_transactions_merchant_id.b64621d2d7)
[0m14:12:37.663073 [debug] [Thread-3 (]: On test.hw4_dbt.not_null_stg_transactions_cat_id.81205306d9: ROLLBACK
[0m14:12:37.677043 [debug] [Thread-2 (]: On test.hw4_dbt.not_null_stg_transactions_amount_bucket.ddccfce050: ROLLBACK
[0m14:12:37.678255 [debug] [Thread-4 (]: Began compiling node test.hw4_dbt.not_null_stg_transactions_merchant_id.b64621d2d7
[0m14:12:37.679433 [debug] [Thread-3 (]: Failed to rollback 'test.hw4_dbt.not_null_stg_transactions_cat_id.81205306d9'
[0m14:12:37.681333 [debug] [Thread-2 (]: Failed to rollback 'test.hw4_dbt.not_null_stg_transactions_amount_bucket.ddccfce050'
[0m14:12:37.685107 [debug] [Thread-4 (]: Writing injected SQL for node "test.hw4_dbt.not_null_stg_transactions_merchant_id.b64621d2d7"
[0m14:12:37.685949 [debug] [Thread-3 (]: On test.hw4_dbt.not_null_stg_transactions_cat_id.81205306d9: Close
[0m14:12:37.686425 [debug] [Thread-2 (]: On test.hw4_dbt.not_null_stg_transactions_amount_bucket.ddccfce050: Close
[0m14:12:37.687484 [info ] [Thread-3 (]: 33 of 56 PASS not_null_stg_transactions_cat_id ................................. [[32mPASS[0m in 0.11s]
[0m14:12:37.687873 [debug] [Thread-4 (]: Began executing node test.hw4_dbt.not_null_stg_transactions_merchant_id.b64621d2d7
[0m14:12:37.688876 [info ] [Thread-2 (]: 32 of 56 PASS not_null_stg_transactions_amount_bucket .......................... [[32mPASS[0m in 0.10s]
[0m14:12:37.690697 [debug] [Thread-3 (]: Finished running node test.hw4_dbt.not_null_stg_transactions_cat_id.81205306d9
[0m14:12:37.692374 [debug] [Thread-4 (]: Writing runtime sql for node "test.hw4_dbt.not_null_stg_transactions_merchant_id.b64621d2d7"
[0m14:12:37.692748 [debug] [Thread-2 (]: Finished running node test.hw4_dbt.not_null_stg_transactions_amount_bucket.ddccfce050
[0m14:12:37.692986 [debug] [Thread-3 (]: Began running node test.hw4_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m14:12:37.695002 [debug] [Thread-2 (]: Began running node test.hw4_dbt.not_null_stg_transactions_transaction_hour.99d50d4d46
[0m14:12:37.696426 [debug] [Thread-4 (]: Using duckdb connection "test.hw4_dbt.not_null_stg_transactions_merchant_id.b64621d2d7"
[0m14:12:37.696901 [info ] [Thread-3 (]: 37 of 56 START test not_null_stg_transactions_transaction_date ................. [RUN]
[0m14:12:37.697637 [info ] [Thread-2 (]: 38 of 56 START test not_null_stg_transactions_transaction_hour ................. [RUN]
[0m14:12:37.698195 [debug] [Thread-4 (]: On test.hw4_dbt.not_null_stg_transactions_merchant_id.b64621d2d7: BEGIN
[0m14:12:37.700710 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_stg_transactions_cat_id.81205306d9, now test.hw4_dbt.not_null_stg_transactions_transaction_date.353bde368c)
[0m14:12:37.701080 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_stg_transactions_amount_bucket.ddccfce050, now test.hw4_dbt.not_null_stg_transactions_transaction_hour.99d50d4d46)
[0m14:12:37.702242 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:12:37.702619 [debug] [Thread-3 (]: Began compiling node test.hw4_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m14:12:37.702921 [debug] [Thread-2 (]: Began compiling node test.hw4_dbt.not_null_stg_transactions_transaction_hour.99d50d4d46
[0m14:12:37.705792 [debug] [Thread-3 (]: Writing injected SQL for node "test.hw4_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m14:12:37.706224 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m14:12:37.709756 [debug] [Thread-2 (]: Writing injected SQL for node "test.hw4_dbt.not_null_stg_transactions_transaction_hour.99d50d4d46"
[0m14:12:37.710097 [debug] [Thread-1 (]: SQL status: OK in 0.083 seconds
[0m14:12:37.710414 [debug] [Thread-4 (]: Using duckdb connection "test.hw4_dbt.not_null_stg_transactions_merchant_id.b64621d2d7"
[0m14:12:37.710887 [debug] [Thread-4 (]: On test.hw4_dbt.not_null_stg_transactions_merchant_id.b64621d2d7: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.not_null_stg_transactions_merchant_id.b64621d2d7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select merchant_id
from transactions.main_staging.stg_transactions
where merchant_id is null



      
    ) dbt_internal_test
[0m14:12:37.711166 [debug] [Thread-3 (]: Began executing node test.hw4_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m14:12:37.715492 [debug] [Thread-3 (]: Writing runtime sql for node "test.hw4_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m14:12:37.716400 [debug] [Thread-1 (]: On test.hw4_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: ROLLBACK
[0m14:12:37.716752 [debug] [Thread-2 (]: Began executing node test.hw4_dbt.not_null_stg_transactions_transaction_hour.99d50d4d46
[0m14:12:37.717183 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m14:12:37.717625 [debug] [Thread-1 (]: Failed to rollback 'test.hw4_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf'
[0m14:12:37.765421 [debug] [Thread-2 (]: Writing runtime sql for node "test.hw4_dbt.not_null_stg_transactions_transaction_hour.99d50d4d46"
[0m14:12:37.766686 [debug] [Thread-4 (]: On test.hw4_dbt.not_null_stg_transactions_merchant_id.b64621d2d7: ROLLBACK
[0m14:12:37.766990 [debug] [Thread-3 (]: Using duckdb connection "test.hw4_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m14:12:37.767297 [debug] [Thread-1 (]: On test.hw4_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: Close
[0m14:12:37.767755 [debug] [Thread-4 (]: Failed to rollback 'test.hw4_dbt.not_null_stg_transactions_merchant_id.b64621d2d7'
[0m14:12:37.767985 [debug] [Thread-3 (]: On test.hw4_dbt.not_null_stg_transactions_transaction_date.353bde368c: BEGIN
[0m14:12:37.768307 [debug] [Thread-2 (]: Using duckdb connection "test.hw4_dbt.not_null_stg_transactions_transaction_hour.99d50d4d46"
[0m14:12:37.768670 [info ] [Thread-1 (]: 34 of 56 PASS not_null_stg_transactions_customer_id ............................ [[32mPASS[0m in 0.18s]
[0m14:12:37.768972 [debug] [Thread-4 (]: On test.hw4_dbt.not_null_stg_transactions_merchant_id.b64621d2d7: Close
[0m14:12:37.769557 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:12:37.769804 [debug] [Thread-2 (]: On test.hw4_dbt.not_null_stg_transactions_transaction_hour.99d50d4d46: BEGIN
[0m14:12:37.770099 [debug] [Thread-1 (]: Finished running node test.hw4_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m14:12:37.770953 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:12:37.770682 [info ] [Thread-4 (]: 36 of 56 PASS not_null_stg_transactions_merchant_id ............................ [[32mPASS[0m in 0.11s]
[0m14:12:37.771301 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:12:37.771616 [debug] [Thread-1 (]: Began running node test.hw4_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m14:12:37.771912 [debug] [Thread-3 (]: Using duckdb connection "test.hw4_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m14:12:37.772218 [debug] [Thread-4 (]: Finished running node test.hw4_dbt.not_null_stg_transactions_merchant_id.b64621d2d7
[0m14:12:37.772620 [info ] [Thread-1 (]: 39 of 56 START test not_null_stg_transactions_transaction_id ................... [RUN]
[0m14:12:37.772915 [debug] [Thread-3 (]: On test.hw4_dbt.not_null_stg_transactions_transaction_date.353bde368c: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.not_null_stg_transactions_transaction_date.353bde368c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_date
from transactions.main_staging.stg_transactions
where transaction_date is null



      
    ) dbt_internal_test
[0m14:12:37.773156 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m14:12:37.773438 [debug] [Thread-4 (]: Began running node test.hw4_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m14:12:37.773833 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf, now test.hw4_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4)
[0m14:12:37.774304 [debug] [Thread-2 (]: Using duckdb connection "test.hw4_dbt.not_null_stg_transactions_transaction_hour.99d50d4d46"
[0m14:12:37.774594 [info ] [Thread-4 (]: 40 of 56 START test not_null_stg_transactions_transaction_ts ................... [RUN]
[0m14:12:37.774862 [debug] [Thread-1 (]: Began compiling node test.hw4_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m14:12:37.775166 [debug] [Thread-2 (]: On test.hw4_dbt.not_null_stg_transactions_transaction_hour.99d50d4d46: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.not_null_stg_transactions_transaction_hour.99d50d4d46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_hour
from transactions.main_staging.stg_transactions
where transaction_hour is null



      
    ) dbt_internal_test
[0m14:12:37.775411 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_stg_transactions_merchant_id.b64621d2d7, now test.hw4_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7)
[0m14:12:37.780788 [debug] [Thread-1 (]: Writing injected SQL for node "test.hw4_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m14:12:37.786197 [debug] [Thread-1 (]: Began executing node test.hw4_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m14:12:37.784894 [debug] [Thread-4 (]: Began compiling node test.hw4_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m14:12:37.789566 [debug] [Thread-1 (]: Writing runtime sql for node "test.hw4_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m14:12:37.797654 [debug] [Thread-4 (]: Writing injected SQL for node "test.hw4_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m14:12:37.797970 [debug] [Thread-3 (]: SQL status: OK in 0.024 seconds
[0m14:12:37.799349 [debug] [Thread-1 (]: Using duckdb connection "test.hw4_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m14:12:37.799794 [debug] [Thread-4 (]: Began executing node test.hw4_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m14:12:37.800721 [debug] [Thread-3 (]: On test.hw4_dbt.not_null_stg_transactions_transaction_date.353bde368c: ROLLBACK
[0m14:12:37.800970 [debug] [Thread-1 (]: On test.hw4_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: BEGIN
[0m14:12:37.801201 [debug] [Thread-2 (]: SQL status: OK in 0.020 seconds
[0m14:12:37.802762 [debug] [Thread-4 (]: Writing runtime sql for node "test.hw4_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m14:12:37.803470 [debug] [Thread-3 (]: Failed to rollback 'test.hw4_dbt.not_null_stg_transactions_transaction_date.353bde368c'
[0m14:12:37.803757 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:37.804703 [debug] [Thread-2 (]: On test.hw4_dbt.not_null_stg_transactions_transaction_hour.99d50d4d46: ROLLBACK
[0m14:12:37.804947 [debug] [Thread-3 (]: On test.hw4_dbt.not_null_stg_transactions_transaction_date.353bde368c: Close
[0m14:12:37.805400 [debug] [Thread-4 (]: Using duckdb connection "test.hw4_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m14:12:37.805620 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:12:37.805898 [debug] [Thread-2 (]: Failed to rollback 'test.hw4_dbt.not_null_stg_transactions_transaction_hour.99d50d4d46'
[0m14:12:37.806299 [info ] [Thread-3 (]: 37 of 56 PASS not_null_stg_transactions_transaction_date ....................... [[32mPASS[0m in 0.11s]
[0m14:12:37.806653 [debug] [Thread-4 (]: On test.hw4_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: BEGIN
[0m14:12:37.807079 [debug] [Thread-1 (]: Using duckdb connection "test.hw4_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m14:12:37.807334 [debug] [Thread-2 (]: On test.hw4_dbt.not_null_stg_transactions_transaction_hour.99d50d4d46: Close
[0m14:12:37.807728 [debug] [Thread-3 (]: Finished running node test.hw4_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m14:12:37.808012 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:12:37.808364 [debug] [Thread-1 (]: On test.hw4_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_id
from transactions.main_staging.stg_transactions
where transaction_id is null



      
    ) dbt_internal_test
[0m14:12:37.808802 [info ] [Thread-2 (]: 38 of 56 PASS not_null_stg_transactions_transaction_hour ....................... [[32mPASS[0m in 0.11s]
[0m14:12:37.809070 [debug] [Thread-3 (]: Began running node test.hw4_dbt.not_null_stg_transactions_us_state.11afe11a0c
[0m14:12:37.809832 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m14:12:37.810124 [debug] [Thread-2 (]: Finished running node test.hw4_dbt.not_null_stg_transactions_transaction_hour.99d50d4d46
[0m14:12:37.810461 [info ] [Thread-3 (]: 41 of 56 START test not_null_stg_transactions_us_state ......................... [RUN]
[0m14:12:37.811202 [debug] [Thread-4 (]: Using duckdb connection "test.hw4_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m14:12:37.815351 [debug] [Thread-4 (]: On test.hw4_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_ts
from transactions.main_staging.stg_transactions
where transaction_ts is null



      
    ) dbt_internal_test
[0m14:12:37.812144 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_stg_transactions_transaction_date.353bde368c, now test.hw4_dbt.not_null_stg_transactions_us_state.11afe11a0c)
[0m14:12:37.811755 [debug] [Thread-2 (]: Began running node test.hw4_dbt.relationships_stg_transactions_us_state__state_code__ref_states_.7b260553ef
[0m14:12:37.822805 [debug] [Thread-3 (]: Began compiling node test.hw4_dbt.not_null_stg_transactions_us_state.11afe11a0c
[0m14:12:37.823136 [info ] [Thread-2 (]: 42 of 56 START test relationships_stg_transactions_us_state__state_code__ref_states_  [RUN]
[0m14:12:37.829440 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_stg_transactions_transaction_hour.99d50d4d46, now test.hw4_dbt.relationships_stg_transactions_us_state__state_code__ref_states_.7b260553ef)
[0m14:12:37.827962 [debug] [Thread-3 (]: Writing injected SQL for node "test.hw4_dbt.not_null_stg_transactions_us_state.11afe11a0c"
[0m14:12:37.829722 [debug] [Thread-2 (]: Began compiling node test.hw4_dbt.relationships_stg_transactions_us_state__state_code__ref_states_.7b260553ef
[0m14:12:37.850086 [debug] [Thread-3 (]: Began executing node test.hw4_dbt.not_null_stg_transactions_us_state.11afe11a0c
[0m14:12:37.858805 [debug] [Thread-2 (]: Writing injected SQL for node "test.hw4_dbt.relationships_stg_transactions_us_state__state_code__ref_states_.7b260553ef"
[0m14:12:37.872772 [debug] [Thread-3 (]: Writing runtime sql for node "test.hw4_dbt.not_null_stg_transactions_us_state.11afe11a0c"
[0m14:12:37.881593 [debug] [Thread-3 (]: Using duckdb connection "test.hw4_dbt.not_null_stg_transactions_us_state.11afe11a0c"
[0m14:12:37.882113 [debug] [Thread-3 (]: On test.hw4_dbt.not_null_stg_transactions_us_state.11afe11a0c: BEGIN
[0m14:12:37.882490 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:12:37.882938 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m14:12:37.883121 [debug] [Thread-3 (]: Using duckdb connection "test.hw4_dbt.not_null_stg_transactions_us_state.11afe11a0c"
[0m14:12:37.883300 [debug] [Thread-3 (]: On test.hw4_dbt.not_null_stg_transactions_us_state.11afe11a0c: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.not_null_stg_transactions_us_state.11afe11a0c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select us_state
from transactions.main_staging.stg_transactions
where us_state is null



      
    ) dbt_internal_test
[0m14:12:37.887962 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m14:12:37.888944 [debug] [Thread-3 (]: On test.hw4_dbt.not_null_stg_transactions_us_state.11afe11a0c: ROLLBACK
[0m14:12:37.877952 [debug] [Thread-2 (]: Began executing node test.hw4_dbt.relationships_stg_transactions_us_state__state_code__ref_states_.7b260553ef
[0m14:12:37.889534 [debug] [Thread-3 (]: Failed to rollback 'test.hw4_dbt.not_null_stg_transactions_us_state.11afe11a0c'
[0m14:12:37.909348 [debug] [Thread-4 (]: SQL status: OK in 0.093 seconds
[0m14:12:37.909958 [debug] [Thread-3 (]: On test.hw4_dbt.not_null_stg_transactions_us_state.11afe11a0c: Close
[0m14:12:37.910662 [info ] [Thread-3 (]: 41 of 56 PASS not_null_stg_transactions_us_state ............................... [[32mPASS[0m in 0.10s]
[0m14:12:37.912255 [debug] [Thread-4 (]: On test.hw4_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: ROLLBACK
[0m14:12:37.912560 [debug] [Thread-3 (]: Finished running node test.hw4_dbt.not_null_stg_transactions_us_state.11afe11a0c
[0m14:12:37.913256 [debug] [Thread-4 (]: Failed to rollback 'test.hw4_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7'
[0m14:12:37.914165 [debug] [Thread-3 (]: Began running node test.hw4_dbt.source_accepted_values_transactions_db_transactions_target__0__1.ff30b0d50d
[0m14:12:37.914557 [debug] [Thread-4 (]: On test.hw4_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: Close
[0m14:12:37.917242 [debug] [Thread-2 (]: Writing runtime sql for node "test.hw4_dbt.relationships_stg_transactions_us_state__state_code__ref_states_.7b260553ef"
[0m14:12:37.918404 [info ] [Thread-3 (]: 43 of 56 START test source_accepted_values_transactions_db_transactions_target__0__1  [RUN]
[0m14:12:37.920710 [info ] [Thread-4 (]: 40 of 56 PASS not_null_stg_transactions_transaction_ts ......................... [[32mPASS[0m in 0.15s]
[0m14:12:37.921341 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_stg_transactions_us_state.11afe11a0c, now test.hw4_dbt.source_accepted_values_transactions_db_transactions_target__0__1.ff30b0d50d)
[0m14:12:37.922701 [debug] [Thread-4 (]: Finished running node test.hw4_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m14:12:37.924529 [debug] [Thread-4 (]: Began running node test.hw4_dbt.source_accepted_values_transactions_db_transactions_us_state__AL__AK__AZ__AR__CA__CO__CT__DC__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY.4941e4798c
[0m14:12:37.923848 [debug] [Thread-3 (]: Began compiling node test.hw4_dbt.source_accepted_values_transactions_db_transactions_target__0__1.ff30b0d50d
[0m14:12:37.924820 [info ] [Thread-4 (]: 44 of 56 START test source_accepted_values_transactions_db_transactions_us_state__AL__AK__AZ__AR__CA__CO__CT__DC__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY  [RUN]
[0m14:12:37.928588 [debug] [Thread-3 (]: Writing injected SQL for node "test.hw4_dbt.source_accepted_values_transactions_db_transactions_target__0__1.ff30b0d50d"
[0m14:12:37.923217 [debug] [Thread-2 (]: Using duckdb connection "test.hw4_dbt.relationships_stg_transactions_us_state__state_code__ref_states_.7b260553ef"
[0m14:12:37.929752 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7, now test.hw4_dbt.source_accepted_values_transactions_db_transactions_us_state__AL__AK__AZ__AR__CA__CO__CT__DC__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY.4941e4798c)
[0m14:12:37.930707 [debug] [Thread-3 (]: Began executing node test.hw4_dbt.source_accepted_values_transactions_db_transactions_target__0__1.ff30b0d50d
[0m14:12:37.930951 [debug] [Thread-2 (]: On test.hw4_dbt.relationships_stg_transactions_us_state__state_code__ref_states_.7b260553ef: BEGIN
[0m14:12:37.931843 [debug] [Thread-4 (]: Began compiling node test.hw4_dbt.source_accepted_values_transactions_db_transactions_us_state__AL__AK__AZ__AR__CA__CO__CT__DC__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY.4941e4798c
[0m14:12:37.933785 [debug] [Thread-3 (]: Writing runtime sql for node "test.hw4_dbt.source_accepted_values_transactions_db_transactions_target__0__1.ff30b0d50d"
[0m14:12:37.934579 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:12:37.948237 [debug] [Thread-1 (]: SQL status: OK in 0.139 seconds
[0m14:12:37.952232 [debug] [Thread-4 (]: Writing injected SQL for node "test.hw4_dbt.source_accepted_values_transactions_db_transactions_us_state__AL__AK__AZ__AR__CA__CO__CT__DC__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY.4941e4798c"
[0m14:12:37.953034 [debug] [Thread-2 (]: SQL status: OK in 0.018 seconds
[0m14:12:37.953939 [debug] [Thread-1 (]: On test.hw4_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: ROLLBACK
[0m14:12:37.954387 [debug] [Thread-2 (]: Using duckdb connection "test.hw4_dbt.relationships_stg_transactions_us_state__state_code__ref_states_.7b260553ef"
[0m14:12:37.954633 [debug] [Thread-4 (]: Began executing node test.hw4_dbt.source_accepted_values_transactions_db_transactions_us_state__AL__AK__AZ__AR__CA__CO__CT__DC__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY.4941e4798c
[0m14:12:37.954866 [debug] [Thread-3 (]: Using duckdb connection "test.hw4_dbt.source_accepted_values_transactions_db_transactions_target__0__1.ff30b0d50d"
[0m14:12:37.955194 [debug] [Thread-1 (]: Failed to rollback 'test.hw4_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4'
[0m14:12:37.955404 [debug] [Thread-2 (]: On test.hw4_dbt.relationships_stg_transactions_us_state__state_code__ref_states_.7b260553ef: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.relationships_stg_transactions_us_state__state_code__ref_states_.7b260553ef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select us_state as from_field
    from transactions.main_staging.stg_transactions
    where us_state is not null
),

parent as (
    select state_code as to_field
    from transactions.main_transactions_db.states
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m14:12:37.957777 [debug] [Thread-4 (]: Writing runtime sql for node "test.hw4_dbt.source_accepted_values_transactions_db_transactions_us_state__AL__AK__AZ__AR__CA__CO__CT__DC__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY.4941e4798c"
[0m14:12:37.958113 [debug] [Thread-3 (]: On test.hw4_dbt.source_accepted_values_transactions_db_transactions_target__0__1.ff30b0d50d: BEGIN
[0m14:12:37.958629 [debug] [Thread-1 (]: On test.hw4_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: Close
[0m14:12:37.959182 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:12:37.959916 [debug] [Thread-4 (]: Using duckdb connection "test.hw4_dbt.source_accepted_values_transactions_db_transactions_us_state__AL__AK__AZ__AR__CA__CO__CT__DC__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY.4941e4798c"
[0m14:12:37.960441 [debug] [Thread-4 (]: On test.hw4_dbt.source_accepted_values_transactions_db_transactions_us_state__AL__AK__AZ__AR__CA__CO__CT__DC__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY.4941e4798c: BEGIN
[0m14:12:37.960685 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:12:37.959669 [info ] [Thread-1 (]: 39 of 56 PASS not_null_stg_transactions_transaction_id ......................... [[32mPASS[0m in 0.19s]
[0m14:12:37.960958 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:12:37.961321 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:12:37.962985 [debug] [Thread-4 (]: Using duckdb connection "test.hw4_dbt.source_accepted_values_transactions_db_transactions_us_state__AL__AK__AZ__AR__CA__CO__CT__DC__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY.4941e4798c"
[0m14:12:37.962729 [debug] [Thread-3 (]: Using duckdb connection "test.hw4_dbt.source_accepted_values_transactions_db_transactions_target__0__1.ff30b0d50d"
[0m14:12:37.963244 [debug] [Thread-4 (]: On test.hw4_dbt.source_accepted_values_transactions_db_transactions_us_state__AL__AK__AZ__AR__CA__CO__CT__DC__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY.4941e4798c: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.source_accepted_values_transactions_db_transactions_us_state__AL__AK__AZ__AR__CA__CO__CT__DC__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY.4941e4798c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        us_state as value_field,
        count(*) as n_records

    from transactions.main_transactions_db.transactions
    group by us_state

)

select *
from all_values
where value_field not in (
    'AL','AK','AZ','AR','CA','CO','CT','DC','DE','FL','GA','HI','ID','IL','IN','IA','KS','KY','LA','ME','MD','MA','MI','MN','MS','MO','MT','NE','NV','NH','NJ','NM','NY','NC','ND','OH','OK','OR','PA','RI','SC','SD','TN','TX','UT','VT','VA','WA','WV','WI','WY'
)



      
    ) dbt_internal_test
[0m14:12:37.962405 [debug] [Thread-1 (]: Finished running node test.hw4_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m14:12:37.963495 [debug] [Thread-3 (]: On test.hw4_dbt.source_accepted_values_transactions_db_transactions_target__0__1.ff30b0d50d: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.source_accepted_values_transactions_db_transactions_target__0__1.ff30b0d50d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        target as value_field,
        count(*) as n_records

    from transactions.main_transactions_db.transactions
    group by target

)

select *
from all_values
where value_field not in (
    '0','1'
)



      
    ) dbt_internal_test
[0m14:12:37.967121 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:12:37.964384 [debug] [Thread-1 (]: Began running node test.hw4_dbt.source_not_null_transactions_db_transactions_amount.307a04757b
[0m14:12:37.968022 [debug] [Thread-3 (]: On test.hw4_dbt.source_accepted_values_transactions_db_transactions_target__0__1.ff30b0d50d: ROLLBACK
[0m14:12:37.968624 [debug] [Thread-3 (]: Failed to rollback 'test.hw4_dbt.source_accepted_values_transactions_db_transactions_target__0__1.ff30b0d50d'
[0m14:12:37.969105 [debug] [Thread-3 (]: On test.hw4_dbt.source_accepted_values_transactions_db_transactions_target__0__1.ff30b0d50d: Close
[0m14:12:37.969979 [info ] [Thread-3 (]: 43 of 56 PASS source_accepted_values_transactions_db_transactions_target__0__1 . [[32mPASS[0m in 0.05s]
[0m14:12:37.970297 [debug] [Thread-3 (]: Finished running node test.hw4_dbt.source_accepted_values_transactions_db_transactions_target__0__1.ff30b0d50d
[0m14:12:37.970504 [debug] [Thread-3 (]: Began running node test.hw4_dbt.source_not_null_transactions_db_transactions_cat_id.24c084b034
[0m14:12:37.970835 [info ] [Thread-3 (]: 46 of 56 START test source_not_null_transactions_db_transactions_cat_id ........ [RUN]
[0m14:12:37.968280 [info ] [Thread-1 (]: 45 of 56 START test source_not_null_transactions_db_transactions_amount ........ [RUN]
[0m14:12:37.971204 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.source_accepted_values_transactions_db_transactions_target__0__1.ff30b0d50d, now test.hw4_dbt.source_not_null_transactions_db_transactions_cat_id.24c084b034)
[0m14:12:37.972147 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4, now test.hw4_dbt.source_not_null_transactions_db_transactions_amount.307a04757b)
[0m14:12:37.972625 [debug] [Thread-3 (]: Began compiling node test.hw4_dbt.source_not_null_transactions_db_transactions_cat_id.24c084b034
[0m14:12:37.973167 [debug] [Thread-1 (]: Began compiling node test.hw4_dbt.source_not_null_transactions_db_transactions_amount.307a04757b
[0m14:12:37.976643 [debug] [Thread-3 (]: Writing injected SQL for node "test.hw4_dbt.source_not_null_transactions_db_transactions_cat_id.24c084b034"
[0m14:12:37.980617 [debug] [Thread-1 (]: Writing injected SQL for node "test.hw4_dbt.source_not_null_transactions_db_transactions_amount.307a04757b"
[0m14:12:37.981816 [debug] [Thread-3 (]: Began executing node test.hw4_dbt.source_not_null_transactions_db_transactions_cat_id.24c084b034
[0m14:12:37.982060 [debug] [Thread-1 (]: Began executing node test.hw4_dbt.source_not_null_transactions_db_transactions_amount.307a04757b
[0m14:12:37.984343 [debug] [Thread-3 (]: Writing runtime sql for node "test.hw4_dbt.source_not_null_transactions_db_transactions_cat_id.24c084b034"
[0m14:12:37.985975 [debug] [Thread-1 (]: Writing runtime sql for node "test.hw4_dbt.source_not_null_transactions_db_transactions_amount.307a04757b"
[0m14:12:37.986617 [debug] [Thread-2 (]: SQL status: OK in 0.028 seconds
[0m14:12:37.987125 [debug] [Thread-3 (]: Using duckdb connection "test.hw4_dbt.source_not_null_transactions_db_transactions_cat_id.24c084b034"
[0m14:12:37.987861 [debug] [Thread-1 (]: Using duckdb connection "test.hw4_dbt.source_not_null_transactions_db_transactions_amount.307a04757b"
[0m14:12:37.989777 [debug] [Thread-2 (]: On test.hw4_dbt.relationships_stg_transactions_us_state__state_code__ref_states_.7b260553ef: ROLLBACK
[0m14:12:37.990028 [debug] [Thread-3 (]: On test.hw4_dbt.source_not_null_transactions_db_transactions_cat_id.24c084b034: BEGIN
[0m14:12:37.990301 [debug] [Thread-1 (]: On test.hw4_dbt.source_not_null_transactions_db_transactions_amount.307a04757b: BEGIN
[0m14:12:37.990964 [debug] [Thread-2 (]: Failed to rollback 'test.hw4_dbt.relationships_stg_transactions_us_state__state_code__ref_states_.7b260553ef'
[0m14:12:37.991436 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:12:37.992029 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:37.992370 [debug] [Thread-2 (]: On test.hw4_dbt.relationships_stg_transactions_us_state__state_code__ref_states_.7b260553ef: Close
[0m14:12:37.992915 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:12:37.993345 [info ] [Thread-2 (]: 42 of 56 PASS relationships_stg_transactions_us_state__state_code__ref_states_ . [[32mPASS[0m in 0.16s]
[0m14:12:37.993718 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:12:37.993932 [debug] [Thread-4 (]: SQL status: OK in 0.030 seconds
[0m14:12:37.994140 [debug] [Thread-3 (]: Using duckdb connection "test.hw4_dbt.source_not_null_transactions_db_transactions_cat_id.24c084b034"
[0m14:12:37.994549 [debug] [Thread-2 (]: Finished running node test.hw4_dbt.relationships_stg_transactions_us_state__state_code__ref_states_.7b260553ef
[0m14:12:37.994819 [debug] [Thread-1 (]: Using duckdb connection "test.hw4_dbt.source_not_null_transactions_db_transactions_amount.307a04757b"
[0m14:12:37.995916 [debug] [Thread-4 (]: On test.hw4_dbt.source_accepted_values_transactions_db_transactions_us_state__AL__AK__AZ__AR__CA__CO__CT__DC__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY.4941e4798c: ROLLBACK
[0m14:12:37.996220 [debug] [Thread-3 (]: On test.hw4_dbt.source_not_null_transactions_db_transactions_cat_id.24c084b034: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.source_not_null_transactions_db_transactions_cat_id.24c084b034"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select cat_id
from transactions.main_transactions_db.transactions
where cat_id is null



      
    ) dbt_internal_test
[0m14:12:37.996581 [debug] [Thread-2 (]: Began running node test.hw4_dbt.source_not_null_transactions_db_transactions_merch.b9d9c15594
[0m14:12:37.996920 [debug] [Thread-1 (]: On test.hw4_dbt.source_not_null_transactions_db_transactions_amount.307a04757b: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.source_not_null_transactions_db_transactions_amount.307a04757b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select amount
from transactions.main_transactions_db.transactions
where amount is null



      
    ) dbt_internal_test
[0m14:12:37.997326 [debug] [Thread-4 (]: Failed to rollback 'test.hw4_dbt.source_accepted_values_transactions_db_transactions_us_state__AL__AK__AZ__AR__CA__CO__CT__DC__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY.4941e4798c'
[0m14:12:37.997809 [info ] [Thread-2 (]: 47 of 56 START test source_not_null_transactions_db_transactions_merch ......... [RUN]
[0m14:12:37.998185 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:12:37.999197 [debug] [Thread-4 (]: On test.hw4_dbt.source_accepted_values_transactions_db_transactions_us_state__AL__AK__AZ__AR__CA__CO__CT__DC__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY.4941e4798c: Close
[0m14:12:37.999969 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.relationships_stg_transactions_us_state__state_code__ref_states_.7b260553ef, now test.hw4_dbt.source_not_null_transactions_db_transactions_merch.b9d9c15594)
[0m14:12:38.001155 [debug] [Thread-3 (]: On test.hw4_dbt.source_not_null_transactions_db_transactions_cat_id.24c084b034: ROLLBACK
[0m14:12:38.001564 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:12:38.002008 [info ] [Thread-4 (]: 44 of 56 PASS source_accepted_values_transactions_db_transactions_us_state__AL__AK__AZ__AR__CA__CO__CT__DC__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY  [[32mPASS[0m in 0.07s]
[0m14:12:38.002303 [debug] [Thread-2 (]: Began compiling node test.hw4_dbt.source_not_null_transactions_db_transactions_merch.b9d9c15594
[0m14:12:38.002779 [debug] [Thread-3 (]: Failed to rollback 'test.hw4_dbt.source_not_null_transactions_db_transactions_cat_id.24c084b034'
[0m14:12:38.004009 [debug] [Thread-1 (]: On test.hw4_dbt.source_not_null_transactions_db_transactions_amount.307a04757b: ROLLBACK
[0m14:12:38.004511 [debug] [Thread-4 (]: Finished running node test.hw4_dbt.source_accepted_values_transactions_db_transactions_us_state__AL__AK__AZ__AR__CA__CO__CT__DC__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY.4941e4798c
[0m14:12:38.008049 [debug] [Thread-2 (]: Writing injected SQL for node "test.hw4_dbt.source_not_null_transactions_db_transactions_merch.b9d9c15594"
[0m14:12:38.009186 [debug] [Thread-3 (]: On test.hw4_dbt.source_not_null_transactions_db_transactions_cat_id.24c084b034: Close
[0m14:12:38.009655 [debug] [Thread-1 (]: Failed to rollback 'test.hw4_dbt.source_not_null_transactions_db_transactions_amount.307a04757b'
[0m14:12:38.009988 [debug] [Thread-4 (]: Began running node test.hw4_dbt.source_not_null_transactions_db_transactions_target.ee81663a6c
[0m14:12:38.011079 [debug] [Thread-1 (]: On test.hw4_dbt.source_not_null_transactions_db_transactions_amount.307a04757b: Close
[0m14:12:38.010693 [info ] [Thread-3 (]: 46 of 56 PASS source_not_null_transactions_db_transactions_cat_id .............. [[32mPASS[0m in 0.04s]
[0m14:12:38.015073 [debug] [Thread-3 (]: Finished running node test.hw4_dbt.source_not_null_transactions_db_transactions_cat_id.24c084b034
[0m14:12:38.015538 [debug] [Thread-3 (]: Began running node test.hw4_dbt.source_not_null_transactions_db_transactions_transaction_time.b0308d1b6c
[0m14:12:38.011801 [info ] [Thread-4 (]: 48 of 56 START test source_not_null_transactions_db_transactions_target ........ [RUN]
[0m14:12:38.019045 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.source_accepted_values_transactions_db_transactions_us_state__AL__AK__AZ__AR__CA__CO__CT__DC__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY.4941e4798c, now test.hw4_dbt.source_not_null_transactions_db_transactions_target.ee81663a6c)
[0m14:12:38.012573 [debug] [Thread-2 (]: Began executing node test.hw4_dbt.source_not_null_transactions_db_transactions_merch.b9d9c15594
[0m14:12:38.015961 [info ] [Thread-3 (]: 49 of 56 START test source_not_null_transactions_db_transactions_transaction_time  [RUN]
[0m14:12:38.019861 [debug] [Thread-4 (]: Began compiling node test.hw4_dbt.source_not_null_transactions_db_transactions_target.ee81663a6c
[0m14:12:38.025277 [debug] [Thread-2 (]: Writing runtime sql for node "test.hw4_dbt.source_not_null_transactions_db_transactions_merch.b9d9c15594"
[0m14:12:38.026618 [info ] [Thread-1 (]: 45 of 56 PASS source_not_null_transactions_db_transactions_amount .............. [[32mPASS[0m in 0.05s]
[0m14:12:38.027855 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.source_not_null_transactions_db_transactions_cat_id.24c084b034, now test.hw4_dbt.source_not_null_transactions_db_transactions_transaction_time.b0308d1b6c)
[0m14:12:38.032843 [debug] [Thread-4 (]: Writing injected SQL for node "test.hw4_dbt.source_not_null_transactions_db_transactions_target.ee81663a6c"
[0m14:12:38.034797 [debug] [Thread-1 (]: Finished running node test.hw4_dbt.source_not_null_transactions_db_transactions_amount.307a04757b
[0m14:12:38.035369 [debug] [Thread-3 (]: Began compiling node test.hw4_dbt.source_not_null_transactions_db_transactions_transaction_time.b0308d1b6c
[0m14:12:38.035838 [debug] [Thread-2 (]: Using duckdb connection "test.hw4_dbt.source_not_null_transactions_db_transactions_merch.b9d9c15594"
[0m14:12:38.038362 [debug] [Thread-1 (]: Began running node test.hw4_dbt.source_not_null_transactions_db_transactions_us_state.4999dadbbc
[0m14:12:38.038905 [debug] [Thread-4 (]: Began executing node test.hw4_dbt.source_not_null_transactions_db_transactions_target.ee81663a6c
[0m14:12:38.043490 [debug] [Thread-3 (]: Writing injected SQL for node "test.hw4_dbt.source_not_null_transactions_db_transactions_transaction_time.b0308d1b6c"
[0m14:12:38.043907 [debug] [Thread-2 (]: On test.hw4_dbt.source_not_null_transactions_db_transactions_merch.b9d9c15594: BEGIN
[0m14:12:38.050246 [debug] [Thread-4 (]: Writing runtime sql for node "test.hw4_dbt.source_not_null_transactions_db_transactions_target.ee81663a6c"
[0m14:12:38.044173 [info ] [Thread-1 (]: 50 of 56 START test source_not_null_transactions_db_transactions_us_state ...... [RUN]
[0m14:12:38.051209 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:12:38.051767 [debug] [Thread-3 (]: Began executing node test.hw4_dbt.source_not_null_transactions_db_transactions_transaction_time.b0308d1b6c
[0m14:12:38.052200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.source_not_null_transactions_db_transactions_amount.307a04757b, now test.hw4_dbt.source_not_null_transactions_db_transactions_us_state.4999dadbbc)
[0m14:12:38.053814 [debug] [Thread-4 (]: Using duckdb connection "test.hw4_dbt.source_not_null_transactions_db_transactions_target.ee81663a6c"
[0m14:12:38.059871 [debug] [Thread-3 (]: Writing runtime sql for node "test.hw4_dbt.source_not_null_transactions_db_transactions_transaction_time.b0308d1b6c"
[0m14:12:38.062523 [debug] [Thread-3 (]: Using duckdb connection "test.hw4_dbt.source_not_null_transactions_db_transactions_transaction_time.b0308d1b6c"
[0m14:12:38.061099 [debug] [Thread-4 (]: On test.hw4_dbt.source_not_null_transactions_db_transactions_target.ee81663a6c: BEGIN
[0m14:12:38.060637 [debug] [Thread-1 (]: Began compiling node test.hw4_dbt.source_not_null_transactions_db_transactions_us_state.4999dadbbc
[0m14:12:38.063440 [debug] [Thread-3 (]: On test.hw4_dbt.source_not_null_transactions_db_transactions_transaction_time.b0308d1b6c: BEGIN
[0m14:12:38.063776 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:12:38.071075 [debug] [Thread-1 (]: Writing injected SQL for node "test.hw4_dbt.source_not_null_transactions_db_transactions_us_state.4999dadbbc"
[0m14:12:38.071976 [debug] [Thread-2 (]: SQL status: OK in 0.021 seconds
[0m14:12:38.072637 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:12:38.073636 [debug] [Thread-2 (]: Using duckdb connection "test.hw4_dbt.source_not_null_transactions_db_transactions_merch.b9d9c15594"
[0m14:12:38.074672 [debug] [Thread-4 (]: SQL status: OK in 0.011 seconds
[0m14:12:38.075404 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m14:12:38.075644 [debug] [Thread-1 (]: Began executing node test.hw4_dbt.source_not_null_transactions_db_transactions_us_state.4999dadbbc
[0m14:12:38.075930 [debug] [Thread-2 (]: On test.hw4_dbt.source_not_null_transactions_db_transactions_merch.b9d9c15594: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.source_not_null_transactions_db_transactions_merch.b9d9c15594"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select merch
from transactions.main_transactions_db.transactions
where merch is null



      
    ) dbt_internal_test
[0m14:12:38.076224 [debug] [Thread-4 (]: Using duckdb connection "test.hw4_dbt.source_not_null_transactions_db_transactions_target.ee81663a6c"
[0m14:12:38.076530 [debug] [Thread-3 (]: Using duckdb connection "test.hw4_dbt.source_not_null_transactions_db_transactions_transaction_time.b0308d1b6c"
[0m14:12:38.078950 [debug] [Thread-1 (]: Writing runtime sql for node "test.hw4_dbt.source_not_null_transactions_db_transactions_us_state.4999dadbbc"
[0m14:12:38.079694 [debug] [Thread-4 (]: On test.hw4_dbt.source_not_null_transactions_db_transactions_target.ee81663a6c: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.source_not_null_transactions_db_transactions_target.ee81663a6c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select target
from transactions.main_transactions_db.transactions
where target is null



      
    ) dbt_internal_test
[0m14:12:38.080269 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:12:38.080733 [debug] [Thread-3 (]: On test.hw4_dbt.source_not_null_transactions_db_transactions_transaction_time.b0308d1b6c: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.source_not_null_transactions_db_transactions_transaction_time.b0308d1b6c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_time
from transactions.main_transactions_db.transactions
where transaction_time is null



      
    ) dbt_internal_test
[0m14:12:38.081494 [debug] [Thread-1 (]: Using duckdb connection "test.hw4_dbt.source_not_null_transactions_db_transactions_us_state.4999dadbbc"
[0m14:12:38.082713 [debug] [Thread-2 (]: On test.hw4_dbt.source_not_null_transactions_db_transactions_merch.b9d9c15594: ROLLBACK
[0m14:12:38.083188 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m14:12:38.083693 [debug] [Thread-1 (]: On test.hw4_dbt.source_not_null_transactions_db_transactions_us_state.4999dadbbc: BEGIN
[0m14:12:38.084106 [debug] [Thread-2 (]: Failed to rollback 'test.hw4_dbt.source_not_null_transactions_db_transactions_merch.b9d9c15594'
[0m14:12:38.084338 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:12:38.085218 [debug] [Thread-4 (]: On test.hw4_dbt.source_not_null_transactions_db_transactions_target.ee81663a6c: ROLLBACK
[0m14:12:38.085440 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:38.088124 [debug] [Thread-2 (]: On test.hw4_dbt.source_not_null_transactions_db_transactions_merch.b9d9c15594: Close
[0m14:12:38.088599 [debug] [Thread-4 (]: Failed to rollback 'test.hw4_dbt.source_not_null_transactions_db_transactions_target.ee81663a6c'
[0m14:12:38.089357 [debug] [Thread-3 (]: On test.hw4_dbt.source_not_null_transactions_db_transactions_transaction_time.b0308d1b6c: ROLLBACK
[0m14:12:38.090345 [info ] [Thread-2 (]: 47 of 56 PASS source_not_null_transactions_db_transactions_merch ............... [[32mPASS[0m in 0.09s]
[0m14:12:38.090679 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m14:12:38.091525 [debug] [Thread-4 (]: On test.hw4_dbt.source_not_null_transactions_db_transactions_target.ee81663a6c: Close
[0m14:12:38.091905 [debug] [Thread-3 (]: Failed to rollback 'test.hw4_dbt.source_not_null_transactions_db_transactions_transaction_time.b0308d1b6c'
[0m14:12:38.092482 [debug] [Thread-2 (]: Finished running node test.hw4_dbt.source_not_null_transactions_db_transactions_merch.b9d9c15594
[0m14:12:38.092756 [debug] [Thread-1 (]: Using duckdb connection "test.hw4_dbt.source_not_null_transactions_db_transactions_us_state.4999dadbbc"
[0m14:12:38.093203 [info ] [Thread-4 (]: 48 of 56 PASS source_not_null_transactions_db_transactions_target .............. [[32mPASS[0m in 0.07s]
[0m14:12:38.093844 [debug] [Thread-3 (]: On test.hw4_dbt.source_not_null_transactions_db_transactions_transaction_time.b0308d1b6c: Close
[0m14:12:38.094434 [debug] [Thread-2 (]: Began running node test.hw4_dbt.unique_mart_customer_risk_profile_customer_id.7b43a6fbd0
[0m14:12:38.094742 [debug] [Thread-1 (]: On test.hw4_dbt.source_not_null_transactions_db_transactions_us_state.4999dadbbc: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.source_not_null_transactions_db_transactions_us_state.4999dadbbc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select us_state
from transactions.main_transactions_db.transactions
where us_state is null



      
    ) dbt_internal_test
[0m14:12:38.095054 [debug] [Thread-4 (]: Finished running node test.hw4_dbt.source_not_null_transactions_db_transactions_target.ee81663a6c
[0m14:12:38.095641 [info ] [Thread-2 (]: 51 of 56 START test unique_mart_customer_risk_profile_customer_id .............. [RUN]
[0m14:12:38.096317 [info ] [Thread-3 (]: 49 of 56 PASS source_not_null_transactions_db_transactions_transaction_time .... [[32mPASS[0m in 0.07s]
[0m14:12:38.096884 [debug] [Thread-4 (]: Began running node test.hw4_dbt.unique_mart_fraud_by_category_cat_id.69c514d94d
[0m14:12:38.097460 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.source_not_null_transactions_db_transactions_merch.b9d9c15594, now test.hw4_dbt.unique_mart_customer_risk_profile_customer_id.7b43a6fbd0)
[0m14:12:38.097686 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:12:38.098024 [debug] [Thread-3 (]: Finished running node test.hw4_dbt.source_not_null_transactions_db_transactions_transaction_time.b0308d1b6c
[0m14:12:38.098985 [info ] [Thread-4 (]: 52 of 56 START test unique_mart_fraud_by_category_cat_id ....................... [RUN]
[0m14:12:38.100410 [debug] [Thread-2 (]: Began compiling node test.hw4_dbt.unique_mart_customer_risk_profile_customer_id.7b43a6fbd0
[0m14:12:38.101273 [debug] [Thread-1 (]: On test.hw4_dbt.source_not_null_transactions_db_transactions_us_state.4999dadbbc: ROLLBACK
[0m14:12:38.101498 [debug] [Thread-3 (]: Began running node test.hw4_dbt.unique_mart_fraud_by_state_us_state.45e47cf1a6
[0m14:12:38.101754 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.source_not_null_transactions_db_transactions_target.ee81663a6c, now test.hw4_dbt.unique_mart_fraud_by_category_cat_id.69c514d94d)
[0m14:12:38.105837 [debug] [Thread-2 (]: Writing injected SQL for node "test.hw4_dbt.unique_mart_customer_risk_profile_customer_id.7b43a6fbd0"
[0m14:12:38.106345 [debug] [Thread-1 (]: Failed to rollback 'test.hw4_dbt.source_not_null_transactions_db_transactions_us_state.4999dadbbc'
[0m14:12:38.109157 [info ] [Thread-3 (]: 53 of 56 START test unique_mart_fraud_by_state_us_state ........................ [RUN]
[0m14:12:38.109527 [debug] [Thread-4 (]: Began compiling node test.hw4_dbt.unique_mart_fraud_by_category_cat_id.69c514d94d
[0m14:12:38.110055 [debug] [Thread-1 (]: On test.hw4_dbt.source_not_null_transactions_db_transactions_us_state.4999dadbbc: Close
[0m14:12:38.110395 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.source_not_null_transactions_db_transactions_transaction_time.b0308d1b6c, now test.hw4_dbt.unique_mart_fraud_by_state_us_state.45e47cf1a6)
[0m14:12:38.113072 [debug] [Thread-4 (]: Writing injected SQL for node "test.hw4_dbt.unique_mart_fraud_by_category_cat_id.69c514d94d"
[0m14:12:38.113284 [debug] [Thread-2 (]: Began executing node test.hw4_dbt.unique_mart_customer_risk_profile_customer_id.7b43a6fbd0
[0m14:12:38.113832 [debug] [Thread-3 (]: Began compiling node test.hw4_dbt.unique_mart_fraud_by_state_us_state.45e47cf1a6
[0m14:12:38.116413 [debug] [Thread-2 (]: Writing runtime sql for node "test.hw4_dbt.unique_mart_customer_risk_profile_customer_id.7b43a6fbd0"
[0m14:12:38.115046 [info ] [Thread-1 (]: 50 of 56 PASS source_not_null_transactions_db_transactions_us_state ............ [[32mPASS[0m in 0.06s]
[0m14:12:38.119128 [debug] [Thread-3 (]: Writing injected SQL for node "test.hw4_dbt.unique_mart_fraud_by_state_us_state.45e47cf1a6"
[0m14:12:38.119409 [debug] [Thread-4 (]: Began executing node test.hw4_dbt.unique_mart_fraud_by_category_cat_id.69c514d94d
[0m14:12:38.119835 [debug] [Thread-1 (]: Finished running node test.hw4_dbt.source_not_null_transactions_db_transactions_us_state.4999dadbbc
[0m14:12:38.123602 [debug] [Thread-4 (]: Writing runtime sql for node "test.hw4_dbt.unique_mart_fraud_by_category_cat_id.69c514d94d"
[0m14:12:38.123902 [debug] [Thread-2 (]: Using duckdb connection "test.hw4_dbt.unique_mart_customer_risk_profile_customer_id.7b43a6fbd0"
[0m14:12:38.124214 [debug] [Thread-1 (]: Began running node test.hw4_dbt.unique_mart_merchant_analytics_merchant_id.58d0768274
[0m14:12:38.124491 [debug] [Thread-3 (]: Began executing node test.hw4_dbt.unique_mart_fraud_by_state_us_state.45e47cf1a6
[0m14:12:38.124719 [debug] [Thread-2 (]: On test.hw4_dbt.unique_mart_customer_risk_profile_customer_id.7b43a6fbd0: BEGIN
[0m14:12:38.124965 [info ] [Thread-1 (]: 54 of 56 START test unique_mart_merchant_analytics_merchant_id ................. [RUN]
[0m14:12:38.125236 [debug] [Thread-4 (]: Using duckdb connection "test.hw4_dbt.unique_mart_fraud_by_category_cat_id.69c514d94d"
[0m14:12:38.127194 [debug] [Thread-3 (]: Writing runtime sql for node "test.hw4_dbt.unique_mart_fraud_by_state_us_state.45e47cf1a6"
[0m14:12:38.127560 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:12:38.127831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.source_not_null_transactions_db_transactions_us_state.4999dadbbc, now test.hw4_dbt.unique_mart_merchant_analytics_merchant_id.58d0768274)
[0m14:12:38.128035 [debug] [Thread-4 (]: On test.hw4_dbt.unique_mart_fraud_by_category_cat_id.69c514d94d: BEGIN
[0m14:12:38.128366 [debug] [Thread-1 (]: Began compiling node test.hw4_dbt.unique_mart_merchant_analytics_merchant_id.58d0768274
[0m14:12:38.128569 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:12:38.131423 [debug] [Thread-1 (]: Writing injected SQL for node "test.hw4_dbt.unique_mart_merchant_analytics_merchant_id.58d0768274"
[0m14:12:38.131727 [debug] [Thread-3 (]: Using duckdb connection "test.hw4_dbt.unique_mart_fraud_by_state_us_state.45e47cf1a6"
[0m14:12:38.132088 [debug] [Thread-3 (]: On test.hw4_dbt.unique_mart_fraud_by_state_us_state.45e47cf1a6: BEGIN
[0m14:12:38.132308 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:12:38.132533 [debug] [Thread-1 (]: Began executing node test.hw4_dbt.unique_mart_merchant_analytics_merchant_id.58d0768274
[0m14:12:38.134688 [debug] [Thread-1 (]: Writing runtime sql for node "test.hw4_dbt.unique_mart_merchant_analytics_merchant_id.58d0768274"
[0m14:12:38.135385 [debug] [Thread-1 (]: Using duckdb connection "test.hw4_dbt.unique_mart_merchant_analytics_merchant_id.58d0768274"
[0m14:12:38.135589 [debug] [Thread-1 (]: On test.hw4_dbt.unique_mart_merchant_analytics_merchant_id.58d0768274: BEGIN
[0m14:12:38.135757 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:38.136836 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m14:12:38.137056 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m14:12:38.137276 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m14:12:38.137441 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:12:38.137668 [debug] [Thread-2 (]: Using duckdb connection "test.hw4_dbt.unique_mart_customer_risk_profile_customer_id.7b43a6fbd0"
[0m14:12:38.137884 [debug] [Thread-4 (]: Using duckdb connection "test.hw4_dbt.unique_mart_fraud_by_category_cat_id.69c514d94d"
[0m14:12:38.138162 [debug] [Thread-3 (]: Using duckdb connection "test.hw4_dbt.unique_mart_fraud_by_state_us_state.45e47cf1a6"
[0m14:12:38.138512 [debug] [Thread-1 (]: Using duckdb connection "test.hw4_dbt.unique_mart_merchant_analytics_merchant_id.58d0768274"
[0m14:12:38.138889 [debug] [Thread-2 (]: On test.hw4_dbt.unique_mart_customer_risk_profile_customer_id.7b43a6fbd0: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.unique_mart_customer_risk_profile_customer_id.7b43a6fbd0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from transactions.main_marts.mart_customer_risk_profile
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:12:38.139205 [debug] [Thread-4 (]: On test.hw4_dbt.unique_mart_fraud_by_category_cat_id.69c514d94d: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.unique_mart_fraud_by_category_cat_id.69c514d94d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    cat_id as unique_field,
    count(*) as n_records

from transactions.main_marts.mart_fraud_by_category
where cat_id is not null
group by cat_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:12:38.139511 [debug] [Thread-3 (]: On test.hw4_dbt.unique_mart_fraud_by_state_us_state.45e47cf1a6: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.unique_mart_fraud_by_state_us_state.45e47cf1a6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    us_state as unique_field,
    count(*) as n_records

from transactions.main_marts.mart_fraud_by_state
where us_state is not null
group by us_state
having count(*) > 1



      
    ) dbt_internal_test
[0m14:12:38.139797 [debug] [Thread-1 (]: On test.hw4_dbt.unique_mart_merchant_analytics_merchant_id.58d0768274: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.unique_mart_merchant_analytics_merchant_id.58d0768274"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    merchant_id as unique_field,
    count(*) as n_records

from transactions.main_marts.mart_merchant_analytics
where merchant_id is not null
group by merchant_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:12:38.141368 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:12:38.142346 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m14:12:38.142674 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:12:38.142900 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:12:38.143798 [debug] [Thread-4 (]: On test.hw4_dbt.unique_mart_fraud_by_category_cat_id.69c514d94d: ROLLBACK
[0m14:12:38.144599 [debug] [Thread-2 (]: On test.hw4_dbt.unique_mart_customer_risk_profile_customer_id.7b43a6fbd0: ROLLBACK
[0m14:12:38.145472 [debug] [Thread-3 (]: On test.hw4_dbt.unique_mart_fraud_by_state_us_state.45e47cf1a6: ROLLBACK
[0m14:12:38.146174 [debug] [Thread-1 (]: On test.hw4_dbt.unique_mart_merchant_analytics_merchant_id.58d0768274: ROLLBACK
[0m14:12:38.146480 [debug] [Thread-4 (]: Failed to rollback 'test.hw4_dbt.unique_mart_fraud_by_category_cat_id.69c514d94d'
[0m14:12:38.146836 [debug] [Thread-2 (]: Failed to rollback 'test.hw4_dbt.unique_mart_customer_risk_profile_customer_id.7b43a6fbd0'
[0m14:12:38.147130 [debug] [Thread-3 (]: Failed to rollback 'test.hw4_dbt.unique_mart_fraud_by_state_us_state.45e47cf1a6'
[0m14:12:38.147388 [debug] [Thread-1 (]: Failed to rollback 'test.hw4_dbt.unique_mart_merchant_analytics_merchant_id.58d0768274'
[0m14:12:38.147629 [debug] [Thread-4 (]: On test.hw4_dbt.unique_mart_fraud_by_category_cat_id.69c514d94d: Close
[0m14:12:38.147863 [debug] [Thread-2 (]: On test.hw4_dbt.unique_mart_customer_risk_profile_customer_id.7b43a6fbd0: Close
[0m14:12:38.148090 [debug] [Thread-3 (]: On test.hw4_dbt.unique_mart_fraud_by_state_us_state.45e47cf1a6: Close
[0m14:12:38.148299 [debug] [Thread-1 (]: On test.hw4_dbt.unique_mart_merchant_analytics_merchant_id.58d0768274: Close
[0m14:12:38.148711 [info ] [Thread-4 (]: 52 of 56 PASS unique_mart_fraud_by_category_cat_id ............................. [[32mPASS[0m in 0.05s]
[0m14:12:38.149097 [info ] [Thread-2 (]: 51 of 56 PASS unique_mart_customer_risk_profile_customer_id .................... [[32mPASS[0m in 0.05s]
[0m14:12:38.149855 [info ] [Thread-3 (]: 53 of 56 PASS unique_mart_fraud_by_state_us_state .............................. [[32mPASS[0m in 0.04s]
[0m14:12:38.150411 [debug] [Thread-4 (]: Finished running node test.hw4_dbt.unique_mart_fraud_by_category_cat_id.69c514d94d
[0m14:12:38.150721 [debug] [Thread-2 (]: Finished running node test.hw4_dbt.unique_mart_customer_risk_profile_customer_id.7b43a6fbd0
[0m14:12:38.151104 [debug] [Thread-3 (]: Finished running node test.hw4_dbt.unique_mart_fraud_by_state_us_state.45e47cf1a6
[0m14:12:38.151418 [debug] [Thread-4 (]: Began running node test.hw4_dbt.unique_states_state_code.67c4706beb
[0m14:12:38.151720 [info ] [Thread-1 (]: 54 of 56 PASS unique_mart_merchant_analytics_merchant_id ....................... [[32mPASS[0m in 0.02s]
[0m14:12:38.151974 [debug] [Thread-2 (]: Began running node test.hw4_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m14:12:38.152350 [info ] [Thread-4 (]: 55 of 56 START test unique_states_state_code ................................... [RUN]
[0m14:12:38.152659 [debug] [Thread-1 (]: Finished running node test.hw4_dbt.unique_mart_merchant_analytics_merchant_id.58d0768274
[0m14:12:38.152919 [info ] [Thread-2 (]: 56 of 56 START test unique_stg_transactions_transaction_id ..................... [RUN]
[0m14:12:38.153493 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.unique_mart_fraud_by_category_cat_id.69c514d94d, now test.hw4_dbt.unique_states_state_code.67c4706beb)
[0m14:12:38.153878 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.unique_mart_customer_risk_profile_customer_id.7b43a6fbd0, now test.hw4_dbt.unique_stg_transactions_transaction_id.ee9a78a396)
[0m14:12:38.154151 [debug] [Thread-4 (]: Began compiling node test.hw4_dbt.unique_states_state_code.67c4706beb
[0m14:12:38.154317 [debug] [Thread-2 (]: Began compiling node test.hw4_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m14:12:38.157160 [debug] [Thread-4 (]: Writing injected SQL for node "test.hw4_dbt.unique_states_state_code.67c4706beb"
[0m14:12:38.159508 [debug] [Thread-2 (]: Writing injected SQL for node "test.hw4_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m14:12:38.160147 [debug] [Thread-4 (]: Began executing node test.hw4_dbt.unique_states_state_code.67c4706beb
[0m14:12:38.161717 [debug] [Thread-4 (]: Writing runtime sql for node "test.hw4_dbt.unique_states_state_code.67c4706beb"
[0m14:12:38.161977 [debug] [Thread-2 (]: Began executing node test.hw4_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m14:12:38.163597 [debug] [Thread-2 (]: Writing runtime sql for node "test.hw4_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m14:12:38.163945 [debug] [Thread-4 (]: Using duckdb connection "test.hw4_dbt.unique_states_state_code.67c4706beb"
[0m14:12:38.164219 [debug] [Thread-4 (]: On test.hw4_dbt.unique_states_state_code.67c4706beb: BEGIN
[0m14:12:38.164448 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:12:38.164727 [debug] [Thread-2 (]: Using duckdb connection "test.hw4_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m14:12:38.164958 [debug] [Thread-2 (]: On test.hw4_dbt.unique_stg_transactions_transaction_id.ee9a78a396: BEGIN
[0m14:12:38.165117 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:12:38.172898 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m14:12:38.173254 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m14:12:38.173590 [debug] [Thread-4 (]: Using duckdb connection "test.hw4_dbt.unique_states_state_code.67c4706beb"
[0m14:12:38.173946 [debug] [Thread-2 (]: Using duckdb connection "test.hw4_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m14:12:38.174204 [debug] [Thread-4 (]: On test.hw4_dbt.unique_states_state_code.67c4706beb: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.unique_states_state_code.67c4706beb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    state_code as unique_field,
    count(*) as n_records

from transactions.main_transactions_db.states
where state_code is not null
group by state_code
having count(*) > 1



      
    ) dbt_internal_test
[0m14:12:38.174468 [debug] [Thread-2 (]: On test.hw4_dbt.unique_stg_transactions_transaction_id.ee9a78a396: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "test.hw4_dbt.unique_stg_transactions_transaction_id.ee9a78a396"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from transactions.main_staging.stg_transactions
where transaction_id is not null
group by transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:12:38.175831 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:12:38.177020 [debug] [Thread-4 (]: On test.hw4_dbt.unique_states_state_code.67c4706beb: ROLLBACK
[0m14:12:38.177354 [debug] [Thread-4 (]: Failed to rollback 'test.hw4_dbt.unique_states_state_code.67c4706beb'
[0m14:12:38.177580 [debug] [Thread-4 (]: On test.hw4_dbt.unique_states_state_code.67c4706beb: Close
[0m14:12:38.178141 [info ] [Thread-4 (]: 55 of 56 PASS unique_states_state_code ......................................... [[32mPASS[0m in 0.02s]
[0m14:12:38.178868 [debug] [Thread-4 (]: Finished running node test.hw4_dbt.unique_states_state_code.67c4706beb
[0m14:12:38.493920 [debug] [Thread-2 (]: SQL status: OK in 0.319 seconds
[0m14:12:38.495303 [debug] [Thread-2 (]: On test.hw4_dbt.unique_stg_transactions_transaction_id.ee9a78a396: ROLLBACK
[0m14:12:38.495984 [debug] [Thread-2 (]: Failed to rollback 'test.hw4_dbt.unique_stg_transactions_transaction_id.ee9a78a396'
[0m14:12:38.496255 [debug] [Thread-2 (]: On test.hw4_dbt.unique_stg_transactions_transaction_id.ee9a78a396: Close
[0m14:12:38.500724 [info ] [Thread-2 (]: 56 of 56 PASS unique_stg_transactions_transaction_id ........................... [[32mPASS[0m in 0.35s]
[0m14:12:38.501144 [debug] [Thread-2 (]: Finished running node test.hw4_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m14:12:38.502676 [debug] [MainThread]: Using duckdb connection "master"
[0m14:12:38.502913 [debug] [MainThread]: On master: BEGIN
[0m14:12:38.503346 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:12:38.513566 [debug] [MainThread]: SQL status: OK in 0.010 seconds
[0m14:12:38.513862 [debug] [MainThread]: On master: COMMIT
[0m14:12:38.514024 [debug] [MainThread]: Using duckdb connection "master"
[0m14:12:38.514173 [debug] [MainThread]: On master: COMMIT
[0m14:12:38.514419 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:12:38.514572 [debug] [MainThread]: On master: Close
[0m14:12:38.516759 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:12:38.517093 [debug] [MainThread]: Connection 'test.hw4_dbt.unique_mart_merchant_analytics_merchant_id.58d0768274' was properly closed.
[0m14:12:38.517373 [debug] [MainThread]: Connection 'test.hw4_dbt.unique_stg_transactions_transaction_id.ee9a78a396' was properly closed.
[0m14:12:38.517539 [debug] [MainThread]: Connection 'test.hw4_dbt.unique_mart_fraud_by_state_us_state.45e47cf1a6' was properly closed.
[0m14:12:38.517674 [debug] [MainThread]: Connection 'test.hw4_dbt.unique_states_state_code.67c4706beb' was properly closed.
[0m14:12:38.517937 [info ] [MainThread]: 
[0m14:12:38.518117 [info ] [MainThread]: Finished running 56 data tests in 0 hours 0 minutes and 1.66 seconds (1.66s).
[0m14:12:38.522662 [debug] [MainThread]: Command end result
[0m14:12:38.556877 [info ] [MainThread]: 
[0m14:12:38.557155 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:12:38.557478 [info ] [MainThread]: 
[0m14:12:38.558462 [info ] [MainThread]: Done. PASS=56 WARN=0 ERROR=0 SKIP=0 TOTAL=56
[0m14:12:38.560588 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.2362015, "process_user_time": 4.631658, "process_kernel_time": 0.524891, "process_mem_max_rss": "412499968", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:12:38.561029 [debug] [MainThread]: Command `dbt test` succeeded at 14:12:38.560955 after 2.24 seconds
[0m14:12:38.561309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044bd090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f81ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f80a90>]}
[0m14:12:38.561592 [debug] [MainThread]: Flushing usage events
[0m14:12:46.516258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11141d1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111481910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111481f90>]}


============================== 14:12:46.519863 | cee7f9fc-6a9c-4e79-9577-2ac5a20eb4c0 ==============================
[0m14:12:46.519863 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:12:46.520730 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/roman/Desktop/hw4-mlops-bokhyan/dbt/logs', 'version_check': 'True', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:12:46.668400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cee7f9fc-6a9c-4e79-9577-2ac5a20eb4c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ff89d0>]}
[0m14:12:46.708881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cee7f9fc-6a9c-4e79-9577-2ac5a20eb4c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cb1150>]}
[0m14:12:46.709623 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m14:12:46.774366 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m14:12:46.871312 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:12:46.871751 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:12:46.905721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cee7f9fc-6a9c-4e79-9577-2ac5a20eb4c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c84a90>]}
[0m14:12:46.916357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cee7f9fc-6a9c-4e79-9577-2ac5a20eb4c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a40310>]}
[0m14:12:46.916725 [info ] [MainThread]: Found 2 seeds, 7 models, 56 data tests, 1 source, 805 macros
[0m14:12:46.916913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cee7f9fc-6a9c-4e79-9577-2ac5a20eb4c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bb5e50>]}
[0m14:12:46.918973 [info ] [MainThread]: 
[0m14:12:46.919429 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:12:46.922179 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_transactions_main_transactions_db'
[0m14:12:46.922615 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_transactions_main_staging'
[0m14:12:46.932201 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_transactions_main_marts'
[0m14:12:46.959520 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_transactions_db"
[0m14:12:46.959801 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_staging"
[0m14:12:46.960016 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_marts"
[0m14:12:46.960208 [debug] [ThreadPool]: On list_transactions_main_transactions_db: BEGIN
[0m14:12:46.960386 [debug] [ThreadPool]: On list_transactions_main_staging: BEGIN
[0m14:12:46.960568 [debug] [ThreadPool]: On list_transactions_main_marts: BEGIN
[0m14:12:46.960727 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:46.960871 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:46.961079 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:46.970039 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m14:12:46.970351 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m14:12:46.970671 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m14:12:46.970878 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_staging"
[0m14:12:46.972243 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_transactions_db"
[0m14:12:46.972469 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_marts"
[0m14:12:46.972724 [debug] [ThreadPool]: On list_transactions_main_staging: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "connection_name": "list_transactions_main_staging"} */
select
      'transactions' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_staging'
    and table_catalog = 'transactions'
  
[0m14:12:46.972935 [debug] [ThreadPool]: On list_transactions_main_transactions_db: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "connection_name": "list_transactions_main_transactions_db"} */
select
      'transactions' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_transactions_db'
    and table_catalog = 'transactions'
  
[0m14:12:46.973111 [debug] [ThreadPool]: On list_transactions_main_marts: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "connection_name": "list_transactions_main_marts"} */
select
      'transactions' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_marts'
    and table_catalog = 'transactions'
  
[0m14:12:46.983006 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m14:12:46.983330 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m14:12:46.983506 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m14:12:46.984392 [debug] [ThreadPool]: On list_transactions_main_transactions_db: ROLLBACK
[0m14:12:46.985405 [debug] [ThreadPool]: On list_transactions_main_staging: ROLLBACK
[0m14:12:46.986181 [debug] [ThreadPool]: On list_transactions_main_marts: ROLLBACK
[0m14:12:46.986934 [debug] [ThreadPool]: Failed to rollback 'list_transactions_main_transactions_db'
[0m14:12:46.987302 [debug] [ThreadPool]: Failed to rollback 'list_transactions_main_staging'
[0m14:12:46.987803 [debug] [ThreadPool]: Failed to rollback 'list_transactions_main_marts'
[0m14:12:46.988251 [debug] [ThreadPool]: On list_transactions_main_transactions_db: Close
[0m14:12:46.988504 [debug] [ThreadPool]: On list_transactions_main_staging: Close
[0m14:12:46.988725 [debug] [ThreadPool]: On list_transactions_main_marts: Close
[0m14:12:46.992301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cee7f9fc-6a9c-4e79-9577-2ac5a20eb4c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bb5e50>]}
[0m14:12:46.992745 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:12:46.992943 [info ] [MainThread]: 
[0m14:12:46.994518 [debug] [Thread-1 (]: Began running node seed.hw4_dbt.states
[0m14:12:46.995057 [debug] [Thread-2 (]: Began running node seed.hw4_dbt.transactions
[0m14:12:46.995455 [debug] [Thread-3 (]: Began running node test.hw4_dbt.source_accepted_values_transactions_db_transactions_target__0__1.ff30b0d50d
[0m14:12:46.995712 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_transactions_main_transactions_db, now seed.hw4_dbt.states)
[0m14:12:46.996057 [debug] [Thread-4 (]: Began running node test.hw4_dbt.source_accepted_values_transactions_db_transactions_us_state__AL__AK__AZ__AR__CA__CO__CT__DC__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY.4941e4798c
[0m14:12:46.996421 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_transactions_main_staging, now seed.hw4_dbt.transactions)
[0m14:12:46.996764 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_transactions_main_marts, now test.hw4_dbt.source_accepted_values_transactions_db_transactions_target__0__1.ff30b0d50d)
[0m14:12:46.996994 [debug] [Thread-1 (]: Began compiling node seed.hw4_dbt.states
[0m14:12:46.997256 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.hw4_dbt.source_accepted_values_transactions_db_transactions_us_state__AL__AK__AZ__AR__CA__CO__CT__DC__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY.4941e4798c'
[0m14:12:46.997638 [debug] [Thread-2 (]: Began compiling node seed.hw4_dbt.transactions
[0m14:12:46.997906 [debug] [Thread-3 (]: Began compiling node test.hw4_dbt.source_accepted_values_transactions_db_transactions_target__0__1.ff30b0d50d
[0m14:12:47.002048 [debug] [Thread-1 (]: Began executing node seed.hw4_dbt.states
[0m14:12:47.002371 [debug] [Thread-4 (]: Began compiling node test.hw4_dbt.source_accepted_values_transactions_db_transactions_us_state__AL__AK__AZ__AR__CA__CO__CT__DC__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY.4941e4798c
[0m14:12:47.003552 [debug] [Thread-2 (]: Began executing node seed.hw4_dbt.transactions
[0m14:12:47.048966 [debug] [Thread-3 (]: Writing injected SQL for node "test.hw4_dbt.source_accepted_values_transactions_db_transactions_target__0__1.ff30b0d50d"
[0m14:12:47.050483 [debug] [Thread-1 (]: Finished running node seed.hw4_dbt.states
[0m14:12:47.066199 [debug] [Thread-4 (]: Writing injected SQL for node "test.hw4_dbt.source_accepted_values_transactions_db_transactions_us_state__AL__AK__AZ__AR__CA__CO__CT__DC__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY.4941e4798c"
[0m14:12:47.067158 [debug] [Thread-2 (]: Finished running node seed.hw4_dbt.transactions
[0m14:12:47.067597 [debug] [Thread-1 (]: Began running node test.hw4_dbt.source_not_null_transactions_db_transactions_amount.307a04757b
[0m14:12:47.068196 [debug] [Thread-3 (]: Began executing node test.hw4_dbt.source_accepted_values_transactions_db_transactions_target__0__1.ff30b0d50d
[0m14:12:47.068443 [debug] [Thread-2 (]: Began running node test.hw4_dbt.source_not_null_transactions_db_transactions_cat_id.24c084b034
[0m14:12:47.068862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.hw4_dbt.states, now test.hw4_dbt.source_not_null_transactions_db_transactions_amount.307a04757b)
[0m14:12:47.069133 [debug] [Thread-4 (]: Began executing node test.hw4_dbt.source_accepted_values_transactions_db_transactions_us_state__AL__AK__AZ__AR__CA__CO__CT__DC__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY.4941e4798c
[0m14:12:47.069708 [debug] [Thread-3 (]: Finished running node test.hw4_dbt.source_accepted_values_transactions_db_transactions_target__0__1.ff30b0d50d
[0m14:12:47.069952 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.hw4_dbt.transactions, now test.hw4_dbt.source_not_null_transactions_db_transactions_cat_id.24c084b034)
[0m14:12:47.070143 [debug] [Thread-1 (]: Began compiling node test.hw4_dbt.source_not_null_transactions_db_transactions_amount.307a04757b
[0m14:12:47.070456 [debug] [Thread-4 (]: Finished running node test.hw4_dbt.source_accepted_values_transactions_db_transactions_us_state__AL__AK__AZ__AR__CA__CO__CT__DC__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY.4941e4798c
[0m14:12:47.070676 [debug] [Thread-3 (]: Began running node test.hw4_dbt.source_not_null_transactions_db_transactions_merch.b9d9c15594
[0m14:12:47.070980 [debug] [Thread-2 (]: Began compiling node test.hw4_dbt.source_not_null_transactions_db_transactions_cat_id.24c084b034
[0m14:12:47.075322 [debug] [Thread-1 (]: Writing injected SQL for node "test.hw4_dbt.source_not_null_transactions_db_transactions_amount.307a04757b"
[0m14:12:47.075759 [debug] [Thread-4 (]: Began running node test.hw4_dbt.source_not_null_transactions_db_transactions_target.ee81663a6c
[0m14:12:47.076156 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.source_accepted_values_transactions_db_transactions_target__0__1.ff30b0d50d, now test.hw4_dbt.source_not_null_transactions_db_transactions_merch.b9d9c15594)
[0m14:12:47.078665 [debug] [Thread-2 (]: Writing injected SQL for node "test.hw4_dbt.source_not_null_transactions_db_transactions_cat_id.24c084b034"
[0m14:12:47.079046 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.source_accepted_values_transactions_db_transactions_us_state__AL__AK__AZ__AR__CA__CO__CT__DC__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY.4941e4798c, now test.hw4_dbt.source_not_null_transactions_db_transactions_target.ee81663a6c)
[0m14:12:47.079499 [debug] [Thread-3 (]: Began compiling node test.hw4_dbt.source_not_null_transactions_db_transactions_merch.b9d9c15594
[0m14:12:47.079877 [debug] [Thread-1 (]: Began executing node test.hw4_dbt.source_not_null_transactions_db_transactions_amount.307a04757b
[0m14:12:47.080234 [debug] [Thread-4 (]: Began compiling node test.hw4_dbt.source_not_null_transactions_db_transactions_target.ee81663a6c
[0m14:12:47.083038 [debug] [Thread-3 (]: Writing injected SQL for node "test.hw4_dbt.source_not_null_transactions_db_transactions_merch.b9d9c15594"
[0m14:12:47.083282 [debug] [Thread-2 (]: Began executing node test.hw4_dbt.source_not_null_transactions_db_transactions_cat_id.24c084b034
[0m14:12:47.083733 [debug] [Thread-1 (]: Finished running node test.hw4_dbt.source_not_null_transactions_db_transactions_amount.307a04757b
[0m14:12:47.086187 [debug] [Thread-4 (]: Writing injected SQL for node "test.hw4_dbt.source_not_null_transactions_db_transactions_target.ee81663a6c"
[0m14:12:47.086870 [debug] [Thread-2 (]: Finished running node test.hw4_dbt.source_not_null_transactions_db_transactions_cat_id.24c084b034
[0m14:12:47.087251 [debug] [Thread-1 (]: Began running node test.hw4_dbt.source_not_null_transactions_db_transactions_transaction_time.b0308d1b6c
[0m14:12:47.087581 [debug] [Thread-3 (]: Began executing node test.hw4_dbt.source_not_null_transactions_db_transactions_merch.b9d9c15594
[0m14:12:47.088056 [debug] [Thread-2 (]: Began running node test.hw4_dbt.source_not_null_transactions_db_transactions_us_state.4999dadbbc
[0m14:12:47.088408 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.source_not_null_transactions_db_transactions_amount.307a04757b, now test.hw4_dbt.source_not_null_transactions_db_transactions_transaction_time.b0308d1b6c)
[0m14:12:47.088878 [debug] [Thread-3 (]: Finished running node test.hw4_dbt.source_not_null_transactions_db_transactions_merch.b9d9c15594
[0m14:12:47.089150 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.source_not_null_transactions_db_transactions_cat_id.24c084b034, now test.hw4_dbt.source_not_null_transactions_db_transactions_us_state.4999dadbbc)
[0m14:12:47.089365 [debug] [Thread-4 (]: Began executing node test.hw4_dbt.source_not_null_transactions_db_transactions_target.ee81663a6c
[0m14:12:47.089618 [debug] [Thread-1 (]: Began compiling node test.hw4_dbt.source_not_null_transactions_db_transactions_transaction_time.b0308d1b6c
[0m14:12:47.089855 [debug] [Thread-3 (]: Began running node model.hw4_dbt.stg_transactions
[0m14:12:47.090071 [debug] [Thread-2 (]: Began compiling node test.hw4_dbt.source_not_null_transactions_db_transactions_us_state.4999dadbbc
[0m14:12:47.090408 [debug] [Thread-4 (]: Finished running node test.hw4_dbt.source_not_null_transactions_db_transactions_target.ee81663a6c
[0m14:12:47.094452 [debug] [Thread-1 (]: Writing injected SQL for node "test.hw4_dbt.source_not_null_transactions_db_transactions_transaction_time.b0308d1b6c"
[0m14:12:47.094839 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.source_not_null_transactions_db_transactions_merch.b9d9c15594, now model.hw4_dbt.stg_transactions)
[0m14:12:47.097174 [debug] [Thread-2 (]: Writing injected SQL for node "test.hw4_dbt.source_not_null_transactions_db_transactions_us_state.4999dadbbc"
[0m14:12:47.097517 [debug] [Thread-4 (]: Began running node test.hw4_dbt.not_null_states_state_code.4c83882290
[0m14:12:47.097826 [debug] [Thread-3 (]: Began compiling node model.hw4_dbt.stg_transactions
[0m14:12:47.098144 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.source_not_null_transactions_db_transactions_target.ee81663a6c, now test.hw4_dbt.not_null_states_state_code.4c83882290)
[0m14:12:47.098346 [debug] [Thread-1 (]: Began executing node test.hw4_dbt.source_not_null_transactions_db_transactions_transaction_time.b0308d1b6c
[0m14:12:47.108208 [debug] [Thread-3 (]: Writing injected SQL for node "model.hw4_dbt.stg_transactions"
[0m14:12:47.108482 [debug] [Thread-2 (]: Began executing node test.hw4_dbt.source_not_null_transactions_db_transactions_us_state.4999dadbbc
[0m14:12:47.108708 [debug] [Thread-4 (]: Began compiling node test.hw4_dbt.not_null_states_state_code.4c83882290
[0m14:12:47.109132 [debug] [Thread-1 (]: Finished running node test.hw4_dbt.source_not_null_transactions_db_transactions_transaction_time.b0308d1b6c
[0m14:12:47.109717 [debug] [Thread-2 (]: Finished running node test.hw4_dbt.source_not_null_transactions_db_transactions_us_state.4999dadbbc
[0m14:12:47.111992 [debug] [Thread-4 (]: Writing injected SQL for node "test.hw4_dbt.not_null_states_state_code.4c83882290"
[0m14:12:47.112186 [debug] [Thread-3 (]: Began executing node model.hw4_dbt.stg_transactions
[0m14:12:47.112435 [debug] [Thread-1 (]: Began running node test.hw4_dbt.not_null_states_state_name.f652068228
[0m14:12:47.112684 [debug] [Thread-2 (]: Began running node test.hw4_dbt.unique_states_state_code.67c4706beb
[0m14:12:47.113112 [debug] [Thread-3 (]: Finished running node model.hw4_dbt.stg_transactions
[0m14:12:47.113385 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.source_not_null_transactions_db_transactions_transaction_time.b0308d1b6c, now test.hw4_dbt.not_null_states_state_name.f652068228)
[0m14:12:47.113712 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.source_not_null_transactions_db_transactions_us_state.4999dadbbc, now test.hw4_dbt.unique_states_state_code.67c4706beb)
[0m14:12:47.113991 [debug] [Thread-4 (]: Began executing node test.hw4_dbt.not_null_states_state_code.4c83882290
[0m14:12:47.114563 [debug] [Thread-3 (]: Began running node model.hw4_dbt.mart_customer_risk_profile
[0m14:12:47.114740 [debug] [Thread-1 (]: Began compiling node test.hw4_dbt.not_null_states_state_name.f652068228
[0m14:12:47.114924 [debug] [Thread-2 (]: Began compiling node test.hw4_dbt.unique_states_state_code.67c4706beb
[0m14:12:47.115266 [debug] [Thread-4 (]: Finished running node test.hw4_dbt.not_null_states_state_code.4c83882290
[0m14:12:47.115462 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.hw4_dbt.stg_transactions, now model.hw4_dbt.mart_customer_risk_profile)
[0m14:12:47.117783 [debug] [Thread-1 (]: Writing injected SQL for node "test.hw4_dbt.not_null_states_state_name.f652068228"
[0m14:12:47.121005 [debug] [Thread-2 (]: Writing injected SQL for node "test.hw4_dbt.unique_states_state_code.67c4706beb"
[0m14:12:47.121326 [debug] [Thread-4 (]: Began running node model.hw4_dbt.mart_daily_state_metrics
[0m14:12:47.121570 [debug] [Thread-3 (]: Began compiling node model.hw4_dbt.mart_customer_risk_profile
[0m14:12:47.122040 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_states_state_code.4c83882290, now model.hw4_dbt.mart_daily_state_metrics)
[0m14:12:47.123993 [debug] [Thread-3 (]: Writing injected SQL for node "model.hw4_dbt.mart_customer_risk_profile"
[0m14:12:47.124274 [debug] [Thread-4 (]: Began compiling node model.hw4_dbt.mart_daily_state_metrics
[0m14:12:47.124454 [debug] [Thread-1 (]: Began executing node test.hw4_dbt.not_null_states_state_name.f652068228
[0m14:12:47.124681 [debug] [Thread-2 (]: Began executing node test.hw4_dbt.unique_states_state_code.67c4706beb
[0m14:12:47.127764 [debug] [Thread-4 (]: Writing injected SQL for node "model.hw4_dbt.mart_daily_state_metrics"
[0m14:12:47.128380 [debug] [Thread-1 (]: Finished running node test.hw4_dbt.not_null_states_state_name.f652068228
[0m14:12:47.128604 [debug] [Thread-3 (]: Began executing node model.hw4_dbt.mart_customer_risk_profile
[0m14:12:47.129047 [debug] [Thread-2 (]: Finished running node test.hw4_dbt.unique_states_state_code.67c4706beb
[0m14:12:47.129485 [debug] [Thread-1 (]: Began running node model.hw4_dbt.mart_fraud_by_category
[0m14:12:47.130006 [debug] [Thread-3 (]: Finished running node model.hw4_dbt.mart_customer_risk_profile
[0m14:12:47.130185 [debug] [Thread-4 (]: Began executing node model.hw4_dbt.mart_daily_state_metrics
[0m14:12:47.130448 [debug] [Thread-2 (]: Began running node model.hw4_dbt.mart_fraud_by_state
[0m14:12:47.130747 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_states_state_name.f652068228, now model.hw4_dbt.mart_fraud_by_category)
[0m14:12:47.130995 [debug] [Thread-3 (]: Began running node model.hw4_dbt.mart_hourly_fraud_pattern
[0m14:12:47.131383 [debug] [Thread-4 (]: Finished running node model.hw4_dbt.mart_daily_state_metrics
[0m14:12:47.131566 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.unique_states_state_code.67c4706beb, now model.hw4_dbt.mart_fraud_by_state)
[0m14:12:47.131759 [debug] [Thread-1 (]: Began compiling node model.hw4_dbt.mart_fraud_by_category
[0m14:12:47.131978 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.hw4_dbt.mart_customer_risk_profile, now model.hw4_dbt.mart_hourly_fraud_pattern)
[0m14:12:47.132211 [debug] [Thread-4 (]: Began running node model.hw4_dbt.mart_merchant_analytics
[0m14:12:47.132432 [debug] [Thread-2 (]: Began compiling node model.hw4_dbt.mart_fraud_by_state
[0m14:12:47.134390 [debug] [Thread-1 (]: Writing injected SQL for node "model.hw4_dbt.mart_fraud_by_category"
[0m14:12:47.134722 [debug] [Thread-3 (]: Began compiling node model.hw4_dbt.mart_hourly_fraud_pattern
[0m14:12:47.135034 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.hw4_dbt.mart_daily_state_metrics, now model.hw4_dbt.mart_merchant_analytics)
[0m14:12:47.136819 [debug] [Thread-2 (]: Writing injected SQL for node "model.hw4_dbt.mart_fraud_by_state"
[0m14:12:47.138686 [debug] [Thread-3 (]: Writing injected SQL for node "model.hw4_dbt.mart_hourly_fraud_pattern"
[0m14:12:47.139013 [debug] [Thread-4 (]: Began compiling node model.hw4_dbt.mart_merchant_analytics
[0m14:12:47.139296 [debug] [Thread-1 (]: Began executing node model.hw4_dbt.mart_fraud_by_category
[0m14:12:47.141311 [debug] [Thread-4 (]: Writing injected SQL for node "model.hw4_dbt.mart_merchant_analytics"
[0m14:12:47.141999 [debug] [Thread-1 (]: Finished running node model.hw4_dbt.mart_fraud_by_category
[0m14:12:47.142254 [debug] [Thread-3 (]: Began executing node model.hw4_dbt.mart_hourly_fraud_pattern
[0m14:12:47.142484 [debug] [Thread-2 (]: Began executing node model.hw4_dbt.mart_fraud_by_state
[0m14:12:47.142746 [debug] [Thread-1 (]: Began running node test.hw4_dbt.accepted_values_stg_transactions_amount_bucket__small__medium__large__extra_large__unknown.f09a27d70f
[0m14:12:47.143243 [debug] [Thread-3 (]: Finished running node model.hw4_dbt.mart_hourly_fraud_pattern
[0m14:12:47.143628 [debug] [Thread-2 (]: Finished running node model.hw4_dbt.mart_fraud_by_state
[0m14:12:47.143830 [debug] [Thread-4 (]: Began executing node model.hw4_dbt.mart_merchant_analytics
[0m14:12:47.144148 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.hw4_dbt.mart_fraud_by_category, now test.hw4_dbt.accepted_values_stg_transactions_amount_bucket__small__medium__large__extra_large__unknown.f09a27d70f)
[0m14:12:47.144439 [debug] [Thread-3 (]: Began running node test.hw4_dbt.accepted_values_stg_transactions_gender__M__F__U.ae8f0c87a0
[0m14:12:47.144765 [debug] [Thread-2 (]: Began running node test.hw4_dbt.accepted_values_stg_transactions_is_fraud__0__1.f6d9ff0fc6
[0m14:12:47.145128 [debug] [Thread-4 (]: Finished running node model.hw4_dbt.mart_merchant_analytics
[0m14:12:47.145331 [debug] [Thread-1 (]: Began compiling node test.hw4_dbt.accepted_values_stg_transactions_amount_bucket__small__medium__large__extra_large__unknown.f09a27d70f
[0m14:12:47.145758 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.hw4_dbt.mart_hourly_fraud_pattern, now test.hw4_dbt.accepted_values_stg_transactions_gender__M__F__U.ae8f0c87a0)
[0m14:12:47.146128 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.hw4_dbt.mart_fraud_by_state, now test.hw4_dbt.accepted_values_stg_transactions_is_fraud__0__1.f6d9ff0fc6)
[0m14:12:47.146368 [debug] [Thread-4 (]: Began running node test.hw4_dbt.assert_no_negative_amounts
[0m14:12:47.150181 [debug] [Thread-1 (]: Writing injected SQL for node "test.hw4_dbt.accepted_values_stg_transactions_amount_bucket__small__medium__large__extra_large__unknown.f09a27d70f"
[0m14:12:47.150518 [debug] [Thread-3 (]: Began compiling node test.hw4_dbt.accepted_values_stg_transactions_gender__M__F__U.ae8f0c87a0
[0m14:12:47.150802 [debug] [Thread-2 (]: Began compiling node test.hw4_dbt.accepted_values_stg_transactions_is_fraud__0__1.f6d9ff0fc6
[0m14:12:47.151112 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.hw4_dbt.mart_merchant_analytics, now test.hw4_dbt.assert_no_negative_amounts)
[0m14:12:47.154333 [debug] [Thread-3 (]: Writing injected SQL for node "test.hw4_dbt.accepted_values_stg_transactions_gender__M__F__U.ae8f0c87a0"
[0m14:12:47.157890 [debug] [Thread-2 (]: Writing injected SQL for node "test.hw4_dbt.accepted_values_stg_transactions_is_fraud__0__1.f6d9ff0fc6"
[0m14:12:47.158373 [debug] [Thread-1 (]: Began executing node test.hw4_dbt.accepted_values_stg_transactions_amount_bucket__small__medium__large__extra_large__unknown.f09a27d70f
[0m14:12:47.158610 [debug] [Thread-4 (]: Began compiling node test.hw4_dbt.assert_no_negative_amounts
[0m14:12:47.159298 [debug] [Thread-1 (]: Finished running node test.hw4_dbt.accepted_values_stg_transactions_amount_bucket__small__medium__large__extra_large__unknown.f09a27d70f
[0m14:12:47.161172 [debug] [Thread-4 (]: Writing injected SQL for node "test.hw4_dbt.assert_no_negative_amounts"
[0m14:12:47.161453 [debug] [Thread-3 (]: Began executing node test.hw4_dbt.accepted_values_stg_transactions_gender__M__F__U.ae8f0c87a0
[0m14:12:47.161690 [debug] [Thread-2 (]: Began executing node test.hw4_dbt.accepted_values_stg_transactions_is_fraud__0__1.f6d9ff0fc6
[0m14:12:47.161971 [debug] [Thread-1 (]: Began running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_stg_transactions_amount__0__True.047010278b
[0m14:12:47.162540 [debug] [Thread-3 (]: Finished running node test.hw4_dbt.accepted_values_stg_transactions_gender__M__F__U.ae8f0c87a0
[0m14:12:47.162900 [debug] [Thread-2 (]: Finished running node test.hw4_dbt.accepted_values_stg_transactions_is_fraud__0__1.f6d9ff0fc6
[0m14:12:47.163233 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.accepted_values_stg_transactions_amount_bucket__small__medium__large__extra_large__unknown.f09a27d70f, now test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_stg_transactions_amount__0__True.047010278b)
[0m14:12:47.163424 [debug] [Thread-4 (]: Began executing node test.hw4_dbt.assert_no_negative_amounts
[0m14:12:47.163751 [debug] [Thread-3 (]: Began running node test.hw4_dbt.dbt_utils_unique_combination_of_columns_stg_transactions_transaction_id.9f8e8cbeb8
[0m14:12:47.164072 [debug] [Thread-2 (]: Began running node test.hw4_dbt.not_null_stg_transactions_amount.3629b5421e
[0m14:12:47.164327 [debug] [Thread-1 (]: Began compiling node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_stg_transactions_amount__0__True.047010278b
[0m14:12:47.164683 [debug] [Thread-4 (]: Finished running node test.hw4_dbt.assert_no_negative_amounts
[0m14:12:47.164918 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.accepted_values_stg_transactions_gender__M__F__U.ae8f0c87a0, now test.hw4_dbt.dbt_utils_unique_combination_of_columns_stg_transactions_transaction_id.9f8e8cbeb8)
[0m14:12:47.165165 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.accepted_values_stg_transactions_is_fraud__0__1.f6d9ff0fc6, now test.hw4_dbt.not_null_stg_transactions_amount.3629b5421e)
[0m14:12:47.175941 [debug] [Thread-1 (]: Writing injected SQL for node "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_stg_transactions_amount__0__True.047010278b"
[0m14:12:47.176859 [debug] [Thread-4 (]: Began running node test.hw4_dbt.not_null_stg_transactions_amount_bucket.ddccfce050
[0m14:12:47.177154 [debug] [Thread-3 (]: Began compiling node test.hw4_dbt.dbt_utils_unique_combination_of_columns_stg_transactions_transaction_id.9f8e8cbeb8
[0m14:12:47.177678 [debug] [Thread-2 (]: Began compiling node test.hw4_dbt.not_null_stg_transactions_amount.3629b5421e
[0m14:12:47.178156 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.assert_no_negative_amounts, now test.hw4_dbt.not_null_stg_transactions_amount_bucket.ddccfce050)
[0m14:12:47.185093 [debug] [Thread-3 (]: Writing injected SQL for node "test.hw4_dbt.dbt_utils_unique_combination_of_columns_stg_transactions_transaction_id.9f8e8cbeb8"
[0m14:12:47.185446 [debug] [Thread-1 (]: Began executing node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_stg_transactions_amount__0__True.047010278b
[0m14:12:47.188374 [debug] [Thread-2 (]: Writing injected SQL for node "test.hw4_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m14:12:47.188675 [debug] [Thread-4 (]: Began compiling node test.hw4_dbt.not_null_stg_transactions_amount_bucket.ddccfce050
[0m14:12:47.190255 [debug] [Thread-1 (]: Finished running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_stg_transactions_amount__0__True.047010278b
[0m14:12:47.190658 [debug] [Thread-3 (]: Began executing node test.hw4_dbt.dbt_utils_unique_combination_of_columns_stg_transactions_transaction_id.9f8e8cbeb8
[0m14:12:47.194414 [debug] [Thread-4 (]: Writing injected SQL for node "test.hw4_dbt.not_null_stg_transactions_amount_bucket.ddccfce050"
[0m14:12:47.195259 [debug] [Thread-1 (]: Began running node test.hw4_dbt.not_null_stg_transactions_cat_id.81205306d9
[0m14:12:47.196314 [debug] [Thread-2 (]: Began executing node test.hw4_dbt.not_null_stg_transactions_amount.3629b5421e
[0m14:12:47.196748 [debug] [Thread-3 (]: Finished running node test.hw4_dbt.dbt_utils_unique_combination_of_columns_stg_transactions_transaction_id.9f8e8cbeb8
[0m14:12:47.198914 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_stg_transactions_amount__0__True.047010278b, now test.hw4_dbt.not_null_stg_transactions_cat_id.81205306d9)
[0m14:12:47.199339 [debug] [Thread-2 (]: Finished running node test.hw4_dbt.not_null_stg_transactions_amount.3629b5421e
[0m14:12:47.199514 [debug] [Thread-4 (]: Began executing node test.hw4_dbt.not_null_stg_transactions_amount_bucket.ddccfce050
[0m14:12:47.200571 [debug] [Thread-3 (]: Began running node test.hw4_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m14:12:47.200917 [debug] [Thread-1 (]: Began compiling node test.hw4_dbt.not_null_stg_transactions_cat_id.81205306d9
[0m14:12:47.201259 [debug] [Thread-2 (]: Began running node test.hw4_dbt.not_null_stg_transactions_is_fraud.c832a79395
[0m14:12:47.201648 [debug] [Thread-4 (]: Finished running node test.hw4_dbt.not_null_stg_transactions_amount_bucket.ddccfce050
[0m14:12:47.201856 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.dbt_utils_unique_combination_of_columns_stg_transactions_transaction_id.9f8e8cbeb8, now test.hw4_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf)
[0m14:12:47.204500 [debug] [Thread-1 (]: Writing injected SQL for node "test.hw4_dbt.not_null_stg_transactions_cat_id.81205306d9"
[0m14:12:47.204953 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_stg_transactions_amount.3629b5421e, now test.hw4_dbt.not_null_stg_transactions_is_fraud.c832a79395)
[0m14:12:47.205314 [debug] [Thread-4 (]: Began running node test.hw4_dbt.not_null_stg_transactions_merchant_id.b64621d2d7
[0m14:12:47.206569 [debug] [Thread-3 (]: Began compiling node test.hw4_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m14:12:47.206907 [debug] [Thread-2 (]: Began compiling node test.hw4_dbt.not_null_stg_transactions_is_fraud.c832a79395
[0m14:12:47.207217 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_stg_transactions_amount_bucket.ddccfce050, now test.hw4_dbt.not_null_stg_transactions_merchant_id.b64621d2d7)
[0m14:12:47.210495 [debug] [Thread-3 (]: Writing injected SQL for node "test.hw4_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m14:12:47.214903 [debug] [Thread-2 (]: Writing injected SQL for node "test.hw4_dbt.not_null_stg_transactions_is_fraud.c832a79395"
[0m14:12:47.215183 [debug] [Thread-1 (]: Began executing node test.hw4_dbt.not_null_stg_transactions_cat_id.81205306d9
[0m14:12:47.215451 [debug] [Thread-4 (]: Began compiling node test.hw4_dbt.not_null_stg_transactions_merchant_id.b64621d2d7
[0m14:12:47.216233 [debug] [Thread-1 (]: Finished running node test.hw4_dbt.not_null_stg_transactions_cat_id.81205306d9
[0m14:12:47.219441 [debug] [Thread-4 (]: Writing injected SQL for node "test.hw4_dbt.not_null_stg_transactions_merchant_id.b64621d2d7"
[0m14:12:47.219950 [debug] [Thread-1 (]: Began running node test.hw4_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m14:12:47.220456 [debug] [Thread-2 (]: Began executing node test.hw4_dbt.not_null_stg_transactions_is_fraud.c832a79395
[0m14:12:47.220955 [debug] [Thread-3 (]: Began executing node test.hw4_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m14:12:47.222334 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_stg_transactions_cat_id.81205306d9, now test.hw4_dbt.not_null_stg_transactions_transaction_date.353bde368c)
[0m14:12:47.222856 [debug] [Thread-2 (]: Finished running node test.hw4_dbt.not_null_stg_transactions_is_fraud.c832a79395
[0m14:12:47.223397 [debug] [Thread-3 (]: Finished running node test.hw4_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m14:12:47.223596 [debug] [Thread-4 (]: Began executing node test.hw4_dbt.not_null_stg_transactions_merchant_id.b64621d2d7
[0m14:12:47.223858 [debug] [Thread-1 (]: Began compiling node test.hw4_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m14:12:47.224153 [debug] [Thread-2 (]: Began running node test.hw4_dbt.not_null_stg_transactions_transaction_hour.99d50d4d46
[0m14:12:47.224458 [debug] [Thread-3 (]: Began running node test.hw4_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m14:12:47.224947 [debug] [Thread-4 (]: Finished running node test.hw4_dbt.not_null_stg_transactions_merchant_id.b64621d2d7
[0m14:12:47.227967 [debug] [Thread-1 (]: Writing injected SQL for node "test.hw4_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m14:12:47.228383 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_stg_transactions_is_fraud.c832a79395, now test.hw4_dbt.not_null_stg_transactions_transaction_hour.99d50d4d46)
[0m14:12:47.229095 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf, now test.hw4_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4)
[0m14:12:47.230249 [debug] [Thread-4 (]: Began running node test.hw4_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m14:12:47.231439 [debug] [Thread-2 (]: Began compiling node test.hw4_dbt.not_null_stg_transactions_transaction_hour.99d50d4d46
[0m14:12:47.231690 [debug] [Thread-3 (]: Began compiling node test.hw4_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m14:12:47.232752 [debug] [Thread-1 (]: Began executing node test.hw4_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m14:12:47.233099 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_stg_transactions_merchant_id.b64621d2d7, now test.hw4_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7)
[0m14:12:47.236541 [debug] [Thread-2 (]: Writing injected SQL for node "test.hw4_dbt.not_null_stg_transactions_transaction_hour.99d50d4d46"
[0m14:12:47.239971 [debug] [Thread-3 (]: Writing injected SQL for node "test.hw4_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m14:12:47.240953 [debug] [Thread-1 (]: Finished running node test.hw4_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m14:12:47.241577 [debug] [Thread-4 (]: Began compiling node test.hw4_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m14:12:47.243201 [debug] [Thread-1 (]: Began running node test.hw4_dbt.not_null_stg_transactions_us_state.11afe11a0c
[0m14:12:47.246442 [debug] [Thread-4 (]: Writing injected SQL for node "test.hw4_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m14:12:47.246920 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_stg_transactions_transaction_date.353bde368c, now test.hw4_dbt.not_null_stg_transactions_us_state.11afe11a0c)
[0m14:12:47.247219 [debug] [Thread-3 (]: Began executing node test.hw4_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m14:12:47.247459 [debug] [Thread-2 (]: Began executing node test.hw4_dbt.not_null_stg_transactions_transaction_hour.99d50d4d46
[0m14:12:47.248016 [debug] [Thread-1 (]: Began compiling node test.hw4_dbt.not_null_stg_transactions_us_state.11afe11a0c
[0m14:12:47.249025 [debug] [Thread-3 (]: Finished running node test.hw4_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m14:12:47.249961 [debug] [Thread-2 (]: Finished running node test.hw4_dbt.not_null_stg_transactions_transaction_hour.99d50d4d46
[0m14:12:47.250448 [debug] [Thread-4 (]: Began executing node test.hw4_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m14:12:47.253362 [debug] [Thread-1 (]: Writing injected SQL for node "test.hw4_dbt.not_null_stg_transactions_us_state.11afe11a0c"
[0m14:12:47.253764 [debug] [Thread-3 (]: Began running node test.hw4_dbt.relationships_stg_transactions_us_state__state_code__ref_states_.7b260553ef
[0m14:12:47.254369 [debug] [Thread-2 (]: Began running node test.hw4_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m14:12:47.255026 [debug] [Thread-4 (]: Finished running node test.hw4_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m14:12:47.255433 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4, now test.hw4_dbt.relationships_stg_transactions_us_state__state_code__ref_states_.7b260553ef)
[0m14:12:47.255706 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_stg_transactions_transaction_hour.99d50d4d46, now test.hw4_dbt.unique_stg_transactions_transaction_id.ee9a78a396)
[0m14:12:47.255993 [debug] [Thread-4 (]: Began running node test.hw4_dbt.accepted_values_mart_customer_risk_profile_risk_level__HIGH__MEDIUM__LOW.95fabd3536
[0m14:12:47.256201 [debug] [Thread-1 (]: Began executing node test.hw4_dbt.not_null_stg_transactions_us_state.11afe11a0c
[0m14:12:47.256414 [debug] [Thread-3 (]: Began compiling node test.hw4_dbt.relationships_stg_transactions_us_state__state_code__ref_states_.7b260553ef
[0m14:12:47.256684 [debug] [Thread-2 (]: Began compiling node test.hw4_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m14:12:47.256974 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7, now test.hw4_dbt.accepted_values_mart_customer_risk_profile_risk_level__HIGH__MEDIUM__LOW.95fabd3536)
[0m14:12:47.257418 [debug] [Thread-1 (]: Finished running node test.hw4_dbt.not_null_stg_transactions_us_state.11afe11a0c
[0m14:12:47.266260 [debug] [Thread-3 (]: Writing injected SQL for node "test.hw4_dbt.relationships_stg_transactions_us_state__state_code__ref_states_.7b260553ef"
[0m14:12:47.270114 [debug] [Thread-2 (]: Writing injected SQL for node "test.hw4_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m14:12:47.270466 [debug] [Thread-4 (]: Began compiling node test.hw4_dbt.accepted_values_mart_customer_risk_profile_risk_level__HIGH__MEDIUM__LOW.95fabd3536
[0m14:12:47.271143 [debug] [Thread-1 (]: Began running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_customer_risk_profile_fraud_rate__100__0.ee441b99d9
[0m14:12:47.275201 [debug] [Thread-4 (]: Writing injected SQL for node "test.hw4_dbt.accepted_values_mart_customer_risk_profile_risk_level__HIGH__MEDIUM__LOW.95fabd3536"
[0m14:12:47.275797 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_stg_transactions_us_state.11afe11a0c, now test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_customer_risk_profile_fraud_rate__100__0.ee441b99d9)
[0m14:12:47.276659 [debug] [Thread-1 (]: Began compiling node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_customer_risk_profile_fraud_rate__100__0.ee441b99d9
[0m14:12:47.277000 [debug] [Thread-2 (]: Began executing node test.hw4_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m14:12:47.280920 [debug] [Thread-1 (]: Writing injected SQL for node "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_customer_risk_profile_fraud_rate__100__0.ee441b99d9"
[0m14:12:47.281300 [debug] [Thread-3 (]: Began executing node test.hw4_dbt.relationships_stg_transactions_us_state__state_code__ref_states_.7b260553ef
[0m14:12:47.281515 [debug] [Thread-4 (]: Began executing node test.hw4_dbt.accepted_values_mart_customer_risk_profile_risk_level__HIGH__MEDIUM__LOW.95fabd3536
[0m14:12:47.282196 [debug] [Thread-2 (]: Finished running node test.hw4_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m14:12:47.282640 [debug] [Thread-3 (]: Finished running node test.hw4_dbt.relationships_stg_transactions_us_state__state_code__ref_states_.7b260553ef
[0m14:12:47.283083 [debug] [Thread-4 (]: Finished running node test.hw4_dbt.accepted_values_mart_customer_risk_profile_risk_level__HIGH__MEDIUM__LOW.95fabd3536
[0m14:12:47.283477 [debug] [Thread-2 (]: Began running node test.hw4_dbt.not_null_mart_customer_risk_profile_customer_id.c066ff7487
[0m14:12:47.283685 [debug] [Thread-1 (]: Began executing node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_customer_risk_profile_fraud_rate__100__0.ee441b99d9
[0m14:12:47.284066 [debug] [Thread-3 (]: Began running node test.hw4_dbt.unique_mart_customer_risk_profile_customer_id.7b43a6fbd0
[0m14:12:47.284504 [debug] [Thread-4 (]: Began running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_fraud_rate__1__0.59ce56cc94
[0m14:12:47.284966 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.unique_stg_transactions_transaction_id.ee9a78a396, now test.hw4_dbt.not_null_mart_customer_risk_profile_customer_id.c066ff7487)
[0m14:12:47.285419 [debug] [Thread-1 (]: Finished running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_customer_risk_profile_fraud_rate__100__0.ee441b99d9
[0m14:12:47.285707 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.relationships_stg_transactions_us_state__state_code__ref_states_.7b260553ef, now test.hw4_dbt.unique_mart_customer_risk_profile_customer_id.7b43a6fbd0)
[0m14:12:47.286061 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.accepted_values_mart_customer_risk_profile_risk_level__HIGH__MEDIUM__LOW.95fabd3536, now test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_fraud_rate__1__0.59ce56cc94)
[0m14:12:47.286325 [debug] [Thread-2 (]: Began compiling node test.hw4_dbt.not_null_mart_customer_risk_profile_customer_id.c066ff7487
[0m14:12:47.286683 [debug] [Thread-1 (]: Began running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_large_txn_share__1__0.d93f9f3127
[0m14:12:47.287019 [debug] [Thread-3 (]: Began compiling node test.hw4_dbt.unique_mart_customer_risk_profile_customer_id.7b43a6fbd0
[0m14:12:47.287304 [debug] [Thread-4 (]: Began compiling node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_fraud_rate__1__0.59ce56cc94
[0m14:12:47.290901 [debug] [Thread-2 (]: Writing injected SQL for node "test.hw4_dbt.not_null_mart_customer_risk_profile_customer_id.c066ff7487"
[0m14:12:47.291331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_customer_risk_profile_fraud_rate__100__0.ee441b99d9, now test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_large_txn_share__1__0.d93f9f3127)
[0m14:12:47.294742 [debug] [Thread-3 (]: Writing injected SQL for node "test.hw4_dbt.unique_mart_customer_risk_profile_customer_id.7b43a6fbd0"
[0m14:12:47.298561 [debug] [Thread-4 (]: Writing injected SQL for node "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_fraud_rate__1__0.59ce56cc94"
[0m14:12:47.299073 [debug] [Thread-1 (]: Began compiling node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_large_txn_share__1__0.d93f9f3127
[0m14:12:47.299469 [debug] [Thread-2 (]: Began executing node test.hw4_dbt.not_null_mart_customer_risk_profile_customer_id.c066ff7487
[0m14:12:47.300132 [debug] [Thread-3 (]: Began executing node test.hw4_dbt.unique_mart_customer_risk_profile_customer_id.7b43a6fbd0
[0m14:12:47.306518 [debug] [Thread-1 (]: Writing injected SQL for node "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_large_txn_share__1__0.d93f9f3127"
[0m14:12:47.306841 [debug] [Thread-4 (]: Began executing node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_fraud_rate__1__0.59ce56cc94
[0m14:12:47.307369 [debug] [Thread-2 (]: Finished running node test.hw4_dbt.not_null_mart_customer_risk_profile_customer_id.c066ff7487
[0m14:12:47.307763 [debug] [Thread-3 (]: Finished running node test.hw4_dbt.unique_mart_customer_risk_profile_customer_id.7b43a6fbd0
[0m14:12:47.308337 [debug] [Thread-4 (]: Finished running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_fraud_rate__1__0.59ce56cc94
[0m14:12:47.308879 [debug] [Thread-2 (]: Began running node test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_daily_state_metrics_transaction_date__us_state.36d7185b4c
[0m14:12:47.309522 [debug] [Thread-1 (]: Began executing node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_large_txn_share__1__0.d93f9f3127
[0m14:12:47.309861 [debug] [Thread-3 (]: Began running node test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_count.44f9f89c45
[0m14:12:47.310183 [debug] [Thread-4 (]: Began running node test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_date.27b2c6ebe0
[0m14:12:47.310468 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_mart_customer_risk_profile_customer_id.c066ff7487, now test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_daily_state_metrics_transaction_date__us_state.36d7185b4c)
[0m14:12:47.310798 [debug] [Thread-1 (]: Finished running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_large_txn_share__1__0.d93f9f3127
[0m14:12:47.311010 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.unique_mart_customer_risk_profile_customer_id.7b43a6fbd0, now test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_count.44f9f89c45)
[0m14:12:47.311199 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_fraud_rate__1__0.59ce56cc94, now test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_date.27b2c6ebe0)
[0m14:12:47.311390 [debug] [Thread-2 (]: Began compiling node test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_daily_state_metrics_transaction_date__us_state.36d7185b4c
[0m14:12:47.311594 [debug] [Thread-1 (]: Began running node test.hw4_dbt.not_null_mart_daily_state_metrics_us_state.e9c98cd892
[0m14:12:47.311774 [debug] [Thread-3 (]: Began compiling node test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_count.44f9f89c45
[0m14:12:47.311952 [debug] [Thread-4 (]: Began compiling node test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_date.27b2c6ebe0
[0m14:12:47.315527 [debug] [Thread-2 (]: Writing injected SQL for node "test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_daily_state_metrics_transaction_date__us_state.36d7185b4c"
[0m14:12:47.315900 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_large_txn_share__1__0.d93f9f3127, now test.hw4_dbt.not_null_mart_daily_state_metrics_us_state.e9c98cd892)
[0m14:12:47.318678 [debug] [Thread-3 (]: Writing injected SQL for node "test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_count.44f9f89c45"
[0m14:12:47.320810 [debug] [Thread-4 (]: Writing injected SQL for node "test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_date.27b2c6ebe0"
[0m14:12:47.321270 [debug] [Thread-1 (]: Began compiling node test.hw4_dbt.not_null_mart_daily_state_metrics_us_state.e9c98cd892
[0m14:12:47.321758 [debug] [Thread-2 (]: Began executing node test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_daily_state_metrics_transaction_date__us_state.36d7185b4c
[0m14:12:47.324583 [debug] [Thread-1 (]: Writing injected SQL for node "test.hw4_dbt.not_null_mart_daily_state_metrics_us_state.e9c98cd892"
[0m14:12:47.324814 [debug] [Thread-3 (]: Began executing node test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_count.44f9f89c45
[0m14:12:47.325182 [debug] [Thread-2 (]: Finished running node test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_daily_state_metrics_transaction_date__us_state.36d7185b4c
[0m14:12:47.325361 [debug] [Thread-4 (]: Began executing node test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_date.27b2c6ebe0
[0m14:12:47.326015 [debug] [Thread-3 (]: Finished running node test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_count.44f9f89c45
[0m14:12:47.326381 [debug] [Thread-2 (]: Began running node test.hw4_dbt.assert_fraud_rate_bounds
[0m14:12:47.326632 [debug] [Thread-1 (]: Began executing node test.hw4_dbt.not_null_mart_daily_state_metrics_us_state.e9c98cd892
[0m14:12:47.327067 [debug] [Thread-4 (]: Finished running node test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_date.27b2c6ebe0
[0m14:12:47.327309 [debug] [Thread-3 (]: Began running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_category_fraud_rate__100__0.60b2512acf
[0m14:12:47.327542 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_daily_state_metrics_transaction_date__us_state.36d7185b4c, now test.hw4_dbt.assert_fraud_rate_bounds)
[0m14:12:47.327899 [debug] [Thread-1 (]: Finished running node test.hw4_dbt.not_null_mart_daily_state_metrics_us_state.e9c98cd892
[0m14:12:47.328247 [debug] [Thread-4 (]: Began running node test.hw4_dbt.not_null_mart_fraud_by_category_cat_id.1d7340ccc5
[0m14:12:47.328574 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_count.44f9f89c45, now test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_category_fraud_rate__100__0.60b2512acf)
[0m14:12:47.328841 [debug] [Thread-2 (]: Began compiling node test.hw4_dbt.assert_fraud_rate_bounds
[0m14:12:47.329092 [debug] [Thread-1 (]: Began running node test.hw4_dbt.unique_mart_fraud_by_category_cat_id.69c514d94d
[0m14:12:47.329347 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_date.27b2c6ebe0, now test.hw4_dbt.not_null_mart_fraud_by_category_cat_id.1d7340ccc5)
[0m14:12:47.329563 [debug] [Thread-3 (]: Began compiling node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_category_fraud_rate__100__0.60b2512acf
[0m14:12:47.331994 [debug] [Thread-2 (]: Writing injected SQL for node "test.hw4_dbt.assert_fraud_rate_bounds"
[0m14:12:47.332464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_mart_daily_state_metrics_us_state.e9c98cd892, now test.hw4_dbt.unique_mart_fraud_by_category_cat_id.69c514d94d)
[0m14:12:47.332779 [debug] [Thread-4 (]: Began compiling node test.hw4_dbt.not_null_mart_fraud_by_category_cat_id.1d7340ccc5
[0m14:12:47.336420 [debug] [Thread-3 (]: Writing injected SQL for node "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_category_fraud_rate__100__0.60b2512acf"
[0m14:12:47.336874 [debug] [Thread-1 (]: Began compiling node test.hw4_dbt.unique_mart_fraud_by_category_cat_id.69c514d94d
[0m14:12:47.339924 [debug] [Thread-4 (]: Writing injected SQL for node "test.hw4_dbt.not_null_mart_fraud_by_category_cat_id.1d7340ccc5"
[0m14:12:47.340226 [debug] [Thread-2 (]: Began executing node test.hw4_dbt.assert_fraud_rate_bounds
[0m14:12:47.345356 [debug] [Thread-1 (]: Writing injected SQL for node "test.hw4_dbt.unique_mart_fraud_by_category_cat_id.69c514d94d"
[0m14:12:47.345816 [debug] [Thread-3 (]: Began executing node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_category_fraud_rate__100__0.60b2512acf
[0m14:12:47.346616 [debug] [Thread-2 (]: Finished running node test.hw4_dbt.assert_fraud_rate_bounds
[0m14:12:47.347035 [debug] [Thread-4 (]: Began executing node test.hw4_dbt.not_null_mart_fraud_by_category_cat_id.1d7340ccc5
[0m14:12:47.347603 [debug] [Thread-3 (]: Finished running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_category_fraud_rate__100__0.60b2512acf
[0m14:12:47.347952 [debug] [Thread-2 (]: Began running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_hourly_fraud_pattern_fraud_rate__100__0.870771d265
[0m14:12:47.348139 [debug] [Thread-1 (]: Began executing node test.hw4_dbt.unique_mart_fraud_by_category_cat_id.69c514d94d
[0m14:12:47.348564 [debug] [Thread-4 (]: Finished running node test.hw4_dbt.not_null_mart_fraud_by_category_cat_id.1d7340ccc5
[0m14:12:47.348828 [debug] [Thread-3 (]: Began running node test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_hourly_fraud_pattern_day_name__hour_of_day.f8d797f239
[0m14:12:47.349098 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.assert_fraud_rate_bounds, now test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_hourly_fraud_pattern_fraud_rate__100__0.870771d265)
[0m14:12:47.349467 [debug] [Thread-1 (]: Finished running node test.hw4_dbt.unique_mart_fraud_by_category_cat_id.69c514d94d
[0m14:12:47.349763 [debug] [Thread-4 (]: Began running node test.hw4_dbt.not_null_mart_hourly_fraud_pattern_day_name.cc79fdc01d
[0m14:12:47.350233 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_category_fraud_rate__100__0.60b2512acf, now test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_hourly_fraud_pattern_day_name__hour_of_day.f8d797f239)
[0m14:12:47.350532 [debug] [Thread-2 (]: Began compiling node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_hourly_fraud_pattern_fraud_rate__100__0.870771d265
[0m14:12:47.350945 [debug] [Thread-1 (]: Began running node test.hw4_dbt.not_null_mart_hourly_fraud_pattern_hour_of_day.7bbb67dbe4
[0m14:12:47.351223 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_mart_fraud_by_category_cat_id.1d7340ccc5, now test.hw4_dbt.not_null_mart_hourly_fraud_pattern_day_name.cc79fdc01d)
[0m14:12:47.351468 [debug] [Thread-3 (]: Began compiling node test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_hourly_fraud_pattern_day_name__hour_of_day.f8d797f239
[0m14:12:47.354439 [debug] [Thread-2 (]: Writing injected SQL for node "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_hourly_fraud_pattern_fraud_rate__100__0.870771d265"
[0m14:12:47.354880 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.unique_mart_fraud_by_category_cat_id.69c514d94d, now test.hw4_dbt.not_null_mart_hourly_fraud_pattern_hour_of_day.7bbb67dbe4)
[0m14:12:47.355305 [debug] [Thread-4 (]: Began compiling node test.hw4_dbt.not_null_mart_hourly_fraud_pattern_day_name.cc79fdc01d
[0m14:12:47.358730 [debug] [Thread-3 (]: Writing injected SQL for node "test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_hourly_fraud_pattern_day_name__hour_of_day.f8d797f239"
[0m14:12:47.359202 [debug] [Thread-1 (]: Began compiling node test.hw4_dbt.not_null_mart_hourly_fraud_pattern_hour_of_day.7bbb67dbe4
[0m14:12:47.361950 [debug] [Thread-4 (]: Writing injected SQL for node "test.hw4_dbt.not_null_mart_hourly_fraud_pattern_day_name.cc79fdc01d"
[0m14:12:47.362464 [debug] [Thread-2 (]: Began executing node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_hourly_fraud_pattern_fraud_rate__100__0.870771d265
[0m14:12:47.365480 [debug] [Thread-1 (]: Writing injected SQL for node "test.hw4_dbt.not_null_mart_hourly_fraud_pattern_hour_of_day.7bbb67dbe4"
[0m14:12:47.365897 [debug] [Thread-3 (]: Began executing node test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_hourly_fraud_pattern_day_name__hour_of_day.f8d797f239
[0m14:12:47.366285 [debug] [Thread-2 (]: Finished running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_hourly_fraud_pattern_fraud_rate__100__0.870771d265
[0m14:12:47.366527 [debug] [Thread-4 (]: Began executing node test.hw4_dbt.not_null_mart_hourly_fraud_pattern_day_name.cc79fdc01d
[0m14:12:47.367100 [debug] [Thread-3 (]: Finished running node test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_hourly_fraud_pattern_day_name__hour_of_day.f8d797f239
[0m14:12:47.367571 [debug] [Thread-2 (]: Began running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_state_fraud_rate__100__0.ad1018ee37
[0m14:12:47.368062 [debug] [Thread-1 (]: Began executing node test.hw4_dbt.not_null_mart_hourly_fraud_pattern_hour_of_day.7bbb67dbe4
[0m14:12:47.368769 [debug] [Thread-4 (]: Finished running node test.hw4_dbt.not_null_mart_hourly_fraud_pattern_day_name.cc79fdc01d
[0m14:12:47.369118 [debug] [Thread-3 (]: Began running node test.hw4_dbt.not_null_mart_fraud_by_state_unique_customers.afa2f0b8db
[0m14:12:47.369475 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_hourly_fraud_pattern_fraud_rate__100__0.870771d265, now test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_state_fraud_rate__100__0.ad1018ee37)
[0m14:12:47.369905 [debug] [Thread-1 (]: Finished running node test.hw4_dbt.not_null_mart_hourly_fraud_pattern_hour_of_day.7bbb67dbe4
[0m14:12:47.370158 [debug] [Thread-4 (]: Began running node test.hw4_dbt.not_null_mart_fraud_by_state_us_state.95ac4eba19
[0m14:12:47.370519 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_hourly_fraud_pattern_day_name__hour_of_day.f8d797f239, now test.hw4_dbt.not_null_mart_fraud_by_state_unique_customers.afa2f0b8db)
[0m14:12:47.370767 [debug] [Thread-2 (]: Began compiling node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_state_fraud_rate__100__0.ad1018ee37
[0m14:12:47.371066 [debug] [Thread-1 (]: Began running node test.hw4_dbt.unique_mart_fraud_by_state_us_state.45e47cf1a6
[0m14:12:47.371709 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_mart_hourly_fraud_pattern_day_name.cc79fdc01d, now test.hw4_dbt.not_null_mart_fraud_by_state_us_state.95ac4eba19)
[0m14:12:47.372277 [debug] [Thread-3 (]: Began compiling node test.hw4_dbt.not_null_mart_fraud_by_state_unique_customers.afa2f0b8db
[0m14:12:47.376207 [debug] [Thread-2 (]: Writing injected SQL for node "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_state_fraud_rate__100__0.ad1018ee37"
[0m14:12:47.376673 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_mart_hourly_fraud_pattern_hour_of_day.7bbb67dbe4, now test.hw4_dbt.unique_mart_fraud_by_state_us_state.45e47cf1a6)
[0m14:12:47.376997 [debug] [Thread-4 (]: Began compiling node test.hw4_dbt.not_null_mart_fraud_by_state_us_state.95ac4eba19
[0m14:12:47.379826 [debug] [Thread-3 (]: Writing injected SQL for node "test.hw4_dbt.not_null_mart_fraud_by_state_unique_customers.afa2f0b8db"
[0m14:12:47.380217 [debug] [Thread-1 (]: Began compiling node test.hw4_dbt.unique_mart_fraud_by_state_us_state.45e47cf1a6
[0m14:12:47.384793 [debug] [Thread-4 (]: Writing injected SQL for node "test.hw4_dbt.not_null_mart_fraud_by_state_us_state.95ac4eba19"
[0m14:12:47.385110 [debug] [Thread-2 (]: Began executing node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_state_fraud_rate__100__0.ad1018ee37
[0m14:12:47.387726 [debug] [Thread-1 (]: Writing injected SQL for node "test.hw4_dbt.unique_mart_fraud_by_state_us_state.45e47cf1a6"
[0m14:12:47.388489 [debug] [Thread-2 (]: Finished running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_state_fraud_rate__100__0.ad1018ee37
[0m14:12:47.388682 [debug] [Thread-3 (]: Began executing node test.hw4_dbt.not_null_mart_fraud_by_state_unique_customers.afa2f0b8db
[0m14:12:47.389065 [debug] [Thread-2 (]: Began running node test.hw4_dbt.accepted_values_mart_merchant_analytics_suspicious_flag__0__1.221ef94aff
[0m14:12:47.389295 [debug] [Thread-4 (]: Began executing node test.hw4_dbt.not_null_mart_fraud_by_state_us_state.95ac4eba19
[0m14:12:47.389756 [debug] [Thread-3 (]: Finished running node test.hw4_dbt.not_null_mart_fraud_by_state_unique_customers.afa2f0b8db
[0m14:12:47.389920 [debug] [Thread-1 (]: Began executing node test.hw4_dbt.unique_mart_fraud_by_state_us_state.45e47cf1a6
[0m14:12:47.390129 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_state_fraud_rate__100__0.ad1018ee37, now test.hw4_dbt.accepted_values_mart_merchant_analytics_suspicious_flag__0__1.221ef94aff)
[0m14:12:47.390470 [debug] [Thread-4 (]: Finished running node test.hw4_dbt.not_null_mart_fraud_by_state_us_state.95ac4eba19
[0m14:12:47.390757 [debug] [Thread-3 (]: Began running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_merchant_analytics_fraud_rate__100__0.8aedb505c1
[0m14:12:47.391207 [debug] [Thread-1 (]: Finished running node test.hw4_dbt.unique_mart_fraud_by_state_us_state.45e47cf1a6
[0m14:12:47.391448 [debug] [Thread-2 (]: Began compiling node test.hw4_dbt.accepted_values_mart_merchant_analytics_suspicious_flag__0__1.221ef94aff
[0m14:12:47.391790 [debug] [Thread-4 (]: Began running node test.hw4_dbt.not_null_mart_merchant_analytics_merchant_id.61b4b4d63c
[0m14:12:47.392188 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_mart_fraud_by_state_unique_customers.afa2f0b8db, now test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_merchant_analytics_fraud_rate__100__0.8aedb505c1)
[0m14:12:47.392524 [debug] [Thread-1 (]: Began running node test.hw4_dbt.unique_mart_merchant_analytics_merchant_id.58d0768274
[0m14:12:47.395057 [debug] [Thread-2 (]: Writing injected SQL for node "test.hw4_dbt.accepted_values_mart_merchant_analytics_suspicious_flag__0__1.221ef94aff"
[0m14:12:47.395373 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_mart_fraud_by_state_us_state.95ac4eba19, now test.hw4_dbt.not_null_mart_merchant_analytics_merchant_id.61b4b4d63c)
[0m14:12:47.395703 [debug] [Thread-3 (]: Began compiling node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_merchant_analytics_fraud_rate__100__0.8aedb505c1
[0m14:12:47.395971 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.unique_mart_fraud_by_state_us_state.45e47cf1a6, now test.hw4_dbt.unique_mart_merchant_analytics_merchant_id.58d0768274)
[0m14:12:47.396343 [debug] [Thread-4 (]: Began compiling node test.hw4_dbt.not_null_mart_merchant_analytics_merchant_id.61b4b4d63c
[0m14:12:47.399347 [debug] [Thread-3 (]: Writing injected SQL for node "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_merchant_analytics_fraud_rate__100__0.8aedb505c1"
[0m14:12:47.399708 [debug] [Thread-1 (]: Began compiling node test.hw4_dbt.unique_mart_merchant_analytics_merchant_id.58d0768274
[0m14:12:47.402234 [debug] [Thread-4 (]: Writing injected SQL for node "test.hw4_dbt.not_null_mart_merchant_analytics_merchant_id.61b4b4d63c"
[0m14:12:47.402547 [debug] [Thread-2 (]: Began executing node test.hw4_dbt.accepted_values_mart_merchant_analytics_suspicious_flag__0__1.221ef94aff
[0m14:12:47.405165 [debug] [Thread-1 (]: Writing injected SQL for node "test.hw4_dbt.unique_mart_merchant_analytics_merchant_id.58d0768274"
[0m14:12:47.405756 [debug] [Thread-2 (]: Finished running node test.hw4_dbt.accepted_values_mart_merchant_analytics_suspicious_flag__0__1.221ef94aff
[0m14:12:47.405955 [debug] [Thread-3 (]: Began executing node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_merchant_analytics_fraud_rate__100__0.8aedb505c1
[0m14:12:47.406238 [debug] [Thread-4 (]: Began executing node test.hw4_dbt.not_null_mart_merchant_analytics_merchant_id.61b4b4d63c
[0m14:12:47.406614 [debug] [Thread-1 (]: Began executing node test.hw4_dbt.unique_mart_merchant_analytics_merchant_id.58d0768274
[0m14:12:47.406992 [debug] [Thread-3 (]: Finished running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_merchant_analytics_fraud_rate__100__0.8aedb505c1
[0m14:12:47.407278 [debug] [Thread-4 (]: Finished running node test.hw4_dbt.not_null_mart_merchant_analytics_merchant_id.61b4b4d63c
[0m14:12:47.407551 [debug] [Thread-1 (]: Finished running node test.hw4_dbt.unique_mart_merchant_analytics_merchant_id.58d0768274
[0m14:12:47.408376 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:12:47.408657 [debug] [MainThread]: Connection 'test.hw4_dbt.unique_mart_merchant_analytics_merchant_id.58d0768274' was properly closed.
[0m14:12:47.408834 [debug] [MainThread]: Connection 'test.hw4_dbt.accepted_values_mart_merchant_analytics_suspicious_flag__0__1.221ef94aff' was properly closed.
[0m14:12:47.408993 [debug] [MainThread]: Connection 'test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_merchant_analytics_fraud_rate__100__0.8aedb505c1' was properly closed.
[0m14:12:47.409129 [debug] [MainThread]: Connection 'test.hw4_dbt.not_null_mart_merchant_analytics_merchant_id.61b4b4d63c' was properly closed.
[0m14:12:47.412472 [debug] [MainThread]: Command end result
[0m14:12:47.501610 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m14:12:47.501977 [info ] [MainThread]: Building catalog
[0m14:12:47.508220 [debug] [ThreadPool]: Acquiring new duckdb connection 'transactions.information_schema'
[0m14:12:47.512895 [debug] [ThreadPool]: Using duckdb connection "transactions.information_schema"
[0m14:12:47.513316 [debug] [ThreadPool]: On transactions.information_schema: BEGIN
[0m14:12:47.513514 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:47.521763 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m14:12:47.522080 [debug] [ThreadPool]: Using duckdb connection "transactions.information_schema"
[0m14:12:47.522279 [debug] [ThreadPool]: On transactions.information_schema: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "connection_name": "transactions.information_schema"} */
with relations AS (
      select
        t.table_name
        , t.database_name
        , t.schema_name
        , 'BASE TABLE' as table_type
        , t.comment as table_comment
      from duckdb_tables() t
      WHERE t.database_name = 'transactions'
      UNION ALL
      SELECT v.view_name as table_name
      , v.database_name
      , v.schema_name
      , 'VIEW' as table_type
      , v.comment as table_comment
      from duckdb_views() v
      WHERE v.database_name = 'transactions'
    )
    select
        'transactions' as table_database,
        r.schema_name as table_schema,
        r.table_name,
        r.table_type,
        r.table_comment,
        c.column_name,
        c.column_index as column_index,
        c.data_type as column_type,
        c.comment as column_comment,
        '' as table_owner
    FROM relations r JOIN duckdb_columns() c ON r.schema_name = c.schema_name AND r.table_name = c.table_name
    WHERE (upper(r.schema_name) = upper('main_staging') or upper(r.schema_name) = upper('main_marts') or upper(r.schema_name) = upper('main_transactions_db'))
    ORDER BY
        r.schema_name,
        r.table_name,
        c.column_index
[0m14:12:47.532721 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m14:12:47.537520 [debug] [ThreadPool]: On transactions.information_schema: ROLLBACK
[0m14:12:47.537963 [debug] [ThreadPool]: Failed to rollback 'transactions.information_schema'
[0m14:12:47.538136 [debug] [ThreadPool]: On transactions.information_schema: Close
[0m14:12:47.573964 [info ] [MainThread]: Catalog written to /Users/roman/Desktop/hw4-mlops-bokhyan/dbt/target/catalog.json
[0m14:12:47.575589 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 1.1047678, "process_user_time": 1.577323, "process_kernel_time": 0.271937, "process_mem_max_rss": "156205056", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:12:47.575913 [debug] [MainThread]: Command `dbt docs generate` succeeded at 14:12:47.575865 after 1.11 seconds
[0m14:12:47.576253 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m14:12:47.576505 [debug] [MainThread]: Connection 'transactions.information_schema' was properly closed.
[0m14:12:47.576735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110ba0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102aba750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cf7a10>]}
[0m14:12:47.577042 [debug] [MainThread]: Flushing usage events
[0m14:14:39.437250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bc7d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c2d510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c2db90>]}


============================== 14:14:39.442085 | 21069dfa-2a27-4555-b720-1d3ad08dba4a ==============================
[0m14:14:39.442085 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:14:39.442613 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/roman/Desktop/hw4-mlops-bokhyan/dbt/logs', 'debug': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ls --resource-type unit_test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:14:39.679213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21069dfa-2a27-4555-b720-1d3ad08dba4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c05bd0>]}
[0m14:14:39.714150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21069dfa-2a27-4555-b720-1d3ad08dba4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102944590>]}
[0m14:14:39.714992 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m14:14:39.783628 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m14:14:39.903412 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:14:39.903723 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:14:39.939016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21069dfa-2a27-4555-b720-1d3ad08dba4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10518e490>]}
[0m14:14:40.035397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21069dfa-2a27-4555-b720-1d3ad08dba4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d610d0>]}
[0m14:14:40.035814 [info ] [MainThread]: Found 2 seeds, 7 models, 56 data tests, 1 source, 805 macros
[0m14:14:40.036089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21069dfa-2a27-4555-b720-1d3ad08dba4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d34390>]}
[0m14:14:40.037238 [warn ] [MainThread]: No nodes selected!
[0m14:14:40.039771 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.6477435, "process_user_time": 1.112507, "process_kernel_time": 0.286947, "process_mem_max_rss": "137281536", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:14:40.040214 [debug] [MainThread]: Command `dbt ls` succeeded at 14:14:40.040147 after 0.65 seconds
[0m14:14:40.040485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1004dd390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c2fa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c2ded0>]}
[0m14:14:40.040707 [debug] [MainThread]: Flushing usage events
[0m14:16:46.390877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120f83190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12122bcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121299750>]}


============================== 14:16:46.396925 | ee6b6595-46a3-492e-975d-8854bab21067 ==============================
[0m14:16:46.396925 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:16:46.397498 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '.', 'log_path': '/Users/roman/Desktop/hw4-mlops-bokhyan/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt ls --resource-type unit_test', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:16:46.641792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee6b6595-46a3-492e-975d-8854bab21067', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1212f0b90>]}
[0m14:16:46.679424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee6b6595-46a3-492e-975d-8854bab21067', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069b0550>]}
[0m14:16:46.680304 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m14:16:46.751194 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m14:16:46.870413 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:16:46.870927 [debug] [MainThread]: Partial parsing: added file: hw4_dbt://models/staging/stg_transactions_unit.yml
[0m14:16:46.969802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee6b6595-46a3-492e-975d-8854bab21067', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12220f390>]}
[0m14:16:47.112454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee6b6595-46a3-492e-975d-8854bab21067', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1220c83d0>]}
[0m14:16:47.112829 [info ] [MainThread]: Found 2 seeds, 7 models, 56 data tests, 1 source, 805 macros, 1 unit test
[0m14:16:47.113014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee6b6595-46a3-492e-975d-8854bab21067', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1224675d0>]}
[0m14:16:47.115862 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.7713603, "process_user_time": 1.225819, "process_kernel_time": 0.301218, "process_mem_max_rss": "139771904", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:16:47.116423 [debug] [MainThread]: Command `dbt ls` succeeded at 14:16:47.116330 after 0.77 seconds
[0m14:16:47.116733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102925050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1029c24d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1029c2c90>]}
[0m14:16:47.117029 [debug] [MainThread]: Flushing usage events
[0m14:16:56.525051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10895d510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108980ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108981550>]}


============================== 14:16:56.528850 | 37862d76-b227-420b-a60d-f3e844d47bbe ==============================
[0m14:16:56.528850 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:16:56.529216 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/roman/Desktop/hw4-mlops-bokhyan/dbt/logs', 'debug': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --select test_type:unit', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:16:56.663487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37862d76-b227-420b-a60d-f3e844d47bbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108917c90>]}
[0m14:16:56.696773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37862d76-b227-420b-a60d-f3e844d47bbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058b0250>]}
[0m14:16:56.697407 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m14:16:56.756349 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m14:16:56.851910 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:16:56.852200 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:16:56.882899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37862d76-b227-420b-a60d-f3e844d47bbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b76f50>]}
[0m14:16:57.013270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37862d76-b227-420b-a60d-f3e844d47bbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d09bd0>]}
[0m14:16:57.013641 [info ] [MainThread]: Found 2 seeds, 7 models, 56 data tests, 1 source, 805 macros, 1 unit test
[0m14:16:57.013854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37862d76-b227-420b-a60d-f3e844d47bbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d043d0>]}
[0m14:16:57.015096 [info ] [MainThread]: 
[0m14:16:57.015425 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:16:57.018623 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_transactions_main_marts'
[0m14:16:57.019014 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_transactions_main_transactions_db'
[0m14:16:57.019325 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_transactions_main_staging'
[0m14:16:57.058979 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_marts"
[0m14:16:57.059296 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_transactions_db"
[0m14:16:57.059607 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_staging"
[0m14:16:57.059912 [debug] [ThreadPool]: On list_transactions_main_marts: BEGIN
[0m14:16:57.060135 [debug] [ThreadPool]: On list_transactions_main_transactions_db: BEGIN
[0m14:16:57.060315 [debug] [ThreadPool]: On list_transactions_main_staging: BEGIN
[0m14:16:57.060526 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:16:57.060760 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:16:57.060952 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:16:57.074869 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m14:16:57.075126 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m14:16:57.075354 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m14:16:57.075556 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_marts"
[0m14:16:57.075846 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_transactions_db"
[0m14:16:57.076079 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_staging"
[0m14:16:57.076260 [debug] [ThreadPool]: On list_transactions_main_marts: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "connection_name": "list_transactions_main_marts"} */
select
      'transactions' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_marts'
    and table_catalog = 'transactions'
  
[0m14:16:57.076477 [debug] [ThreadPool]: On list_transactions_main_transactions_db: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "connection_name": "list_transactions_main_transactions_db"} */
select
      'transactions' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_transactions_db'
    and table_catalog = 'transactions'
  
[0m14:16:57.076711 [debug] [ThreadPool]: On list_transactions_main_staging: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "connection_name": "list_transactions_main_staging"} */
select
      'transactions' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_staging'
    and table_catalog = 'transactions'
  
[0m14:16:57.092780 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m14:16:57.093074 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m14:16:57.093279 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m14:16:57.094437 [debug] [ThreadPool]: On list_transactions_main_transactions_db: ROLLBACK
[0m14:16:57.095199 [debug] [ThreadPool]: On list_transactions_main_marts: ROLLBACK
[0m14:16:57.095838 [debug] [ThreadPool]: On list_transactions_main_staging: ROLLBACK
[0m14:16:57.096762 [debug] [ThreadPool]: Failed to rollback 'list_transactions_main_transactions_db'
[0m14:16:57.097093 [debug] [ThreadPool]: Failed to rollback 'list_transactions_main_marts'
[0m14:16:57.097404 [debug] [ThreadPool]: Failed to rollback 'list_transactions_main_staging'
[0m14:16:57.097597 [debug] [ThreadPool]: On list_transactions_main_transactions_db: Close
[0m14:16:57.097775 [debug] [ThreadPool]: On list_transactions_main_marts: Close
[0m14:16:57.097945 [debug] [ThreadPool]: On list_transactions_main_staging: Close
[0m14:16:57.101441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37862d76-b227-420b-a60d-f3e844d47bbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d0ad50>]}
[0m14:16:57.101795 [debug] [MainThread]: Using duckdb connection "master"
[0m14:16:57.101962 [debug] [MainThread]: On master: BEGIN
[0m14:16:57.102109 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:16:57.109867 [debug] [MainThread]: SQL status: OK in 0.008 seconds
[0m14:16:57.110258 [debug] [MainThread]: On master: COMMIT
[0m14:16:57.110506 [debug] [MainThread]: Using duckdb connection "master"
[0m14:16:57.110689 [debug] [MainThread]: On master: COMMIT
[0m14:16:57.111039 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:16:57.111206 [debug] [MainThread]: On master: Close
[0m14:16:57.112505 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:16:57.112761 [info ] [MainThread]: 
[0m14:16:57.114409 [debug] [Thread-1 (]: Began running node unit_test.hw4_dbt.stg_transactions.stg_transactions_unit
[0m14:16:57.114746 [info ] [Thread-1 (]: 1 of 1 START unit_test stg_transactions::stg_transactions_unit ................. [RUN]
[0m14:16:57.115578 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_transactions_main_marts, now unit_test.hw4_dbt.stg_transactions.stg_transactions_unit)
[0m14:16:57.115804 [debug] [Thread-1 (]: Began compiling node unit_test.hw4_dbt.stg_transactions.stg_transactions_unit
[0m14:16:57.115992 [debug] [Thread-1 (]: Began executing node unit_test.hw4_dbt.stg_transactions.stg_transactions_unit
[0m14:16:57.142528 [debug] [Thread-1 (]: Compilation Error in unit_test stg_transactions_unit (models/staging/stg_transactions_unit.yml)
  Unit_Test 'unit_test.hw4_dbt.stg_transactions.stg_transactions_unit' (models/staging/stg_transactions_unit.yml) depends on a node named 'states' which was not found
[0m14:16:57.142970 [error] [Thread-1 (]: 1 of 1 ERROR stg_transactions::stg_transactions_unit ........................... [[31mERROR[0m in 0.03s]
[0m14:16:57.143367 [debug] [Thread-1 (]: Finished running node unit_test.hw4_dbt.stg_transactions.stg_transactions_unit
[0m14:16:57.144475 [debug] [MainThread]: Using duckdb connection "master"
[0m14:16:57.144746 [debug] [MainThread]: On master: BEGIN
[0m14:16:57.144902 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:16:57.153198 [debug] [MainThread]: SQL status: OK in 0.008 seconds
[0m14:16:57.153452 [debug] [MainThread]: On master: COMMIT
[0m14:16:57.153595 [debug] [MainThread]: Using duckdb connection "master"
[0m14:16:57.153728 [debug] [MainThread]: On master: COMMIT
[0m14:16:57.153936 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:16:57.154068 [debug] [MainThread]: On master: Close
[0m14:16:57.155613 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:16:57.155999 [debug] [MainThread]: Connection 'unit_test.hw4_dbt.stg_transactions.stg_transactions_unit' was properly closed.
[0m14:16:57.156152 [debug] [MainThread]: Connection 'list_transactions_main_transactions_db' was properly closed.
[0m14:16:57.156269 [debug] [MainThread]: Connection 'list_transactions_main_staging' was properly closed.
[0m14:16:57.156423 [info ] [MainThread]: 
[0m14:16:57.156681 [info ] [MainThread]: Finished running 1 unit test in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m14:16:57.157251 [debug] [MainThread]: Command end result
[0m14:16:57.186455 [info ] [MainThread]: 
[0m14:16:57.186830 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:16:57.187114 [info ] [MainThread]: 
[0m14:16:57.187677 [error] [MainThread]:   Compilation Error in unit_test stg_transactions_unit (models/staging/stg_transactions_unit.yml)
  Unit_Test 'unit_test.hw4_dbt.stg_transactions.stg_transactions_unit' (models/staging/stg_transactions_unit.yml) depends on a node named 'states' which was not found
[0m14:16:57.188060 [info ] [MainThread]: 
[0m14:16:57.188640 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:16:57.190590 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.7060111, "process_user_time": 1.238896, "process_kernel_time": 0.224165, "process_mem_max_rss": "153010176", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:16:57.190913 [debug] [MainThread]: Command `dbt test` failed at 14:16:57.190867 after 0.71 seconds
[0m14:16:57.191156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089a6450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103089050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108981210>]}
[0m14:16:57.191380 [debug] [MainThread]: Flushing usage events
[0m14:17:19.914945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b41c5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b478a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b479090>]}


============================== 14:17:19.919451 | ba6dc2c9-70fc-4116-b8e6-6b4afe3fc767 ==============================
[0m14:17:19.919451 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:17:19.919838 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/roman/Desktop/hw4-mlops-bokhyan/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --select test_type:unit', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:17:20.057374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba6dc2c9-70fc-4116-b8e6-6b4afe3fc767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b6dd110>]}
[0m14:17:20.092946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ba6dc2c9-70fc-4116-b8e6-6b4afe3fc767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bb4fd0>]}
[0m14:17:20.093578 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m14:17:20.160339 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m14:17:20.259981 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:17:20.260529 [debug] [MainThread]: Partial parsing: updated file: hw4_dbt://models/staging/stg_transactions_unit.yml
[0m14:17:20.353942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba6dc2c9-70fc-4116-b8e6-6b4afe3fc767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ba83750>]}
[0m14:17:20.478780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba6dc2c9-70fc-4116-b8e6-6b4afe3fc767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bb4af50>]}
[0m14:17:20.479117 [info ] [MainThread]: Found 2 seeds, 7 models, 56 data tests, 1 source, 805 macros, 1 unit test
[0m14:17:20.479306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba6dc2c9-70fc-4116-b8e6-6b4afe3fc767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bf33d50>]}
[0m14:17:20.480848 [info ] [MainThread]: 
[0m14:17:20.481307 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:17:20.484397 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_transactions_main_transactions_db'
[0m14:17:20.484735 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_transactions_main_staging'
[0m14:17:20.490874 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_transactions_main_marts'
[0m14:17:20.519027 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_transactions_db"
[0m14:17:20.519271 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_staging"
[0m14:17:20.519443 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_marts"
[0m14:17:20.519644 [debug] [ThreadPool]: On list_transactions_main_transactions_db: BEGIN
[0m14:17:20.519804 [debug] [ThreadPool]: On list_transactions_main_staging: BEGIN
[0m14:17:20.519950 [debug] [ThreadPool]: On list_transactions_main_marts: BEGIN
[0m14:17:20.520091 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:17:20.520226 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:17:20.520354 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:17:20.529361 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m14:17:20.529694 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m14:17:20.529906 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_transactions_db"
[0m14:17:20.530089 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m14:17:20.530270 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_marts"
[0m14:17:20.530460 [debug] [ThreadPool]: On list_transactions_main_transactions_db: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "connection_name": "list_transactions_main_transactions_db"} */
select
      'transactions' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_transactions_db'
    and table_catalog = 'transactions'
  
[0m14:17:20.530728 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_staging"
[0m14:17:20.530998 [debug] [ThreadPool]: On list_transactions_main_marts: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "connection_name": "list_transactions_main_marts"} */
select
      'transactions' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_marts'
    and table_catalog = 'transactions'
  
[0m14:17:20.531350 [debug] [ThreadPool]: On list_transactions_main_staging: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "connection_name": "list_transactions_main_staging"} */
select
      'transactions' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_staging'
    and table_catalog = 'transactions'
  
[0m14:17:20.540677 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m14:17:20.540974 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m14:17:20.541150 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m14:17:20.542161 [debug] [ThreadPool]: On list_transactions_main_staging: ROLLBACK
[0m14:17:20.544933 [debug] [ThreadPool]: On list_transactions_main_marts: ROLLBACK
[0m14:17:20.545582 [debug] [ThreadPool]: On list_transactions_main_transactions_db: ROLLBACK
[0m14:17:20.546345 [debug] [ThreadPool]: Failed to rollback 'list_transactions_main_staging'
[0m14:17:20.546729 [debug] [ThreadPool]: Failed to rollback 'list_transactions_main_marts'
[0m14:17:20.547169 [debug] [ThreadPool]: Failed to rollback 'list_transactions_main_transactions_db'
[0m14:17:20.547391 [debug] [ThreadPool]: On list_transactions_main_staging: Close
[0m14:17:20.547545 [debug] [ThreadPool]: On list_transactions_main_marts: Close
[0m14:17:20.547692 [debug] [ThreadPool]: On list_transactions_main_transactions_db: Close
[0m14:17:20.550760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba6dc2c9-70fc-4116-b8e6-6b4afe3fc767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bcc57d0>]}
[0m14:17:20.551192 [debug] [MainThread]: Using duckdb connection "master"
[0m14:17:20.551523 [debug] [MainThread]: On master: BEGIN
[0m14:17:20.551705 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:17:20.559508 [debug] [MainThread]: SQL status: OK in 0.008 seconds
[0m14:17:20.559761 [debug] [MainThread]: On master: COMMIT
[0m14:17:20.559908 [debug] [MainThread]: Using duckdb connection "master"
[0m14:17:20.560035 [debug] [MainThread]: On master: COMMIT
[0m14:17:20.560263 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:17:20.560404 [debug] [MainThread]: On master: Close
[0m14:17:20.561593 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:17:20.561948 [info ] [MainThread]: 
[0m14:17:20.564115 [debug] [Thread-1 (]: Began running node unit_test.hw4_dbt.stg_transactions.stg_transactions_unit
[0m14:17:20.564458 [info ] [Thread-1 (]: 1 of 1 START unit_test stg_transactions::stg_transactions_unit ................. [RUN]
[0m14:17:20.565077 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_transactions_main_transactions_db, now unit_test.hw4_dbt.stg_transactions.stg_transactions_unit)
[0m14:17:20.565369 [debug] [Thread-1 (]: Began compiling node unit_test.hw4_dbt.stg_transactions.stg_transactions_unit
[0m14:17:20.565560 [debug] [Thread-1 (]: Began executing node unit_test.hw4_dbt.stg_transactions.stg_transactions_unit
[0m14:17:20.602110 [debug] [Thread-1 (]: Using duckdb connection "unit_test.hw4_dbt.stg_transactions.stg_transactions_unit"
[0m14:17:20.602430 [debug] [Thread-1 (]: On unit_test.hw4_dbt.stg_transactions.stg_transactions_unit: BEGIN
[0m14:17:20.602602 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:20.611876 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m14:17:20.613070 [debug] [Thread-1 (]: Using duckdb connection "unit_test.hw4_dbt.stg_transactions.stg_transactions_unit"
[0m14:17:20.613470 [debug] [Thread-1 (]: On unit_test.hw4_dbt.stg_transactions.stg_transactions_unit: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "unit_test.hw4_dbt.stg_transactions.stg_transactions_unit"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'transactions'
      
      and table_schema = 'main_transactions_db'
      
      
      and table_catalog = 'transactions'
      
      order by ordinal_position

  
[0m14:17:20.625732 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m14:17:20.639781 [debug] [Thread-1 (]: Writing injected SQL for node "unit_test.hw4_dbt.stg_transactions.stg_transactions_unit"
[0m14:17:20.647048 [debug] [Thread-1 (]: Using duckdb connection "unit_test.hw4_dbt.stg_transactions.stg_transactions_unit"
[0m14:17:20.647365 [debug] [Thread-1 (]: On unit_test.hw4_dbt.stg_transactions.stg_transactions_unit: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "unit_test.hw4_dbt.stg_transactions.stg_transactions_unit"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'states'
      
      and table_schema = 'main_transactions_db'
      
      
      and table_catalog = 'transactions'
      
      order by ordinal_position

  
[0m14:17:20.649627 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:17:20.651205 [debug] [Thread-1 (]: Writing injected SQL for node "unit_test.hw4_dbt.stg_transactions.stg_transactions_unit"
[0m14:17:20.669806 [debug] [Thread-1 (]: Writing injected SQL for node "unit_test.hw4_dbt.stg_transactions.stg_transactions_unit"
[0m14:17:20.684876 [debug] [Thread-1 (]: Using duckdb connection "unit_test.hw4_dbt.stg_transactions.stg_transactions_unit"
[0m14:17:20.685449 [debug] [Thread-1 (]: On unit_test.hw4_dbt.stg_transactions.stg_transactions_unit: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "unit_test.hw4_dbt.stg_transactions.stg_transactions_unit"} */

    
  
    
    

    create temporary table
      stg_transactions_unit__dbt_tmp20251202141720678114
  
    as (
      select * from (
        with  __dbt__cte__transactions as (

-- Fixture for transactions
select 
    
    cast('2020-01-01 10:00:00' as character varying(256))
 as transaction_time, 
    
    cast('Test Shop' as character varying(256))
 as merch, 
    
    cast('games' as character varying(256))
 as cat_id, 
    
    cast(25 as DOUBLE)
 as amount, 
    
    cast('Alex' as character varying(256))
 as name_1, 
    
    cast('Smith' as character varying(256))
 as name_2, 
    
    cast('M' as character varying(256))
 as gender, 
    
    cast('1 Main' as character varying(256))
 as street, 
    
    cast('New York' as character varying(256))
 as one_city, 
    
    cast('NY' as character varying(256))
 as us_state, 
    
    cast('10001' as INTEGER)
 as post_code, 
    
    cast(40.0 as DOUBLE)
 as lat, 
    
    cast(-73.0 as DOUBLE)
 as lon, 
    
    cast(1000 as INTEGER)
 as population_city, 
    
    cast('Analyst' as character varying(256))
 as jobs, 
    
    cast(40.5 as DOUBLE)
 as merchant_lat, 
    
    cast(-73.5 as DOUBLE)
 as merchant_lon, 
    
    cast(0 as INTEGER)
 as target
union all
select 
    
    cast('2020-01-02 12:00:00' as character varying(256))
 as transaction_time, 
    
    cast('Test Shop' as character varying(256))
 as merch, 
    
    cast('travel' as character varying(256))
 as cat_id, 
    
    cast(600 as DOUBLE)
 as amount, 
    
    cast('Jamie' as character varying(256))
 as name_1, 
    
    cast('Doe' as character varying(256))
 as name_2, 
    
    cast('F' as character varying(256))
 as gender, 
    
    cast('2 Main' as character varying(256))
 as street, 
    
    cast('Los Angeles' as character varying(256))
 as one_city, 
    
    cast('CA' as character varying(256))
 as us_state, 
    
    cast('90001' as INTEGER)
 as post_code, 
    
    cast(34.0 as DOUBLE)
 as lat, 
    
    cast(-118.0 as DOUBLE)
 as lon, 
    
    cast(2000 as INTEGER)
 as population_city, 
    
    cast('Engineer' as character varying(256))
 as jobs, 
    
    cast(34.5 as DOUBLE)
 as merchant_lat, 
    
    cast(-118.3 as DOUBLE)
 as merchant_lon, 
    
    cast(1 as INTEGER)
 as target
),  __dbt__cte__states as (

-- Fixture for states
select 
    
    cast('NY' as character varying(256))
 as state_code, 
    
    cast('New York' as character varying(256))
 as state_name
union all
select 
    
    cast('CA' as character varying(256))
 as state_code, 
    
    cast('California' as character varying(256))
 as state_name
), source as (
    select * from __dbt__cte__transactions
),
renamed as (
    select
        md5(cast(coalesce(cast(transaction_time as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(merch as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(amount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(cat_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(post_code as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as transaction_id,
        cast(transaction_time as timestamp) as transaction_ts,
        cast(date(transaction_time) as date) as transaction_date,
        date_trunc('hour', cast(transaction_time as timestamp)) as transaction_hour,
        substr(dayname(cast(transaction_time as timestamp)), 1, 3) as day_name,
        merch as merchant_name,
        md5(cast(coalesce(cast(merch as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as merchant_id,
        cat_id,
        cast(amount as double) as amount,
        
    case
        when cast(amount as double) is null then 'unknown'
        when cast(amount as double) < 50 then 'small'
        when cast(amount as double) < 200 then 'medium'
        when cast(amount as double) < 500 then 'large'
        else 'extra_large'
    end
 as amount_bucket,
        case
            when upper(gender) in ('M', 'MALE') then 'M'
            when upper(gender) in ('F', 'FEMALE') then 'F'
            else 'U'
        end as gender,
        md5(cast(coalesce(cast(name_1 as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(name_2 as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(street as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(post_code as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
        concat_ws(' ', nullif(name_1, ''), nullif(name_2, '')) as customer_full_name,
        street,
        one_city as city,
        upper(us_state) as us_state,
        post_code,
        cast(lat as double) as customer_lat,
        cast(lon as double) as customer_lon,
        cast(merchant_lat as double) as merchant_lat,
        cast(merchant_lon as double) as merchant_lon,
        nullif(jobs, '') as job_title,
        cast(population_city as bigint) as population_city,
        cast(target as integer) as is_fraud,
        case when 
    case
        when cast(amount as double) is null then 'unknown'
        when cast(amount as double) < 50 then 'small'
        when cast(amount as double) < 200 then 'medium'
        when cast(amount as double) < 500 then 'large'
        else 'extra_large'
    end
 in ('large', 'extra_large') then 1 else 0 end as is_large_amount
    from source
),
with_states as (
    select
        r.*,
        s.state_name
    from renamed r
    left join __dbt__cte__states s
        on r.us_state = s.state_code
)
select * from with_states
    ) as __dbt_sbq
    where false
    limit 0

    );
  
  
  
[0m14:17:20.690657 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m14:17:20.692643 [debug] [Thread-1 (]: Using duckdb connection "unit_test.hw4_dbt.stg_transactions.stg_transactions_unit"
[0m14:17:20.692912 [debug] [Thread-1 (]: On unit_test.hw4_dbt.stg_transactions.stg_transactions_unit: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "unit_test.hw4_dbt.stg_transactions.stg_transactions_unit"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'stg_transactions_unit__dbt_tmp20251202141720678114'
      
      
      order by ordinal_position

  
[0m14:17:20.694416 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:17:20.701243 [debug] [Thread-1 (]: Writing runtime sql for node "unit_test.hw4_dbt.stg_transactions.stg_transactions_unit"
[0m14:17:20.703388 [debug] [Thread-1 (]: Using duckdb connection "unit_test.hw4_dbt.stg_transactions.stg_transactions_unit"
[0m14:17:20.703949 [debug] [Thread-1 (]: On unit_test.hw4_dbt.stg_transactions.stg_transactions_unit: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "unit_test.hw4_dbt.stg_transactions.stg_transactions_unit"} */
-- Build actual result given inputs
with dbt_internal_unit_test_actual as (
  select
    transaction_date,amount_bucket,is_fraud,gender,us_state,day_name, 'actual' as "actual_or_expected"
  from (
    with  __dbt__cte__transactions as (

-- Fixture for transactions
select 
    
    cast('2020-01-01 10:00:00' as character varying(256))
 as transaction_time, 
    
    cast('Test Shop' as character varying(256))
 as merch, 
    
    cast('games' as character varying(256))
 as cat_id, 
    
    cast(25 as DOUBLE)
 as amount, 
    
    cast('Alex' as character varying(256))
 as name_1, 
    
    cast('Smith' as character varying(256))
 as name_2, 
    
    cast('M' as character varying(256))
 as gender, 
    
    cast('1 Main' as character varying(256))
 as street, 
    
    cast('New York' as character varying(256))
 as one_city, 
    
    cast('NY' as character varying(256))
 as us_state, 
    
    cast('10001' as INTEGER)
 as post_code, 
    
    cast(40.0 as DOUBLE)
 as lat, 
    
    cast(-73.0 as DOUBLE)
 as lon, 
    
    cast(1000 as INTEGER)
 as population_city, 
    
    cast('Analyst' as character varying(256))
 as jobs, 
    
    cast(40.5 as DOUBLE)
 as merchant_lat, 
    
    cast(-73.5 as DOUBLE)
 as merchant_lon, 
    
    cast(0 as INTEGER)
 as target
union all
select 
    
    cast('2020-01-02 12:00:00' as character varying(256))
 as transaction_time, 
    
    cast('Test Shop' as character varying(256))
 as merch, 
    
    cast('travel' as character varying(256))
 as cat_id, 
    
    cast(600 as DOUBLE)
 as amount, 
    
    cast('Jamie' as character varying(256))
 as name_1, 
    
    cast('Doe' as character varying(256))
 as name_2, 
    
    cast('F' as character varying(256))
 as gender, 
    
    cast('2 Main' as character varying(256))
 as street, 
    
    cast('Los Angeles' as character varying(256))
 as one_city, 
    
    cast('CA' as character varying(256))
 as us_state, 
    
    cast('90001' as INTEGER)
 as post_code, 
    
    cast(34.0 as DOUBLE)
 as lat, 
    
    cast(-118.0 as DOUBLE)
 as lon, 
    
    cast(2000 as INTEGER)
 as population_city, 
    
    cast('Engineer' as character varying(256))
 as jobs, 
    
    cast(34.5 as DOUBLE)
 as merchant_lat, 
    
    cast(-118.3 as DOUBLE)
 as merchant_lon, 
    
    cast(1 as INTEGER)
 as target
),  __dbt__cte__states as (

-- Fixture for states
select 
    
    cast('NY' as character varying(256))
 as state_code, 
    
    cast('New York' as character varying(256))
 as state_name
union all
select 
    
    cast('CA' as character varying(256))
 as state_code, 
    
    cast('California' as character varying(256))
 as state_name
), source as (
    select * from __dbt__cte__transactions
),
renamed as (
    select
        md5(cast(coalesce(cast(transaction_time as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(merch as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(amount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(cat_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(post_code as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as transaction_id,
        cast(transaction_time as timestamp) as transaction_ts,
        cast(date(transaction_time) as date) as transaction_date,
        date_trunc('hour', cast(transaction_time as timestamp)) as transaction_hour,
        substr(dayname(cast(transaction_time as timestamp)), 1, 3) as day_name,
        merch as merchant_name,
        md5(cast(coalesce(cast(merch as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as merchant_id,
        cat_id,
        cast(amount as double) as amount,
        
    case
        when cast(amount as double) is null then 'unknown'
        when cast(amount as double) < 50 then 'small'
        when cast(amount as double) < 200 then 'medium'
        when cast(amount as double) < 500 then 'large'
        else 'extra_large'
    end
 as amount_bucket,
        case
            when upper(gender) in ('M', 'MALE') then 'M'
            when upper(gender) in ('F', 'FEMALE') then 'F'
            else 'U'
        end as gender,
        md5(cast(coalesce(cast(name_1 as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(name_2 as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(street as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(post_code as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
        concat_ws(' ', nullif(name_1, ''), nullif(name_2, '')) as customer_full_name,
        street,
        one_city as city,
        upper(us_state) as us_state,
        post_code,
        cast(lat as double) as customer_lat,
        cast(lon as double) as customer_lon,
        cast(merchant_lat as double) as merchant_lat,
        cast(merchant_lon as double) as merchant_lon,
        nullif(jobs, '') as job_title,
        cast(population_city as bigint) as population_city,
        cast(target as integer) as is_fraud,
        case when 
    case
        when cast(amount as double) is null then 'unknown'
        when cast(amount as double) < 50 then 'small'
        when cast(amount as double) < 200 then 'medium'
        when cast(amount as double) < 500 then 'large'
        else 'extra_large'
    end
 in ('large', 'extra_large') then 1 else 0 end as is_large_amount
    from source
),
with_states as (
    select
        r.*,
        s.state_name
    from renamed r
    left join __dbt__cte__states s
        on r.us_state = s.state_code
)
select * from with_states
  ) _dbt_internal_unit_test_actual
),
-- Build expected result
dbt_internal_unit_test_expected as (
  select
    transaction_date, amount_bucket, is_fraud, gender, us_state, day_name, 'expected' as "actual_or_expected"
  from (
    select 
    
    cast('2020-01-01' as DATE)
 as transaction_date, 
    
    cast('small' as character varying(256))
 as amount_bucket, 
    
    cast(0 as INTEGER)
 as is_fraud, 
    
    cast('M' as character varying(256))
 as gender, 
    
    cast('NY' as character varying(256))
 as us_state, 
    
    cast('Wednesday' as character varying(256))
 as day_name
union all
select 
    
    cast('2020-01-02' as DATE)
 as transaction_date, 
    
    cast('extra_large' as character varying(256))
 as amount_bucket, 
    
    cast(1 as INTEGER)
 as is_fraud, 
    
    cast('F' as character varying(256))
 as gender, 
    
    cast('CA' as character varying(256))
 as us_state, 
    
    cast('Thursday' as character varying(256))
 as day_name
  ) _dbt_internal_unit_test_expected
)
-- Union actual and expected results
select * from dbt_internal_unit_test_actual
union all
select * from dbt_internal_unit_test_expected
[0m14:17:20.712012 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m14:17:20.716212 [debug] [Thread-1 (]: Using duckdb connection "unit_test.hw4_dbt.stg_transactions.stg_transactions_unit"
[0m14:17:20.716486 [debug] [Thread-1 (]: On unit_test.hw4_dbt.stg_transactions.stg_transactions_unit: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "unit_test.hw4_dbt.stg_transactions.stg_transactions_unit"} */
drop table if exists stg_transactions_unit__dbt_tmp20251202141720678114 cascade
[0m14:17:20.717205 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:17:20.721500 [debug] [Thread-1 (]: On unit_test.hw4_dbt.stg_transactions.stg_transactions_unit: ROLLBACK
[0m14:17:20.721858 [debug] [Thread-1 (]: Failed to rollback 'unit_test.hw4_dbt.stg_transactions.stg_transactions_unit'
[0m14:17:20.722031 [debug] [Thread-1 (]: On unit_test.hw4_dbt.stg_transactions.stg_transactions_unit: Close
[0m14:17:20.723649 [error] [Thread-1 (]: 1 of 1 FAIL 1 stg_transactions::stg_transactions_unit .......................... [[31mFAIL 1[0m in 0.16s]
[0m14:17:20.724266 [debug] [Thread-1 (]: Finished running node unit_test.hw4_dbt.stg_transactions.stg_transactions_unit
[0m14:17:20.725058 [debug] [MainThread]: Using duckdb connection "master"
[0m14:17:20.725209 [debug] [MainThread]: On master: BEGIN
[0m14:17:20.725342 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:17:20.733211 [debug] [MainThread]: SQL status: OK in 0.008 seconds
[0m14:17:20.733533 [debug] [MainThread]: On master: COMMIT
[0m14:17:20.733695 [debug] [MainThread]: Using duckdb connection "master"
[0m14:17:20.733868 [debug] [MainThread]: On master: COMMIT
[0m14:17:20.734105 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:17:20.734247 [debug] [MainThread]: On master: Close
[0m14:17:20.735520 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:17:20.735809 [debug] [MainThread]: Connection 'unit_test.hw4_dbt.stg_transactions.stg_transactions_unit' was properly closed.
[0m14:17:20.735957 [debug] [MainThread]: Connection 'list_transactions_main_staging' was properly closed.
[0m14:17:20.736093 [debug] [MainThread]: Connection 'list_transactions_main_marts' was properly closed.
[0m14:17:20.736264 [info ] [MainThread]: 
[0m14:17:20.736432 [info ] [MainThread]: Finished running 1 unit test in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m14:17:20.736779 [debug] [MainThread]: Command end result
[0m14:17:20.765414 [info ] [MainThread]: 
[0m14:17:20.765796 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:17:20.766069 [info ] [MainThread]: 
[0m14:17:20.766308 [error] [MainThread]: [31mFailure in unit_test stg_transactions_unit (models/staging/stg_transactions_unit.yml)[0m
[0m14:17:20.766808 [error] [MainThread]:   

[32mactual[0m differs from [31mexpected[0m:

[0;1m@@[0m[33m,[0m[0;1mtransaction_date[0m[33m,[0m[0;1mamount_bucket[0m[33m,[0m[0;1m...[0m[33m,[0m[0;1mus_state[0m[33m,[0m[0;1mday_name[0m
[31;1m[34;1m→[32;1m[0m [33m,[0m2020-01-01      [33m,[0msmall        [33m,[0m...[33m,[0mNY      [33m,[0m[31;1mWednesday[34;1m→[32;1mWed[0m
[31;1m[34;1m→[32;1m[0m [33m,[0m2020-01-02      [33m,[0mextra_large  [33m,[0m...[33m,[0mCA      [33m,[0m[31;1mThursday[34;1m→[32;1mThu[0m


[0m14:17:20.767077 [info ] [MainThread]: 
[0m14:17:20.767800 [info ] [MainThread]:   compiled code at target/compiled/hw4_dbt/models/staging/stg_transactions_unit.yml/models/staging/stg_transactions_unit.sql
[0m14:17:20.768012 [info ] [MainThread]: 
[0m14:17:20.768374 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:17:20.770629 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.89837986, "process_user_time": 1.392707, "process_kernel_time": 0.224437, "process_mem_max_rss": "160677888", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:17:20.771010 [debug] [MainThread]: Command `dbt test` failed at 14:17:20.770954 after 0.90 seconds
[0m14:17:20.771269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b4a5c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103035350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b47ac10>]}
[0m14:17:20.771514 [debug] [MainThread]: Flushing usage events
[0m14:17:41.678714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111216b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111280d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112813d0>]}


============================== 14:17:41.683337 | 07564f32-20c4-4d10-8639-1dde033a9be3 ==============================
[0m14:17:41.683337 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:17:41.683772 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '.', 'log_path': '/Users/roman/Desktop/hw4-mlops-bokhyan/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --select test_type:unit', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:17:41.867933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07564f32-20c4-4d10-8639-1dde033a9be3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111631d10>]}
[0m14:17:41.903257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07564f32-20c4-4d10-8639-1dde033a9be3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116e6c50>]}
[0m14:17:41.904771 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m14:17:41.974116 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m14:17:42.091229 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:17:42.091778 [debug] [MainThread]: Partial parsing: updated file: hw4_dbt://models/staging/stg_transactions_unit.yml
[0m14:17:42.180877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07564f32-20c4-4d10-8639-1dde033a9be3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c579d0>]}
[0m14:17:42.322730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07564f32-20c4-4d10-8639-1dde033a9be3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b31090>]}
[0m14:17:42.323160 [info ] [MainThread]: Found 2 seeds, 7 models, 56 data tests, 1 source, 805 macros, 1 unit test
[0m14:17:42.323366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07564f32-20c4-4d10-8639-1dde033a9be3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111880ad0>]}
[0m14:17:42.324456 [info ] [MainThread]: 
[0m14:17:42.324834 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:17:42.327858 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_transactions_main_staging'
[0m14:17:42.328205 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_transactions_main_marts'
[0m14:17:42.328470 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_transactions_main_transactions_db'
[0m14:17:42.364290 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_staging"
[0m14:17:42.364607 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_marts"
[0m14:17:42.364797 [debug] [ThreadPool]: On list_transactions_main_staging: BEGIN
[0m14:17:42.365025 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_transactions_db"
[0m14:17:42.365217 [debug] [ThreadPool]: On list_transactions_main_marts: BEGIN
[0m14:17:42.365441 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:17:42.365678 [debug] [ThreadPool]: On list_transactions_main_transactions_db: BEGIN
[0m14:17:42.365824 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:17:42.366068 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:17:42.382447 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m14:17:42.382687 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m14:17:42.382879 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m14:17:42.383157 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_staging"
[0m14:17:42.383342 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_marts"
[0m14:17:42.383499 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_transactions_db"
[0m14:17:42.383676 [debug] [ThreadPool]: On list_transactions_main_staging: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "connection_name": "list_transactions_main_staging"} */
select
      'transactions' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_staging'
    and table_catalog = 'transactions'
  
[0m14:17:42.383870 [debug] [ThreadPool]: On list_transactions_main_marts: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "connection_name": "list_transactions_main_marts"} */
select
      'transactions' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_marts'
    and table_catalog = 'transactions'
  
[0m14:17:42.384057 [debug] [ThreadPool]: On list_transactions_main_transactions_db: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "connection_name": "list_transactions_main_transactions_db"} */
select
      'transactions' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_transactions_db'
    and table_catalog = 'transactions'
  
[0m14:17:42.402076 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m14:17:42.402418 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m14:17:42.402682 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m14:17:42.403760 [debug] [ThreadPool]: On list_transactions_main_staging: ROLLBACK
[0m14:17:42.404409 [debug] [ThreadPool]: On list_transactions_main_transactions_db: ROLLBACK
[0m14:17:42.404933 [debug] [ThreadPool]: On list_transactions_main_marts: ROLLBACK
[0m14:17:42.405783 [debug] [ThreadPool]: Failed to rollback 'list_transactions_main_marts'
[0m14:17:42.406071 [debug] [ThreadPool]: Failed to rollback 'list_transactions_main_staging'
[0m14:17:42.406288 [debug] [ThreadPool]: Failed to rollback 'list_transactions_main_transactions_db'
[0m14:17:42.406524 [debug] [ThreadPool]: On list_transactions_main_marts: Close
[0m14:17:42.406802 [debug] [ThreadPool]: On list_transactions_main_staging: Close
[0m14:17:42.406996 [debug] [ThreadPool]: On list_transactions_main_transactions_db: Close
[0m14:17:42.410262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07564f32-20c4-4d10-8639-1dde033a9be3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b30710>]}
[0m14:17:42.410616 [debug] [MainThread]: Using duckdb connection "master"
[0m14:17:42.410784 [debug] [MainThread]: On master: BEGIN
[0m14:17:42.410923 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:17:42.419113 [debug] [MainThread]: SQL status: OK in 0.008 seconds
[0m14:17:42.419404 [debug] [MainThread]: On master: COMMIT
[0m14:17:42.419554 [debug] [MainThread]: Using duckdb connection "master"
[0m14:17:42.419691 [debug] [MainThread]: On master: COMMIT
[0m14:17:42.419940 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:17:42.420095 [debug] [MainThread]: On master: Close
[0m14:17:42.421422 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:17:42.421816 [info ] [MainThread]: 
[0m14:17:42.423879 [debug] [Thread-1 (]: Began running node unit_test.hw4_dbt.stg_transactions.stg_transactions_unit
[0m14:17:42.424200 [info ] [Thread-1 (]: 1 of 1 START unit_test stg_transactions::stg_transactions_unit ................. [RUN]
[0m14:17:42.424788 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_transactions_main_staging, now unit_test.hw4_dbt.stg_transactions.stg_transactions_unit)
[0m14:17:42.425011 [debug] [Thread-1 (]: Began compiling node unit_test.hw4_dbt.stg_transactions.stg_transactions_unit
[0m14:17:42.425195 [debug] [Thread-1 (]: Began executing node unit_test.hw4_dbt.stg_transactions.stg_transactions_unit
[0m14:17:42.470031 [debug] [Thread-1 (]: Using duckdb connection "unit_test.hw4_dbt.stg_transactions.stg_transactions_unit"
[0m14:17:42.470374 [debug] [Thread-1 (]: On unit_test.hw4_dbt.stg_transactions.stg_transactions_unit: BEGIN
[0m14:17:42.470549 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:42.480161 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m14:17:42.480603 [debug] [Thread-1 (]: Using duckdb connection "unit_test.hw4_dbt.stg_transactions.stg_transactions_unit"
[0m14:17:42.480893 [debug] [Thread-1 (]: On unit_test.hw4_dbt.stg_transactions.stg_transactions_unit: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "unit_test.hw4_dbt.stg_transactions.stg_transactions_unit"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'transactions'
      
      and table_schema = 'main_transactions_db'
      
      
      and table_catalog = 'transactions'
      
      order by ordinal_position

  
[0m14:17:42.495112 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m14:17:42.509785 [debug] [Thread-1 (]: Writing injected SQL for node "unit_test.hw4_dbt.stg_transactions.stg_transactions_unit"
[0m14:17:42.517864 [debug] [Thread-1 (]: Using duckdb connection "unit_test.hw4_dbt.stg_transactions.stg_transactions_unit"
[0m14:17:42.518283 [debug] [Thread-1 (]: On unit_test.hw4_dbt.stg_transactions.stg_transactions_unit: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "unit_test.hw4_dbt.stg_transactions.stg_transactions_unit"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'states'
      
      and table_schema = 'main_transactions_db'
      
      
      and table_catalog = 'transactions'
      
      order by ordinal_position

  
[0m14:17:42.520491 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:17:42.521957 [debug] [Thread-1 (]: Writing injected SQL for node "unit_test.hw4_dbt.stg_transactions.stg_transactions_unit"
[0m14:17:42.547274 [debug] [Thread-1 (]: Writing injected SQL for node "unit_test.hw4_dbt.stg_transactions.stg_transactions_unit"
[0m14:17:42.566235 [debug] [Thread-1 (]: Using duckdb connection "unit_test.hw4_dbt.stg_transactions.stg_transactions_unit"
[0m14:17:42.567647 [debug] [Thread-1 (]: On unit_test.hw4_dbt.stg_transactions.stg_transactions_unit: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "unit_test.hw4_dbt.stg_transactions.stg_transactions_unit"} */

    
  
    
    

    create temporary table
      stg_transactions_unit__dbt_tmp20251202141742556639
  
    as (
      select * from (
        with  __dbt__cte__transactions as (

-- Fixture for transactions
select 
    
    cast('2020-01-01 10:00:00' as character varying(256))
 as transaction_time, 
    
    cast('Test Shop' as character varying(256))
 as merch, 
    
    cast('games' as character varying(256))
 as cat_id, 
    
    cast(25 as DOUBLE)
 as amount, 
    
    cast('Alex' as character varying(256))
 as name_1, 
    
    cast('Smith' as character varying(256))
 as name_2, 
    
    cast('M' as character varying(256))
 as gender, 
    
    cast('1 Main' as character varying(256))
 as street, 
    
    cast('New York' as character varying(256))
 as one_city, 
    
    cast('NY' as character varying(256))
 as us_state, 
    
    cast('10001' as INTEGER)
 as post_code, 
    
    cast(40.0 as DOUBLE)
 as lat, 
    
    cast(-73.0 as DOUBLE)
 as lon, 
    
    cast(1000 as INTEGER)
 as population_city, 
    
    cast('Analyst' as character varying(256))
 as jobs, 
    
    cast(40.5 as DOUBLE)
 as merchant_lat, 
    
    cast(-73.5 as DOUBLE)
 as merchant_lon, 
    
    cast(0 as INTEGER)
 as target
union all
select 
    
    cast('2020-01-02 12:00:00' as character varying(256))
 as transaction_time, 
    
    cast('Test Shop' as character varying(256))
 as merch, 
    
    cast('travel' as character varying(256))
 as cat_id, 
    
    cast(600 as DOUBLE)
 as amount, 
    
    cast('Jamie' as character varying(256))
 as name_1, 
    
    cast('Doe' as character varying(256))
 as name_2, 
    
    cast('F' as character varying(256))
 as gender, 
    
    cast('2 Main' as character varying(256))
 as street, 
    
    cast('Los Angeles' as character varying(256))
 as one_city, 
    
    cast('CA' as character varying(256))
 as us_state, 
    
    cast('90001' as INTEGER)
 as post_code, 
    
    cast(34.0 as DOUBLE)
 as lat, 
    
    cast(-118.0 as DOUBLE)
 as lon, 
    
    cast(2000 as INTEGER)
 as population_city, 
    
    cast('Engineer' as character varying(256))
 as jobs, 
    
    cast(34.5 as DOUBLE)
 as merchant_lat, 
    
    cast(-118.3 as DOUBLE)
 as merchant_lon, 
    
    cast(1 as INTEGER)
 as target
),  __dbt__cte__states as (

-- Fixture for states
select 
    
    cast('NY' as character varying(256))
 as state_code, 
    
    cast('New York' as character varying(256))
 as state_name
union all
select 
    
    cast('CA' as character varying(256))
 as state_code, 
    
    cast('California' as character varying(256))
 as state_name
), source as (
    select * from __dbt__cte__transactions
),
renamed as (
    select
        md5(cast(coalesce(cast(transaction_time as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(merch as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(amount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(cat_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(post_code as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as transaction_id,
        cast(transaction_time as timestamp) as transaction_ts,
        cast(date(transaction_time) as date) as transaction_date,
        date_trunc('hour', cast(transaction_time as timestamp)) as transaction_hour,
        substr(dayname(cast(transaction_time as timestamp)), 1, 3) as day_name,
        merch as merchant_name,
        md5(cast(coalesce(cast(merch as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as merchant_id,
        cat_id,
        cast(amount as double) as amount,
        
    case
        when cast(amount as double) is null then 'unknown'
        when cast(amount as double) < 50 then 'small'
        when cast(amount as double) < 200 then 'medium'
        when cast(amount as double) < 500 then 'large'
        else 'extra_large'
    end
 as amount_bucket,
        case
            when upper(gender) in ('M', 'MALE') then 'M'
            when upper(gender) in ('F', 'FEMALE') then 'F'
            else 'U'
        end as gender,
        md5(cast(coalesce(cast(name_1 as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(name_2 as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(street as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(post_code as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
        concat_ws(' ', nullif(name_1, ''), nullif(name_2, '')) as customer_full_name,
        street,
        one_city as city,
        upper(us_state) as us_state,
        post_code,
        cast(lat as double) as customer_lat,
        cast(lon as double) as customer_lon,
        cast(merchant_lat as double) as merchant_lat,
        cast(merchant_lon as double) as merchant_lon,
        nullif(jobs, '') as job_title,
        cast(population_city as bigint) as population_city,
        cast(target as integer) as is_fraud,
        case when 
    case
        when cast(amount as double) is null then 'unknown'
        when cast(amount as double) < 50 then 'small'
        when cast(amount as double) < 200 then 'medium'
        when cast(amount as double) < 500 then 'large'
        else 'extra_large'
    end
 in ('large', 'extra_large') then 1 else 0 end as is_large_amount
    from source
),
with_states as (
    select
        r.*,
        s.state_name
    from renamed r
    left join __dbt__cte__states s
        on r.us_state = s.state_code
)
select * from with_states
    ) as __dbt_sbq
    where false
    limit 0

    );
  
  
  
[0m14:17:42.573221 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m14:17:42.575172 [debug] [Thread-1 (]: Using duckdb connection "unit_test.hw4_dbt.stg_transactions.stg_transactions_unit"
[0m14:17:42.575439 [debug] [Thread-1 (]: On unit_test.hw4_dbt.stg_transactions.stg_transactions_unit: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "unit_test.hw4_dbt.stg_transactions.stg_transactions_unit"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'stg_transactions_unit__dbt_tmp20251202141742556639'
      
      
      order by ordinal_position

  
[0m14:17:42.577378 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:17:42.584041 [debug] [Thread-1 (]: Writing runtime sql for node "unit_test.hw4_dbt.stg_transactions.stg_transactions_unit"
[0m14:17:42.584743 [debug] [Thread-1 (]: Using duckdb connection "unit_test.hw4_dbt.stg_transactions.stg_transactions_unit"
[0m14:17:42.585291 [debug] [Thread-1 (]: On unit_test.hw4_dbt.stg_transactions.stg_transactions_unit: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "unit_test.hw4_dbt.stg_transactions.stg_transactions_unit"} */
-- Build actual result given inputs
with dbt_internal_unit_test_actual as (
  select
    transaction_date,amount_bucket,is_fraud,gender,us_state,day_name, 'actual' as "actual_or_expected"
  from (
    with  __dbt__cte__transactions as (

-- Fixture for transactions
select 
    
    cast('2020-01-01 10:00:00' as character varying(256))
 as transaction_time, 
    
    cast('Test Shop' as character varying(256))
 as merch, 
    
    cast('games' as character varying(256))
 as cat_id, 
    
    cast(25 as DOUBLE)
 as amount, 
    
    cast('Alex' as character varying(256))
 as name_1, 
    
    cast('Smith' as character varying(256))
 as name_2, 
    
    cast('M' as character varying(256))
 as gender, 
    
    cast('1 Main' as character varying(256))
 as street, 
    
    cast('New York' as character varying(256))
 as one_city, 
    
    cast('NY' as character varying(256))
 as us_state, 
    
    cast('10001' as INTEGER)
 as post_code, 
    
    cast(40.0 as DOUBLE)
 as lat, 
    
    cast(-73.0 as DOUBLE)
 as lon, 
    
    cast(1000 as INTEGER)
 as population_city, 
    
    cast('Analyst' as character varying(256))
 as jobs, 
    
    cast(40.5 as DOUBLE)
 as merchant_lat, 
    
    cast(-73.5 as DOUBLE)
 as merchant_lon, 
    
    cast(0 as INTEGER)
 as target
union all
select 
    
    cast('2020-01-02 12:00:00' as character varying(256))
 as transaction_time, 
    
    cast('Test Shop' as character varying(256))
 as merch, 
    
    cast('travel' as character varying(256))
 as cat_id, 
    
    cast(600 as DOUBLE)
 as amount, 
    
    cast('Jamie' as character varying(256))
 as name_1, 
    
    cast('Doe' as character varying(256))
 as name_2, 
    
    cast('F' as character varying(256))
 as gender, 
    
    cast('2 Main' as character varying(256))
 as street, 
    
    cast('Los Angeles' as character varying(256))
 as one_city, 
    
    cast('CA' as character varying(256))
 as us_state, 
    
    cast('90001' as INTEGER)
 as post_code, 
    
    cast(34.0 as DOUBLE)
 as lat, 
    
    cast(-118.0 as DOUBLE)
 as lon, 
    
    cast(2000 as INTEGER)
 as population_city, 
    
    cast('Engineer' as character varying(256))
 as jobs, 
    
    cast(34.5 as DOUBLE)
 as merchant_lat, 
    
    cast(-118.3 as DOUBLE)
 as merchant_lon, 
    
    cast(1 as INTEGER)
 as target
),  __dbt__cte__states as (

-- Fixture for states
select 
    
    cast('NY' as character varying(256))
 as state_code, 
    
    cast('New York' as character varying(256))
 as state_name
union all
select 
    
    cast('CA' as character varying(256))
 as state_code, 
    
    cast('California' as character varying(256))
 as state_name
), source as (
    select * from __dbt__cte__transactions
),
renamed as (
    select
        md5(cast(coalesce(cast(transaction_time as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(merch as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(amount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(cat_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(post_code as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as transaction_id,
        cast(transaction_time as timestamp) as transaction_ts,
        cast(date(transaction_time) as date) as transaction_date,
        date_trunc('hour', cast(transaction_time as timestamp)) as transaction_hour,
        substr(dayname(cast(transaction_time as timestamp)), 1, 3) as day_name,
        merch as merchant_name,
        md5(cast(coalesce(cast(merch as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as merchant_id,
        cat_id,
        cast(amount as double) as amount,
        
    case
        when cast(amount as double) is null then 'unknown'
        when cast(amount as double) < 50 then 'small'
        when cast(amount as double) < 200 then 'medium'
        when cast(amount as double) < 500 then 'large'
        else 'extra_large'
    end
 as amount_bucket,
        case
            when upper(gender) in ('M', 'MALE') then 'M'
            when upper(gender) in ('F', 'FEMALE') then 'F'
            else 'U'
        end as gender,
        md5(cast(coalesce(cast(name_1 as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(name_2 as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(street as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(post_code as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
        concat_ws(' ', nullif(name_1, ''), nullif(name_2, '')) as customer_full_name,
        street,
        one_city as city,
        upper(us_state) as us_state,
        post_code,
        cast(lat as double) as customer_lat,
        cast(lon as double) as customer_lon,
        cast(merchant_lat as double) as merchant_lat,
        cast(merchant_lon as double) as merchant_lon,
        nullif(jobs, '') as job_title,
        cast(population_city as bigint) as population_city,
        cast(target as integer) as is_fraud,
        case when 
    case
        when cast(amount as double) is null then 'unknown'
        when cast(amount as double) < 50 then 'small'
        when cast(amount as double) < 200 then 'medium'
        when cast(amount as double) < 500 then 'large'
        else 'extra_large'
    end
 in ('large', 'extra_large') then 1 else 0 end as is_large_amount
    from source
),
with_states as (
    select
        r.*,
        s.state_name
    from renamed r
    left join __dbt__cte__states s
        on r.us_state = s.state_code
)
select * from with_states
  ) _dbt_internal_unit_test_actual
),
-- Build expected result
dbt_internal_unit_test_expected as (
  select
    transaction_date, amount_bucket, is_fraud, gender, us_state, day_name, 'expected' as "actual_or_expected"
  from (
    select 
    
    cast('2020-01-01' as DATE)
 as transaction_date, 
    
    cast('small' as character varying(256))
 as amount_bucket, 
    
    cast(0 as INTEGER)
 as is_fraud, 
    
    cast('M' as character varying(256))
 as gender, 
    
    cast('NY' as character varying(256))
 as us_state, 
    
    cast('Wed' as character varying(256))
 as day_name
union all
select 
    
    cast('2020-01-02' as DATE)
 as transaction_date, 
    
    cast('extra_large' as character varying(256))
 as amount_bucket, 
    
    cast(1 as INTEGER)
 as is_fraud, 
    
    cast('F' as character varying(256))
 as gender, 
    
    cast('CA' as character varying(256))
 as us_state, 
    
    cast('Thu' as character varying(256))
 as day_name
  ) _dbt_internal_unit_test_expected
)
-- Union actual and expected results
select * from dbt_internal_unit_test_actual
union all
select * from dbt_internal_unit_test_expected
[0m14:17:42.593132 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m14:17:42.598818 [debug] [Thread-1 (]: Using duckdb connection "unit_test.hw4_dbt.stg_transactions.stg_transactions_unit"
[0m14:17:42.599545 [debug] [Thread-1 (]: On unit_test.hw4_dbt.stg_transactions.stg_transactions_unit: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "node_id": "unit_test.hw4_dbt.stg_transactions.stg_transactions_unit"} */
drop table if exists stg_transactions_unit__dbt_tmp20251202141742556639 cascade
[0m14:17:42.600288 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:17:42.604354 [debug] [Thread-1 (]: On unit_test.hw4_dbt.stg_transactions.stg_transactions_unit: ROLLBACK
[0m14:17:42.604733 [debug] [Thread-1 (]: Failed to rollback 'unit_test.hw4_dbt.stg_transactions.stg_transactions_unit'
[0m14:17:42.604905 [debug] [Thread-1 (]: On unit_test.hw4_dbt.stg_transactions.stg_transactions_unit: Close
[0m14:17:42.607049 [info ] [Thread-1 (]: 1 of 1 PASS stg_transactions::stg_transactions_unit ............................ [[32mPASS[0m in 0.18s]
[0m14:17:42.607534 [debug] [Thread-1 (]: Finished running node unit_test.hw4_dbt.stg_transactions.stg_transactions_unit
[0m14:17:42.608351 [debug] [MainThread]: Using duckdb connection "master"
[0m14:17:42.608610 [debug] [MainThread]: On master: BEGIN
[0m14:17:42.608769 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:17:42.617868 [debug] [MainThread]: SQL status: OK in 0.009 seconds
[0m14:17:42.618168 [debug] [MainThread]: On master: COMMIT
[0m14:17:42.618421 [debug] [MainThread]: Using duckdb connection "master"
[0m14:17:42.618715 [debug] [MainThread]: On master: COMMIT
[0m14:17:42.619366 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:17:42.619583 [debug] [MainThread]: On master: Close
[0m14:17:42.620969 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:17:42.621241 [debug] [MainThread]: Connection 'unit_test.hw4_dbt.stg_transactions.stg_transactions_unit' was properly closed.
[0m14:17:42.621395 [debug] [MainThread]: Connection 'list_transactions_main_marts' was properly closed.
[0m14:17:42.621541 [debug] [MainThread]: Connection 'list_transactions_main_transactions_db' was properly closed.
[0m14:17:42.621713 [info ] [MainThread]: 
[0m14:17:42.621935 [info ] [MainThread]: Finished running 1 unit test in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m14:17:42.622664 [debug] [MainThread]: Command end result
[0m14:17:42.657025 [info ] [MainThread]: 
[0m14:17:42.657527 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:17:42.657774 [info ] [MainThread]: 
[0m14:17:42.658056 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:17:42.660411 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.0227362, "process_user_time": 1.443122, "process_kernel_time": 0.274551, "process_mem_max_rss": "162217984", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:17:42.660848 [debug] [MainThread]: Command `dbt test` succeeded at 14:17:42.660797 after 1.02 seconds
[0m14:17:42.661082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10309d350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111281290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065a3b50>]}
[0m14:17:42.661313 [debug] [MainThread]: Flushing usage events
[0m14:17:59.063053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11801f810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118080fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118081650>]}


============================== 14:17:59.067021 | 8f18ef21-fd6c-46e7-9e0a-96d5709dcf64 ==============================
[0m14:17:59.067021 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:17:59.067398 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/roman/Desktop/hw4-mlops-bokhyan/dbt/logs', 'version_check': 'True', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:17:59.205946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f18ef21-fd6c-46e7-9e0a-96d5709dcf64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11806d210>]}
[0m14:17:59.239938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8f18ef21-fd6c-46e7-9e0a-96d5709dcf64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cb1390>]}
[0m14:17:59.240601 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m14:17:59.303408 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m14:17:59.402693 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:17:59.403083 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:17:59.433542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f18ef21-fd6c-46e7-9e0a-96d5709dcf64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118b05a90>]}
[0m14:17:59.449275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f18ef21-fd6c-46e7-9e0a-96d5709dcf64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118964310>]}
[0m14:17:59.449626 [info ] [MainThread]: Found 2 seeds, 7 models, 56 data tests, 1 source, 805 macros, 1 unit test
[0m14:17:59.449805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f18ef21-fd6c-46e7-9e0a-96d5709dcf64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064c6410>]}
[0m14:17:59.452071 [info ] [MainThread]: 
[0m14:17:59.452677 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:17:59.455561 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_transactions_main_transactions_db'
[0m14:17:59.455860 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_transactions_main_staging'
[0m14:17:59.456319 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_transactions_main_marts'
[0m14:17:59.488760 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_transactions_db"
[0m14:17:59.489043 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_staging"
[0m14:17:59.489326 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_marts"
[0m14:17:59.489553 [debug] [ThreadPool]: On list_transactions_main_transactions_db: BEGIN
[0m14:17:59.489779 [debug] [ThreadPool]: On list_transactions_main_staging: BEGIN
[0m14:17:59.490037 [debug] [ThreadPool]: On list_transactions_main_marts: BEGIN
[0m14:17:59.490249 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:17:59.490411 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:17:59.490615 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:17:59.499995 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m14:17:59.500289 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m14:17:59.500421 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m14:17:59.500548 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_transactions_db"
[0m14:17:59.500714 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_marts"
[0m14:17:59.500844 [debug] [ThreadPool]: Using duckdb connection "list_transactions_main_staging"
[0m14:17:59.501003 [debug] [ThreadPool]: On list_transactions_main_transactions_db: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "connection_name": "list_transactions_main_transactions_db"} */
select
      'transactions' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_transactions_db'
    and table_catalog = 'transactions'
  
[0m14:17:59.501176 [debug] [ThreadPool]: On list_transactions_main_marts: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "connection_name": "list_transactions_main_marts"} */
select
      'transactions' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_marts'
    and table_catalog = 'transactions'
  
[0m14:17:59.501332 [debug] [ThreadPool]: On list_transactions_main_staging: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "connection_name": "list_transactions_main_staging"} */
select
      'transactions' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_staging'
    and table_catalog = 'transactions'
  
[0m14:17:59.511115 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m14:17:59.511413 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m14:17:59.511823 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m14:17:59.512660 [debug] [ThreadPool]: On list_transactions_main_marts: ROLLBACK
[0m14:17:59.513468 [debug] [ThreadPool]: On list_transactions_main_transactions_db: ROLLBACK
[0m14:17:59.513944 [debug] [ThreadPool]: On list_transactions_main_staging: ROLLBACK
[0m14:17:59.514674 [debug] [ThreadPool]: Failed to rollback 'list_transactions_main_marts'
[0m14:17:59.514919 [debug] [ThreadPool]: Failed to rollback 'list_transactions_main_transactions_db'
[0m14:17:59.515279 [debug] [ThreadPool]: Failed to rollback 'list_transactions_main_staging'
[0m14:17:59.515467 [debug] [ThreadPool]: On list_transactions_main_marts: Close
[0m14:17:59.515643 [debug] [ThreadPool]: On list_transactions_main_transactions_db: Close
[0m14:17:59.515806 [debug] [ThreadPool]: On list_transactions_main_staging: Close
[0m14:17:59.518592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f18ef21-fd6c-46e7-9e0a-96d5709dcf64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118ba4250>]}
[0m14:17:59.519065 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:17:59.519308 [info ] [MainThread]: 
[0m14:17:59.521312 [debug] [Thread-1 (]: Began running node seed.hw4_dbt.states
[0m14:17:59.521841 [debug] [Thread-2 (]: Began running node seed.hw4_dbt.transactions
[0m14:17:59.522150 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_transactions_main_transactions_db, now seed.hw4_dbt.states)
[0m14:17:59.522393 [debug] [Thread-3 (]: Began running node test.hw4_dbt.source_accepted_values_transactions_db_transactions_target__0__1.ff30b0d50d
[0m14:17:59.522638 [debug] [Thread-4 (]: Began running node test.hw4_dbt.source_accepted_values_transactions_db_transactions_us_state__AL__AK__AZ__AR__CA__CO__CT__DC__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY.4941e4798c
[0m14:17:59.522881 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_transactions_main_staging, now seed.hw4_dbt.transactions)
[0m14:17:59.523422 [debug] [Thread-1 (]: Began compiling node seed.hw4_dbt.states
[0m14:17:59.524067 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_transactions_main_marts, now test.hw4_dbt.source_accepted_values_transactions_db_transactions_target__0__1.ff30b0d50d)
[0m14:17:59.524492 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.hw4_dbt.source_accepted_values_transactions_db_transactions_us_state__AL__AK__AZ__AR__CA__CO__CT__DC__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY.4941e4798c'
[0m14:17:59.524796 [debug] [Thread-2 (]: Began compiling node seed.hw4_dbt.transactions
[0m14:17:59.529194 [debug] [Thread-1 (]: Began executing node seed.hw4_dbt.states
[0m14:17:59.529483 [debug] [Thread-3 (]: Began compiling node test.hw4_dbt.source_accepted_values_transactions_db_transactions_target__0__1.ff30b0d50d
[0m14:17:59.529703 [debug] [Thread-4 (]: Began compiling node test.hw4_dbt.source_accepted_values_transactions_db_transactions_us_state__AL__AK__AZ__AR__CA__CO__CT__DC__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY.4941e4798c
[0m14:17:59.601416 [debug] [Thread-2 (]: Began executing node seed.hw4_dbt.transactions
[0m14:17:59.601935 [debug] [Thread-1 (]: Finished running node seed.hw4_dbt.states
[0m14:17:59.607487 [debug] [Thread-3 (]: Writing injected SQL for node "test.hw4_dbt.source_accepted_values_transactions_db_transactions_target__0__1.ff30b0d50d"
[0m14:17:59.621834 [debug] [Thread-4 (]: Writing injected SQL for node "test.hw4_dbt.source_accepted_values_transactions_db_transactions_us_state__AL__AK__AZ__AR__CA__CO__CT__DC__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY.4941e4798c"
[0m14:17:59.622336 [debug] [Thread-2 (]: Finished running node seed.hw4_dbt.transactions
[0m14:17:59.622573 [debug] [Thread-1 (]: Began running node test.hw4_dbt.source_not_null_transactions_db_transactions_amount.307a04757b
[0m14:17:59.623173 [debug] [Thread-2 (]: Began running node test.hw4_dbt.source_not_null_transactions_db_transactions_cat_id.24c084b034
[0m14:17:59.623598 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.hw4_dbt.states, now test.hw4_dbt.source_not_null_transactions_db_transactions_amount.307a04757b)
[0m14:17:59.624003 [debug] [Thread-3 (]: Began executing node test.hw4_dbt.source_accepted_values_transactions_db_transactions_target__0__1.ff30b0d50d
[0m14:17:59.624360 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.hw4_dbt.transactions, now test.hw4_dbt.source_not_null_transactions_db_transactions_cat_id.24c084b034)
[0m14:17:59.624581 [debug] [Thread-4 (]: Began executing node test.hw4_dbt.source_accepted_values_transactions_db_transactions_us_state__AL__AK__AZ__AR__CA__CO__CT__DC__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY.4941e4798c
[0m14:17:59.624801 [debug] [Thread-1 (]: Began compiling node test.hw4_dbt.source_not_null_transactions_db_transactions_amount.307a04757b
[0m14:17:59.625213 [debug] [Thread-3 (]: Finished running node test.hw4_dbt.source_accepted_values_transactions_db_transactions_target__0__1.ff30b0d50d
[0m14:17:59.625455 [debug] [Thread-2 (]: Began compiling node test.hw4_dbt.source_not_null_transactions_db_transactions_cat_id.24c084b034
[0m14:17:59.625855 [debug] [Thread-4 (]: Finished running node test.hw4_dbt.source_accepted_values_transactions_db_transactions_us_state__AL__AK__AZ__AR__CA__CO__CT__DC__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY.4941e4798c
[0m14:17:59.630519 [debug] [Thread-1 (]: Writing injected SQL for node "test.hw4_dbt.source_not_null_transactions_db_transactions_amount.307a04757b"
[0m14:17:59.630954 [debug] [Thread-3 (]: Began running node test.hw4_dbt.source_not_null_transactions_db_transactions_merch.b9d9c15594
[0m14:17:59.633284 [debug] [Thread-2 (]: Writing injected SQL for node "test.hw4_dbt.source_not_null_transactions_db_transactions_cat_id.24c084b034"
[0m14:17:59.633640 [debug] [Thread-4 (]: Began running node test.hw4_dbt.source_not_null_transactions_db_transactions_target.ee81663a6c
[0m14:17:59.634152 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.source_accepted_values_transactions_db_transactions_target__0__1.ff30b0d50d, now test.hw4_dbt.source_not_null_transactions_db_transactions_merch.b9d9c15594)
[0m14:17:59.634526 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.source_accepted_values_transactions_db_transactions_us_state__AL__AK__AZ__AR__CA__CO__CT__DC__DE__FL__GA__HI__ID__IL__IN__IA__KS__KY__LA__ME__MD__MA__MI__MN__MS__MO__MT__NE__NV__NH__NJ__NM__NY__NC__ND__OH__OK__OR__PA__RI__SC__SD__TN__TX__UT__VT__VA__WA__WV__WI__WY.4941e4798c, now test.hw4_dbt.source_not_null_transactions_db_transactions_target.ee81663a6c)
[0m14:17:59.634756 [debug] [Thread-1 (]: Began executing node test.hw4_dbt.source_not_null_transactions_db_transactions_amount.307a04757b
[0m14:17:59.634978 [debug] [Thread-3 (]: Began compiling node test.hw4_dbt.source_not_null_transactions_db_transactions_merch.b9d9c15594
[0m14:17:59.635199 [debug] [Thread-4 (]: Began compiling node test.hw4_dbt.source_not_null_transactions_db_transactions_target.ee81663a6c
[0m14:17:59.635365 [debug] [Thread-2 (]: Began executing node test.hw4_dbt.source_not_null_transactions_db_transactions_cat_id.24c084b034
[0m14:17:59.635692 [debug] [Thread-1 (]: Finished running node test.hw4_dbt.source_not_null_transactions_db_transactions_amount.307a04757b
[0m14:17:59.638109 [debug] [Thread-3 (]: Writing injected SQL for node "test.hw4_dbt.source_not_null_transactions_db_transactions_merch.b9d9c15594"
[0m14:17:59.641595 [debug] [Thread-4 (]: Writing injected SQL for node "test.hw4_dbt.source_not_null_transactions_db_transactions_target.ee81663a6c"
[0m14:17:59.642142 [debug] [Thread-2 (]: Finished running node test.hw4_dbt.source_not_null_transactions_db_transactions_cat_id.24c084b034
[0m14:17:59.642441 [debug] [Thread-1 (]: Began running node test.hw4_dbt.source_not_null_transactions_db_transactions_transaction_time.b0308d1b6c
[0m14:17:59.642828 [debug] [Thread-2 (]: Began running node test.hw4_dbt.source_not_null_transactions_db_transactions_us_state.4999dadbbc
[0m14:17:59.643106 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.source_not_null_transactions_db_transactions_amount.307a04757b, now test.hw4_dbt.source_not_null_transactions_db_transactions_transaction_time.b0308d1b6c)
[0m14:17:59.643363 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.source_not_null_transactions_db_transactions_cat_id.24c084b034, now test.hw4_dbt.source_not_null_transactions_db_transactions_us_state.4999dadbbc)
[0m14:17:59.643538 [debug] [Thread-4 (]: Began executing node test.hw4_dbt.source_not_null_transactions_db_transactions_target.ee81663a6c
[0m14:17:59.643700 [debug] [Thread-3 (]: Began executing node test.hw4_dbt.source_not_null_transactions_db_transactions_merch.b9d9c15594
[0m14:17:59.643904 [debug] [Thread-1 (]: Began compiling node test.hw4_dbt.source_not_null_transactions_db_transactions_transaction_time.b0308d1b6c
[0m14:17:59.644197 [debug] [Thread-2 (]: Began compiling node test.hw4_dbt.source_not_null_transactions_db_transactions_us_state.4999dadbbc
[0m14:17:59.644637 [debug] [Thread-4 (]: Finished running node test.hw4_dbt.source_not_null_transactions_db_transactions_target.ee81663a6c
[0m14:17:59.645033 [debug] [Thread-3 (]: Finished running node test.hw4_dbt.source_not_null_transactions_db_transactions_merch.b9d9c15594
[0m14:17:59.647225 [debug] [Thread-1 (]: Writing injected SQL for node "test.hw4_dbt.source_not_null_transactions_db_transactions_transaction_time.b0308d1b6c"
[0m14:17:59.649713 [debug] [Thread-2 (]: Writing injected SQL for node "test.hw4_dbt.source_not_null_transactions_db_transactions_us_state.4999dadbbc"
[0m14:17:59.650091 [debug] [Thread-4 (]: Began running node model.hw4_dbt.stg_transactions
[0m14:17:59.650396 [debug] [Thread-3 (]: Began running node test.hw4_dbt.not_null_states_state_code.4c83882290
[0m14:17:59.650785 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.source_not_null_transactions_db_transactions_target.ee81663a6c, now model.hw4_dbt.stg_transactions)
[0m14:17:59.651032 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.source_not_null_transactions_db_transactions_merch.b9d9c15594, now test.hw4_dbt.not_null_states_state_code.4c83882290)
[0m14:17:59.651307 [debug] [Thread-1 (]: Began executing node test.hw4_dbt.source_not_null_transactions_db_transactions_transaction_time.b0308d1b6c
[0m14:17:59.651493 [debug] [Thread-2 (]: Began executing node test.hw4_dbt.source_not_null_transactions_db_transactions_us_state.4999dadbbc
[0m14:17:59.651663 [debug] [Thread-4 (]: Began compiling node model.hw4_dbt.stg_transactions
[0m14:17:59.651841 [debug] [Thread-3 (]: Began compiling node test.hw4_dbt.not_null_states_state_code.4c83882290
[0m14:17:59.652174 [debug] [Thread-1 (]: Finished running node test.hw4_dbt.source_not_null_transactions_db_transactions_transaction_time.b0308d1b6c
[0m14:17:59.652598 [debug] [Thread-2 (]: Finished running node test.hw4_dbt.source_not_null_transactions_db_transactions_us_state.4999dadbbc
[0m14:17:59.662448 [debug] [Thread-4 (]: Writing injected SQL for node "model.hw4_dbt.stg_transactions"
[0m14:17:59.664567 [debug] [Thread-3 (]: Writing injected SQL for node "test.hw4_dbt.not_null_states_state_code.4c83882290"
[0m14:17:59.664834 [debug] [Thread-1 (]: Began running node test.hw4_dbt.not_null_states_state_name.f652068228
[0m14:17:59.665115 [debug] [Thread-2 (]: Began running node test.hw4_dbt.unique_states_state_code.67c4706beb
[0m14:17:59.665785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.source_not_null_transactions_db_transactions_transaction_time.b0308d1b6c, now test.hw4_dbt.not_null_states_state_name.f652068228)
[0m14:17:59.666272 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.source_not_null_transactions_db_transactions_us_state.4999dadbbc, now test.hw4_dbt.unique_states_state_code.67c4706beb)
[0m14:17:59.666528 [debug] [Thread-3 (]: Began executing node test.hw4_dbt.not_null_states_state_code.4c83882290
[0m14:17:59.666696 [debug] [Thread-4 (]: Began executing node model.hw4_dbt.stg_transactions
[0m14:17:59.666882 [debug] [Thread-1 (]: Began compiling node test.hw4_dbt.not_null_states_state_name.f652068228
[0m14:17:59.667085 [debug] [Thread-2 (]: Began compiling node test.hw4_dbt.unique_states_state_code.67c4706beb
[0m14:17:59.667449 [debug] [Thread-3 (]: Finished running node test.hw4_dbt.not_null_states_state_code.4c83882290
[0m14:17:59.667769 [debug] [Thread-4 (]: Finished running node model.hw4_dbt.stg_transactions
[0m14:17:59.670144 [debug] [Thread-1 (]: Writing injected SQL for node "test.hw4_dbt.not_null_states_state_name.f652068228"
[0m14:17:59.674551 [debug] [Thread-2 (]: Writing injected SQL for node "test.hw4_dbt.unique_states_state_code.67c4706beb"
[0m14:17:59.675350 [debug] [Thread-3 (]: Began running node model.hw4_dbt.mart_customer_risk_profile
[0m14:17:59.675605 [debug] [Thread-4 (]: Began running node model.hw4_dbt.mart_daily_state_metrics
[0m14:17:59.675992 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_states_state_code.4c83882290, now model.hw4_dbt.mart_customer_risk_profile)
[0m14:17:59.676308 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.hw4_dbt.stg_transactions, now model.hw4_dbt.mart_daily_state_metrics)
[0m14:17:59.676558 [debug] [Thread-3 (]: Began compiling node model.hw4_dbt.mart_customer_risk_profile
[0m14:17:59.676746 [debug] [Thread-2 (]: Began executing node test.hw4_dbt.unique_states_state_code.67c4706beb
[0m14:17:59.676920 [debug] [Thread-1 (]: Began executing node test.hw4_dbt.not_null_states_state_name.f652068228
[0m14:17:59.677140 [debug] [Thread-4 (]: Began compiling node model.hw4_dbt.mart_daily_state_metrics
[0m14:17:59.678973 [debug] [Thread-3 (]: Writing injected SQL for node "model.hw4_dbt.mart_customer_risk_profile"
[0m14:17:59.679422 [debug] [Thread-2 (]: Finished running node test.hw4_dbt.unique_states_state_code.67c4706beb
[0m14:17:59.679709 [debug] [Thread-1 (]: Finished running node test.hw4_dbt.not_null_states_state_name.f652068228
[0m14:17:59.681669 [debug] [Thread-4 (]: Writing injected SQL for node "model.hw4_dbt.mart_daily_state_metrics"
[0m14:17:59.682077 [debug] [Thread-2 (]: Began running node model.hw4_dbt.mart_fraud_by_category
[0m14:17:59.682450 [debug] [Thread-1 (]: Began running node model.hw4_dbt.mart_fraud_by_state
[0m14:17:59.682745 [debug] [Thread-3 (]: Began executing node model.hw4_dbt.mart_customer_risk_profile
[0m14:17:59.683001 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.unique_states_state_code.67c4706beb, now model.hw4_dbt.mart_fraud_by_category)
[0m14:17:59.683231 [debug] [Thread-4 (]: Began executing node model.hw4_dbt.mart_daily_state_metrics
[0m14:17:59.683427 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_states_state_name.f652068228, now model.hw4_dbt.mart_fraud_by_state)
[0m14:17:59.683811 [debug] [Thread-3 (]: Finished running node model.hw4_dbt.mart_customer_risk_profile
[0m14:17:59.684027 [debug] [Thread-2 (]: Began compiling node model.hw4_dbt.mart_fraud_by_category
[0m14:17:59.684323 [debug] [Thread-4 (]: Finished running node model.hw4_dbt.mart_daily_state_metrics
[0m14:17:59.684496 [debug] [Thread-1 (]: Began compiling node model.hw4_dbt.mart_fraud_by_state
[0m14:17:59.684697 [debug] [Thread-3 (]: Began running node model.hw4_dbt.mart_hourly_fraud_pattern
[0m14:17:59.686902 [debug] [Thread-2 (]: Writing injected SQL for node "model.hw4_dbt.mart_fraud_by_category"
[0m14:17:59.687274 [debug] [Thread-4 (]: Began running node model.hw4_dbt.mart_merchant_analytics
[0m14:17:59.689150 [debug] [Thread-1 (]: Writing injected SQL for node "model.hw4_dbt.mart_fraud_by_state"
[0m14:17:59.689479 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.hw4_dbt.mart_customer_risk_profile, now model.hw4_dbt.mart_hourly_fraud_pattern)
[0m14:17:59.689782 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.hw4_dbt.mart_daily_state_metrics, now model.hw4_dbt.mart_merchant_analytics)
[0m14:17:59.690258 [debug] [Thread-3 (]: Began compiling node model.hw4_dbt.mart_hourly_fraud_pattern
[0m14:17:59.690594 [debug] [Thread-4 (]: Began compiling node model.hw4_dbt.mart_merchant_analytics
[0m14:17:59.690834 [debug] [Thread-2 (]: Began executing node model.hw4_dbt.mart_fraud_by_category
[0m14:17:59.691029 [debug] [Thread-1 (]: Began executing node model.hw4_dbt.mart_fraud_by_state
[0m14:17:59.692925 [debug] [Thread-3 (]: Writing injected SQL for node "model.hw4_dbt.mart_hourly_fraud_pattern"
[0m14:17:59.694886 [debug] [Thread-4 (]: Writing injected SQL for node "model.hw4_dbt.mart_merchant_analytics"
[0m14:17:59.695403 [debug] [Thread-2 (]: Finished running node model.hw4_dbt.mart_fraud_by_category
[0m14:17:59.695779 [debug] [Thread-1 (]: Finished running node model.hw4_dbt.mart_fraud_by_state
[0m14:17:59.696225 [debug] [Thread-2 (]: Began running node test.hw4_dbt.accepted_values_stg_transactions_amount_bucket__small__medium__large__extra_large__unknown.f09a27d70f
[0m14:17:59.696743 [debug] [Thread-1 (]: Began running node test.hw4_dbt.accepted_values_stg_transactions_gender__M__F__U.ae8f0c87a0
[0m14:17:59.696958 [debug] [Thread-4 (]: Began executing node model.hw4_dbt.mart_merchant_analytics
[0m14:17:59.697180 [debug] [Thread-3 (]: Began executing node model.hw4_dbt.mart_hourly_fraud_pattern
[0m14:17:59.697379 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.hw4_dbt.mart_fraud_by_category, now test.hw4_dbt.accepted_values_stg_transactions_amount_bucket__small__medium__large__extra_large__unknown.f09a27d70f)
[0m14:17:59.697621 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.hw4_dbt.mart_fraud_by_state, now test.hw4_dbt.accepted_values_stg_transactions_gender__M__F__U.ae8f0c87a0)
[0m14:17:59.697901 [debug] [Thread-4 (]: Finished running node model.hw4_dbt.mart_merchant_analytics
[0m14:17:59.698242 [debug] [Thread-3 (]: Finished running node model.hw4_dbt.mart_hourly_fraud_pattern
[0m14:17:59.698638 [debug] [Thread-2 (]: Began compiling node test.hw4_dbt.accepted_values_stg_transactions_amount_bucket__small__medium__large__extra_large__unknown.f09a27d70f
[0m14:17:59.698916 [debug] [Thread-1 (]: Began compiling node test.hw4_dbt.accepted_values_stg_transactions_gender__M__F__U.ae8f0c87a0
[0m14:17:59.699173 [debug] [Thread-4 (]: Began running node test.hw4_dbt.accepted_values_stg_transactions_is_fraud__0__1.f6d9ff0fc6
[0m14:17:59.699544 [debug] [Thread-3 (]: Began running node test.hw4_dbt.assert_no_negative_amounts
[0m14:17:59.703525 [debug] [Thread-2 (]: Writing injected SQL for node "test.hw4_dbt.accepted_values_stg_transactions_amount_bucket__small__medium__large__extra_large__unknown.f09a27d70f"
[0m14:17:59.707946 [debug] [Thread-1 (]: Writing injected SQL for node "test.hw4_dbt.accepted_values_stg_transactions_gender__M__F__U.ae8f0c87a0"
[0m14:17:59.708371 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.hw4_dbt.mart_merchant_analytics, now test.hw4_dbt.accepted_values_stg_transactions_is_fraud__0__1.f6d9ff0fc6)
[0m14:17:59.708649 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.hw4_dbt.mart_hourly_fraud_pattern, now test.hw4_dbt.assert_no_negative_amounts)
[0m14:17:59.709049 [debug] [Thread-4 (]: Began compiling node test.hw4_dbt.accepted_values_stg_transactions_is_fraud__0__1.f6d9ff0fc6
[0m14:17:59.709409 [debug] [Thread-3 (]: Began compiling node test.hw4_dbt.assert_no_negative_amounts
[0m14:17:59.709615 [debug] [Thread-1 (]: Began executing node test.hw4_dbt.accepted_values_stg_transactions_gender__M__F__U.ae8f0c87a0
[0m14:17:59.709790 [debug] [Thread-2 (]: Began executing node test.hw4_dbt.accepted_values_stg_transactions_amount_bucket__small__medium__large__extra_large__unknown.f09a27d70f
[0m14:17:59.712292 [debug] [Thread-4 (]: Writing injected SQL for node "test.hw4_dbt.accepted_values_stg_transactions_is_fraud__0__1.f6d9ff0fc6"
[0m14:17:59.714113 [debug] [Thread-3 (]: Writing injected SQL for node "test.hw4_dbt.assert_no_negative_amounts"
[0m14:17:59.717447 [debug] [Thread-1 (]: Finished running node test.hw4_dbt.accepted_values_stg_transactions_gender__M__F__U.ae8f0c87a0
[0m14:17:59.717829 [debug] [Thread-2 (]: Finished running node test.hw4_dbt.accepted_values_stg_transactions_amount_bucket__small__medium__large__extra_large__unknown.f09a27d70f
[0m14:17:59.718247 [debug] [Thread-1 (]: Began running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_stg_transactions_amount__0__True.047010278b
[0m14:17:59.718610 [debug] [Thread-2 (]: Began running node test.hw4_dbt.dbt_utils_unique_combination_of_columns_stg_transactions_transaction_id.9f8e8cbeb8
[0m14:17:59.718810 [debug] [Thread-3 (]: Began executing node test.hw4_dbt.assert_no_negative_amounts
[0m14:17:59.719042 [debug] [Thread-4 (]: Began executing node test.hw4_dbt.accepted_values_stg_transactions_is_fraud__0__1.f6d9ff0fc6
[0m14:17:59.719333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.accepted_values_stg_transactions_gender__M__F__U.ae8f0c87a0, now test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_stg_transactions_amount__0__True.047010278b)
[0m14:17:59.720166 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.accepted_values_stg_transactions_amount_bucket__small__medium__large__extra_large__unknown.f09a27d70f, now test.hw4_dbt.dbt_utils_unique_combination_of_columns_stg_transactions_transaction_id.9f8e8cbeb8)
[0m14:17:59.720883 [debug] [Thread-3 (]: Finished running node test.hw4_dbt.assert_no_negative_amounts
[0m14:17:59.721362 [debug] [Thread-4 (]: Finished running node test.hw4_dbt.accepted_values_stg_transactions_is_fraud__0__1.f6d9ff0fc6
[0m14:17:59.722728 [debug] [Thread-1 (]: Began compiling node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_stg_transactions_amount__0__True.047010278b
[0m14:17:59.723039 [debug] [Thread-2 (]: Began compiling node test.hw4_dbt.dbt_utils_unique_combination_of_columns_stg_transactions_transaction_id.9f8e8cbeb8
[0m14:17:59.723440 [debug] [Thread-3 (]: Began running node test.hw4_dbt.not_null_stg_transactions_amount.3629b5421e
[0m14:17:59.723817 [debug] [Thread-4 (]: Began running node test.hw4_dbt.not_null_stg_transactions_amount_bucket.ddccfce050
[0m14:17:59.732947 [debug] [Thread-1 (]: Writing injected SQL for node "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_stg_transactions_amount__0__True.047010278b"
[0m14:17:59.738573 [debug] [Thread-2 (]: Writing injected SQL for node "test.hw4_dbt.dbt_utils_unique_combination_of_columns_stg_transactions_transaction_id.9f8e8cbeb8"
[0m14:17:59.739617 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.assert_no_negative_amounts, now test.hw4_dbt.not_null_stg_transactions_amount.3629b5421e)
[0m14:17:59.739912 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.accepted_values_stg_transactions_is_fraud__0__1.f6d9ff0fc6, now test.hw4_dbt.not_null_stg_transactions_amount_bucket.ddccfce050)
[0m14:17:59.741343 [debug] [Thread-3 (]: Began compiling node test.hw4_dbt.not_null_stg_transactions_amount.3629b5421e
[0m14:17:59.741886 [debug] [Thread-4 (]: Began compiling node test.hw4_dbt.not_null_stg_transactions_amount_bucket.ddccfce050
[0m14:17:59.744234 [debug] [Thread-3 (]: Writing injected SQL for node "test.hw4_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m14:17:59.747468 [debug] [Thread-4 (]: Writing injected SQL for node "test.hw4_dbt.not_null_stg_transactions_amount_bucket.ddccfce050"
[0m14:17:59.747680 [debug] [Thread-2 (]: Began executing node test.hw4_dbt.dbt_utils_unique_combination_of_columns_stg_transactions_transaction_id.9f8e8cbeb8
[0m14:17:59.747881 [debug] [Thread-1 (]: Began executing node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_stg_transactions_amount__0__True.047010278b
[0m14:17:59.749661 [debug] [Thread-2 (]: Finished running node test.hw4_dbt.dbt_utils_unique_combination_of_columns_stg_transactions_transaction_id.9f8e8cbeb8
[0m14:17:59.750149 [debug] [Thread-1 (]: Finished running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_stg_transactions_amount__0__True.047010278b
[0m14:17:59.750823 [debug] [Thread-2 (]: Began running node test.hw4_dbt.not_null_stg_transactions_cat_id.81205306d9
[0m14:17:59.751134 [debug] [Thread-3 (]: Began executing node test.hw4_dbt.not_null_stg_transactions_amount.3629b5421e
[0m14:17:59.751324 [debug] [Thread-4 (]: Began executing node test.hw4_dbt.not_null_stg_transactions_amount_bucket.ddccfce050
[0m14:17:59.752609 [debug] [Thread-1 (]: Began running node test.hw4_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m14:17:59.753019 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.dbt_utils_unique_combination_of_columns_stg_transactions_transaction_id.9f8e8cbeb8, now test.hw4_dbt.not_null_stg_transactions_cat_id.81205306d9)
[0m14:17:59.754478 [debug] [Thread-3 (]: Finished running node test.hw4_dbt.not_null_stg_transactions_amount.3629b5421e
[0m14:17:59.755496 [debug] [Thread-4 (]: Finished running node test.hw4_dbt.not_null_stg_transactions_amount_bucket.ddccfce050
[0m14:17:59.755719 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_stg_transactions_amount__0__True.047010278b, now test.hw4_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf)
[0m14:17:59.755948 [debug] [Thread-2 (]: Began compiling node test.hw4_dbt.not_null_stg_transactions_cat_id.81205306d9
[0m14:17:59.757423 [debug] [Thread-3 (]: Began running node test.hw4_dbt.not_null_stg_transactions_is_fraud.c832a79395
[0m14:17:59.758198 [debug] [Thread-4 (]: Began running node test.hw4_dbt.not_null_stg_transactions_merchant_id.b64621d2d7
[0m14:17:59.758426 [debug] [Thread-1 (]: Began compiling node test.hw4_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m14:17:59.762442 [debug] [Thread-2 (]: Writing injected SQL for node "test.hw4_dbt.not_null_stg_transactions_cat_id.81205306d9"
[0m14:17:59.763493 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_stg_transactions_amount.3629b5421e, now test.hw4_dbt.not_null_stg_transactions_is_fraud.c832a79395)
[0m14:17:59.764152 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_stg_transactions_amount_bucket.ddccfce050, now test.hw4_dbt.not_null_stg_transactions_merchant_id.b64621d2d7)
[0m14:17:59.767028 [debug] [Thread-1 (]: Writing injected SQL for node "test.hw4_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m14:17:59.767907 [debug] [Thread-3 (]: Began compiling node test.hw4_dbt.not_null_stg_transactions_is_fraud.c832a79395
[0m14:17:59.768182 [debug] [Thread-4 (]: Began compiling node test.hw4_dbt.not_null_stg_transactions_merchant_id.b64621d2d7
[0m14:17:59.768544 [debug] [Thread-2 (]: Began executing node test.hw4_dbt.not_null_stg_transactions_cat_id.81205306d9
[0m14:17:59.771123 [debug] [Thread-3 (]: Writing injected SQL for node "test.hw4_dbt.not_null_stg_transactions_is_fraud.c832a79395"
[0m14:17:59.773845 [debug] [Thread-4 (]: Writing injected SQL for node "test.hw4_dbt.not_null_stg_transactions_merchant_id.b64621d2d7"
[0m14:17:59.774218 [debug] [Thread-1 (]: Began executing node test.hw4_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m14:17:59.774875 [debug] [Thread-2 (]: Finished running node test.hw4_dbt.not_null_stg_transactions_cat_id.81205306d9
[0m14:17:59.775843 [debug] [Thread-1 (]: Finished running node test.hw4_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m14:17:59.776151 [debug] [Thread-2 (]: Began running node test.hw4_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m14:17:59.776391 [debug] [Thread-3 (]: Began executing node test.hw4_dbt.not_null_stg_transactions_is_fraud.c832a79395
[0m14:17:59.776576 [debug] [Thread-4 (]: Began executing node test.hw4_dbt.not_null_stg_transactions_merchant_id.b64621d2d7
[0m14:17:59.776777 [debug] [Thread-1 (]: Began running node test.hw4_dbt.not_null_stg_transactions_transaction_hour.99d50d4d46
[0m14:17:59.777008 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_stg_transactions_cat_id.81205306d9, now test.hw4_dbt.not_null_stg_transactions_transaction_date.353bde368c)
[0m14:17:59.777324 [debug] [Thread-3 (]: Finished running node test.hw4_dbt.not_null_stg_transactions_is_fraud.c832a79395
[0m14:17:59.777908 [debug] [Thread-4 (]: Finished running node test.hw4_dbt.not_null_stg_transactions_merchant_id.b64621d2d7
[0m14:17:59.778213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf, now test.hw4_dbt.not_null_stg_transactions_transaction_hour.99d50d4d46)
[0m14:17:59.779185 [debug] [Thread-2 (]: Began compiling node test.hw4_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m14:17:59.779474 [debug] [Thread-3 (]: Began running node test.hw4_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m14:17:59.780014 [debug] [Thread-4 (]: Began running node test.hw4_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m14:17:59.780273 [debug] [Thread-1 (]: Began compiling node test.hw4_dbt.not_null_stg_transactions_transaction_hour.99d50d4d46
[0m14:17:59.783401 [debug] [Thread-2 (]: Writing injected SQL for node "test.hw4_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m14:17:59.783762 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_stg_transactions_is_fraud.c832a79395, now test.hw4_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4)
[0m14:17:59.784649 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_stg_transactions_merchant_id.b64621d2d7, now test.hw4_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7)
[0m14:17:59.787295 [debug] [Thread-1 (]: Writing injected SQL for node "test.hw4_dbt.not_null_stg_transactions_transaction_hour.99d50d4d46"
[0m14:17:59.787880 [debug] [Thread-3 (]: Began compiling node test.hw4_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m14:17:59.788634 [debug] [Thread-4 (]: Began compiling node test.hw4_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m14:17:59.788949 [debug] [Thread-2 (]: Began executing node test.hw4_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m14:17:59.791862 [debug] [Thread-3 (]: Writing injected SQL for node "test.hw4_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m14:17:59.796236 [debug] [Thread-4 (]: Writing injected SQL for node "test.hw4_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m14:17:59.796480 [debug] [Thread-1 (]: Began executing node test.hw4_dbt.not_null_stg_transactions_transaction_hour.99d50d4d46
[0m14:17:59.796996 [debug] [Thread-2 (]: Finished running node test.hw4_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m14:17:59.799150 [debug] [Thread-1 (]: Finished running node test.hw4_dbt.not_null_stg_transactions_transaction_hour.99d50d4d46
[0m14:17:59.799768 [debug] [Thread-2 (]: Began running node test.hw4_dbt.not_null_stg_transactions_us_state.11afe11a0c
[0m14:17:59.800100 [debug] [Thread-4 (]: Began executing node test.hw4_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m14:17:59.800343 [debug] [Thread-3 (]: Began executing node test.hw4_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m14:17:59.800784 [debug] [Thread-1 (]: Began running node test.hw4_dbt.relationships_stg_transactions_us_state__state_code__ref_states_.7b260553ef
[0m14:17:59.801893 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_stg_transactions_transaction_date.353bde368c, now test.hw4_dbt.not_null_stg_transactions_us_state.11afe11a0c)
[0m14:17:59.802682 [debug] [Thread-4 (]: Finished running node test.hw4_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m14:17:59.803161 [debug] [Thread-3 (]: Finished running node test.hw4_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m14:17:59.803397 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_stg_transactions_transaction_hour.99d50d4d46, now test.hw4_dbt.relationships_stg_transactions_us_state__state_code__ref_states_.7b260553ef)
[0m14:17:59.803674 [debug] [Thread-2 (]: Began compiling node test.hw4_dbt.not_null_stg_transactions_us_state.11afe11a0c
[0m14:17:59.803989 [debug] [Thread-4 (]: Began running node test.hw4_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m14:17:59.804320 [debug] [Thread-3 (]: Began running node test.hw4_dbt.accepted_values_mart_customer_risk_profile_risk_level__HIGH__MEDIUM__LOW.95fabd3536
[0m14:17:59.804578 [debug] [Thread-1 (]: Began compiling node test.hw4_dbt.relationships_stg_transactions_us_state__state_code__ref_states_.7b260553ef
[0m14:17:59.807014 [debug] [Thread-2 (]: Writing injected SQL for node "test.hw4_dbt.not_null_stg_transactions_us_state.11afe11a0c"
[0m14:17:59.807791 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7, now test.hw4_dbt.unique_stg_transactions_transaction_id.ee9a78a396)
[0m14:17:59.808154 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4, now test.hw4_dbt.accepted_values_mart_customer_risk_profile_risk_level__HIGH__MEDIUM__LOW.95fabd3536)
[0m14:17:59.812917 [debug] [Thread-1 (]: Writing injected SQL for node "test.hw4_dbt.relationships_stg_transactions_us_state__state_code__ref_states_.7b260553ef"
[0m14:17:59.813327 [debug] [Thread-4 (]: Began compiling node test.hw4_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m14:17:59.813626 [debug] [Thread-3 (]: Began compiling node test.hw4_dbt.accepted_values_mart_customer_risk_profile_risk_level__HIGH__MEDIUM__LOW.95fabd3536
[0m14:17:59.814024 [debug] [Thread-2 (]: Began executing node test.hw4_dbt.not_null_stg_transactions_us_state.11afe11a0c
[0m14:17:59.816950 [debug] [Thread-4 (]: Writing injected SQL for node "test.hw4_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m14:17:59.820599 [debug] [Thread-3 (]: Writing injected SQL for node "test.hw4_dbt.accepted_values_mart_customer_risk_profile_risk_level__HIGH__MEDIUM__LOW.95fabd3536"
[0m14:17:59.820837 [debug] [Thread-1 (]: Began executing node test.hw4_dbt.relationships_stg_transactions_us_state__state_code__ref_states_.7b260553ef
[0m14:17:59.821231 [debug] [Thread-2 (]: Finished running node test.hw4_dbt.not_null_stg_transactions_us_state.11afe11a0c
[0m14:17:59.821698 [debug] [Thread-1 (]: Finished running node test.hw4_dbt.relationships_stg_transactions_us_state__state_code__ref_states_.7b260553ef
[0m14:17:59.822021 [debug] [Thread-2 (]: Began running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_customer_risk_profile_fraud_rate__100__0.ee441b99d9
[0m14:17:59.822391 [debug] [Thread-1 (]: Began running node test.hw4_dbt.not_null_mart_customer_risk_profile_customer_id.c066ff7487
[0m14:17:59.822594 [debug] [Thread-3 (]: Began executing node test.hw4_dbt.accepted_values_mart_customer_risk_profile_risk_level__HIGH__MEDIUM__LOW.95fabd3536
[0m14:17:59.822821 [debug] [Thread-4 (]: Began executing node test.hw4_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m14:17:59.823069 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_stg_transactions_us_state.11afe11a0c, now test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_customer_risk_profile_fraud_rate__100__0.ee441b99d9)
[0m14:17:59.823312 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.relationships_stg_transactions_us_state__state_code__ref_states_.7b260553ef, now test.hw4_dbt.not_null_mart_customer_risk_profile_customer_id.c066ff7487)
[0m14:17:59.823676 [debug] [Thread-3 (]: Finished running node test.hw4_dbt.accepted_values_mart_customer_risk_profile_risk_level__HIGH__MEDIUM__LOW.95fabd3536
[0m14:17:59.824098 [debug] [Thread-4 (]: Finished running node test.hw4_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m14:17:59.824375 [debug] [Thread-2 (]: Began compiling node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_customer_risk_profile_fraud_rate__100__0.ee441b99d9
[0m14:17:59.824638 [debug] [Thread-1 (]: Began compiling node test.hw4_dbt.not_null_mart_customer_risk_profile_customer_id.c066ff7487
[0m14:17:59.824932 [debug] [Thread-3 (]: Began running node test.hw4_dbt.unique_mart_customer_risk_profile_customer_id.7b43a6fbd0
[0m14:17:59.825227 [debug] [Thread-4 (]: Began running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_fraud_rate__1__0.59ce56cc94
[0m14:17:59.828074 [debug] [Thread-2 (]: Writing injected SQL for node "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_customer_risk_profile_fraud_rate__100__0.ee441b99d9"
[0m14:17:59.830434 [debug] [Thread-1 (]: Writing injected SQL for node "test.hw4_dbt.not_null_mart_customer_risk_profile_customer_id.c066ff7487"
[0m14:17:59.830779 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.accepted_values_mart_customer_risk_profile_risk_level__HIGH__MEDIUM__LOW.95fabd3536, now test.hw4_dbt.unique_mart_customer_risk_profile_customer_id.7b43a6fbd0)
[0m14:17:59.831058 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.unique_stg_transactions_transaction_id.ee9a78a396, now test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_fraud_rate__1__0.59ce56cc94)
[0m14:17:59.831384 [debug] [Thread-3 (]: Began compiling node test.hw4_dbt.unique_mart_customer_risk_profile_customer_id.7b43a6fbd0
[0m14:17:59.831679 [debug] [Thread-4 (]: Began compiling node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_fraud_rate__1__0.59ce56cc94
[0m14:17:59.831885 [debug] [Thread-2 (]: Began executing node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_customer_risk_profile_fraud_rate__100__0.ee441b99d9
[0m14:17:59.832058 [debug] [Thread-1 (]: Began executing node test.hw4_dbt.not_null_mart_customer_risk_profile_customer_id.c066ff7487
[0m14:17:59.834208 [debug] [Thread-3 (]: Writing injected SQL for node "test.hw4_dbt.unique_mart_customer_risk_profile_customer_id.7b43a6fbd0"
[0m14:17:59.838023 [debug] [Thread-4 (]: Writing injected SQL for node "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_fraud_rate__1__0.59ce56cc94"
[0m14:17:59.838588 [debug] [Thread-2 (]: Finished running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_customer_risk_profile_fraud_rate__100__0.ee441b99d9
[0m14:17:59.838986 [debug] [Thread-1 (]: Finished running node test.hw4_dbt.not_null_mart_customer_risk_profile_customer_id.c066ff7487
[0m14:17:59.839439 [debug] [Thread-2 (]: Began running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_large_txn_share__1__0.d93f9f3127
[0m14:17:59.840130 [debug] [Thread-1 (]: Began running node test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_daily_state_metrics_transaction_date__us_state.36d7185b4c
[0m14:17:59.840451 [debug] [Thread-4 (]: Began executing node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_fraud_rate__1__0.59ce56cc94
[0m14:17:59.840676 [debug] [Thread-3 (]: Began executing node test.hw4_dbt.unique_mart_customer_risk_profile_customer_id.7b43a6fbd0
[0m14:17:59.841009 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_customer_risk_profile_fraud_rate__100__0.ee441b99d9, now test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_large_txn_share__1__0.d93f9f3127)
[0m14:17:59.841306 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_mart_customer_risk_profile_customer_id.c066ff7487, now test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_daily_state_metrics_transaction_date__us_state.36d7185b4c)
[0m14:17:59.841684 [debug] [Thread-4 (]: Finished running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_fraud_rate__1__0.59ce56cc94
[0m14:17:59.842766 [debug] [Thread-3 (]: Finished running node test.hw4_dbt.unique_mart_customer_risk_profile_customer_id.7b43a6fbd0
[0m14:17:59.843024 [debug] [Thread-2 (]: Began compiling node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_large_txn_share__1__0.d93f9f3127
[0m14:17:59.843342 [debug] [Thread-1 (]: Began compiling node test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_daily_state_metrics_transaction_date__us_state.36d7185b4c
[0m14:17:59.844301 [debug] [Thread-4 (]: Began running node test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_count.44f9f89c45
[0m14:17:59.844630 [debug] [Thread-3 (]: Began running node test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_date.27b2c6ebe0
[0m14:17:59.847190 [debug] [Thread-2 (]: Writing injected SQL for node "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_large_txn_share__1__0.d93f9f3127"
[0m14:17:59.851210 [debug] [Thread-1 (]: Writing injected SQL for node "test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_daily_state_metrics_transaction_date__us_state.36d7185b4c"
[0m14:17:59.851635 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_fraud_rate__1__0.59ce56cc94, now test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_count.44f9f89c45)
[0m14:17:59.852002 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.unique_mart_customer_risk_profile_customer_id.7b43a6fbd0, now test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_date.27b2c6ebe0)
[0m14:17:59.852473 [debug] [Thread-4 (]: Began compiling node test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_count.44f9f89c45
[0m14:17:59.853038 [debug] [Thread-3 (]: Began compiling node test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_date.27b2c6ebe0
[0m14:17:59.856252 [debug] [Thread-4 (]: Writing injected SQL for node "test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_count.44f9f89c45"
[0m14:17:59.856573 [debug] [Thread-2 (]: Began executing node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_large_txn_share__1__0.d93f9f3127
[0m14:17:59.856795 [debug] [Thread-1 (]: Began executing node test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_daily_state_metrics_transaction_date__us_state.36d7185b4c
[0m14:17:59.860203 [debug] [Thread-3 (]: Writing injected SQL for node "test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_date.27b2c6ebe0"
[0m14:17:59.860803 [debug] [Thread-2 (]: Finished running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_large_txn_share__1__0.d93f9f3127
[0m14:17:59.861212 [debug] [Thread-1 (]: Finished running node test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_daily_state_metrics_transaction_date__us_state.36d7185b4c
[0m14:17:59.861478 [debug] [Thread-4 (]: Began executing node test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_count.44f9f89c45
[0m14:17:59.862021 [debug] [Thread-2 (]: Began running node test.hw4_dbt.not_null_mart_daily_state_metrics_us_state.e9c98cd892
[0m14:17:59.862343 [debug] [Thread-1 (]: Began running node test.hw4_dbt.assert_fraud_rate_bounds
[0m14:17:59.862749 [debug] [Thread-4 (]: Finished running node test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_count.44f9f89c45
[0m14:17:59.862920 [debug] [Thread-3 (]: Began executing node test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_date.27b2c6ebe0
[0m14:17:59.863154 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_daily_state_metrics_large_txn_share__1__0.d93f9f3127, now test.hw4_dbt.not_null_mart_daily_state_metrics_us_state.e9c98cd892)
[0m14:17:59.863494 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_daily_state_metrics_transaction_date__us_state.36d7185b4c, now test.hw4_dbt.assert_fraud_rate_bounds)
[0m14:17:59.863770 [debug] [Thread-4 (]: Began running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_category_fraud_rate__100__0.60b2512acf
[0m14:17:59.864155 [debug] [Thread-3 (]: Finished running node test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_date.27b2c6ebe0
[0m14:17:59.864367 [debug] [Thread-2 (]: Began compiling node test.hw4_dbt.not_null_mart_daily_state_metrics_us_state.e9c98cd892
[0m14:17:59.864719 [debug] [Thread-1 (]: Began compiling node test.hw4_dbt.assert_fraud_rate_bounds
[0m14:17:59.864952 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_count.44f9f89c45, now test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_category_fraud_rate__100__0.60b2512acf)
[0m14:17:59.865298 [debug] [Thread-3 (]: Began running node test.hw4_dbt.not_null_mart_fraud_by_category_cat_id.1d7340ccc5
[0m14:17:59.868502 [debug] [Thread-2 (]: Writing injected SQL for node "test.hw4_dbt.not_null_mart_daily_state_metrics_us_state.e9c98cd892"
[0m14:17:59.870644 [debug] [Thread-1 (]: Writing injected SQL for node "test.hw4_dbt.assert_fraud_rate_bounds"
[0m14:17:59.871029 [debug] [Thread-4 (]: Began compiling node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_category_fraud_rate__100__0.60b2512acf
[0m14:17:59.871354 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_mart_daily_state_metrics_transaction_date.27b2c6ebe0, now test.hw4_dbt.not_null_mart_fraud_by_category_cat_id.1d7340ccc5)
[0m14:17:59.876356 [debug] [Thread-4 (]: Writing injected SQL for node "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_category_fraud_rate__100__0.60b2512acf"
[0m14:17:59.876714 [debug] [Thread-3 (]: Began compiling node test.hw4_dbt.not_null_mart_fraud_by_category_cat_id.1d7340ccc5
[0m14:17:59.876878 [debug] [Thread-2 (]: Began executing node test.hw4_dbt.not_null_mart_daily_state_metrics_us_state.e9c98cd892
[0m14:17:59.877045 [debug] [Thread-1 (]: Began executing node test.hw4_dbt.assert_fraud_rate_bounds
[0m14:17:59.879905 [debug] [Thread-3 (]: Writing injected SQL for node "test.hw4_dbt.not_null_mart_fraud_by_category_cat_id.1d7340ccc5"
[0m14:17:59.880393 [debug] [Thread-2 (]: Finished running node test.hw4_dbt.not_null_mart_daily_state_metrics_us_state.e9c98cd892
[0m14:17:59.880616 [debug] [Thread-4 (]: Began executing node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_category_fraud_rate__100__0.60b2512acf
[0m14:17:59.881058 [debug] [Thread-1 (]: Finished running node test.hw4_dbt.assert_fraud_rate_bounds
[0m14:17:59.881417 [debug] [Thread-2 (]: Began running node test.hw4_dbt.unique_mart_fraud_by_category_cat_id.69c514d94d
[0m14:17:59.881862 [debug] [Thread-4 (]: Finished running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_category_fraud_rate__100__0.60b2512acf
[0m14:17:59.882194 [debug] [Thread-1 (]: Began running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_state_fraud_rate__100__0.ad1018ee37
[0m14:17:59.882485 [debug] [Thread-3 (]: Began executing node test.hw4_dbt.not_null_mart_fraud_by_category_cat_id.1d7340ccc5
[0m14:17:59.882858 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_mart_daily_state_metrics_us_state.e9c98cd892, now test.hw4_dbt.unique_mart_fraud_by_category_cat_id.69c514d94d)
[0m14:17:59.883143 [debug] [Thread-4 (]: Began running node test.hw4_dbt.not_null_mart_fraud_by_state_unique_customers.afa2f0b8db
[0m14:17:59.883397 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.assert_fraud_rate_bounds, now test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_state_fraud_rate__100__0.ad1018ee37)
[0m14:17:59.883735 [debug] [Thread-3 (]: Finished running node test.hw4_dbt.not_null_mart_fraud_by_category_cat_id.1d7340ccc5
[0m14:17:59.883955 [debug] [Thread-2 (]: Began compiling node test.hw4_dbt.unique_mart_fraud_by_category_cat_id.69c514d94d
[0m14:17:59.884248 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_category_fraud_rate__100__0.60b2512acf, now test.hw4_dbt.not_null_mart_fraud_by_state_unique_customers.afa2f0b8db)
[0m14:17:59.884532 [debug] [Thread-1 (]: Began compiling node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_state_fraud_rate__100__0.ad1018ee37
[0m14:17:59.884782 [debug] [Thread-3 (]: Began running node test.hw4_dbt.not_null_mart_fraud_by_state_us_state.95ac4eba19
[0m14:17:59.887891 [debug] [Thread-2 (]: Writing injected SQL for node "test.hw4_dbt.unique_mart_fraud_by_category_cat_id.69c514d94d"
[0m14:17:59.888174 [debug] [Thread-4 (]: Began compiling node test.hw4_dbt.not_null_mart_fraud_by_state_unique_customers.afa2f0b8db
[0m14:17:59.890870 [debug] [Thread-1 (]: Writing injected SQL for node "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_state_fraud_rate__100__0.ad1018ee37"
[0m14:17:59.891266 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_mart_fraud_by_category_cat_id.1d7340ccc5, now test.hw4_dbt.not_null_mart_fraud_by_state_us_state.95ac4eba19)
[0m14:17:59.893657 [debug] [Thread-4 (]: Writing injected SQL for node "test.hw4_dbt.not_null_mart_fraud_by_state_unique_customers.afa2f0b8db"
[0m14:17:59.894016 [debug] [Thread-3 (]: Began compiling node test.hw4_dbt.not_null_mart_fraud_by_state_us_state.95ac4eba19
[0m14:17:59.894224 [debug] [Thread-2 (]: Began executing node test.hw4_dbt.unique_mart_fraud_by_category_cat_id.69c514d94d
[0m14:17:59.894610 [debug] [Thread-1 (]: Began executing node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_state_fraud_rate__100__0.ad1018ee37
[0m14:17:59.897175 [debug] [Thread-3 (]: Writing injected SQL for node "test.hw4_dbt.not_null_mart_fraud_by_state_us_state.95ac4eba19"
[0m14:17:59.897729 [debug] [Thread-2 (]: Finished running node test.hw4_dbt.unique_mart_fraud_by_category_cat_id.69c514d94d
[0m14:17:59.897926 [debug] [Thread-4 (]: Began executing node test.hw4_dbt.not_null_mart_fraud_by_state_unique_customers.afa2f0b8db
[0m14:17:59.898269 [debug] [Thread-1 (]: Finished running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_state_fraud_rate__100__0.ad1018ee37
[0m14:17:59.898667 [debug] [Thread-2 (]: Began running node test.hw4_dbt.unique_mart_fraud_by_state_us_state.45e47cf1a6
[0m14:17:59.899235 [debug] [Thread-4 (]: Finished running node test.hw4_dbt.not_null_mart_fraud_by_state_unique_customers.afa2f0b8db
[0m14:17:59.899638 [debug] [Thread-1 (]: Began running node test.hw4_dbt.accepted_values_mart_merchant_analytics_suspicious_flag__0__1.221ef94aff
[0m14:17:59.899950 [debug] [Thread-3 (]: Began executing node test.hw4_dbt.not_null_mart_fraud_by_state_us_state.95ac4eba19
[0m14:17:59.900272 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.unique_mart_fraud_by_category_cat_id.69c514d94d, now test.hw4_dbt.unique_mart_fraud_by_state_us_state.45e47cf1a6)
[0m14:17:59.900588 [debug] [Thread-4 (]: Began running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_merchant_analytics_fraud_rate__100__0.8aedb505c1
[0m14:17:59.900831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_fraud_by_state_fraud_rate__100__0.ad1018ee37, now test.hw4_dbt.accepted_values_mart_merchant_analytics_suspicious_flag__0__1.221ef94aff)
[0m14:17:59.901161 [debug] [Thread-3 (]: Finished running node test.hw4_dbt.not_null_mart_fraud_by_state_us_state.95ac4eba19
[0m14:17:59.901352 [debug] [Thread-2 (]: Began compiling node test.hw4_dbt.unique_mart_fraud_by_state_us_state.45e47cf1a6
[0m14:17:59.901546 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_mart_fraud_by_state_unique_customers.afa2f0b8db, now test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_merchant_analytics_fraud_rate__100__0.8aedb505c1)
[0m14:17:59.901722 [debug] [Thread-1 (]: Began compiling node test.hw4_dbt.accepted_values_mart_merchant_analytics_suspicious_flag__0__1.221ef94aff
[0m14:17:59.901913 [debug] [Thread-3 (]: Began running node test.hw4_dbt.not_null_mart_merchant_analytics_merchant_id.61b4b4d63c
[0m14:17:59.904500 [debug] [Thread-2 (]: Writing injected SQL for node "test.hw4_dbt.unique_mart_fraud_by_state_us_state.45e47cf1a6"
[0m14:17:59.904838 [debug] [Thread-4 (]: Began compiling node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_merchant_analytics_fraud_rate__100__0.8aedb505c1
[0m14:17:59.907116 [debug] [Thread-1 (]: Writing injected SQL for node "test.hw4_dbt.accepted_values_mart_merchant_analytics_suspicious_flag__0__1.221ef94aff"
[0m14:17:59.907504 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_mart_fraud_by_state_us_state.95ac4eba19, now test.hw4_dbt.not_null_mart_merchant_analytics_merchant_id.61b4b4d63c)
[0m14:17:59.911680 [debug] [Thread-4 (]: Writing injected SQL for node "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_merchant_analytics_fraud_rate__100__0.8aedb505c1"
[0m14:17:59.912124 [debug] [Thread-2 (]: Began executing node test.hw4_dbt.unique_mart_fraud_by_state_us_state.45e47cf1a6
[0m14:17:59.912369 [debug] [Thread-3 (]: Began compiling node test.hw4_dbt.not_null_mart_merchant_analytics_merchant_id.61b4b4d63c
[0m14:17:59.912754 [debug] [Thread-1 (]: Began executing node test.hw4_dbt.accepted_values_mart_merchant_analytics_suspicious_flag__0__1.221ef94aff
[0m14:17:59.913154 [debug] [Thread-2 (]: Finished running node test.hw4_dbt.unique_mart_fraud_by_state_us_state.45e47cf1a6
[0m14:17:59.915593 [debug] [Thread-3 (]: Writing injected SQL for node "test.hw4_dbt.not_null_mart_merchant_analytics_merchant_id.61b4b4d63c"
[0m14:17:59.915932 [debug] [Thread-4 (]: Began executing node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_merchant_analytics_fraud_rate__100__0.8aedb505c1
[0m14:17:59.916627 [debug] [Thread-1 (]: Finished running node test.hw4_dbt.accepted_values_mart_merchant_analytics_suspicious_flag__0__1.221ef94aff
[0m14:17:59.916925 [debug] [Thread-2 (]: Began running node test.hw4_dbt.unique_mart_merchant_analytics_merchant_id.58d0768274
[0m14:17:59.917414 [debug] [Thread-4 (]: Finished running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_merchant_analytics_fraud_rate__100__0.8aedb505c1
[0m14:17:59.917670 [debug] [Thread-1 (]: Began running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_hourly_fraud_pattern_fraud_rate__100__0.870771d265
[0m14:17:59.917916 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.unique_mart_fraud_by_state_us_state.45e47cf1a6, now test.hw4_dbt.unique_mart_merchant_analytics_merchant_id.58d0768274)
[0m14:17:59.918079 [debug] [Thread-3 (]: Began executing node test.hw4_dbt.not_null_mart_merchant_analytics_merchant_id.61b4b4d63c
[0m14:17:59.918288 [debug] [Thread-4 (]: Began running node test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_hourly_fraud_pattern_day_name__hour_of_day.f8d797f239
[0m14:17:59.918517 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.accepted_values_mart_merchant_analytics_suspicious_flag__0__1.221ef94aff, now test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_hourly_fraud_pattern_fraud_rate__100__0.870771d265)
[0m14:17:59.918697 [debug] [Thread-2 (]: Began compiling node test.hw4_dbt.unique_mart_merchant_analytics_merchant_id.58d0768274
[0m14:17:59.919130 [debug] [Thread-3 (]: Finished running node test.hw4_dbt.not_null_mart_merchant_analytics_merchant_id.61b4b4d63c
[0m14:17:59.919460 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_merchant_analytics_fraud_rate__100__0.8aedb505c1, now test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_hourly_fraud_pattern_day_name__hour_of_day.f8d797f239)
[0m14:17:59.919787 [debug] [Thread-1 (]: Began compiling node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_hourly_fraud_pattern_fraud_rate__100__0.870771d265
[0m14:17:59.922247 [debug] [Thread-2 (]: Writing injected SQL for node "test.hw4_dbt.unique_mart_merchant_analytics_merchant_id.58d0768274"
[0m14:17:59.922659 [debug] [Thread-3 (]: Began running node test.hw4_dbt.not_null_mart_hourly_fraud_pattern_day_name.cc79fdc01d
[0m14:17:59.922936 [debug] [Thread-4 (]: Began compiling node test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_hourly_fraud_pattern_day_name__hour_of_day.f8d797f239
[0m14:17:59.925531 [debug] [Thread-1 (]: Writing injected SQL for node "test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_hourly_fraud_pattern_fraud_rate__100__0.870771d265"
[0m14:17:59.926044 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.not_null_mart_merchant_analytics_merchant_id.61b4b4d63c, now test.hw4_dbt.not_null_mart_hourly_fraud_pattern_day_name.cc79fdc01d)
[0m14:17:59.929358 [debug] [Thread-4 (]: Writing injected SQL for node "test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_hourly_fraud_pattern_day_name__hour_of_day.f8d797f239"
[0m14:17:59.929702 [debug] [Thread-2 (]: Began executing node test.hw4_dbt.unique_mart_merchant_analytics_merchant_id.58d0768274
[0m14:17:59.930035 [debug] [Thread-3 (]: Began compiling node test.hw4_dbt.not_null_mart_hourly_fraud_pattern_day_name.cc79fdc01d
[0m14:17:59.930585 [debug] [Thread-2 (]: Finished running node test.hw4_dbt.unique_mart_merchant_analytics_merchant_id.58d0768274
[0m14:17:59.933278 [debug] [Thread-3 (]: Writing injected SQL for node "test.hw4_dbt.not_null_mart_hourly_fraud_pattern_day_name.cc79fdc01d"
[0m14:17:59.933564 [debug] [Thread-4 (]: Began executing node test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_hourly_fraud_pattern_day_name__hour_of_day.f8d797f239
[0m14:17:59.933783 [debug] [Thread-1 (]: Began executing node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_hourly_fraud_pattern_fraud_rate__100__0.870771d265
[0m14:17:59.934076 [debug] [Thread-2 (]: Began running node test.hw4_dbt.not_null_mart_hourly_fraud_pattern_hour_of_day.7bbb67dbe4
[0m14:17:59.934525 [debug] [Thread-4 (]: Finished running node test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_hourly_fraud_pattern_day_name__hour_of_day.f8d797f239
[0m14:17:59.934863 [debug] [Thread-1 (]: Finished running node test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_hourly_fraud_pattern_fraud_rate__100__0.870771d265
[0m14:17:59.935082 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.hw4_dbt.unique_mart_merchant_analytics_merchant_id.58d0768274, now test.hw4_dbt.not_null_mart_hourly_fraud_pattern_hour_of_day.7bbb67dbe4)
[0m14:17:59.935253 [debug] [Thread-3 (]: Began executing node test.hw4_dbt.not_null_mart_hourly_fraud_pattern_day_name.cc79fdc01d
[0m14:17:59.935533 [debug] [Thread-2 (]: Began compiling node test.hw4_dbt.not_null_mart_hourly_fraud_pattern_hour_of_day.7bbb67dbe4
[0m14:17:59.935869 [debug] [Thread-3 (]: Finished running node test.hw4_dbt.not_null_mart_hourly_fraud_pattern_day_name.cc79fdc01d
[0m14:17:59.938361 [debug] [Thread-2 (]: Writing injected SQL for node "test.hw4_dbt.not_null_mart_hourly_fraud_pattern_hour_of_day.7bbb67dbe4"
[0m14:17:59.939047 [debug] [Thread-2 (]: Began executing node test.hw4_dbt.not_null_mart_hourly_fraud_pattern_hour_of_day.7bbb67dbe4
[0m14:17:59.939479 [debug] [Thread-2 (]: Finished running node test.hw4_dbt.not_null_mart_hourly_fraud_pattern_hour_of_day.7bbb67dbe4
[0m14:17:59.940257 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:17:59.940520 [debug] [MainThread]: Connection 'test.hw4_dbt.dbt_expectations_expect_column_values_to_be_between_mart_hourly_fraud_pattern_fraud_rate__100__0.870771d265' was properly closed.
[0m14:17:59.940674 [debug] [MainThread]: Connection 'test.hw4_dbt.not_null_mart_hourly_fraud_pattern_hour_of_day.7bbb67dbe4' was properly closed.
[0m14:17:59.940816 [debug] [MainThread]: Connection 'test.hw4_dbt.not_null_mart_hourly_fraud_pattern_day_name.cc79fdc01d' was properly closed.
[0m14:17:59.940943 [debug] [MainThread]: Connection 'test.hw4_dbt.dbt_utils_unique_combination_of_columns_mart_hourly_fraud_pattern_day_name__hour_of_day.f8d797f239' was properly closed.
[0m14:17:59.944201 [debug] [MainThread]: Command end result
[0m14:18:00.035915 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m14:18:00.036282 [info ] [MainThread]: Building catalog
[0m14:18:00.043654 [debug] [ThreadPool]: Acquiring new duckdb connection 'transactions.information_schema'
[0m14:18:00.048723 [debug] [ThreadPool]: Using duckdb connection "transactions.information_schema"
[0m14:18:00.049016 [debug] [ThreadPool]: On transactions.information_schema: BEGIN
[0m14:18:00.049174 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:18:00.059451 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m14:18:00.059748 [debug] [ThreadPool]: Using duckdb connection "transactions.information_schema"
[0m14:18:00.059955 [debug] [ThreadPool]: On transactions.information_schema: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "hw4_dbt", "target_name": "dev", "connection_name": "transactions.information_schema"} */
with relations AS (
      select
        t.table_name
        , t.database_name
        , t.schema_name
        , 'BASE TABLE' as table_type
        , t.comment as table_comment
      from duckdb_tables() t
      WHERE t.database_name = 'transactions'
      UNION ALL
      SELECT v.view_name as table_name
      , v.database_name
      , v.schema_name
      , 'VIEW' as table_type
      , v.comment as table_comment
      from duckdb_views() v
      WHERE v.database_name = 'transactions'
    )
    select
        'transactions' as table_database,
        r.schema_name as table_schema,
        r.table_name,
        r.table_type,
        r.table_comment,
        c.column_name,
        c.column_index as column_index,
        c.data_type as column_type,
        c.comment as column_comment,
        '' as table_owner
    FROM relations r JOIN duckdb_columns() c ON r.schema_name = c.schema_name AND r.table_name = c.table_name
    WHERE (upper(r.schema_name) = upper('main_marts') or upper(r.schema_name) = upper('main_transactions_db') or upper(r.schema_name) = upper('main_staging'))
    ORDER BY
        r.schema_name,
        r.table_name,
        c.column_index
[0m14:18:00.072911 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m14:18:00.078113 [debug] [ThreadPool]: On transactions.information_schema: ROLLBACK
[0m14:18:00.079020 [debug] [ThreadPool]: Failed to rollback 'transactions.information_schema'
[0m14:18:00.079287 [debug] [ThreadPool]: On transactions.information_schema: Close
[0m14:18:00.139567 [info ] [MainThread]: Catalog written to /Users/roman/Desktop/hw4-mlops-bokhyan/dbt/target/catalog.json
[0m14:18:00.141327 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 1.124544, "process_user_time": 1.558145, "process_kernel_time": 0.265811, "process_mem_max_rss": "157319168", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:18:00.142446 [debug] [MainThread]: Command `dbt docs generate` succeeded at 14:18:00.142352 after 1.13 seconds
[0m14:18:00.143203 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m14:18:00.143751 [debug] [MainThread]: Connection 'transactions.information_schema' was properly closed.
[0m14:18:00.143987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10254a450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a2cbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10663c0d0>]}
[0m14:18:00.144358 [debug] [MainThread]: Flushing usage events
